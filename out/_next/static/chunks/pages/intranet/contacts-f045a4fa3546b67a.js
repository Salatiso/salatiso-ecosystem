(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3996],{24069:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/intranet/contacts",function(){return s(41894)}])},41894:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return tt}});var a=s(85893),n=s(67294),r=s(12023),l=s(89176),i=s(55264),o=s(37864),c=s(43283),d=s(12779),u=s(4270),m=s(72887),x=s(33243),h=s(84056),g=s(36127),b=s(73416),p=s(38361),y=s(11199),f=s(62190),N=s(21603),j=s(12220),v=s(60837),w=s(98264),C=s(8267),k=s(15928),S=s(43832),Z=s(96921),E=s(86691),A=s(60493),M=s(21992),F=s(23603),T=s(96815),L=s(21700),D=s(3350),I=s(32257),R=s(2553),B=s(43765),P=s(60641),O=s(72577);var z=e=>{let{contact:t,onClose:s,onSendSuccess:l}=e;var i;const[o,c]=(0,n.useState)("sonny-invite"),[d,u]=(0,n.useState)(""),[m,x]=(0,n.useState)(""),[h,g]=(0,n.useState)(!1),[b,p]=(0,n.useState)(!1),[y,f]=(0,n.useState)(""),N=[{id:"sonny-invite",name:"Sonny Network Invitation",subject:"Join the Sonny Network - Family Connection",body:"Hi ".concat(t.firstName,",\n\nI would like to invite you to join the Sonny Network, our family's digital ecosystem for staying connected and collaborating together.\n\nThe Sonny Network helps us:\n\u2022 Stay connected with family members\n\u2022 Share important updates and documents\n\u2022 Collaborate on family projects\n\u2022 Access family resources and templates\n\nTo get started, please visit: https://salatiso-lifecv.web.app/\n\nLooking forward to connecting with you!\n\nBest regards"),category:"sonny"},{id:"household-invite",name:"Household Member Invitation",subject:"Welcome to Our Household Network",body:"Hi ".concat(t.firstName,",\n\nI'm inviting you to join our household network on the MNI platform. This will help us coordinate household activities, share calendars, and stay organized.\n\nBenefits:\n\u2022 Shared family calendar\n\u2022 Household task management\n\u2022 Document sharing\n\u2022 Emergency contacts\n\nJoin us at: https://salatiso-lifecv.web.app/\n\nWarm regards"),category:"sonny"},{id:"business-collab",name:"Business Collaboration Invitation",subject:"Collaborate on MNI Business Platform",body:"Hi ".concat(t.firstName,",\n\nI'd like to invite you to collaborate on the MNI Business Platform. This platform helps us manage projects, share documents, and work together more effectively.\n\nKey Features:\n\u2022 Project management tools\n\u2022 Document collaboration\n\u2022 Business templates\n\u2022 Professional networking\n\nGet started: https://salatiso-lifecv.web.app/\n\nLooking forward to working together!\n\nBest regards"),category:"business"},{id:"community-invite",name:"Community Engagement Invitation",subject:"Join Our Community Platform",body:"Hi ".concat(t.firstName,",\n\nYou're invited to join our community platform where we share resources, collaborate on initiatives, and support each other's growth.\n\nWhat's Available:\n\u2022 Community resources\n\u2022 Educational content\n\u2022 Networking opportunities\n\u2022 Event coordination\n\nJoin the community: https://salatiso-lifecv.web.app/\n\nSee you there!\n\nBest regards"),category:"general"},{id:"custom",name:"Custom Message",subject:"",body:"",category:"general"}],j=N.find((e=>e.id===o));return(0,a.jsx)(O.uj,{isOpen:!0,onClose:s,title:"Send Email Invitation",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsx)("div",{className:"bg-ubuntu-warm-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-ubuntu-orange rounded-full flex items-center justify-center",children:(0,a.jsx)(C.Z,{className:"w-6 h-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"font-semibold text-gray-900",children:[t.firstName," ",t.lastName]}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:t.emails&&t.emails.length>0?(0,a.jsxs)("span",{className:"flex items-center gap-1",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),t.emails[0]]}):(0,a.jsx)("span",{className:"text-red-600",children:"No email address"})})]})]})}),(0,a.jsxs)("div",{children:[(0,a.jsx)(O.SB,{label:"Email Template",value:o,onChange:e=>{return t=e.target.value,c(t),f(""),void("custom"===t&&(u(""),x("")));var t},options:N.map((e=>({value:e.id,label:e.name})))}),(0,a.jsx)("p",{className:"mt-1 text-sm text-gray-500",children:"Choose a pre-written template or create a custom message"})]}),"custom"===o?(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject"}),(0,a.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),placeholder:"Email subject",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ubuntu-orange focus:border-transparent"})]}),(0,a.jsx)(O.eP,{label:"Message",value:m,onChange:e=>x(e.target.value),placeholder:"Type your custom message here...",rows:8})]}):(0,a.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5 text-ubuntu-orange"}),(0,a.jsx)("h4",{className:"font-semibold text-gray-900",children:"Preview"})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Subject:"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:null===j||void 0===j?void 0:j.subject})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-600 mb-1",children:"Message:"}),(0,a.jsx)("p",{className:"text-sm text-gray-700 whitespace-pre-line",children:null===j||void 0===j?void 0:j.body})]})]})]}),y&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-red-50 border border-red-200 rounded-lg p-4 flex items-start gap-3",children:[(0,a.jsx)(B.Z,{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("p",{className:"text-sm text-red-800",children:y})]}),b&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-start gap-3",children:[(0,a.jsx)(A.Z,{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-green-900",children:"Email Client Opened"}),(0,a.jsx)("p",{className:"text-sm text-green-700",children:"Your default email application has been opened with the message ready to send."})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:h,children:"Cancel"}),(0,a.jsx)("button",{onClick:async()=>{if(!t.emails||0===t.emails.length)return void f("This contact has no email addresses.");const e=t.emails[0];let a="custom"===o?d:(null===j||void 0===j?void 0:j.subject)||"",n="custom"===o?m:(null===j||void 0===j?void 0:j.body)||"";a=a.replace(/\{firstName\}/g,t.firstName),n=n.replace(/\{firstName\}/g,t.firstName),n=n.replace(/\{lastName\}/g,t.lastName);const r="mailto:".concat(e,"?subject=").concat(encodeURIComponent(a),"&body=").concat(encodeURIComponent(n));try{g(!0),window.location.href=r,await I.Z.markInvitationSent(t.id),setTimeout((()=>{g(!1),p(!0),l&&l(),setTimeout((()=>{s()}),2e3)}),1e3)}catch(i){g(!1),f("Failed to open email client. Please try again.")}},disabled:h||b||!(null===(i=t.emails)||void 0===i?void 0:i.length)||"custom"===o&&(!d||!m),className:"flex-1 px-4 py-2 bg-ubuntu-orange text-white rounded-lg hover:bg-ubuntu-orange-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}),"Opening..."]}):b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),"Sent"]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(F.Z,{className:"w-4 h-4"}),"Send Email"]})})]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 text-center",children:"This will open your default email application with the message pre-filled. You can review and edit before sending."})]})})},U=s(69819);var _=e=>{let{contact:t,onClose:s,onSave:i}=e;var o;const[c,d]=(0,n.useState)(!1),[u,m]=(0,n.useState)({isHouseholdMember:t.isHouseholdMember||!1,isFamilyMember:t.isFamilyMember||!1,sonnyRole:t.sonnyRole||"none"}),x=[{value:"none",label:"No Monitoring",description:"Standard contact"},{value:"monitor",label:"I Monitor Them",description:"You watch this contact"},{value:"monitored",label:"They Monitor Me",description:"This contact watches you"},{value:"both",label:"Mutual Monitoring",description:"Bidirectional monitoring"}];return(0,a.jsx)(O.uj,{isOpen:!0,onClose:s,title:"Classify ".concat(t.firstName," ").concat(t.lastName),size:"md",children:(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-ubuntu-warm-900",children:"Relationship Classification"}),(0,a.jsxs)(r.E.label,{whileHover:{scale:1.02},className:"flex items-center p-4 border border-indigo-200 rounded-lg cursor-pointer hover:bg-indigo-50 transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:u.isFamilyMember,onChange:e=>m((t=>({...t,isFamilyMember:e.target.checked}))),className:"w-4 h-4 text-indigo-600 rounded focus:ring-2 focus:ring-indigo-500"}),(0,a.jsxs)("div",{className:"ml-3 flex items-center space-x-2",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-indigo-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-ubuntu-warm-900",children:"Family Member"}),(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-600",children:"This person is part of your family"})]})]})]}),(0,a.jsxs)(r.E.label,{whileHover:{scale:1.02},className:"flex items-center p-4 border border-orange-200 rounded-lg cursor-pointer hover:bg-orange-50 transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:u.isHouseholdMember,onChange:e=>m((t=>({...t,isHouseholdMember:e.target.checked}))),className:"w-4 h-4 text-orange-600 rounded focus:ring-2 focus:ring-orange-500"}),(0,a.jsxs)("div",{className:"ml-3 flex items-center space-x-2",children:[(0,a.jsx)(p.Z,{className:"w-5 h-5 text-orange-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-ubuntu-warm-900",children:"Household Member"}),(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-600",children:"This person lives in your household"})]})]})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium text-ubuntu-warm-900",children:"Monitoring Role (Sonny)"}),(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-600",children:"Set how you interact with this contact in the Sonny Network"}),(0,a.jsx)("div",{className:"space-y-2",children:x.map((e=>(0,a.jsxs)(r.E.label,{whileHover:{scale:1.01},className:"flex items-center p-4 border-2 rounded-lg cursor-pointer transition-all ".concat(u.sonnyRole===e.value?"border-ubuntu-gold bg-ubuntu-gold/5":"border-ubuntu-warm-200 hover:border-ubuntu-gold/50"),children:[(0,a.jsx)("input",{type:"radio",name:"sonnyRole",value:e.value,checked:u.sonnyRole===e.value,onChange:e=>m((t=>({...t,sonnyRole:e.target.value}))),className:"w-4 h-4 text-ubuntu-gold focus:ring-2 focus:ring-ubuntu-gold"}),(0,a.jsxs)("div",{className:"ml-3 flex items-center space-x-2 flex-1",children:["none"===e.value&&(0,a.jsx)(k.Z,{className:"w-5 h-5 text-gray-400"}),"monitor"===e.value&&(0,a.jsx)(k.Z,{className:"w-5 h-5 text-ubuntu-gold"}),"monitored"===e.value&&(0,a.jsx)(S.Z,{className:"w-5 h-5 text-purple-600"}),"both"===e.value&&(0,a.jsx)(Z.Z,{className:"w-5 h-5 text-ubuntu-orange"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-ubuntu-warm-900",children:e.label}),(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-600",children:e.description})]})]})]},e.value)))})]}),(0,a.jsxs)("div",{className:"bg-ubuntu-aubergine/5 border border-ubuntu-aubergine/20 rounded-lg p-4 space-y-2",children:[(0,a.jsx)("h4",{className:"font-medium text-ubuntu-aubergine",children:"Classification Summary"}),(0,a.jsxs)("ul",{className:"text-sm text-ubuntu-warm-700 space-y-1",children:[u.isFamilyMember&&(0,a.jsx)("li",{children:"\u2713 Marked as family member"}),u.isHouseholdMember&&(0,a.jsx)("li",{children:"\u2713 Marked as household member"}),"none"!==u.sonnyRole&&(0,a.jsxs)("li",{children:["\u2713 Sonny role: ",null===(o=x.find((e=>e.value===u.sonnyRole)))||void 0===o?void 0:o.label]}),!u.isFamilyMember&&!u.isHouseholdMember&&"none"===u.sonnyRole&&(0,a.jsx)("li",{className:"text-gray-400",children:"\u2022 No classification set"})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-4 border-t border-ubuntu-warm-100",children:[(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 text-ubuntu-warm-700 border border-ubuntu-warm-300 rounded-lg hover:bg-ubuntu-warm-50 transition-colors",children:"Cancel"}),(0,a.jsx)("button",{onClick:async()=>{d(!0);try{const e={...t,...u,updatedAt:new Date};await I.V.updateContact(t.id,{isHouseholdMember:u.isHouseholdMember,isFamilyMember:u.isFamilyMember,sonnyRole:u.sonnyRole}),i&&i(e),s()}catch(e){}finally{d(!1)}},disabled:c,className:"flex items-center space-x-2 px-4 py-2 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-orange disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}),(0,a.jsx)("span",{children:"Saving..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(U.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Save Classification"})]})})]})]})})},H=s(99724),V=s(97042);var G=new class{async initializePresence(e,t){try{const s=(0,H.JU)(V.db,this.presenceCollection,e),a=await this.getPresenceSettings(e),n=(null===a||void 0===a?void 0:a.defaultStatus)||"online";await(0,H.pl)(s,{status:n,lastSeen:(0,H.Bt)(),userId:e,displayName:t||"User",updatedAt:(0,H.Bt)()},{merge:!0});const r=async()=>{document.hidden?await this.updateLastSeen(e):"invisible"!==n&&await this.setUserStatus(e,n)};document.addEventListener("visibilitychange",r),this.unsubscribers.set(e,(()=>{document.removeEventListener("visibilitychange",r)}));const l=setInterval((async()=>{document.hidden||await this.updateLastSeen(e)}),3e4),i=this.unsubscribers.get(e);this.unsubscribers.set(e,(()=>{null===i||void 0===i||i(),clearInterval(l)}))}catch(s){throw s}}async cleanupPresence(e){try{const t=this.unsubscribers.get(e);t&&(t(),this.unsubscribers.delete(e));const s=(0,H.JU)(V.db,this.presenceCollection,e);await(0,H.r7)(s,{status:"offline",lastSeen:(0,H.Bt)(),updatedAt:(0,H.Bt)()})}catch(t){}}async setUserStatus(e,t){try{const s=(0,H.JU)(V.db,this.presenceCollection,e);await(0,H.r7)(s,{status:t,lastSeen:(0,H.Bt)(),updatedAt:(0,H.Bt)()})}catch(s){throw s}}async updateLastSeen(e){try{const t=(0,H.JU)(V.db,this.presenceCollection,e);await(0,H.r7)(t,{lastSeen:(0,H.Bt)(),updatedAt:(0,H.Bt)()})}catch(t){}}async getUserPresence(e){try{var t;const s=(0,H.JU)(V.db,this.presenceCollection,e),a=await(0,H.QT)(s);if(!a.exists())return null;const n=a.data();return{status:n.status,lastSeen:(null===(t=n.lastSeen)||void 0===t?void 0:t.toDate())||new Date,userId:n.userId,displayName:n.displayName}}catch(s){return null}}subscribeToPresence(e,t){try{const s=(0,H.JU)(V.db,this.presenceCollection,e);return(0,H.cf)(s,(e=>{var s;if(!e.exists())return void t(null);const a=e.data();t({status:a.status,lastSeen:(null===(s=a.lastSeen)||void 0===s?void 0:s.toDate())||new Date,userId:a.userId,displayName:a.displayName})}),(e=>{t(null)}))}catch(s){return()=>{}}}async getPresenceSettings(e){try{const t=(0,H.JU)(V.db,this.settingsCollection,e),s=await(0,H.QT)(t);if(!s.exists())return{defaultStatus:"online",showOnlineStatus:!0,allowFamilyToSee:!0,allowContactsToSee:!0};const a=s.data();return{defaultStatus:a.defaultStatus||"online",showOnlineStatus:!1!==a.showOnlineStatus,allowFamilyToSee:!1!==a.allowFamilyToSee,allowContactsToSee:!1!==a.allowContactsToSee}}catch(t){return null}}async updatePresenceSettings(e,t){try{const s=(0,H.JU)(V.db,this.settingsCollection,e);await(0,H.pl)(s,{...t,updatedAt:(0,H.Bt)()},{merge:!0}),t.defaultStatus&&await this.setUserStatus(e,t.defaultStatus)}catch(s){throw s}}async canSeePresence(e,t,s){try{const e=await this.getPresenceSettings(t);return!(!e||!e.showOnlineStatus)&&("family"===s?e.allowFamilyToSee:"contact"===s&&e.allowContactsToSee)}catch(a){return!1}}formatLastSeen(e,t){if("online"===t)return"Active now";if("invisible"===t)return"Offline";const s=(new Date).getTime()-e.getTime(),a=Math.floor(s/6e4),n=Math.floor(a/60),r=Math.floor(n/24);return a<1?"Just now":a<60?"".concat(a," ").concat(1===a?"minute":"minutes"," ago"):n<24?"".concat(n," ").concat(1===n?"hour":"hours"," ago"):r<7?"".concat(r," ").concat(1===r?"day":"days"," ago"):e.toLocaleDateString()}async getBatchPresence(e){const t=new Map;try{const s=e.map((async e=>{const s=await this.getUserPresence(e);s&&t.set(e,s)}));await Promise.all(s)}catch(s){}return t}constructor(){this.presenceCollection="presence",this.settingsCollection="userSettings",this.unsubscribers=new Map}};var J=e=>{let{userId:t,showLabel:s=!1,size:l="md",className:i=""}=e;const[o,c]=(0,n.useState)(null),[d,u]=(0,n.useState)(!0);if((0,n.useEffect)((()=>{const e=G.subscribeToPresence(t,(e=>{c(e),u(!1)}));return()=>{e()}}),[t]),d)return null;if(!o)return null;const m={sm:"w-2 h-2",md:"w-3 h-3",lg:"w-4 h-4"};return(0,a.jsxs)("div",{className:"inline-flex items-center gap-1.5 ".concat(i),children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(r.E.div,{className:"".concat(m[l]," rounded-full ").concat((x=o.status,"online"===x?"bg-green-500":"bg-gray-400")," ").concat({sm:"ring-1",md:"ring-2",lg:"ring-2"}[l]," ring-white"),initial:{scale:0},animate:{scale:1},transition:{type:"spring",stiffness:500,damping:30}}),"online"===o.status&&(0,a.jsx)(r.E.div,{className:"absolute inset-0 ".concat(m[l]," rounded-full bg-green-500 opacity-75"),animate:{scale:[1,1.5,1],opacity:[.75,0,.75]},transition:{duration:2,repeat:1/0,ease:"easeInOut"}})]}),s&&(0,a.jsx)("span",{className:"text-xs text-gray-600",children:"online"===o.status?"Active now":G.formatLastSeen(o.lastSeen,o.status)})]});var x},W=s(51526),Y=s(71601),q=s(80893),K=s(15432),X=s(42171);const Q=new class{calculateDistance(e,t){const s=Array(t.length+1).fill(null).map((()=>Array(e.length+1).fill(null)));for(let a=0;a<=e.length;a+=1)s[0][a]=a;for(let a=0;a<=t.length;a+=1)s[a][0]=a;for(let a=1;a<=t.length;a+=1)for(let n=1;n<=e.length;n+=1){const r=e[n-1]===t[a-1]?0:1;s[a][n]=Math.min(s[a][n-1]+1,s[a-1][n]+1,s[a-1][n-1]+r)}return s[t.length][e.length]}calculateSimilarity(e,t){const s=this.calculateDistance(e.toLowerCase(),t.toLowerCase()),a=Math.max(e.length,t.length);return Math.round(100*(1-s/a))}extractCity(e){const t=e.split(",");return t[t.length-1].trim().toLowerCase()}findSurnameSuggestions(e,t){const s=[],a=e.lastName.toLowerCase();for(const n of t){if(n.id===e.id)continue;const t=this.calculateSimilarity(a,n.lastName);t>=85&&s.push({contactId:e.id,suggestedContactId:n.id,suggestedContact:n,reason:'Matching surname: "'.concat(e.lastName,'" vs "').concat(n.lastName,'"'),confidence:t,matchType:"surname"})}return s}findAddressSuggestions(e,t){const s=[],a=e.addresses.map((e=>this.extractCity(e))).filter((e=>e.length>2));if(0===a.length)return s;for(const n of t){if(n.id===e.id)continue;const t=n.addresses.map((e=>this.extractCity(e))).filter((e=>e.length>2));for(const r of a){for(const a of t){const t=this.calculateSimilarity(r,a);if(t>=85){s.push({contactId:e.id,suggestedContactId:n.id,suggestedContact:n,reason:'Same location: Both in "'.concat(r,'"'),confidence:Math.min(95,t+10),matchType:"address"});break}}if(s.length>0)break}}return s}findMutualConnectionSuggestions(e,t){const s=[];for(const a of t){if(a.id===e.id)continue;const t=e.tags.filter((e=>a.tags.includes(e)));if(t.length>0){const n=Math.min(90,30*t.length);s.push({contactId:e.id,suggestedContactId:a.id,suggestedContact:a,reason:"Shared interests: ".concat(t.join(", ")),confidence:n,matchType:"mutual_friend"})}}return s}findCategorySuggestions(e,t){const s=[];if(!["business","professional"].includes(e.category))return s;for(const a of t)a.id!==e.id&&a.category===e.category&&s.push({contactId:e.id,suggestedContactId:a.id,suggestedContact:a,reason:"Both ".concat(e.category," contacts"),confidence:65,matchType:"same_organization"});return s}async getSuggestions(e,t){const s=[];s.push(...this.findSurnameSuggestions(e,t)),s.push(...this.findAddressSuggestions(e,t)),s.push(...this.findMutualConnectionSuggestions(e,t)),s.push(...this.findCategorySuggestions(e,t));const a=new Map;for(const n of s){const e="".concat(n.contactId,"-").concat(n.suggestedContactId),t=a.get(e);(!t||n.confidence>t.confidence)&&a.set(e,n)}return Array.from(a.values()).sort(((e,t)=>t.confidence-e.confidence))}async getTopSuggestions(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;return(await this.getSuggestions(e,t)).slice(0,s)}};var $=e=>{let{contact:t,allContacts:s,onContactClick:i,maxSuggestions:o=3,compact:c=!1}=e;const[d,u]=(0,n.useState)([]),[m,x]=(0,n.useState)(!c),[h,g]=(0,n.useState)(!0);if((0,n.useEffect)((()=>{(async()=>{try{g(!0);const e=await Q.getSuggestions(t,s);u(e.slice(0,o))}catch(e){}finally{g(!1)}})()}),[t,s,o]),h||0===d.length)return null;const b=e=>{switch(e){case"surname":return(0,a.jsx)(Y.Z,{className:"w-4 h-4 text-red-500"});case"address":return(0,a.jsx)(p.Z,{className:"w-4 h-4 text-blue-500"});case"mutual_friend":return(0,a.jsx)(l.Z,{className:"w-4 h-4 text-green-500"});case"same_organization":return(0,a.jsx)(q.Z,{className:"w-4 h-4 text-purple-500"});default:return(0,a.jsx)(B.Z,{className:"w-4 h-4 text-gray-500"})}},y=e=>{switch(e){case"surname":return"Family";case"address":return"Household";case"mutual_friend":return"Shared Interest";case"same_organization":return"Organization";default:return"Connection"}};return c?(0,a.jsxs)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"mt-3 pt-3 border-t border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 text-ubuntu-gold"}),(0,a.jsxs)("p",{className:"text-xs font-medium text-ubuntu-warm-700",children:[d.length," suggestion",1!==d.length?"s":""]})]}),(0,a.jsx)("button",{onClick:()=>x(!m),className:"text-ubuntu-warm-500 hover:text-ubuntu-warm-700 transition-colors",children:m?(0,a.jsx)(K.Z,{className:"w-4 h-4"}):(0,a.jsx)(X.Z,{className:"w-4 h-4"})})]}),(0,a.jsx)(W.M,{children:m&&(0,a.jsx)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-1",children:d.map(((e,t)=>(0,a.jsx)(r.E.button,{onClick:()=>i(e.suggestedContact),className:"w-full text-left px-2 py-1.5 rounded-lg hover:bg-ubuntu-warm-50 transition-colors group",children:(0,a.jsx)("div",{className:"flex items-center justify-between",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 flex-1 min-w-0",children:[b(e.matchType),(0,a.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,a.jsxs)("p",{className:"text-xs font-medium text-ubuntu-warm-900 truncate",children:[e.suggestedContact.firstName," ",e.suggestedContact.lastName]}),(0,a.jsxs)("p",{className:"text-xs text-ubuntu-warm-500",children:[y(e.matchType)," \u2022 ",e.confidence,"%"]})]})]})})},t)))})})]}):(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg p-4 border border-blue-100",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-3",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5 text-ubuntu-gold"}),(0,a.jsx)("h3",{className:"font-medium text-ubuntu-warm-900",children:"You might know"}),(0,a.jsx)("span",{className:"text-xs bg-ubuntu-gold text-white px-2 py-0.5 rounded-full",children:d.length})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-2",children:d.map(((e,t)=>(0,a.jsxs)(r.E.button,{whileHover:{scale:1.02},onClick:()=>i(e.suggestedContact),className:"text-left p-3 bg-white rounded-lg border border-gray-200 hover:border-ubuntu-gold hover:shadow-md transition-all group",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("p",{className:"font-medium text-ubuntu-warm-900 truncate",children:[e.suggestedContact.firstName," ",e.suggestedContact.lastName]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1.5 mt-1",children:[b(e.matchType),(0,a.jsx)("span",{className:"text-xs text-ubuntu-warm-600",children:y(e.matchType)})]})]}),(0,a.jsxs)("div",{className:"ml-2 text-xs font-semibold text-ubuntu-gold bg-ubuntu-warm-50 px-2 py-1 rounded",children:[e.confidence,"%"]})]}),(0,a.jsx)("p",{className:"text-xs text-ubuntu-warm-500 mt-2 line-clamp-2",children:e.reason})]},t)))})]})},ee=s(68760),te=s(82606);var se=e=>{let{contactId:t,userId:s,images:l=[],onImagesUpdate:i,maxImages:o=5,compact:d=!1}=e;const[u,m]=(0,n.useState)(!1),[x,h]=(0,n.useState)({}),[g,b]=(0,n.useState)(!1),[p,y]=(0,n.useState)(null),N=(0,n.useRef)(null),j=async e=>{if(!e||0===e.length)return;const t=Array.from(e),s=o-l.length;if(t.length>s)y("You can only add ".concat(s," more image(s). Maximum is ").concat(o," per contact."));else{y(null),m(!0);try{for(const s of t){if(!s.type.startsWith("image/"))throw new Error("Only image files are allowed");if(s.size>5242880)throw new Error("Image size must be less than 5MB")}const e=[];for(const s of t){const a=new FileReader,n=Math.random().toString(36).substring(7);a.onload=s=>{var a;(null===(a=s.target)||void 0===a?void 0:a.result)&&(e.push(s.target.result),h((e=>({...e,[n]:100}))),e.length===t.length&&(i([...l,...e]),m(!1),h({}),N.current&&(N.current.value="")))},a.onerror=()=>{y("Failed to read file"),m(!1)},a.readAsDataURL(s),h((e=>({...e,[n]:30})))}}catch(a){const e=a instanceof Error?a.message:"Failed to upload images";y(e),m(!1)}}},v=l.length<o;return d&&0===l.length?(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-blue-100 text-blue-700 hover:bg-blue-200 transition-colors",title:"Add images to this contact",disabled:u,children:[(0,a.jsx)(ee.Z,{className:"w-3 h-3 mr-1"}),"Add Photos (",l.length,"/",o,")"]}):(0,a.jsxs)("div",{className:"space-y-4",children:[l.length>0&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-2",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-ubuntu-warm-900",children:["Photos (",l.length,"/",o,")"]}),(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:(0,a.jsx)(W.M,{children:l.map(((e,t)=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.8},className:"relative group",children:[(0,a.jsx)("img",{src:e,alt:"Contact photo ".concat(t+1),className:"w-full h-24 object-cover rounded-lg border border-ubuntu-warm-200"}),(0,a.jsx)("button",{onClick:()=>(e=>{const t=l.filter(((t,s)=>s!==e));i(t)})(t),className:"absolute top-1 right-1 p-1 bg-red-500 text-white rounded-full opacity-0 group-hover:opacity-100 transition-opacity",title:"Remove image",children:(0,a.jsx)(f.Z,{className:"w-3 h-3"})})]},t)))})})]}),v&&(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"space-y-3",children:[(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),b(!0)},onDragLeave:()=>b(!1),onDrop:e=>{e.preventDefault(),e.stopPropagation(),b(!1),j(e.dataTransfer.files)},onClick:()=>{var e;return null===(e=N.current)||void 0===e?void 0:e.click()},className:"border-2 border-dashed rounded-lg p-6 text-center cursor-pointer transition-all ".concat(g?"border-ubuntu-gold bg-ubuntu-gold/5":"border-ubuntu-warm-300 hover:border-ubuntu-gold hover:bg-ubuntu-warm-50"," ").concat(u?"opacity-50 cursor-not-allowed":""),children:[(0,a.jsx)("input",{ref:N,type:"file",multiple:!0,accept:"image/*",onChange:e=>j(e.target.files),className:"hidden",disabled:u}),(0,a.jsx)("div",{className:"flex flex-col items-center gap-2",children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(te.Z,{className:"w-8 h-8 text-ubuntu-gold animate-spin"}),(0,a.jsx)("p",{className:"text-sm font-medium text-ubuntu-warm-700",children:"Uploading images..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"w-8 h-8 text-ubuntu-gold"}),(0,a.jsx)("p",{className:"text-sm font-medium text-ubuntu-warm-900",children:"Drag and drop images here"}),(0,a.jsxs)("p",{className:"text-xs text-ubuntu-warm-600",children:["or click to browse (",l.length,"/",o," used)"]}),(0,a.jsxs)("p",{className:"text-xs text-ubuntu-warm-500 mt-1",children:["Max 5MB per image, up to ",o-l.length," more"]})]})})]}),p&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:[(0,a.jsx)("p",{className:"font-medium",children:p}),(0,a.jsx)("button",{onClick:()=>y(null),className:"text-red-600 hover:text-red-800 underline text-xs mt-1",children:"Dismiss"})]})]}),!v&&(0,a.jsxs)("div",{className:"p-3 bg-blue-50 border border-blue-200 rounded-lg text-blue-700 text-sm",children:[(0,a.jsx)("p",{className:"font-medium",children:"Maximum images reached"}),(0,a.jsx)("p",{className:"text-xs mt-1",children:"Remove an image to add more"})]})]})},ae=s(59442),ne=s(18277),re=s(52790);const le=[{id:"spouse",label:"Spouse",icon:Y.Z,color:"text-red-500"},{id:"child",label:"Child",icon:ae.Z,color:"text-blue-500"},{id:"parent",label:"Parent",icon:C.Z,color:"text-purple-500"},{id:"sibling",label:"Sibling",icon:ne.Z,color:"text-green-500"},{id:"friend",label:"Friend",icon:l.Z,color:"text-yellow-500"},{id:"colleague",label:"Colleague",icon:q.Z,color:"text-blue-600"},{id:"other",label:"Other",icon:re.Z,color:"text-gray-500"}];var ie=e=>{let{contact:t,allContacts:s,relationships:i=[],onAddRelationship:c,onRemoveRelationship:d,compact:m=!1}=e;const[x,h]=(0,n.useState)(!m),[g,b]=(0,n.useState)(!1),[p,y]=(0,n.useState)("spouse"),[f,N]=(0,n.useState)(""),j=s.filter((e=>e.id!==t.id)),v=le.map((e=>({...e,relationships:i.filter((t=>t.type===e.id))}))).filter((e=>e.relationships.length>0));return m&&0===i.length?(0,a.jsxs)("button",{onClick:()=>h(!0),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-purple-100 text-purple-700 hover:bg-purple-200 transition-colors",title:"Add relationships",children:[(0,a.jsx)(l.Z,{className:"w-3 h-3 mr-1"}),"Add Relationships (",i.length,")"]}):(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("button",{onClick:()=>h(!x),className:"flex items-center gap-2 font-semibold text-ubuntu-warm-900 hover:text-ubuntu-gold transition-colors",children:[(0,a.jsx)(l.Z,{className:"w-5 h-5"}),"Relationships",x?(0,a.jsx)(K.Z,{className:"w-4 h-4"}):(0,a.jsx)(X.Z,{className:"w-4 h-4"})]}),(0,a.jsxs)("span",{className:"text-sm font-medium text-ubuntu-warm-600",children:[i.length," relationship",1!==i.length?"s":""]})]}),(0,a.jsx)(W.M,{children:x&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"space-y-3",children:[v.length>0?(0,a.jsx)("div",{className:"space-y-2",children:v.map((e=>{const t=e.icon;return(0,a.jsxs)("div",{className:"space-y-1",children:[(0,a.jsxs)("h4",{className:"text-xs font-semibold text-ubuntu-warm-700 flex items-center gap-2",children:[(0,a.jsx)(t,{className:"w-3 h-3 ".concat(e.color)}),e.label,"s"]}),(0,a.jsx)("div",{className:"ml-4 space-y-1",children:e.relationships.map((e=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,x:-10},animate:{opacity:1,x:0},exit:{opacity:0,x:-10},className:"flex items-center justify-between p-2 bg-ubuntu-warm-50 rounded border border-ubuntu-warm-200 hover:bg-ubuntu-warm-100 transition-colors",children:[(0,a.jsx)("span",{className:"text-sm text-ubuntu-warm-900 font-medium",children:e.contactName}),(0,a.jsx)("button",{onClick:()=>d(e.type,e.contactId),className:"text-ubuntu-warm-500 hover:text-red-600 transition-colors",title:"Remove relationship",children:(0,a.jsx)(o.Z,{className:"w-3 h-3"})})]},"".concat(e.type,"-").concat(e.contactId))))})]},e.id)}))}):(0,a.jsx)("div",{className:"p-3 bg-ubuntu-warm-50 rounded border border-dashed border-ubuntu-warm-300 text-center",children:(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-600",children:"No relationships added yet"})}),g?(0,a.jsxs)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"p-3 bg-blue-50 rounded-lg border border-blue-200 space-y-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-ubuntu-warm-900 mb-2",children:"Relationship Type"}),(0,a.jsx)("select",{value:p,onChange:e=>y(e.target.value),className:"w-full px-3 py-2 rounded border border-blue-300 text-sm focus:outline-none focus:ring-2 focus:ring-ubuntu-gold",children:le.map((e=>(0,a.jsx)("option",{value:e.id,children:e.label},e.id)))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-xs font-semibold text-ubuntu-warm-900 mb-2",children:"Select Contact"}),(0,a.jsxs)("select",{value:f,onChange:e=>N(e.target.value),className:"w-full px-3 py-2 rounded border border-blue-300 text-sm focus:outline-none focus:ring-2 focus:ring-ubuntu-gold max-h-48",children:[(0,a.jsx)("option",{value:"",children:"Choose a contact..."}),j.map((e=>(0,a.jsxs)("option",{value:e.id,children:[e.firstName," ",e.lastName]},e.id)))]})]}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(!f)return;const e=j.find((e=>e.id===f));e&&(c({type:p,contactId:f,contactName:"".concat(e.firstName," ").concat(e.lastName)}),N(""),y("spouse"),b(!1))},disabled:!f,className:"flex-1 px-3 py-2 bg-blue-600 text-white rounded text-sm font-medium hover:bg-blue-700 disabled:bg-gray-300 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1 inline"}),"Add Relationship"]}),(0,a.jsx)("button",{onClick:()=>b(!1),className:"px-3 py-2 bg-gray-200 text-gray-800 rounded text-sm font-medium hover:bg-gray-300 transition-colors",children:"Cancel"})]})]}):(0,a.jsxs)("button",{onClick:()=>b(!0),disabled:0===j.length,className:"w-full px-3 py-2 border border-dashed border-ubuntu-gold text-ubuntu-gold rounded-lg text-sm font-medium hover:bg-ubuntu-gold/5 disabled:border-gray-300 disabled:text-gray-400 transition-colors",title:0===j.length?"No other contacts available":"Add a relationship",children:[(0,a.jsx)(u.Z,{className:"w-3 h-3 mr-1 inline"}),"Add Relationship"]})]})})]})};const oe=[{id:"family-member",label:"Family Member",category:"family",color:"bg-blue-100 text-blue-700 border-blue-300",description:"Close family member"},{id:"immediate-family",label:"Immediate Family",category:"family",color:"bg-blue-100 text-blue-700 border-blue-300",description:"Parent, sibling, or child"},{id:"extended-family",label:"Extended Family",category:"family",color:"bg-indigo-100 text-indigo-700 border-indigo-300",description:"Aunt, uncle, cousin, etc."},{id:"in-law",label:"In-Law",category:"family",color:"bg-purple-100 text-purple-700 border-purple-300",description:"Family through marriage"},{id:"business-partner",label:"Business Partner",category:"business",color:"bg-yellow-100 text-yellow-700 border-yellow-300",description:"Business collaboration partner"},{id:"client",label:"Client",category:"business",color:"bg-green-100 text-green-700 border-green-300",description:"Business client or customer"},{id:"supplier",label:"Supplier",category:"business",color:"bg-orange-100 text-orange-700 border-orange-300",description:"Service or product supplier"},{id:"investor",label:"Investor",category:"business",color:"bg-emerald-100 text-emerald-700 border-emerald-300",description:"Financial investor or backer"},{id:"mentor",label:"Mentor",category:"business",color:"bg-teal-100 text-teal-700 border-teal-300",description:"Business mentor or advisor"},{id:"community-lead",label:"Community Lead",category:"community",color:"bg-pink-100 text-pink-700 border-pink-300",description:"Community leadership role"},{id:"education-lead",label:"Education Lead",category:"community",color:"bg-cyan-100 text-cyan-700 border-cyan-300",description:"Leads educational initiatives"},{id:"volunteer",label:"Volunteer",category:"community",color:"bg-lime-100 text-lime-700 border-lime-300",description:"Community volunteer"},{id:"neighbor",label:"Neighbor",category:"community",color:"bg-amber-100 text-amber-700 border-amber-300",description:"Lives nearby"},{id:"tech-expert",label:"Tech Expert",category:"skills",color:"bg-violet-100 text-violet-700 border-violet-300",description:"Technology expertise"},{id:"creative",label:"Creative",category:"skills",color:"bg-fuchsia-100 text-fuchsia-700 border-fuchsia-300",description:"Creative skills (art, design, etc.)"},{id:"healthcare",label:"Healthcare",category:"skills",color:"bg-red-100 text-red-700 border-red-300",description:"Healthcare professional"},{id:"legal",label:"Legal",category:"skills",color:"bg-slate-100 text-slate-700 border-slate-300",description:"Legal expertise"},{id:"finance",label:"Finance",category:"skills",color:"bg-emerald-100 text-emerald-700 border-emerald-300",description:"Financial expertise"},{id:"emergency-contact",label:"Emergency Contact",category:"role",color:"bg-red-100 text-red-700 border-red-300",description:"Contact in case of emergency"},{id:"trusted-advisor",label:"Trusted Advisor",category:"role",color:"bg-blue-100 text-blue-700 border-blue-300",description:"Trusted for advice and guidance"},{id:"collaborator",label:"Collaborator",category:"role",color:"bg-purple-100 text-purple-700 border-purple-300",description:"Active project collaborator"},{id:"close-friend",label:"Close Friend",category:"relationship",color:"bg-pink-100 text-pink-700 border-pink-300",description:"Close personal friend"},{id:"acquaintance",label:"Acquaintance",category:"relationship",color:"bg-gray-100 text-gray-700 border-gray-300",description:"Known but not close"},{id:"school-friend",label:"School Friend",category:"relationship",color:"bg-blue-100 text-blue-700 border-blue-300",description:"Friend from school/university"},{id:"work-colleague",label:"Work Colleague",category:"relationship",color:"bg-indigo-100 text-indigo-700 border-indigo-300",description:"Current or former colleague"}],ce=[{id:"family",label:"Family",icon:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66"},{id:"business",label:"Business",icon:"\ud83d\udcbc"},{id:"community",label:"Community",icon:"\ud83c\udf0d"},{id:"skills",label:"Skills",icon:"\u26a1"},{id:"role",label:"Role",icon:"\ud83c\udfaf"},{id:"relationship",label:"Relationship",icon:"\u2764\ufe0f"}];function de(e){const t=oe.find((t=>t.label===e));return(null===t||void 0===t?void 0:t.color)||"bg-gray-100 text-gray-700 border-gray-300"}var ue=e=>{let{contact:t,onEdit:s,onDelete:i,onViewDetails:c,currentUserId:d,allContacts:u=[],onContactClick:m,isSelected:x=!1,onSelectChange:h}=e;var g;const[y,f]=(0,n.useState)(!1),[j,v]=(0,n.useState)(!1),[w,R]=(0,n.useState)(t.photoUrls||[]),[B,P]=(0,n.useState)((null===(g=t.relationships)||void 0===g?void 0:g.map((e=>({type:e.label.toLowerCase(),contactId:"",contactName:e.value}))))||[]),O=t.addedBy===d||"salatiso"===d;return(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-xl p-6 shadow-sm border transition-all ".concat(x?"border-ubuntu-gold border-2 bg-ubuntu-gold/5":"border-ubuntu-warm-200 hover:shadow-md"),children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 flex-1",children:[(0,a.jsx)("input",{type:"checkbox",checked:x,onChange:e=>null===h||void 0===h?void 0:h(e.target.checked),className:"mt-1 w-5 h-5 rounded border-gray-300 text-ubuntu-gold cursor-pointer"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2 mb-1",children:[(0,a.jsxs)("h3",{className:"text-lg font-ubuntu font-semibold text-ubuntu-warm-900",children:[t.firstName," ",t.lastName]}),(e=>{switch(e){case"private":return(0,a.jsx)(b.Z,{className:"w-3 h-3 text-red-500"});case"family":return(0,a.jsx)(C.Z,{className:"w-3 h-3 text-blue-500"});default:return null}})(t.privacy),(t.isFamilyMember||t.isHouseholdMember)&&t.addedBy&&(0,a.jsx)(J,{userId:t.addedBy,size:"sm"})]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 items-center",children:[(0,a.jsx)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium border ".concat((U=t.category,{family:"bg-blue-100 text-blue-700 border-blue-200",friend:"bg-green-100 text-green-700 border-green-200",business:"bg-yellow-100 text-yellow-700 border-yellow-200",professional:"bg-purple-100 text-purple-700 border-purple-200",service:"bg-red-100 text-red-700 border-red-200"}[U]||"bg-gray-100 text-gray-700 border-gray-200")),children:t.category}),t.isHouseholdMember&&(0,a.jsxs)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-orange-100 text-orange-700 border border-orange-200",children:[(0,a.jsx)(p.Z,{className:"w-3 h-3 mr-1"}),"Household"]}),t.isFamilyMember&&(0,a.jsxs)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-indigo-100 text-indigo-700 border border-indigo-200",children:[(0,a.jsx)(l.Z,{className:"w-3 h-3 mr-1"}),"Family"]}),t.sonnyRole&&"none"!==t.sonnyRole&&(0,a.jsxs)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-purple-100 text-purple-700 border border-purple-200",children:["monitor"===t.sonnyRole&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{className:"w-3 h-3 mr-1"}),"I Monitor"]}),"monitored"===t.sonnyRole&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(S.Z,{className:"w-3 h-3 mr-1"}),"They Monitor"]}),"both"===t.sonnyRole&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Z.Z,{className:"w-3 h-3 mr-1"}),"Mutual"]})]}),t.invitationStatus&&"not-invited"!==t.invitationStatus&&(0,a.jsxs)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat("invited"===t.invitationStatus?"bg-blue-100 text-blue-700 border border-blue-200":"accepted"===t.invitationStatus?"bg-green-100 text-green-700 border border-green-200":"pending"===t.invitationStatus?"bg-yellow-100 text-yellow-700 border border-yellow-200":"declined"===t.invitationStatus?"bg-red-100 text-red-700 border border-red-200":"bg-gray-100 text-gray-700 border border-gray-200"),children:["invited"===t.invitationStatus&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(E.Z,{className:"w-3 h-3 mr-1"}),"Invited"]}),"accepted"===t.invitationStatus&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.Z,{className:"w-3 h-3 mr-1"}),"Accepted"]}),"pending"===t.invitationStatus&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(M.Z,{className:"w-3 h-3 mr-1"}),"Pending"]}),"declined"===t.invitationStatus&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(M.Z,{className:"w-3 h-3 mr-1"}),"Declined"]})]})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[O&&(0,a.jsx)("button",{onClick:()=>v(!0),className:"p-1 text-ubuntu-warm-500 hover:text-ubuntu-gold transition-colors",title:"Classify contact",children:(0,a.jsx)(M.Z,{className:"w-4 h-4"})}),t.emails&&t.emails.length>0&&(0,a.jsx)("button",{onClick:()=>f(!0),className:"p-1 text-ubuntu-warm-500 hover:text-ubuntu-orange transition-colors",title:t.invitationSent?"Send another invitation":"Send email invitation",children:(0,a.jsx)(F.Z,{className:"w-4 h-4"})}),c&&(0,a.jsx)("button",{onClick:c,className:"p-1 text-ubuntu-warm-500 hover:text-ubuntu-blue transition-colors",title:"View full contact details",children:(0,a.jsx)(k.Z,{className:"w-4 h-4"})}),O&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("button",{onClick:s,className:"p-1 text-ubuntu-warm-500 hover:text-ubuntu-gold transition-colors",title:"Edit contact",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:i,className:"p-1 text-ubuntu-warm-500 hover:text-red-500 transition-colors",title:"Delete contact",children:(0,a.jsx)(o.Z,{className:"w-4 h-4"})})]})]})]}),(0,a.jsxs)("div",{className:"space-y-3",children:[t.phoneNumbers.length>0&&(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 text-ubuntu-warm-500 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex flex-col space-y-1",children:t.phoneNumbers.map(((e,t)=>(0,a.jsx)("a",{href:"tel:".concat(e),className:"text-ubuntu-warm-700 hover:text-ubuntu-gold transition-colors",children:e},t)))})]}),t.emails.length>0&&(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 text-ubuntu-warm-500 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex flex-col space-y-1",children:t.emails.map(((e,t)=>(0,a.jsx)("a",{href:"mailto:".concat(e),className:"text-ubuntu-warm-700 hover:text-ubuntu-gold transition-colors break-all",children:e},t)))})]}),t.addresses.length>0&&(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 text-ubuntu-warm-500 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex flex-col space-y-1",children:t.addresses.map(((e,t)=>(0,a.jsx)("span",{className:"text-ubuntu-warm-700 text-sm",children:e},t)))})]}),t.coordinates&&(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 text-ubuntu-orange mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"bg-ubuntu-aubergine/5 border border-ubuntu-aubergine/20 rounded-lg px-3 py-2",children:[(0,a.jsx)("p",{className:"text-xs font-medium text-ubuntu-aubergine mb-1",children:"Location on Map"}),(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-gray-600",children:[(0,a.jsxs)("span",{children:["Lat: ",t.coordinates.latitude.toFixed(4)]}),(0,a.jsxs)("span",{children:["Lng: ",t.coordinates.longitude.toFixed(4)]})]}),(0,a.jsx)("a",{href:"https://www.google.com/maps?q=".concat(t.coordinates.latitude,",").concat(t.coordinates.longitude),target:"_blank",rel:"noopener noreferrer",className:"text-xs text-ubuntu-orange hover:text-orange-600 font-medium mt-2 inline-block",children:"View on Google Maps \u2192"})]})})]}),t.tags.length>0&&(0,a.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 text-ubuntu-warm-500 mt-0.5 flex-shrink-0"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:t.tags.map((e=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs border ".concat(de(e)),children:e},e)))})]}),t.notes&&(0,a.jsx)("div",{className:"pt-3 border-t border-ubuntu-warm-100",children:(0,a.jsx)("p",{className:"text-ubuntu-warm-600 text-sm italic",children:t.notes})}),(0,a.jsx)("div",{className:"pt-3 border-t border-ubuntu-warm-100",children:(0,a.jsx)(se,{contactId:t.id,userId:t.addedBy,images:w,onImagesUpdate:async e=>{try{R(e),await I.Z.updateContact(t.id,{...t,photoUrls:e})}catch(s){R(t.photoUrls||[])}},maxImages:5,compact:!0})}),(0,a.jsx)("div",{className:"pt-3 border-t border-ubuntu-warm-100",children:(0,a.jsx)(ie,{contact:t,allContacts:u,relationships:B,onAddRelationship:async e=>{try{const s=[...B,e];P(s),await I.Z.updateContact(t.id,{...t,relationships:s.map((e=>({label:e.type.charAt(0).toUpperCase()+e.type.slice(1),value:e.contactName})))})}catch(a){var s;P((null===(s=t.relationships)||void 0===s?void 0:s.map((e=>({type:e.label.toLowerCase(),contactId:"",contactName:e.value}))))||[])}},onRemoveRelationship:async(e,s)=>{try{const a=B.filter((t=>!(t.type===e&&t.contactId===s)));P(a),await I.Z.updateContact(t.id,{...t,relationships:a.map((e=>({label:e.type.charAt(0).toUpperCase()+e.type.slice(1),value:e.contactName})))})}catch(n){var a;P((null===(a=t.relationships)||void 0===a?void 0:a.map((e=>({type:e.label.toLowerCase(),contactId:"",contactName:e.value}))))||[])}},compact:!0})}),u.length>0&&(0,a.jsx)($,{contact:t,allContacts:u,onContactClick:e=>{m&&m(e)},maxSuggestions:3,compact:!0})]}),(0,a.jsx)("div",{className:"mt-4 pt-3 border-t border-ubuntu-warm-100",children:(0,a.jsxs)("div",{className:"flex items-center justify-between text-xs text-ubuntu-warm-500",children:[(0,a.jsxs)("span",{children:["Added ",t.createdAt.toLocaleDateString()]}),t.updatedAt>t.createdAt&&(0,a.jsxs)("span",{children:["Updated ",t.updatedAt.toLocaleDateString()]})]})}),y&&(0,a.jsx)(z,{contact:t,onClose:()=>f(!1),onSendSuccess:()=>{}}),j&&(0,a.jsx)(_,{contact:t,onClose:()=>v(!1),onSave:e=>{}})]});var U},me=s(23346);var xe=e=>{let{contacts:t,onEdit:s,onDelete:n,currentUserId:l,isSelected:i,onSelect:c}=e;return(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-lg shadow-sm border border-ubuntu-warm-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"sticky top-0 bg-gradient-to-r from-ubuntu-warm-50 to-ubuntu-warm-100 px-6 py-4 border-b border-ubuntu-warm-200",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center text-sm font-semibold text-ubuntu-warm-900",children:[c&&(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)("input",{type:"checkbox",checked:t.length>0&&t.every((e=>null===i||void 0===i?void 0:i(e.id))),onChange:e=>{t.forEach((t=>c(t.id,e.target.checked)))},className:"w-4 h-4 rounded border-ubuntu-warm-300 cursor-pointer"})}),(0,a.jsx)("div",{className:c?"col-span-3":"col-span-4",children:"Name"}),(0,a.jsx)("div",{className:"col-span-3",children:"Contact Info"}),(0,a.jsx)("div",{className:"col-span-2",children:"Category"}),(0,a.jsx)("div",{className:"col-span-2",children:"Added"}),(0,a.jsx)("div",{className:"col-span-1 text-right",children:"Actions"})]})}),(0,a.jsx)("div",{className:"divide-y divide-ubuntu-warm-100",children:t.map(((e,t)=>(0,a.jsx)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:.02*t},className:"hover:bg-ubuntu-warm-50 transition-colors px-6 py-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-12 gap-4 items-center text-sm",children:[c&&(0,a.jsx)("div",{className:"col-span-1",children:(0,a.jsx)("input",{type:"checkbox",checked:(null===i||void 0===i?void 0:i(e.id))||!1,onChange:t=>c(e.id,t.target.checked),className:"w-4 h-4 rounded border-ubuntu-warm-300 cursor-pointer"})}),(0,a.jsxs)("div",{className:c?"col-span-3":"col-span-4",children:[(0,a.jsxs)("div",{className:"font-medium text-ubuntu-warm-900",children:[e.firstName," ",e.lastName]}),e.tags.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-1 mt-1 flex-wrap",children:[e.tags.slice(0,2).map(((e,t)=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded-full text-xs font-medium ".concat(de(e)),children:e},t))),e.tags.length>2&&(0,a.jsxs)("span",{className:"text-xs text-ubuntu-warm-500",children:["+",e.tags.length-2]})]})]}),(0,a.jsx)("div",{className:"col-span-3",children:(0,a.jsxs)("div",{className:"space-y-1",children:[e.emails.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-ubuntu-warm-600 truncate",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:e.emails[0]})]}),e.phoneNumbers.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-ubuntu-warm-600 truncate",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:e.phoneNumbers[0]})]}),e.addresses.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-ubuntu-warm-600 truncate",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:e.addresses[0].split(",")[0]})]})]})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsx)("span",{className:"inline-flex items-center px-3 py-1 rounded-full text-xs font-medium ".concat("family"===e.category?"bg-blue-100 text-blue-700":"friend"===e.category?"bg-green-100 text-green-700":"business"===e.category?"bg-yellow-100 text-yellow-700":"professional"===e.category?"bg-purple-100 text-purple-700":"service"===e.category?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:e.category||"Other"})}),(0,a.jsx)("div",{className:"col-span-2",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-ubuntu-warm-600 text-xs",children:[(0,a.jsx)(me.Z,{className:"w-4 h-4"}),e.createdAt.toLocaleDateString()]})}),(0,a.jsxs)("div",{className:"col-span-1 flex items-center justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>s(e),className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",title:"Edit contact",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>n(e.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-600 transition-colors",title:"Delete contact",children:(0,a.jsx)(o.Z,{className:"w-4 h-4"})})]})]})},e.id)))}),0===t.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(E.Z,{className:"w-12 h-12 text-ubuntu-warm-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600",children:"No contacts to display"})]})]})};var he=e=>{let{contacts:t,onEdit:s,onDelete:n,currentUserId:l,isSelected:i,onSelect:c}=e;return(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"bg-white rounded-lg shadow-sm border border-ubuntu-warm-200 overflow-x-auto",children:[(0,a.jsxs)("table",{className:"w-full text-sm",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gradient-to-r from-ubuntu-warm-50 to-ubuntu-warm-100 border-b border-ubuntu-warm-200",children:[c&&(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900 w-12",children:(0,a.jsx)("input",{type:"checkbox",checked:t.length>0&&t.every((e=>null===i||void 0===i?void 0:i(e.id))),onChange:e=>{t.forEach((t=>c(t.id,e.target.checked)))},className:"w-4 h-4 rounded border-ubuntu-warm-300 cursor-pointer"})}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Name"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Email"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Phone"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Address"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Category"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Tags"}),(0,a.jsx)("th",{className:"px-6 py-3 text-left font-semibold text-ubuntu-warm-900",children:"Added"}),(0,a.jsx)("th",{className:"px-6 py-3 text-right font-semibold text-ubuntu-warm-900",children:"Actions"})]})}),(0,a.jsx)("tbody",{className:"divide-y divide-ubuntu-warm-100",children:t.map(((e,t)=>(0,a.jsxs)(r.E.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.02*t},className:"hover:bg-ubuntu-warm-50 transition-colors",children:[c&&(0,a.jsx)("td",{className:"px-6 py-3 w-12",children:(0,a.jsx)("input",{type:"checkbox",checked:(null===i||void 0===i?void 0:i(e.id))||!1,onChange:t=>c(e.id,t.target.checked),className:"w-4 h-4 rounded border-ubuntu-warm-300 cursor-pointer"})}),(0,a.jsx)("td",{className:"px-6 py-3 font-medium text-ubuntu-warm-900",children:(0,a.jsxs)("div",{children:[e.firstName," ",e.lastName]})}),(0,a.jsx)("td",{className:"px-6 py-3 text-ubuntu-warm-600",children:e.emails.length>0?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:e.emails[0]})]}):(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"\u2014"})}),(0,a.jsx)("td",{className:"px-6 py-3 text-ubuntu-warm-600",children:e.phoneNumbers.length>0?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs",children:e.phoneNumbers[0]})]}):(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"\u2014"})}),(0,a.jsx)("td",{className:"px-6 py-3 text-ubuntu-warm-600",children:e.addresses.length>0?(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4 text-gray-400 flex-shrink-0"}),(0,a.jsx)("span",{className:"truncate text-xs max-w-xs",children:e.addresses[0]})]}):(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"\u2014"})}),(0,a.jsx)("td",{className:"px-6 py-3",children:(0,a.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("family"===e.category?"bg-blue-100 text-blue-700":"friend"===e.category?"bg-green-100 text-green-700":"business"===e.category?"bg-yellow-100 text-yellow-700":"professional"===e.category?"bg-purple-100 text-purple-700":"service"===e.category?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"),children:e.category||"Other"})}),(0,a.jsx)("td",{className:"px-6 py-3",children:e.tags.length>0?(0,a.jsxs)("div",{className:"flex items-center gap-1 flex-wrap",children:[e.tags.slice(0,2).map(((e,t)=>(0,a.jsx)("span",{className:"inline-flex items-center px-2 py-0.5 rounded text-xs ".concat(de(e)),children:e},t))),e.tags.length>2&&(0,a.jsxs)("span",{className:"text-xs text-ubuntu-warm-500",children:["+",e.tags.length-2]})]}):(0,a.jsx)("span",{className:"text-gray-400 text-xs",children:"\u2014"})}),(0,a.jsx)("td",{className:"px-6 py-3 text-ubuntu-warm-600 text-xs",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(me.Z,{className:"w-4 h-4 text-gray-400"}),e.createdAt.toLocaleDateString()]})}),(0,a.jsx)("td",{className:"px-6 py-3 text-right",children:(0,a.jsxs)("div",{className:"flex items-center justify-end gap-2",children:[(0,a.jsx)("button",{onClick:()=>s(e),className:"p-2 hover:bg-blue-50 rounded-lg text-blue-600 transition-colors",title:"Edit contact",children:(0,a.jsx)(T.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>n(e.id),className:"p-2 hover:bg-red-50 rounded-lg text-red-600 transition-colors",title:"Delete contact",children:(0,a.jsx)(o.Z,{className:"w-4 h-4"})})]})})]},e.id)))})]}),0===t.length&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(E.Z,{className:"w-12 h-12 text-ubuntu-warm-300 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600",children:"No contacts to display"})]})]})},ge=s(97818),be=s(38999);var pe=e=>{let{selectedTags:t,onChange:s,placeholder:l="Add tags..."}=e;const[i,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(""),[m,x]=(0,n.useState)(""),[h,b]=(0,n.useState)(!1),[p,y]=(0,n.useState)(null),N=(0,n.useRef)(null);(0,n.useEffect)((()=>{const e=e=>{N.current&&!N.current.contains(e.target)&&(o(!1),b(!1),d(""))};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const j=()=>{const e=m.trim();e&&!t.includes(e)&&(s([...t,e]),x(""),b(!1),o(!1))},v=oe.filter((e=>{var s;const a=e.label.toLowerCase().includes(c.toLowerCase())||(null===(s=e.description)||void 0===s?void 0:s.toLowerCase().includes(c.toLowerCase())),n=!p||e.category===p,r=!t.includes(e.label);return a&&n&&r})),w=ce.map((e=>({...e,tags:v.filter((t=>t.category===e.id))}))).filter((e=>e.tags.length>0));return(0,a.jsxs)("div",{className:"relative",ref:N,children:[(0,a.jsxs)("div",{className:"mb-3",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-ubuntu-warm-700 mb-2",children:"Tags"}),t.length>0&&(0,a.jsx)("div",{className:"flex flex-wrap gap-2 mb-2",children:t.map((e=>(0,a.jsxs)(r.E.span,{initial:{scale:0},animate:{scale:1},exit:{scale:0},className:"inline-flex items-center px-3 py-1 rounded-full text-sm border ".concat(de(e)),children:[e,(0,a.jsx)("button",{type:"button",onClick:()=>{return a=e,void s(t.filter((e=>e!==a)));var a},className:"ml-2 hover:text-red-600 transition-colors",children:(0,a.jsx)(f.Z,{className:"w-3 h-3"})})]},e)))}),(0,a.jsxs)("button",{type:"button",onClick:()=>o(!i),className:"w-full px-4 py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-ubuntu-orange hover:text-ubuntu-orange transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),l]})]}),(0,a.jsx)(W.M,{children:i&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute z-50 w-full mt-1 bg-white border border-gray-200 rounded-lg shadow-lg max-h-96 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:c,onChange:e=>d(e.target.value),placeholder:"Search tags...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ubuntu-orange focus:border-transparent"})]})}),(0,a.jsxs)("div",{className:"p-2 border-b border-gray-200 flex flex-wrap gap-1",children:[(0,a.jsx)("button",{type:"button",onClick:()=>y(null),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat(null===p?"bg-ubuntu-orange text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:"All"}),ce.map((e=>(0,a.jsxs)("button",{type:"button",onClick:()=>y(p===e.id?null:e.id),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat(p===e.id?"bg-ubuntu-orange text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"),children:[e.icon," ",e.label]},e.id)))]}),(0,a.jsx)("div",{className:"max-h-64 overflow-y-auto",children:h?(0,a.jsx)("div",{className:"p-3 border-b border-gray-200",children:(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{type:"text",value:m,onChange:e=>x(e.target.value),onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),j()),placeholder:"Enter custom tag...",className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ubuntu-orange focus:border-transparent",autoFocus:!0}),(0,a.jsx)("button",{type:"button",onClick:j,className:"px-4 py-2 bg-ubuntu-orange text-white rounded-lg hover:bg-ubuntu-orange-dark transition-colors",children:"Add"}),(0,a.jsx)("button",{type:"button",onClick:()=>{b(!1),x("")},className:"px-3 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})})]})}):(0,a.jsxs)(a.Fragment,{children:[w.map((e=>(0,a.jsxs)("div",{className:"border-b border-gray-100 last:border-b-0",children:[(0,a.jsxs)("div",{className:"px-3 py-2 bg-gray-50 text-xs font-semibold text-gray-600 flex items-center gap-2",children:[(0,a.jsx)("span",{children:e.icon}),e.label]}),(0,a.jsx)("div",{className:"p-2",children:e.tags.map((e=>(0,a.jsx)("button",{type:"button",onClick:()=>{return a=e.label,void(t.includes(a)||s([...t,a]));var a},className:"w-full px-3 py-2 text-left hover:bg-gray-50 rounded-lg transition-colors group",children:(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs border ".concat(e.color," mb-1"),children:e.label}),e.description&&(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.description})]}),(0,a.jsx)(u.Z,{className:"w-4 h-4 text-gray-400 group-hover:text-ubuntu-orange flex-shrink-0 mt-1"})]})},e.id)))})]},e.id))),0===v.length&&(0,a.jsx)("div",{className:"p-4 text-center text-gray-500 text-sm",children:"No tags found"}),(0,a.jsxs)("button",{type:"button",onClick:()=>b(!0),className:"w-full px-4 py-3 text-left border-t border-gray-200 hover:bg-gray-50 transition-colors flex items-center gap-2 text-ubuntu-orange font-medium",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4"}),"Add Custom Tag"]})]})})]})})]})},ye=s(37054);const fe={width:"100%",height:"400px"},Ne={lat:-33.9249,lng:18.4241},je=["places"],ve=e=>{let{initialLocation:t,onLocationSelect:s,onClose:l}=e;const[i,o]=(0,n.useState)(t?{lat:t.latitude,lng:t.longitude}:Ne),[c,d]=(0,n.useState)(""),[u,m]=(0,n.useState)(t?{lat:t.latitude,lng:t.longitude}:Ne),x=(0,n.useRef)(null),h=(0,n.useRef)(null),b="AIzaSyBl15V2pM4E6Yeh7YzVEdBjXsH3E2b1Wro",p=(0,n.useCallback)((e=>{if(e.latLng){const t=e.latLng.lat(),s=e.latLng.lng();o({lat:t,lng:s});(new google.maps.Geocoder).geocode({location:{lat:t,lng:s}},((e,t)=>{"OK"===t&&e&&e[0]&&d(e[0].formatted_address)}))}}),[]);return(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-ubuntu-orange to-orange-600 p-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2 text-white",children:[(0,a.jsx)(D.Z,{className:"w-5 h-5"}),(0,a.jsx)("h3",{className:"text-lg font-semibold",children:"Select Location"})]}),l&&(0,a.jsx)("button",{onClick:l,className:"text-white hover:bg-white/20 rounded-lg p-2 transition-colors",children:(0,a.jsx)(f.Z,{className:"w-5 h-5"})})]}),(0,a.jsxs)("div",{className:"p-4 space-y-4",children:[(0,a.jsxs)(ye.KJ,{googleMapsApiKey:b,libraries:je,children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(ye.F2,{onLoad:e=>{x.current=e},onPlaceChanged:()=>{if(x.current){var e;const t=x.current.getPlace();if(null===(e=t.geometry)||void 0===e?void 0:e.location){const e=t.geometry.location.lat(),s=t.geometry.location.lng();o({lat:e,lng:s}),m({lat:e,lng:s}),d(t.formatted_address||""),h.current&&h.current.panTo({lat:e,lng:s})}}},children:(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),(0,a.jsx)("input",{type:"text",placeholder:"Search for a location...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-ubuntu-orange focus:border-transparent"})]})}),(0,a.jsxs)("button",{onClick:()=>{navigator.geolocation&&navigator.geolocation.getCurrentPosition((e=>{const t=e.coords.latitude,s=e.coords.longitude;o({lat:t,lng:s}),m({lat:t,lng:s});(new google.maps.Geocoder).geocode({location:{lat:t,lng:s}},((e,t)=>{"OK"===t&&e&&e[0]&&d(e[0].formatted_address)})),h.current&&h.current.panTo({lat:t,lng:s})}),(e=>{}))},className:"text-sm text-ubuntu-orange hover:text-orange-600 flex items-center gap-1 font-medium",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4"}),"Use my current location"]})]}),(0,a.jsx)(ye.b6,{mapContainerStyle:fe,center:u,zoom:13,onClick:p,onLoad:e=>{h.current=e},options:{streetViewControl:!1,mapTypeControl:!1,fullscreenControl:!1},children:(0,a.jsx)(ye.Jx,{position:i})})]}),c&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"bg-ubuntu-aubergine/5 border border-ubuntu-aubergine/20 rounded-lg p-3",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600 mb-1",children:"Selected Location:"}),(0,a.jsx)("p",{className:"text-sm font-medium text-ubuntu-aubergine",children:c}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["Coordinates: ",i.lat.toFixed(6),", ",i.lng.toFixed(6)]})]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[l&&(0,a.jsx)("button",{onClick:l,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors font-medium text-gray-700",children:"Cancel"}),(0,a.jsx)("button",{onClick:()=>{s({latitude:i.lat,longitude:i.lng,address:c})},className:"flex-1 px-4 py-2 bg-ubuntu-orange text-white rounded-lg hover:bg-orange-600 transition-colors font-medium shadow-md",children:"Confirm Location"})]})]})]})};var we=s(52125),Ce=s(87975),ke=s(78170);const Se=e=>{let{address:t,locationType:s,onLocationChange:r,onRemove:l,existingLocation:i}=e;const[o,c]=(0,n.useState)(!1),[d,u]=(0,n.useState)(!1),[m,x]=(0,n.useState)(null),[h,g]=(0,n.useState)((null===i||void 0===i?void 0:i.readings)||[]),[b,p]=(0,n.useState)((null===i||void 0===i?void 0:i.latitude)?0:null),[y,f]=(0,n.useState)((null===i||void 0===i?void 0:i.latitude)?{latitude:i.latitude||0,longitude:i.longitude||0,accuracy:i.accuracy||0,what3words:i.what3words||"",timestamp:new Date}:null),[N,j]=(0,n.useState)(!1),v=(0,n.useRef)(null),w=(e,t)=>{const s=Math.floor(1e3*e),a=Math.floor(1e3*t),n={adj:["sharp","bold","quiet","bright","lucky","quick","swift","clever","silent","happy","strong","gentle","warm","calm","near","far","high","low","deep","wide"],noun:["canyon","ridge","valley","plain","stream","grove","field","peak","slope","bridge","lake","river","cliff","forest","garden","beach","square","avenue","corner","gate"],verb:["running","flying","dancing","singing","jumping","walking","climbing","sailing","riding","racing","rolling","sliding","spinning","soaring","gliding","wading","flowing","rushing","drifting","swaying"]},r=Math.abs(s)%n.adj.length,l=Math.abs(a)%n.noun.length,i=Math.abs(s+a)%n.verb.length;return"".concat(n.adj[r],".").concat(n.noun[l],".").concat(n.verb[i])},C=()=>{navigator.geolocation?(u(!0),x(null),navigator.geolocation.getCurrentPosition((e=>{const{latitude:a,longitude:n,accuracy:l}=e.coords,i=w(a,n),o={latitude:a,longitude:n,accuracy:Math.round(l),what3words:i,timestamp:new Date,readingNumber:h.length+1},c=[...h,o];g(c),f({latitude:a,longitude:n,accuracy:Math.round(l),what3words:i,timestamp:new Date}),p(c.length-1),r({address:t,locationType:s,latitude:a,longitude:n,accuracy:Math.round(l),what3words:i,readings:c}),u(!1)}),(e=>{x("GPS Error: ".concat(e.message)),u(!1)}),{enableHighAccuracy:!0,timeout:15e3,maximumAge:0})):x("Geolocation is not supported by your browser")};(0,n.useEffect)((()=>()=>{null!==v.current&&navigator.geolocation.clearWatch(v.current)}),[]);return(0,a.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-indigo-50 border-2 border-blue-200 rounded-lg p-4 space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(D.Z,{className:"w-5 h-5 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-gray-900",children:{residential:"\ud83c\udfe0 Residential",work:"\ud83d\udcbc Work",vacation:"\ud83c\udfd6\ufe0f Vacation",other:"\ud83d\udccd Other"}[s]}),(0,a.jsx)("p",{className:"text-xs text-gray-600",children:t})]})]}),l&&(0,a.jsx)("button",{onClick:l,className:"p-1.5 hover:bg-red-100 rounded-lg transition-colors text-red-500 hover:text-red-700",title:"Remove this location",children:"\u2715"})]}),y&&(0,a.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-green-200 space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center gap-1 text-green-700",children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),(0,a.jsx)("p",{className:"text-sm font-medium",children:"Location Captured"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Latitude"}),(0,a.jsx)("p",{className:"font-mono font-semibold text-gray-900",children:y.latitude.toFixed(6)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Longitude"}),(0,a.jsx)("p",{className:"font-mono font-semibold text-gray-900",children:y.longitude.toFixed(6)})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-gray-600",children:"Accuracy"}),(0,a.jsxs)("p",{className:"text-gray-900 font-semibold",children:["\xb1",y.accuracy," meters ",y.accuracy<10?"\u2713":""]})]})]}),(0,a.jsxs)("div",{className:"bg-purple-50 rounded p-2",children:[(0,a.jsx)("p",{className:"text-xs text-gray-600 mb-1",children:"What3Words"}),(0,a.jsx)("code",{className:"text-sm font-mono font-bold text-purple-600",children:y.what3words})]})]}),(0,a.jsx)("div",{className:"flex gap-2",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("button",{onClick:()=>{C()},disabled:d,className:"flex-1 px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors flex items-center justify-center gap-1",children:[(0,a.jsx)(we.Z,{className:"w-4 h-4 ".concat(d?"animate-spin":"")}),d?"Reading...":"Refresh GPS"]}),N?(0,a.jsx)("button",{onClick:()=>{null!==v.current&&(navigator.geolocation.clearWatch(v.current),v.current=null),j(!1)},className:"flex-1 px-3 py-2 bg-red-600 text-white text-sm font-medium rounded-lg hover:bg-red-700 transition-colors",children:"Stop"}):(0,a.jsxs)("button",{onClick:()=>{navigator.geolocation?(j(!0),x(null),v.current=navigator.geolocation.watchPosition((e=>{const{latitude:t,longitude:s,accuracy:a}=e.coords,n=w(t,s);f({latitude:t,longitude:s,accuracy:Math.round(a),what3words:n,timestamp:new Date})}),(e=>{x("Tracking Error: ".concat(e.message))}),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})):x("Geolocation is not supported by your browser")},className:"flex-1 px-3 py-2 bg-green-600 text-white text-sm font-medium rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center gap-1",children:[(0,a.jsx)(Ce.Z,{className:"w-4 h-4"}),"Live Track"]})]}):(0,a.jsxs)("button",{onClick:()=>c(!0),className:"flex-1 px-3 py-2 bg-blue-600 text-white text-sm font-medium rounded-lg hover:bg-blue-700 transition-colors flex items-center justify-center gap-1",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4"}),"Capture GPS"]})}),m&&(0,a.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-2 flex gap-2 items-start",children:[(0,a.jsx)(ke.Z,{className:"w-4 h-4 text-red-600 flex-shrink-0 mt-0.5"}),(0,a.jsx)("p",{className:"text-xs text-red-700",children:m})]}),o&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white rounded-lg shadow-xl max-w-sm w-full p-6",children:[(0,a.jsxs)("div",{className:"flex items-start gap-3 mb-4",children:[(0,a.jsx)(B.Z,{className:"w-6 h-6 text-amber-600 flex-shrink-0"}),(0,a.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Allow GPS Access?"})]}),(0,a.jsxs)("p",{className:"text-gray-700 mb-4 text-sm",children:["To capture precise GPS coordinates for this ",s," address, enable location access."]}),(0,a.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-lg p-3 mb-4",children:(0,a.jsxs)("p",{className:"text-sm text-amber-900",children:[(0,a.jsx)("strong",{children:"Privacy:"})," Your location data is encrypted and stored securely. You control what's shared."]})}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)("button",{onClick:()=>{C(),c(!1)},disabled:d,className:"w-full px-4 py-2 bg-blue-600 text-white font-medium rounded-lg hover:bg-blue-700 disabled:bg-gray-400 transition-colors text-sm",children:d?"Reading Location...":"Allow & Capture GPS"}),(0,a.jsx)("button",{onClick:()=>c(!1),className:"w-full px-4 py-2 bg-gray-200 text-gray-900 font-medium rounded-lg hover:bg-gray-300 transition-colors text-sm",children:"Cancel"})]})]})}),h.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg p-3 border border-gray-200 space-y-2",children:[(0,a.jsxs)("p",{className:"text-xs font-semibold text-gray-700",children:["Reading History (",h.length,")"]}),(0,a.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:h.map(((e,n)=>(0,a.jsx)("button",{onClick:()=>(e=>{const a=h[e];p(e),f({latitude:a.latitude,longitude:a.longitude,accuracy:a.accuracy,what3words:a.what3words,timestamp:a.timestamp}),r({address:t,locationType:s,latitude:a.latitude,longitude:a.longitude,accuracy:a.accuracy,what3words:a.what3words,readings:h})})(n),className:"w-full text-left p-2 rounded text-xs transition-colors ".concat(b===n?"bg-blue-100 border border-blue-300":"bg-gray-50 border border-gray-200 hover:bg-gray-100"),children:(0,a.jsxs)("div",{className:"flex justify-between items-start",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-medium text-gray-900",children:["#",e.readingNumber]}),(0,a.jsx)("p",{className:"text-gray-600",children:e.timestamp.toLocaleTimeString()})]}),(0,a.jsxs)("div",{className:"text-right",children:[(0,a.jsxs)("p",{className:"text-gray-600",children:["\xb1",e.accuracy,"m"]}),(0,a.jsx)("code",{className:"text-xs font-mono text-purple-600",children:e.what3words})]})]})},n)))})]}),N&&(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-2 flex gap-2 items-center",children:[(0,a.jsx)("div",{className:"w-2 h-2 bg-green-600 rounded-full animate-pulse"}),(0,a.jsx)("p",{className:"text-xs text-green-700 font-medium",children:"Live tracking active"})]})]})};var Ze=e=>{let{contact:t,onSave:s,onCancel:r}=e;const[i,o]=(0,n.useState)(!1),[c,d]=(0,n.useState)(!1),[m,x]=(0,n.useState)(null),[h,g]=(0,n.useState)([]),[p,y]=(0,n.useState)({}),[N,j]=(0,n.useState)({firstName:"",lastName:"",phoneNumbers:[""],emails:[""],addresses:[""],category:"friend",tags:[],notes:"",privacy:"family",isHouseholdMember:!1,isFamilyMember:!1,sonnyRole:"none",coordinates:void 0});(0,n.useEffect)((()=>{t&&j({firstName:t.firstName,lastName:t.lastName,phoneNumbers:t.phoneNumbers.length>0?t.phoneNumbers:[""],emails:t.emails.length>0?t.emails:[""],addresses:t.addresses.length>0?t.addresses:[""],category:t.category,tags:t.tags,notes:t.notes,privacy:t.privacy,isHouseholdMember:t.isHouseholdMember||!1,isFamilyMember:t.isFamilyMember||!1,sonnyRole:t.sonnyRole||"none",coordinates:t.coordinates})}),[t]);const v=e=>{j((t=>({...t,[e]:[...t[e],""]})))},w=(e,t)=>{j((s=>({...s,[e]:s[e].filter(((e,s)=>s!==t))})))},k=(e,t,s)=>{j((a=>({...a,[e]:a[e].map(((e,a)=>a===t?s:e))})))};return(0,a.jsxs)(O.uj,{isOpen:!0,onClose:r,title:t?"Edit Contact":"Add New Contact",size:"xl",children:[(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o(!0);try{const e={...N,phoneNumbers:N.phoneNumbers.filter((e=>e.trim())),emails:N.emails.filter((e=>e.trim())),addresses:N.addresses.filter((e=>e.trim())),tags:N.tags.filter((e=>e.trim()))};await s(e)}catch(t){}finally{o(!1)}},className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(O.Pg,{label:"First Name",required:!0,value:N.firstName,onChange:e=>j((t=>({...t,firstName:e.target.value}))),placeholder:"Enter first name",className:"pl-10"}),(0,a.jsx)(C.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-ubuntu-warm-400 z-10"})]}),(0,a.jsx)(O.Pg,{label:"Last Name",required:!0,value:N.lastName,onChange:e=>j((t=>({...t,lastName:e.target.value}))),placeholder:"Enter last name"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsx)(O.SB,{label:"Category",value:N.category,onChange:e=>j((t=>({...t,category:e.target.value}))),options:[{value:"family",label:"Family"},{value:"friend",label:"Friend"},{value:"business",label:"Business"},{value:"professional",label:"Professional"},{value:"service",label:"Service"}].map((e=>({value:e.value,label:e.label})))}),(0,a.jsx)(O.SB,{label:"Privacy Level",value:N.privacy,onChange:e=>j((t=>({...t,privacy:e.target.value}))),options:[{value:"public",label:"Public",description:"Visible to all family members"},{value:"family",label:"Family Only",description:"Visible to family members only"},{value:"private",label:"Private",description:"Visible only to you"}].map((e=>({value:e.value,label:e.label})))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-ubuntu-warm-700 mb-2",children:"Phone Numbers"}),(0,a.jsxs)("div",{className:"space-y-2",children:[N.phoneNumbers.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(L.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-ubuntu-warm-400"}),(0,a.jsx)("input",{type:"tel",value:e,onChange:e=>k("phoneNumbers",t,e.target.value),className:"w-full pl-10 pr-4 py-2 border border-ubuntu-warm-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ubuntu-gold focus:border-transparent",placeholder:"Enter phone number"})]}),N.phoneNumbers.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>w("phoneNumbers",t),className:"p-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(ge.Z,{className:"w-4 h-4"})})]},t))),(0,a.jsxs)("button",{type:"button",onClick:()=>v("phoneNumbers"),className:"inline-flex items-center px-3 py-1 text-sm text-ubuntu-gold hover:text-ubuntu-gold/80 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),"Add Phone"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-ubuntu-warm-700 mb-2",children:"Email Addresses"}),(0,a.jsxs)("div",{className:"space-y-2",children:[N.emails.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(E.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-ubuntu-warm-400"}),(0,a.jsx)("input",{type:"email",value:e,onChange:e=>k("emails",t,e.target.value),className:"w-full pl-10 pr-4 py-2 border border-ubuntu-warm-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ubuntu-gold focus:border-transparent",placeholder:"Enter email address"})]}),N.emails.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>w("emails",t),className:"p-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(ge.Z,{className:"w-4 h-4"})})]},t))),(0,a.jsxs)("button",{type:"button",onClick:()=>v("emails"),className:"inline-flex items-center px-3 py-1 text-sm text-ubuntu-gold hover:text-ubuntu-gold/80 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),"Add Email"]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-ubuntu-warm-700 mb-2",children:"Addresses (with Precise GPS)"}),(0,a.jsxs)("div",{className:"space-y-3",children:[N.addresses.map(((e,t)=>(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("div",{className:"relative flex-1",children:[(0,a.jsx)(D.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-ubuntu-warm-400"}),(0,a.jsx)("input",{type:"text",value:e,onChange:e=>k("addresses",t,e.target.value),className:"w-full pl-10 pr-4 py-2 border border-ubuntu-warm-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-ubuntu-gold focus:border-transparent",placeholder:"Enter address (e.g., 123 Main St, City, Country)"})]}),N.addresses.length>1&&(0,a.jsx)("button",{type:"button",onClick:()=>w("addresses",t),className:"p-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(ge.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{type:"button",onClick:()=>x(m===t?null:t),className:"p-2 text-ubuntu-warm-600 hover:text-ubuntu-warm-900 transition-colors",title:"Add precise GPS location for this address",children:m===t?(0,a.jsx)(K.Z,{className:"w-4 h-4"}):(0,a.jsx)(X.Z,{className:"w-4 h-4"})})]}),m===t&&e.trim()&&(0,a.jsx)("div",{className:"ml-2 border-l-4 border-blue-400 pl-3",children:(0,a.jsx)(Se,{address:e,locationType:h[t]||"residential",existingLocation:p[t],onLocationChange:e=>{const s=[...h];s[t]=e.locationType,g(s);const a={...p};a[t]=e,y(a)}})})]},t))),(0,a.jsxs)("button",{type:"button",onClick:()=>v("addresses"),className:"inline-flex items-center px-3 py-1 text-sm text-ubuntu-gold hover:text-ubuntu-gold/80 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-1"}),"Add Address"]})]}),(0,a.jsxs)("p",{className:"text-xs text-ubuntu-warm-500 mt-2",children:["\ud83d\udca1 ",(0,a.jsx)("strong",{children:"Tip:"})," Click the expand arrow next to each address to capture precise GPS coordinates, What3Words address, and location type (residential, work, vacation, etc)."]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-ubuntu-warm-700 mb-2",children:"Location on Map"}),(0,a.jsx)("div",{className:"space-y-2",children:N.coordinates?(0,a.jsxs)("div",{className:"bg-ubuntu-aubergine/5 border border-ubuntu-aubergine/20 rounded-lg p-4",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-ubuntu-aubergine mb-1",children:"Location Set"}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["Latitude: ",N.coordinates.latitude.toFixed(6)]}),(0,a.jsxs)("p",{className:"text-xs text-gray-600",children:["Longitude: ",N.coordinates.longitude.toFixed(6)]})]}),(0,a.jsx)("button",{type:"button",onClick:()=>j((e=>({...e,coordinates:void 0}))),className:"text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})})]}),(0,a.jsxs)("button",{type:"button",onClick:()=>d(!0),className:"mt-3 inline-flex items-center px-3 py-1.5 text-sm text-ubuntu-orange hover:text-orange-600 font-medium transition-colors",children:[(0,a.jsx)(be.Z,{className:"w-4 h-4 mr-1"}),"Change Location"]})]}):(0,a.jsxs)("button",{type:"button",onClick:()=>d(!0),className:"w-full py-3 border-2 border-dashed border-ubuntu-warm-300 rounded-lg hover:border-ubuntu-orange hover:bg-ubuntu-orange/5 transition-colors flex items-center justify-center text-ubuntu-warm-600 hover:text-ubuntu-orange",children:[(0,a.jsx)(be.Z,{className:"w-5 h-5 mr-2"}),(0,a.jsx)("span",{className:"font-medium",children:"Add Location on Map"})]})})]}),(0,a.jsx)(pe,{selectedTags:N.tags,onChange:e=>j((t=>({...t,tags:e}))),placeholder:"Add tags to categorize this contact"}),(0,a.jsx)(O.eP,{label:"Notes",value:N.notes,onChange:e=>j((t=>({...t,notes:e.target.value}))),rows:3,placeholder:"Add any additional notes about this contact"}),(0,a.jsxs)("div",{className:"pt-6 border-t border-ubuntu-warm-200",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-ubuntu-warm-900 mb-4 flex items-center",children:[(0,a.jsx)(b.Z,{className:"w-5 h-5 mr-2 text-indigo-600"}),"Sonny Network Settings"]}),(0,a.jsxs)("div",{className:"space-y-4 bg-indigo-50 p-4 rounded-lg",children:[N.isFamilyMember&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-3 bg-white rounded-lg border-2 border-indigo-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("div",{className:"p-2 bg-indigo-100 rounded",children:(0,a.jsx)(l.Z,{className:"w-4 h-4 text-indigo-600"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"Family Member"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Imported from family tree"})]})]}),(0,a.jsx)("span",{className:"px-3 py-1 bg-indigo-100 text-indigo-700 text-xs font-medium rounded-full",children:"Family"})]}),(0,a.jsxs)("label",{className:"flex items-center space-x-3 p-3 bg-white rounded-lg border-2 border-gray-200 hover:border-indigo-300 cursor-pointer transition-colors",children:[(0,a.jsx)("input",{type:"checkbox",checked:N.isHouseholdMember,onChange:e=>j((t=>({...t,isHouseholdMember:e.target.checked}))),className:"w-5 h-5 text-indigo-600 rounded focus:ring-indigo-500"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("p",{className:"font-medium text-gray-900",children:"Household Member"}),(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Lives in the same household"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sonny Network Role"}),(0,a.jsx)("div",{className:"grid grid-cols-2 gap-3",children:[{value:"none",label:"None",desc:"Not on Sonny network"},{value:"monitor",label:"I Monitor Them",desc:"You track their safety"},{value:"monitored",label:"They Monitor Me",desc:"They track your safety"},{value:"both",label:"Mutual Monitoring",desc:"Both track each other"}].map((e=>(0,a.jsxs)("label",{className:"relative flex flex-col p-3 rounded-lg border-2 cursor-pointer transition-all ".concat(N.sonnyRole===e.value?"border-indigo-600 bg-indigo-50":"border-gray-200 bg-white hover:border-gray-300"),children:[(0,a.jsx)("input",{type:"radio",name:"sonnyRole",value:e.value,checked:N.sonnyRole===e.value,onChange:e=>j((t=>({...t,sonnyRole:e.target.value}))),className:"sr-only"}),(0,a.jsx)("span",{className:"font-medium text-gray-900 text-sm",children:e.label}),(0,a.jsx)("span",{className:"text-xs text-gray-600 mt-1",children:e.desc}),N.sonnyRole===e.value&&(0,a.jsx)("span",{className:"absolute top-2 right-2 w-2 h-2 bg-indigo-600 rounded-full"})]},e.value)))}),(0,a.jsx)("p",{className:"mt-2 text-xs text-gray-500",children:"Configure how this contact appears on the Sonny mesh network for family safety tracking"})]})]})]}),(0,a.jsxs)("div",{className:"flex items-center justify-end space-x-3 pt-6 border-t border-ubuntu-warm-200",children:[(0,a.jsx)("button",{type:"button",onClick:r,className:"px-6 py-2 border border-ubuntu-warm-300 rounded-lg text-ubuntu-warm-700 hover:bg-ubuntu-warm-50 transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{type:"submit",disabled:i,className:"inline-flex items-center px-6 py-2 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-gold/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[i&&(0,a.jsx)(P.Z,{className:"w-4 h-4 mr-2 animate-spin"}),(0,a.jsx)(U.Z,{className:"w-4 h-4 mr-2"}),t?"Update Contact":"Save Contact"]})]})]}),(0,a.jsx)(W.M,{children:c&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-4",children:(0,a.jsx)("div",{className:"max-w-4xl w-full",children:(0,a.jsx)(ve,{initialLocation:N.coordinates,onLocationSelect:e=>{j((t=>({...t,coordinates:{latitude:e.latitude,longitude:e.longitude}}))),e.address&&!N.addresses.includes(e.address)&&j((t=>({...t,addresses:[...t.addresses.filter((e=>e.trim())),e.address||""]}))),d(!1)},onClose:()=>d(!1)})})})})]})},Ee=s(24420),Ae=s(81296);const Me=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),Fe=()=>{const e=navigator.userAgent;return/Android/.test(e)?"android":/iPhone|iPad|iPod/.test(e)?"ios":/Win/.test(e)?"windows":/Mac/.test(e)?"mac":/Linux/.test(e)?"linux":"desktop"};const Te=e=>{const t=[],s=[],a=e.match(/BEGIN:VCARD[\s\S]*?END:VCARD/g)||[];return 0===a.length?(s.push("No vCard entries found in file"),{contacts:t,errors:s}):(a.forEach(((e,a)=>{try{const n=Le(e);n&&n.firstName?t.push(n):(null===n||void 0===n?void 0:n.firstName)||s.push("vCard ".concat(a+1,": No name found"))}catch(n){s.push("vCard ".concat(a+1,": ").concat(n instanceof Error?n.message:"Unknown error"))}})),{contacts:t,errors:s})},Le=e=>{var t,s,a,n;const r=e.split(/\r\n|\r|\n/),l={firstName:"",lastName:"",emails:[],phoneNumbers:[],addresses:[],organization:"",position:"",bio:"",website:"",tags:[],category:"friend"};for(let d=0;d<r.length;d++){const e=r[d].trim();if(!e||e.startsWith("BEGIN:")||e.startsWith("END:"))continue;let t=e;for(;d+1<r.length&&(r[d+1].startsWith(" ")||r[d+1].startsWith("\t"));)d++,t+=r[d].trim();const s=t.indexOf(":");if(-1===s)continue;const a=t.substring(0,s).split(";")[0].toUpperCase(),n=t.substring(s+1).trim();if(n)switch(a){case"FN":const e=n.split(/\s+/);l.firstName=e[0]||"",e.length>1&&(l.lastName=e.slice(1).join(" "));break;case"N":var i,o;const s=n.split(";");l.lastName=(null===(i=s[0])||void 0===i?void 0:i.trim())||l.lastName||"",l.firstName=(null===(o=s[1])||void 0===o?void 0:o.trim())||l.firstName||"";break;case"EMAIL":n&&/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)&&(l.emails.includes(n)||l.emails.push(n));break;case"TEL":const a=De(n,t);a&&!l.phoneNumbers.includes(a)&&l.phoneNumbers.push(a);break;case"ORG":l.organization=n.split(";")[0].trim();break;case"TITLE":l.position=n;break;case"URL":l.website||(l.website=n);break;case"ADR":const r=n.split(";"),c=[r[2],r[3],r[4],r[5]].filter(Boolean).join(", ");c&&!l.addresses.includes(c)&&l.addresses.push(c);break;case"NOTE":l.bio||(l.bio=n);break;case"CATEGORIES":const d=n.split(",").map((e=>e.trim())).filter(Boolean);l.tags=[...new Set([...l.tags,...d])]}}if(!l.firstName)return null;l.emails=(null===(t=l.emails)||void 0===t?void 0:t.filter(Boolean))||[],l.phoneNumbers=(null===(s=l.phoneNumbers)||void 0===s?void 0:s.filter(Boolean))||[],l.addresses=(null===(a=l.addresses)||void 0===a?void 0:a.filter(Boolean))||[],l.tags=(null===(n=l.tags)||void 0===n?void 0:n.filter(Boolean))||[];const c={firstName:l.firstName,lastName:l.lastName||void 0,organization:l.organization||void 0,position:l.position||void 0,bio:l.bio||void 0,website:l.website||void 0,tags:l.tags&&l.tags.length>0?l.tags:void 0,category:l.category};return l.emails&&l.emails.length>0&&(c.email=l.emails[0]),l.phoneNumbers&&l.phoneNumbers.length>0&&(c.phone=l.phoneNumbers[0]),l.addresses&&l.addresses.length>0&&(c.location=l.addresses[0]),c},De=(e,t)=>{let s=e;s.toLowerCase().startsWith("tel:")&&(s=s.substring(4));return s.replace(/[\s\-()]/g,"").length>=7?s.trim():""},Ie=e=>{const t=[],s=[],a=[];return e.email&&t.push(e.email),e.phone&&s.push(e.phone),e.location&&a.push(e.location),{firstName:e.firstName,lastName:e.lastName,emails:t,phoneNumbers:s,addresses:a,organizationName:e.organization,organizationTitle:e.position,notes:e.bio||"",websites:e.website?[{label:"profile",value:e.website}]:[],tags:e.tags||[],category:e.category||"friend"}};var Re=e=>{let{contacts:t,onImport:s,onClose:l}=e;const i=(0,n.useRef)(null),[o,u]=(0,n.useState)("export"),[m,x]=(0,n.useState)("csv"),[h,g]=(0,n.useState)(!1),[b,p]=(0,n.useState)(!1),[y,f]=(0,n.useState)(null),[N,j]=(0,n.useState)(!1),[v,w]=(0,n.useState)(!1),[C,k]=(0,n.useState)("desktop");(0,n.useEffect)((()=>{w(Me()),k(Fe())}),[]);const S=(e,t)=>{window.gtag&&window.gtag("event","import_contacts",{success_count:e,error_count:t,device_type:C,file_type:"csv_or_vcf",timestamp:(new Date).toISOString()})},Z=()=>{const e=[["First Name","Last Name","Phone Numbers","Emails","Addresses","Category","Tags","Notes","Privacy","Added By","Created Date","Updated Date"].join(","),...t.map((e=>['"'.concat(e.firstName,'"'),'"'.concat(e.lastName,'"'),'"'.concat(e.phoneNumbers.join("; "),'"'),'"'.concat(e.emails.join("; "),'"'),'"'.concat(e.addresses.join("; "),'"'),'"'.concat(e.category,'"'),'"'.concat(e.tags.join("; "),'"'),'"'.concat(e.notes.replace(/"/g,'""'),'"'),'"'.concat(e.privacy,'"'),'"'.concat(e.addedBy,'"'),'"'.concat(e.createdAt.toISOString(),'"'),'"'.concat(e.updatedAt.toISOString(),'"')].join(",")))].join("\n"),s=new Blob([e],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(s),a.download="family-contacts-".concat((new Date).toISOString().split("T")[0],".csv"),a.click()},E=()=>{const e=t.map((e=>["BEGIN:VCARD","VERSION:3.0","FN:".concat(e.firstName," ").concat(e.lastName),"N:".concat(e.lastName,";").concat(e.firstName,";;;"),...e.phoneNumbers.map((e=>"TEL:".concat(e))),...e.emails.map((e=>"EMAIL:".concat(e))),...e.addresses.map((e=>"ADR:;;".concat(e,";;;"))),e.notes?"NOTE:".concat(e.notes.replace(/\n/g,"\\n")):null,"CATEGORIES:".concat(e.category,",").concat(e.tags.join(",")),"END:VCARD"].filter(Boolean).join("\n"))).join("\n\n"),s=new Blob([e],{type:"text/vcard;charset=utf-8;"}),a=document.createElement("a");a.href=URL.createObjectURL(s),a.download="family-contacts-".concat((new Date).toISOString().split("T")[0],".vcf"),a.click()},M=async e=>{p(!0),f(null);try{const t=await e.text();let a=[],n=[];if(e.name.endsWith(".csv")){const e=F(t);a=e.contacts,n=e.errors}else if(e.name.endsWith(".vcf")){const e=I(t);a=e.contacts,n=e.errors}else n.push("Unsupported file format. Please use CSV or VCF files.");a.length>0&&(s(a),S(a.length,n.length)),f({success:a.length,errors:n})}catch(t){f({success:0,errors:["Failed to parse file. Please check the format."]}),window.gtag&&window.gtag("event","exception",{description:"import_contacts_parse_failed",fatal:!1})}finally{p(!1)}},F=e=>{const t=e.split("\n"),s=t[0],a=D(s).map((e=>e.toLowerCase().trim())),n=[],r=[],l=a.some((e=>e.includes("given name")||e.includes("family name")||e.includes("email address")||e.includes("phone")));for(let o=1;o<t.length;o++){if(t[o].trim())try{const e=D(t[o]);if(!e.some((e=>e.trim())))continue;const s={};a.forEach(((t,a)=>{s[t]=e[a]||""}));let i=null,c=null;if(l?(i=T(s),i||(c="Missing required fields (first/last name)")):(i=L(s,e,a.length),i||(c="Custom format requires at least first or last name")),!i){const t=e.slice(0,3).filter((e=>e.trim())).join(", ")||"(empty row)";r.push("Line ".concat(o+1,": Could not parse contact data - ").concat(c,". Values: ").concat(t));continue}n.push(i)}catch(i){const e=i instanceof Error?i.message:String(i);r.push("Line ".concat(o+1,": Failed to parse - ").concat(e))}}return{contacts:n,errors:r}},T=e=>{const t=(e["given name"]||e["first name"]||e["given names"]||"").trim(),s=(e["family name"]||e["last name"]||e["family names"]||"").trim();if(!t&&!s)return null;const a=[];for(let p=1;p<=10;p++){const t=(e["email ".concat(p," value")]||e["email address"]||"").trim();t&&!a.includes(t)&&a.push(t)}const n=[];for(let p=1;p<=10;p++){const t=(e["phone ".concat(p," value")]||e["phone number"]||e.phone||"").trim();t&&!n.includes(t)&&n.push(t)}const r=[];for(let p=1;p<=5;p++){const t=[(e["address ".concat(p," street")]||"").trim(),(e["address ".concat(p," city")]||"").trim(),(e["address ".concat(p," region")]||"").trim(),(e["address ".concat(p," postal code")]||"").trim(),(e["address ".concat(p," country")]||"").trim()].filter(Boolean);if(t.length>0){const e=t.join(", ");r.includes(e)||r.push(e)}}const l=(e.notes||e.note||"").trim(),i=(e["group membership"]||e.groups||"").trim(),o=(e.relation||e.relationship||"").trim();let c="friend",d=!1,u=!1,m="none";const x=i.toLowerCase(),h=o.toLowerCase();x.includes("family")||h.includes("family")||x.includes("relative")?(c="family",d=!0,m="none"):x.includes("household")||h.includes("household")?(u=!0,c="friend",m="none"):x.includes("business")||x.includes("work")?c="business":x.includes("professional")?c="professional":x.includes("service")&&(c="service");const g=i.split(",").map((e=>e.trim())).filter(Boolean),b=[...new Set(g)].filter((e=>e.length>0));return{id:"contact_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7)),firstName:t,lastName:s,phoneNumbers:[...new Set(n)],emails:[...new Set(a)],addresses:[...new Set(r)],category:c,tags:b,notes:l,privacy:"family",addedBy:"imported-google",createdAt:new Date,updatedAt:new Date,isFamilyMember:d,isHouseholdMember:u,sonnyRole:m}},L=(e,t,s)=>{const a=(e["first name"]||e["given name"]||t[0]||"").trim(),n=(e["last name"]||e["family name"]||t[1]||"").trim();if(!a&&!n)return null;const r=(e["phone numbers"]||t[2]||"").split(";").map((e=>e.trim())).filter(Boolean),l=(e.emails||t[3]||"").split(";").map((e=>e.trim())).filter(Boolean),i=(e.addresses||t[4]||"").split(";").map((e=>e.trim())).filter(Boolean),o=e.category||t[5]||"friend",c=(e.tags||t[6]||"").split(";").map((e=>e.trim())).filter(Boolean);return{id:"contact_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7)),firstName:a,lastName:n,phoneNumbers:[...new Set(r)],emails:[...new Set(l)],addresses:[...new Set(i)],category:o,tags:[...new Set(c)],notes:(e.notes||t[7]||"").trim(),privacy:e.privacy||t[8]||"family",addedBy:"imported-custom",createdAt:new Date,updatedAt:new Date}},D=e=>{const t=[];let s="",a=!1;for(let n=0;n<e.length;n++){const r=e[n];'"'===r?a=!a:","!==r||a?s+=r:(t.push(s.replace(/"/g,"")),s="")}return t.push(s.replace(/"/g,"")),t},I=e=>{const t=Te(e);return{contacts:t.contacts.map((e=>{const t=Ie(e);return{id:"contact_".concat(Date.now(),"_").concat(Math.random().toString(36).substring(7)),firstName:t.firstName||"",lastName:t.lastName||"",phoneNumbers:t.phoneNumbers||[],emails:t.emails||[],addresses:t.addresses||[],category:t.category||"friend",tags:t.tags||[],notes:t.notes||"",privacy:"family",addedBy:"imported-vcf",createdAt:new Date,updatedAt:new Date}})),errors:t.errors}},z=[{id:"export",label:"Export Contacts",icon:d.Z},{id:"import",label:"Import Contacts",icon:c.Z}];return(0,a.jsxs)(O.uj,{isOpen:!0,onClose:l,title:"Import/Export Contacts",size:"xl",children:[(0,a.jsx)("div",{className:"flex space-x-1 mb-6 bg-ubuntu-warm-100 rounded-lg p-1",children:z.map((e=>(0,a.jsxs)("button",{onClick:()=>u(e.id),className:"flex-1 flex items-center justify-center px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(o===e.id?"bg-white text-ubuntu-warm-900 shadow-sm":"text-ubuntu-warm-600 hover:text-ubuntu-warm-900"),children:[(0,a.jsx)(e.icon,{className:"w-4 h-4 mr-2"}),e.label]},e.id)))}),"export"===o&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-ubuntu font-semibold text-ubuntu-warm-900 mb-2",children:"Export Your Contacts"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600 text-sm mb-4",children:"Download your contacts in a format that can be imported into other applications."}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{children:(0,a.jsx)(O.DZ,{name:"exportFormat",label:"Export Format",options:[{value:"csv",label:"CSV (Spreadsheet)"},{value:"vcf",label:"VCF (Address Book)"}],value:m,onChange:e=>x(e)})}),(0,a.jsx)("div",{className:"bg-ubuntu-warm-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-ubuntu-warm-700",children:[(0,a.jsx)(R.Z,{className:"w-5 h-5"}),(0,a.jsxs)("span",{className:"font-medium",children:[t.length," contact",1!==t.length?"s":""," ready for export"]})]})}),(0,a.jsx)("button",{onClick:async()=>{var e;g(!0),e=m,window.gtag&&window.gtag("event","export_contacts",{format:e,contact_count:t.length,device_type:C,timestamp:(new Date).toISOString()});try{"csv"===m?await Z():await E()}catch(s){window.gtag&&window.gtag("event","exception",{description:"export_contacts_failed",fatal:!1})}finally{g(!1)}},disabled:h||0===t.length,className:"w-full inline-flex items-center justify-center px-6 py-3 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-gold/90 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:h?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"w-5 h-5 mr-2 animate-spin"}),"Exporting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"w-5 h-5 mr-2"}),"Export Contacts"]})})]})]})}),"import"===o&&(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-ubuntu font-semibold text-ubuntu-warm-900 mb-2",children:"Import Contacts"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600 text-sm mb-4",children:"Upload a CSV or VCF file to import contacts into your address book."}),(0,a.jsxs)("div",{className:"space-y-4",children:[v&&(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-3 flex items-center space-x-2",children:[(0,a.jsx)(Ee.Z,{className:"w-5 h-5 text-blue-600"}),(0,a.jsx)("span",{className:"text-sm text-blue-700",children:"Mobile device detected - tap to select files"})]}),!v&&(0,a.jsxs)("div",{onDragOver:e=>{e.preventDefault(),e.stopPropagation(),j(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation(),j(!1)},onDrop:e=>{var t;e.preventDefault(),e.stopPropagation(),j(!1);const s=null===(t=e.dataTransfer.files)||void 0===t?void 0:t[0];s&&(s.name.endsWith(".csv")||s.name.endsWith(".vcf"))&&(M(s),S(0,0))},className:"border-2 border-dashed rounded-lg p-8 text-center transition-colors ".concat(N?"border-ubuntu-gold bg-ubuntu-gold/5":"border-ubuntu-warm-300 hover:border-ubuntu-gold"),children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 mx-auto mb-3 text-ubuntu-warm-400"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-900 font-medium mb-1",children:"Drag and drop your files here"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600 text-sm mb-3",children:"or click the button below to browse"}),(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.click()},className:"px-4 py-2 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-gold/90 transition-colors inline-flex items-center space-x-2",children:[(0,a.jsx)(Ae.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:"Browse Files"})]})]}),v&&(0,a.jsxs)("button",{onClick:()=>{var e;return null===(e=i.current)||void 0===e?void 0:e.click()},disabled:b,className:"w-full px-4 py-3 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-gold/90 disabled:opacity-50 disabled:cursor-not-allowed transition-colors inline-flex items-center justify-center space-x-2",children:[(0,a.jsx)(c.Z,{className:"w-5 h-5"}),(0,a.jsx)("span",{children:"Choose File"})]}),(0,a.jsx)("input",{ref:i,type:"file",accept:".csv,.vcf",onChange:async e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];s&&await M(s)},disabled:b,className:"hidden"}),b&&(0,a.jsxs)("div",{className:"flex items-center space-x-2 text-ubuntu-warm-700",children:[(0,a.jsx)(P.Z,{className:"w-5 h-5 animate-spin"}),(0,a.jsx)("span",{children:"Importing contacts..."})]}),y&&(0,a.jsx)(r.E.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"bg-ubuntu-warm-50 rounded-lg p-4",children:(0,a.jsxs)("div",{className:"flex items-start space-x-3",children:[0===y.errors.length?(0,a.jsx)(A.Z,{className:"w-5 h-5 text-green-500 mt-0.5"}):(0,a.jsx)(B.Z,{className:"w-5 h-5 text-yellow-500 mt-0.5"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-ubuntu-warm-900",children:"Import Complete"}),(0,a.jsxs)("p",{className:"text-sm text-ubuntu-warm-700 mt-1",children:[y.success," contact",1!==y.success?"s":""," imported successfully"]}),y.errors.length>0&&(0,a.jsxs)("div",{className:"mt-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-ubuntu-warm-900",children:"Errors:"}),(0,a.jsx)("ul",{className:"text-sm text-red-600 mt-1 list-disc list-inside",children:y.errors.map(((e,t)=>(0,a.jsx)("li",{className:"truncate",children:e},t)))})]})]})]})}),(0,a.jsxs)("div",{className:"bg-blue-50 rounded-lg p-4",children:[(0,a.jsx)("h4",{className:"font-medium text-blue-900 mb-2",children:"Supported Formats:"}),(0,a.jsxs)("ul",{className:"text-sm text-blue-700 space-y-1",children:[(0,a.jsxs)("li",{children:["\u2022 ",(0,a.jsx)("strong",{children:"CSV:"})," First Name, Last Name, Phone Numbers, Emails, Addresses, Category, Tags, Notes, Privacy"]}),(0,a.jsxs)("li",{children:["\u2022 ",(0,a.jsx)("strong",{children:"VCF:"})," Standard vCard format from most address book applications"]})]})]})]})]})})]})},Be=s(70162);const Pe=[{id:"notemba",name:"Nozukile Cynthia Mdeni (Notemba)",role:"Family Matriarch & Trust Beneficiary",email:"mdeninotembac@gmail.com",phone:"+27 81 000 0000",dateOfBirth:"1960-12-16",location:"Eastern Cape, South Africa",status:"active"},{id:"salatiso",name:"Salatiso Mdeni",role:"Founder & Chief Visionary",email:"spiceinc@gmail.com",phone:"+27 82 123 4567",dateOfBirth:"1982-09-16",location:"Cape Town, South Africa",status:"active"},{id:"visa",name:"Visa Mdeni",role:"Marketing & Global Expansion Lead",email:"visasande@gmail.com",phone:"+27 83 234 5678",dateOfBirth:"1985-05-15",location:"Johannesburg, South Africa",status:"active"},{id:"tina",name:"Tina Mdeni",role:"Education & Finance Oversight",email:"tina@salatiso.com",phone:"+27 84 345 6789",dateOfBirth:"1990-06-15",location:"Durban, South Africa",status:"active"},{id:"kwakho",name:"Kwakho Mdeni",role:"Community Engagement Lead",email:"kwakhomdeni@gmail.com",phone:"+27 85 456 7890",dateOfBirth:"1992-09-15",location:"East London, South Africa",status:"active"},{id:"solo",name:"Solo Mdeni",role:"CTO & Technology Lead",email:"solo@mdeni.family",phone:"+27 86 567 8901",dateOfBirth:"2010-06-15",location:"Cape Town, South Africa",status:"active"},{id:"milande",name:"Milande Mdeni",role:"Future Leader in Development",email:"milandep.mdeni@gmail.com",phone:"+27 87 678 9012",dateOfBirth:"2017-03-12",location:"Cape Town, South Africa",status:"developing"},{id:"sazi",name:"Sazi Mdeni",role:"Future Leader in Training",email:"sazisimdeni@gmail.com",phone:"+27 87 111 2222",dateOfBirth:"2018-08-10",location:"Cape Town, South Africa",status:"developing"},{id:"mila",name:"Mila Mdeni",role:"Future Leader in Training",email:"milamdeni@gmail.com",phone:"+27 87 333 4444",dateOfBirth:"2019-05-20",location:"Cape Town, South Africa",status:"developing"},{id:"milani",name:"Milani Mdeni",role:"Next Generation in Training",email:"",phone:"+27 87 555 6666",dateOfBirth:"2020-11-08",location:"Cape Town, South Africa",status:"developing"},{id:"azora",name:"Azora Mdeni",role:"Next Generation in Training",email:"azoramdeni@gmail.com",phone:"+27 87 777 8888",dateOfBirth:"2021-04-15",location:"Durban, South Africa",status:"developing"}];var Oe=e=>{let{existingContacts:t,onImport:s,onClose:i,currentUserId:o}=e;const[c,u]=(0,n.useState)(new Set),[m,x]=(0,n.useState)("selecting"),[h,g]=(0,n.useState)(0),b=new Set(t.filter((e=>e.familyTreeId)).map((e=>e.familyTreeId))),p=Pe.filter((e=>!b.has(e.id)&&e.email));(0,n.useEffect)((()=>{const e=p.filter((e=>"active"===e.status)).map((e=>e.id));u(new Set(e))}),[]);return(0,a.jsx)(W.M,{children:(0,a.jsx)("div",{className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[(0,a.jsxs)("div",{className:"px-6 py-5 border-b border-gray-200 flex items-center justify-between bg-gradient-to-r from-indigo-50 to-purple-50",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsx)("div",{className:"p-2 bg-indigo-600 rounded-lg",children:(0,a.jsx)(l.Z,{className:"h-6 w-6 text-white"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Import from Family Tree"}),(0,a.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"Select family members to add as contacts"})]})]}),(0,a.jsx)("button",{onClick:i,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:"importing"===m,children:(0,a.jsx)(f.Z,{className:"h-6 w-6 text-gray-500"})})]}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6",children:["selecting"===m&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"mb-6 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:c.size})," of"," ",(0,a.jsx)("span",{className:"font-semibold text-gray-900",children:p.length})," selected"]}),b.size>0&&(0,a.jsxs)("div",{className:"text-sm text-gray-500",children:["(",b.size," already imported)"]})]}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)("button",{onClick:()=>{u(new Set(p.map((e=>e.id))))},className:"px-3 py-1.5 text-sm text-indigo-600 hover:bg-indigo-50 rounded-lg transition-colors",children:"Select All"}),(0,a.jsx)("button",{onClick:()=>{u(new Set)},className:"px-3 py-1.5 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear"})]})]}),0===p.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(A.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"All Family Members Imported"}),(0,a.jsx)("p",{className:"text-gray-600",children:"All available family members have already been added to your contacts."})]}):(0,a.jsx)("div",{className:"space-y-3",children:p.map((e=>{return(0,a.jsx)(r.E.button,{onClick:()=>(e=>{const t=new Set(c);t.has(e)?t.delete(e):t.add(e),u(t)})(e.id),className:"w-full p-4 rounded-xl border-2 transition-all text-left ".concat(c.has(e.id)?"border-indigo-500 bg-indigo-50":"border-gray-200 hover:border-gray-300 bg-white"),whileHover:{scale:1.01},whileTap:{scale:.99},children:(0,a.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,a.jsx)("div",{className:"pt-1",children:c.has(e.id)?(0,a.jsx)(A.Z,{className:"h-6 w-6 text-indigo-600"}):(0,a.jsx)(Be.Z,{className:"h-6 w-6 text-gray-300"})}),(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"font-semibold text-gray-900 text-lg",children:e.name}),(0,a.jsx)("p",{className:"text-sm text-indigo-600 font-medium",children:e.role})]}),(0,a.jsx)("span",{className:"px-2 py-1 text-xs font-medium rounded-full ".concat((t=e.status,{active:"bg-green-100 text-green-700",emeritus:"bg-purple-100 text-purple-700",developing:"bg-blue-100 text-blue-700"}[t]||"bg-gray-100 text-gray-700")),children:e.status})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-2 text-sm text-gray-600",children:[e.email&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"\ud83d\udce7"}),(0,a.jsx)("span",{className:"truncate",children:e.email})]}),e.phone&&(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"\ud83d\udcf1"}),(0,a.jsx)("span",{children:e.phone})]}),e.location&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 col-span-2",children:[(0,a.jsx)("span",{className:"text-gray-400",children:"\ud83d\udccd"}),(0,a.jsx)("span",{className:"truncate",children:e.location})]})]})]})]})},e.id);var t}))})]}),"importing"===m&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-16 w-16 border-b-4 border-indigo-600 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Importing Contacts..."}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Adding ",c.size," family member",1!==c.size?"s":""," to your contacts"]})]}),"complete"===m&&(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(A.Z,{className:"h-16 w-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Import Complete!"}),(0,a.jsxs)("p",{className:"text-gray-600",children:["Successfully imported ",h," family member",1!==h?"s":""]})]})]}),"selecting"===m&&p.length>0&&(0,a.jsxs)("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex items-center justify-between",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600",children:c.size>0?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(y.Z,{className:"inline h-4 w-4 mr-1 text-green-600"}),"Ready to import ",c.size," contact",1!==c.size?"s":""]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(B.Z,{className:"inline h-4 w-4 mr-1 text-gray-400"}),"Select at least one family member to import"]})}),(0,a.jsxs)("div",{className:"flex space-x-3",children:[(0,a.jsx)("button",{onClick:i,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-100 transition-colors",children:"Cancel"}),(0,a.jsxs)("button",{onClick:()=>{x("importing");const e=p.filter((e=>c.has(e.id))).map((e=>{const t=e.name.split(" "),s=t[0],a=t.slice(1).join(" ");return{id:"family_".concat(e.id,"_").concat(Date.now()),firstName:s,lastName:a,phoneNumbers:e.phone?[e.phone]:[],emails:e.email?[e.email]:[],addresses:e.location?[e.location]:[],category:"family",tags:["Family Member",e.role],notes:"Imported from family tree. Role: ".concat(e.role),privacy:"family",addedBy:o,createdAt:new Date,updatedAt:new Date,isHouseholdMember:!1,isFamilyMember:!0,sonnyRole:"none",familyTreeId:e.id}}));g(e.length),setTimeout((()=>{s(e),x("complete"),setTimeout(i,2e3)}),1e3)},disabled:0===c.size,className:"px-6 py-2 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsxs)("span",{children:["Import ",c.size>0?"".concat(c.size):""," Contact",1!==c.size?"s":""]})]})]})]})]})})})};var ze=e=>{let{isOpen:t,onClose:s}=e;const{user:o}=(0,v.a)(),[c,d]=(0,n.useState)({defaultStatus:"online",showOnlineStatus:!0,allowFamilyToSee:!0,allowContactsToSee:!0}),[u,m]=(0,n.useState)(!1),[x,h]=(0,n.useState)(!1),[g,b]=(0,n.useState)(!0);(0,n.useEffect)((()=>{t&&o&&p()}),[t,o]);const p=async()=>{if(o)try{b(!0);const e=await G.getPresenceSettings(o.id);e&&d(e)}catch(e){}finally{b(!1)}},f=[{value:"online",label:"Online",description:"Show when you are active",icon:(0,a.jsx)("div",{className:"w-3 h-3 bg-green-500 rounded-full"})},{value:"offline",label:"Appear Offline",description:"Always show as offline",icon:(0,a.jsx)("div",{className:"w-3 h-3 bg-gray-400 rounded-full"})},{value:"invisible",label:"Invisible",description:"Hide your online status completely",icon:(0,a.jsx)(S.Z,{className:"w-4 h-4 text-gray-500"})}];return(0,a.jsx)(O.uj,{isOpen:t,onClose:s,title:"Presence & Privacy Settings",children:(0,a.jsx)("div",{className:"space-y-6",children:g?(0,a.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,a.jsx)(P.Z,{className:"w-8 h-8 text-ubuntu-orange animate-spin"})}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4"}),"Default Status"]}),(0,a.jsx)("div",{className:"space-y-2",children:f.map((e=>(0,a.jsx)("button",{onClick:()=>d({...c,defaultStatus:e.value}),className:"w-full p-3 rounded-lg border-2 text-left transition-all ".concat(c.defaultStatus===e.value?"border-ubuntu-orange bg-orange-50":"border-gray-200 hover:border-gray-300"),children:(0,a.jsxs)("div",{className:"flex items-start gap-3",children:[(0,a.jsx)("div",{className:"mt-1",children:e.icon}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:e.label}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:e.description})]}),c.defaultStatus===e.value&&(0,a.jsx)(A.Z,{className:"w-5 h-5 text-ubuntu-orange flex-shrink-0 mt-0.5"})]})},e.value)))})]}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-sm font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,a.jsx)(k.Z,{className:"w-4 h-4"}),"Who Can See Your Status"]}),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border border-gray-200 hover:bg-gray-50 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:c.showOnlineStatus,onChange:e=>d({...c,showOnlineStatus:e.target.checked}),className:"mt-1 w-4 h-4 text-ubuntu-orange border-gray-300 rounded focus:ring-ubuntu-orange"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium text-gray-900",children:"Show my online status"}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Display when you are active on the platform"})]})]}),(0,a.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border ".concat(c.showOnlineStatus?"border-gray-200 hover:bg-gray-50 cursor-pointer":"border-gray-100 bg-gray-50 opacity-50 cursor-not-allowed"),children:[(0,a.jsx)("input",{type:"checkbox",checked:c.allowFamilyToSee,onChange:e=>d({...c,allowFamilyToSee:e.target.checked}),disabled:!c.showOnlineStatus,className:"mt-1 w-4 h-4 text-ubuntu-orange border-gray-300 rounded focus:ring-ubuntu-orange disabled:opacity-50"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4"}),"Family Members"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Allow family members to see when you are online"})]})]}),(0,a.jsxs)("label",{className:"flex items-start gap-3 p-3 rounded-lg border ".concat(c.showOnlineStatus?"border-gray-200 hover:bg-gray-50 cursor-pointer":"border-gray-100 bg-gray-50 opacity-50 cursor-not-allowed"),children:[(0,a.jsx)("input",{type:"checkbox",checked:c.allowContactsToSee,onChange:e=>d({...c,allowContactsToSee:e.target.checked}),disabled:!c.showOnlineStatus,className:"mt-1 w-4 h-4 text-ubuntu-orange border-gray-300 rounded focus:ring-ubuntu-orange disabled:opacity-50"}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsxs)("div",{className:"font-medium text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(y.Z,{className:"w-4 h-4"}),"My Contacts"]}),(0,a.jsx)("div",{className:"text-sm text-gray-600",children:"Allow your contacts to see when you are online"})]})]})]})]}),(0,a.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,a.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,a.jsx)("strong",{children:"Privacy Note:"})," Even when invisible, your last seen time will be hidden. Family members and contacts will only see you as offline."]})}),x&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:"bg-green-50 border border-green-200 rounded-lg p-4 flex items-center gap-3",children:[(0,a.jsx)(A.Z,{className:"w-5 h-5 text-green-600 flex-shrink-0"}),(0,a.jsx)("p",{className:"text-sm text-green-800 font-medium",children:"Settings saved successfully!"})]}),(0,a.jsxs)("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",disabled:u,children:"Cancel"}),(0,a.jsx)("button",{onClick:async()=>{if(o)try{m(!0),await G.updatePresenceSettings(o.id,c),h(!0),setTimeout((()=>{s(),h(!1)}),1e3)}catch(e){alert("Failed to save settings. Please try again.")}finally{m(!1)}},disabled:u||x,className:"flex-1 px-4 py-2 bg-ubuntu-orange text-white rounded-lg hover:bg-ubuntu-orange-dark transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:u?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(P.Z,{className:"w-4 h-4 animate-spin"}),"Saving..."]}):x?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(A.Z,{className:"w-4 h-4"}),"Saved"]}):"Save Settings"})]})]})})})},Ue=s(86082),_e=s(78865),He=s(18289);const Ve=e=>{let{title:t,expanded:s,onToggle:n,children:l,icon:i}=e;return(0,a.jsxs)("div",{className:"border border-ubuntu-warm-200 rounded-lg overflow-hidden",children:[(0,a.jsxs)("button",{onClick:n,className:"w-full px-4 py-3 bg-gradient-to-r from-ubuntu-warm-50 to-ubuntu-warm-100 hover:from-ubuntu-warm-100 hover:to-ubuntu-warm-200 transition-colors flex items-center justify-between font-semibold text-ubuntu-warm-900",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[i,t]}),(0,a.jsx)(r.E.div,{animate:{rotate:s?180:0},transition:{duration:.2},children:"\u25bc"})]}),(0,a.jsx)(W.M,{children:s&&(0,a.jsx)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"px-4 py-4 border-t border-ubuntu-warm-200 space-y-3",children:l})})]})};var Ge=e=>{let{contact:t,allContacts:s,onClose:o,onEdit:c,currentUserId:u}=e;var m;const[x,h]=(0,n.useState)(null),[g,b]=(0,n.useState)("overview");if(!t)return null;const p=(e,t)=>{navigator.clipboard.writeText(e),h(t),setTimeout((()=>h(null)),2e3)};return(0,a.jsx)(W.M,{children:(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:o,className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)(r.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-ubuntu-warm-50 to-ubuntu-warm-100 px-6 py-6 border-b border-ubuntu-warm-200 flex items-center justify-between z-10",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-3xl font-ubuntu font-bold text-ubuntu-warm-900",children:[t.firstName," ",t.lastName]}),(0,a.jsxs)("p",{className:"text-ubuntu-warm-600 mt-1 text-sm",children:[t.category," \u2022 Added ",t.createdAt.toLocaleDateString()]})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("button",{onClick:()=>{const e="Contact: ".concat(t.firstName," ").concat(t.lastName,"\n").concat(t.emails.join(", "),"\n").concat(t.phoneNumbers.join(", "));navigator.share?navigator.share({title:"Contact: ".concat(t.firstName," ").concat(t.lastName),text:e}):p(e,"share")},className:"p-2 hover:bg-ubuntu-warm-200 rounded-lg transition-colors",title:"Share contact",children:(0,a.jsx)(Ue.Z,{className:"w-5 h-5 text-ubuntu-warm-700"})}),(0,a.jsx)("button",{onClick:()=>{const e=function(e){const t="".concat(e.firstName).concat(e.middleName?" "+e.middleName:""," ").concat(e.lastName),s=["BEGIN:VCARD","VERSION:3.0","FN:".concat(t),"N:".concat(e.lastName,";").concat(e.firstName,";;;"),...e.phoneNumbers.map((e=>"TEL:".concat(e))),...e.emails.map((e=>"EMAIL:".concat(e))),...e.addresses.map((e=>"ADR:;;".concat(e))),e.birthday?"BDAY:".concat(e.birthday):"",e.notes?"NOTE:".concat(e.notes.replace(/\n/g,"\\n")):"","END:VCARD"].filter((e=>e.length>0));return s.join("\r\n")}(t),s=new Blob([e],{type:"text/vcard"}),a=document.createElement("a"),n=URL.createObjectURL(s);a.href=n,a.download="".concat(t.firstName,"_").concat(t.lastName,".vcf"),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n)},className:"p-2 hover:bg-ubuntu-warm-200 rounded-lg transition-colors",title:"Export as vCard",children:(0,a.jsx)(d.Z,{className:"w-5 h-5 text-ubuntu-warm-700"})}),(0,a.jsx)("button",{onClick:()=>c(t),className:"p-2 hover:bg-ubuntu-gold/20 rounded-lg transition-colors",title:"Edit contact",children:(0,a.jsx)(T.Z,{className:"w-5 h-5 text-ubuntu-gold"})}),(0,a.jsx)("button",{onClick:o,className:"p-2 hover:bg-red-100 rounded-lg transition-colors",title:"Close",children:(0,a.jsx)(f.Z,{className:"w-5 h-5 text-red-600"})})]})]}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsx)(Ve,{title:"Overview",section:"overview",expanded:"overview"===g,onToggle:()=>b("overview"===g?null:"overview"),children:(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[t.emails.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-ubuntu-warm-700 mb-2 flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),"Emails"]}),(0,a.jsx)("div",{className:"space-y-1",children:t.emails.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-ubuntu-warm-50 rounded",children:[(0,a.jsx)("a",{href:"mailto:".concat(e),className:"text-ubuntu-warm-700 hover:text-ubuntu-gold truncate",children:e}),(0,a.jsx)("button",{onClick:()=>p(e,"email-".concat(t)),className:"ml-2 p-1 hover:bg-ubuntu-warm-200 rounded transition-colors",children:x==="email-".concat(t)?(0,a.jsx)(_e.Z,{className:"w-4 h-4 text-green-600"}):(0,a.jsx)(He.Z,{className:"w-4 h-4 text-ubuntu-warm-500"})})]},t)))})]}),t.phoneNumbers.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-ubuntu-warm-700 mb-2 flex items-center gap-2",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4"}),"Phone"]}),(0,a.jsx)("div",{className:"space-y-1",children:t.phoneNumbers.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center justify-between p-2 bg-ubuntu-warm-50 rounded",children:[(0,a.jsx)("a",{href:"tel:".concat(e),className:"text-ubuntu-warm-700 hover:text-ubuntu-gold",children:e}),(0,a.jsx)("button",{onClick:()=>p(e,"phone-".concat(t)),className:"ml-2 p-1 hover:bg-ubuntu-warm-200 rounded transition-colors",children:x==="phone-".concat(t)?(0,a.jsx)(_e.Z,{className:"w-4 h-4 text-green-600"}):(0,a.jsx)(He.Z,{className:"w-4 h-4 text-ubuntu-warm-500"})})]},t)))})]}),t.addresses.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-ubuntu-warm-700 mb-2 flex items-center gap-2",children:[(0,a.jsx)(D.Z,{className:"w-4 h-4"}),"Addresses"]}),(0,a.jsx)("div",{className:"space-y-1",children:t.addresses.map(((e,t)=>(0,a.jsx)("div",{className:"p-2 bg-ubuntu-warm-50 rounded text-sm text-ubuntu-warm-700",children:e},t)))})]}),t.birthday&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-ubuntu-warm-700 mb-2 flex items-center gap-2",children:[(0,a.jsx)(me.Z,{className:"w-4 h-4"}),"Birthday"]}),(0,a.jsx)("div",{className:"p-2 bg-ubuntu-warm-50 rounded text-sm text-ubuntu-warm-700",children:new Date(t.birthday).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})})]})]})}),t.photoUrls&&t.photoUrls.length>0&&(0,a.jsx)(Ve,{title:"Images (".concat(t.photoUrls.length,")"),section:"images",expanded:"images"===g,onToggle:()=>b("images"===g?null:"images"),icon:(0,a.jsx)(ee.Z,{className:"w-4 h-4"}),children:(0,a.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 gap-3",children:t.photoUrls.map(((e,t)=>(0,a.jsxs)(r.E.div,{initial:{opacity:0,scale:.8},animate:{opacity:1,scale:1},className:"relative group cursor-pointer",children:[(0,a.jsx)("img",{src:e,alt:"Photo ".concat(t+1),className:"w-full h-32 object-cover rounded-lg border border-ubuntu-warm-200 hover:border-ubuntu-gold transition-colors"}),(0,a.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 rounded-lg transition-colors flex items-center justify-center",children:(0,a.jsx)("span",{className:"text-white opacity-0 group-hover:opacity-100 text-sm font-medium",children:t+1})})]},t)))})}),t.notes&&(0,a.jsx)(Ve,{title:"Notes",section:"notes",expanded:"notes"===g,onToggle:()=>b("notes"===g?null:"notes"),children:(0,a.jsx)("div",{className:"p-4 bg-ubuntu-warm-50 rounded-lg border border-ubuntu-warm-200",children:(0,a.jsx)("p",{className:"text-ubuntu-warm-700 whitespace-pre-wrap",children:t.notes})})}),t.relationships&&t.relationships.length>0&&(0,a.jsx)(Ve,{title:"Relationships (".concat(t.relationships.length,")"),section:"relationships",expanded:"relationships"===g,onToggle:()=>b("relationships"===g?null:"relationships"),icon:(0,a.jsx)(Y.Z,{className:"w-4 h-4"}),children:(0,a.jsx)(ie,{contact:t,allContacts:s,relationships:(null===(m=t.relationships)||void 0===m?void 0:m.map((e=>({type:e.label.toLowerCase(),contactId:"",contactName:e.value}))))||[],onAddRelationship:()=>{},onRemoveRelationship:()=>{}})}),s.length>0&&(0,a.jsx)(Ve,{title:"Smart Suggestions",section:"suggestions",expanded:"suggestions"===g,onToggle:()=>b("suggestions"===g?null:"suggestions"),icon:(0,a.jsx)(l.Z,{className:"w-4 h-4"}),children:(0,a.jsx)($,{contact:t,allContacts:s,onContactClick:()=>{},maxSuggestions:10,compact:!1})}),(0,a.jsx)(Ve,{title:"Information",section:"metadata",expanded:"metadata"===g,onToggle:()=>b("metadata"===g?null:"metadata"),icon:(0,a.jsx)(i.Z,{className:"w-4 h-4"}),children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-sm",children:[(0,a.jsxs)("div",{className:"p-3 bg-ubuntu-warm-50 rounded",children:[(0,a.jsx)("p",{className:"text-ubuntu-warm-600",children:"Category"}),(0,a.jsx)("p",{className:"font-semibold text-ubuntu-warm-900 capitalize",children:t.category})]}),(0,a.jsxs)("div",{className:"p-3 bg-ubuntu-warm-50 rounded",children:[(0,a.jsx)("p",{className:"text-ubuntu-warm-600",children:"Added"}),(0,a.jsx)("p",{className:"font-semibold text-ubuntu-warm-900",children:t.createdAt.toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"p-3 bg-ubuntu-warm-50 rounded",children:[(0,a.jsx)("p",{className:"text-ubuntu-warm-600",children:"Last Updated"}),(0,a.jsx)("p",{className:"font-semibold text-ubuntu-warm-900",children:t.updatedAt.toLocaleDateString()})]}),(0,a.jsxs)("div",{className:"p-3 bg-ubuntu-warm-50 rounded",children:[(0,a.jsx)("p",{className:"text-ubuntu-warm-600",children:"Tags"}),(0,a.jsx)("p",{className:"font-semibold text-ubuntu-warm-900",children:t.tags.length>0?t.tags.join(", "):"None"})]})]})})]})]})})})},Je=s(50039),We=s(83691);var Ye=e=>{let{contacts:t,onRestore:s,currentUserId:l}=e;const[i,u]=(0,n.useState)([]),[m,x]=(0,n.useState)(null),[h,g]=(0,n.useState)(!0),[b,p]=(0,n.useState)(!1),[y,f]=(0,n.useState)(!1),[N,j]=(0,n.useState)(null),[v,w]=(0,n.useState)(null);(0,n.useEffect)((()=>{C()}),[l]),(0,n.useEffect)((()=>{if(h&&t.length>0){const e=setTimeout((()=>{S()}),6e4);return()=>clearTimeout(e)}}),[t,h]);const C=()=>{try{const e="contact_backups_".concat(l),t=localStorage.getItem(e);if(t){u(JSON.parse(t));const e=JSON.parse(t);if(e.length>0){const t=e[0];x(t.date)}}}catch(e){}},k=()=>{const e={version:"1.0",appName:"LifeCV Contacts",timestamp:(new Date).toISOString(),userId:l,contactCount:t.length,contacts:t};return new Blob([JSON.stringify(e,null,2)],{type:"application/json"})},S=async()=>{if(0!==t.length)try{const e=k(),s=new Date,a=s.toLocaleString(),n=s.getTime(),r=[{timestamp:n,date:a,size:e.size,contactCount:t.length},...i].slice(0,10);u(r);const o="contact_backups_".concat(l);localStorage.setItem(o,JSON.stringify(r)),x(a)}catch(e){}},Z=e=>{if(0===e)return"0 B";const t=Math.floor(Math.log(e)/Math.log(1024));return Math.round(e/Math.pow(1024,t)*100)/100+" "+["B","KB","MB"][t]};return(0,a.jsxs)("div",{className:"space-y-6",children:[N&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-4 rounded-lg flex items-center gap-2 ".concat("success"===N.type?"bg-green-50 border border-green-200 text-green-700":"bg-red-50 border border-red-200 text-red-700"),children:["success"===N.type?(0,a.jsx)(A.Z,{className:"w-5 h-5 flex-shrink-0"}):(0,a.jsx)(B.Z,{className:"w-5 h-5 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm font-medium",children:N.text})]}),(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-ubuntu-warm-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-ubuntu-warm-50 to-ubuntu-warm-100 px-6 py-4 border-b border-ubuntu-warm-200",children:[(0,a.jsxs)("h3",{className:"font-semibold text-ubuntu-warm-900 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-5 h-5"}),"Backup Your Contacts"]}),(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-700 mt-1",children:"Download all your contacts as a JSON file for safekeeping"})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"p-3 bg-ubuntu-warm-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-700",children:"Total Contacts"}),(0,a.jsx)("p",{className:"text-2xl font-bold text-ubuntu-warm-900",children:t.length})]}),(0,a.jsxs)("div",{className:"p-3 bg-ubuntu-warm-50 rounded-lg",children:[(0,a.jsx)("p",{className:"text-sm text-ubuntu-warm-700",children:"Last Backup"}),(0,a.jsx)("p",{className:"text-lg font-semibold text-ubuntu-warm-900",children:m?new Date(m).toLocaleDateString():"Never"})]})]}),(0,a.jsxs)("div",{className:"flex gap-3 flex-wrap",children:[(0,a.jsx)(r.E.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:async()=>{if(0!==t.length)try{f(!0);const e=k(),s=new Date,a=s.toLocaleString(),n=s.getTime(),r=[{timestamp:n,date:a,size:e.size,contactCount:t.length},...i].slice(0,10);u(r);const o="contact_backups_".concat(l);localStorage.setItem(o,JSON.stringify(r)),x(a);const c=URL.createObjectURL(e),d=document.createElement("a");d.href=c,d.download="contacts-backup-".concat(s.toISOString().split("T")[0],".json"),document.body.appendChild(d),d.click(),document.body.removeChild(d),URL.revokeObjectURL(c),j({type:"success",text:"\u2705 Backed up ".concat(t.length," contacts")}),setTimeout((()=>j(null)),3e3)}catch(e){j({type:"error",text:"Failed to backup contacts"})}finally{f(!1)}else j({type:"error",text:"No contacts to backup"})},disabled:y||0===t.length,className:"px-4 py-2 bg-gradient-to-r from-ubuntu-orange to-ubuntu-gold text-white rounded-lg font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transition-shadow",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Je.Z,{className:"w-4 h-4 inline mr-2"}),"Backing up..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 inline mr-2"}),"Download Backup"]})}),(0,a.jsxs)("label",{className:"px-4 py-2 bg-ubuntu-warm-200 text-ubuntu-warm-900 rounded-lg font-medium cursor-pointer hover:bg-ubuntu-warm-300 transition-colors",children:[b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(Je.Z,{className:"w-4 h-4 inline mr-2"}),"Restoring..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 inline mr-2"}),"Restore from File"]}),(0,a.jsx)("input",{type:"file",accept:".json",onChange:async e=>{var t;const a=null===(t=e.target.files)||void 0===t?void 0:t[0];if(a)try{p(!0);const e=await a.text(),t=JSON.parse(e);if(!t.contacts||!Array.isArray(t.contacts))return void j({type:"error",text:"Invalid backup file format"});const n=t.contacts.length;if(!confirm("This will restore ".concat(n," contacts. This may overwrite existing contacts. Continue?")))return;await s(t.contacts),j({type:"success",text:"\u2705 Restored ".concat(n," contacts from backup")}),C(),setTimeout((()=>j(null)),3e3)}catch(n){j({type:"error",text:"Failed to restore contacts. Invalid file format."})}finally{p(!1),e.target&&(e.target.value="")}},disabled:b,className:"hidden"})]})]}),(0,a.jsx)("div",{className:"border-t border-ubuntu-warm-200 pt-4",children:(0,a.jsxs)("label",{className:"flex items-center gap-3 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:h,onChange:e=>g(e.target.checked),className:"w-4 h-4 rounded border-ubuntu-warm-300 text-ubuntu-gold cursor-pointer"}),(0,a.jsxs)("span",{className:"text-sm text-ubuntu-warm-700",children:[(0,a.jsx)("span",{className:"font-medium",children:"Auto-backup enabled"}),(0,a.jsx)("span",{className:"block text-xs text-ubuntu-warm-600",children:"Automatically backup contacts every 60 seconds when enabled"})]})]})})]})]}),i.length>0&&(0,a.jsxs)("div",{className:"bg-white rounded-lg border border-ubuntu-warm-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-ubuntu-warm-50 to-ubuntu-warm-100 px-6 py-4 border-b border-ubuntu-warm-200 flex items-center justify-between",children:[(0,a.jsxs)("h3",{className:"font-semibold text-ubuntu-warm-900 flex items-center gap-2",children:[(0,a.jsx)(me.Z,{className:"w-5 h-5"}),"Backup History"]}),i.length>0&&(0,a.jsx)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>{if(!confirm("Delete all backup history? This cannot be undone."))return;u([]);const e="contact_backups_".concat(l);localStorage.removeItem(e),x(null),j({type:"success",text:"All backup history cleared"}),setTimeout((()=>j(null)),2e3)},className:"text-xs px-2 py-1 bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors",children:"Clear All"})]}),(0,a.jsx)("div",{className:"divide-y divide-ubuntu-warm-200",children:i.map(((e,t)=>(0,a.jsxs)(r.E.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 hover:bg-ubuntu-warm-50 transition-colors",children:[(0,a.jsx)("button",{onClick:()=>w(v===t?null:t),className:"w-full text-left",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 flex-1",children:[(0,a.jsx)(We.Z,{className:"w-4 h-4 text-ubuntu-warm-500 flex-shrink-0"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-medium text-ubuntu-warm-900",children:e.date}),(0,a.jsxs)("p",{className:"text-sm text-ubuntu-warm-600",children:[e.contactCount," contacts \u2022 ",Z(e.size)]})]})]}),(0,a.jsx)(r.E.div,{animate:{rotate:v===t?180:0},className:"text-ubuntu-warm-500",children:"\u25bc"})]})}),v===t&&(0,a.jsx)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-3 pt-3 border-t border-ubuntu-warm-200 flex gap-2",children:(0,a.jsxs)(r.E.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:()=>(e=>{const t=i.filter(((t,s)=>s!==e));u(t);const s="contact_backups_".concat(l);localStorage.setItem(s,JSON.stringify(t)),j({type:"success",text:"Backup metadata deleted"}),setTimeout((()=>j(null)),2e3)})(t),className:"flex-1 px-3 py-1 text-sm bg-red-100 text-red-700 rounded hover:bg-red-200 transition-colors flex items-center justify-center gap-1",children:[(0,a.jsx)(o.Z,{className:"w-3 h-3"}),"Delete Record"]})})]},e.timestamp)))})]}),(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex gap-3",children:[(0,a.jsx)(B.Z,{className:"w-5 h-5 text-blue-600 flex-shrink-0 mt-0.5"}),(0,a.jsxs)("div",{className:"text-sm text-blue-700",children:[(0,a.jsx)("p",{className:"font-medium",children:"Backup Best Practices:"}),(0,a.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1 text-xs",children:[(0,a.jsx)("li",{children:"Download backups regularly and store them safely"}),(0,a.jsx)("li",{children:"Keep auto-backup enabled for automatic protection"}),(0,a.jsx)("li",{children:"Store backups on external drives or cloud storage"}),(0,a.jsx)("li",{children:"Backup history is stored locally and cleared when browser data is cleared"})]})]})]})]})},qe=s(90163);var Ke=e=>{let{userId:t,isOpen:s,onClose:l,onContactRestored:i}=e;const[c,d]=(0,n.useState)([]),[u,m]=(0,n.useState)(!0),[x,h]=(0,n.useState)(""),[b,p]=(0,n.useState)(null),[y,N]=(0,n.useState)(null),[j,v]=(0,n.useState)(!1);(0,n.useEffect)((()=>{if(!s)return;(async()=>{try{m(!0);const e=await I.Z.getDeletedContacts(t);d(e)}catch(e){}finally{m(!1)}})()}),[s,t]);const w=e=>{if(!e)return 30;const t=new Date,s=new Date(e),a=Math.floor((t.getTime()-s.getTime())/864e5);return Math.max(0,30-a)},C=e=>0===w(e),k=c.filter((e=>{const t="".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(x.toLowerCase())||e.emails.some((e=>e.toLowerCase().includes(x.toLowerCase())))||e.phoneNumbers.some((e=>e.includes(x)));return j?t&&C(e.deletedAt):t}));return s?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:l,className:"fixed inset-0 bg-black/50 z-40"}),(0,a.jsxs)(r.E.div,{initial:{y:"100%",opacity:0},animate:{y:0,opacity:1},exit:{y:"100%",opacity:0},transition:{type:"spring",damping:30,stiffness:300},className:"fixed bottom-0 left-0 right-0 max-h-[90vh] bg-white dark:bg-slate-900 rounded-t-2xl shadow-2xl z-50 overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-orange-50 to-red-50 dark:from-slate-800 dark:to-slate-800 border-b border-orange-200 dark:border-slate-700 px-6 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-red-100 dark:bg-red-900 rounded-lg",children:(0,a.jsx)(o.Z,{className:"w-5 h-5 text-red-600 dark:text-red-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Recycle Bin"}),(0,a.jsxs)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:["Contacts deleted here can be restored for ",30," days"]})]})]}),(0,a.jsx)("button",{onClick:l,className:"p-2 hover:bg-white/50 dark:hover:bg-slate-700 rounded-lg transition-colors",children:(0,a.jsx)(f.Z,{className:"w-5 h-5 text-slate-500"})})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search deleted contacts...",value:x,onChange:e=>h(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400 dark:placeholder-slate-500 focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,a.jsx)("div",{className:"flex gap-2 items-center",children:(0,a.jsxs)("label",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400 cursor-pointer",children:[(0,a.jsx)("input",{type:"checkbox",checked:j,onChange:e=>v(e.target.checked),className:"rounded"}),"Show only expiring soon"]})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,a.jsxs)("div",{className:"p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Total Deleted"}),(0,a.jsx)("p",{className:"text-xl font-bold text-slate-900 dark:text-white",children:c.length})]}),(0,a.jsxs)("div",{className:"p-3 bg-orange-50 dark:bg-orange-900/20 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Available"}),(0,a.jsx)("p",{className:"text-xl font-bold text-orange-600 dark:text-orange-400",children:c.filter((e=>!C(e.deletedAt))).length})]}),(0,a.jsxs)("div",{className:"p-3 bg-red-50 dark:bg-red-900/20 rounded-lg",children:[(0,a.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Expiring"}),(0,a.jsx)("p",{className:"text-xl font-bold text-red-600 dark:text-red-400",children:c.filter((e=>C(e.deletedAt))).length})]})]}),u?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):0===k.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(A.Z,{className:"w-12 h-12 text-green-500 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"No deleted contacts found"})]}):(0,a.jsx)("div",{className:"space-y-3",children:(0,a.jsx)(W.M,{children:k.map(((e,t)=>{const s=w(e.deletedAt),n=C(e.deletedAt),l=b===e.id||y===e.id;return(0,a.jsx)(r.E.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},transition:{delay:.05*t},className:"p-4 border rounded-lg transition-all ".concat(n?"border-red-200 dark:border-red-900/30 bg-red-50/50 dark:bg-red-900/10":"border-slate-200 dark:border-slate-700 bg-slate-50/50 dark:bg-slate-800/50"," ").concat(l?"opacity-50":""),children:(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,a.jsxs)("h3",{className:"font-semibold text-slate-900 dark:text-white",children:[e.firstName," ",e.lastName]}),(0,a.jsxs)("div",{className:"mt-2 space-y-1 text-sm text-slate-600 dark:text-slate-400",children:[e.emails.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(E.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"truncate",children:e.emails[0]})]}),e.phoneNumbers.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(L.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{children:e.phoneNumbers[0]})]}),e.addresses.length>0&&(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(me.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"truncate text-xs",children:e.addresses[0]})]})]}),(0,a.jsx)("div",{className:"mt-3 pt-3 border-t border-slate-200 dark:border-slate-700",children:(0,a.jsxs)("div",{className:"flex items-center gap-2 text-xs text-slate-500 dark:text-slate-400",children:[(0,a.jsx)(Je.Z,{className:"w-3.5 h-3.5"}),e.deletedAt&&(0,a.jsxs)(a.Fragment,{children:["Deleted ",new Date(e.deletedAt).toLocaleDateString()," \u2022"," ",s>0?(0,a.jsx)("span",{className:n?"text-red-600 dark:text-red-400 font-semibold":"text-orange-600 dark:text-orange-400",children:1===s?"1 day left":"".concat(s," days left")}):(0,a.jsx)("span",{className:"text-red-600 dark:text-red-400 font-semibold",children:"Expiring today"})]})]})})]}),(0,a.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,a.jsx)("button",{onClick:()=>(async e=>{try{p(e),await I.Z.restoreContact(e);const t=c.find((t=>t.id===e));t&&i(t),d((t=>t.filter((t=>t.id!==e))))}catch(t){alert("Failed to restore contact. Please try again.")}finally{p(null)}})(e.id),disabled:l||null!==b,className:"p-2 bg-green-50 dark:bg-green-900/20 hover:bg-green-100 dark:hover:bg-green-900/40 text-green-600 dark:text-green-400 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Restore this contact",children:(0,a.jsx)(qe.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>(async(e,t)=>{if(confirm('Are you sure you want to permanently delete "'.concat(t,'"? This action CANNOT be undone.')))try{N(e),await I.Z.permanentlyDeleteContact(e),d((t=>t.filter((t=>t.id!==e))))}catch(s){alert("Failed to permanently delete contact. Please try again.")}finally{N(null)}})(e.id,"".concat(e.firstName," ").concat(e.lastName)),disabled:l,className:"p-2 bg-red-50 dark:bg-red-900/20 hover:bg-red-100 dark:hover:bg-red-900/40 text-red-600 dark:text-red-400 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",title:"Permanently delete this contact",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})})]})]})},e.id)}))})}),c.length>0&&(0,a.jsxs)("div",{className:"border-t border-slate-200 dark:border-slate-700 pt-4 flex gap-3",children:[(0,a.jsxs)("button",{onClick:async()=>{if(confirm("Are you sure you want to permanently delete ALL deleted contacts? This action CANNOT be undone."))try{for(const e of c)await I.Z.permanentlyDeleteContact(e.id);d([]),alert("\u2705 Recycle bin emptied successfully.")}catch(e){alert("Failed to empty recycle bin. Please try again.")}},className:"flex-1 px-4 py-2 bg-red-100 dark:bg-red-900/30 hover:bg-red-200 dark:hover:bg-red-900/50 text-red-600 dark:text-red-400 font-medium rounded-lg transition-colors flex items-center justify-center gap-2",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),"Empty Recycle Bin"]}),(0,a.jsx)("button",{onClick:l,className:"flex-1 px-4 py-2 bg-slate-100 dark:bg-slate-700 hover:bg-slate-200 dark:hover:bg-slate-600 text-slate-900 dark:text-white font-medium rounded-lg transition-colors",children:"Close"})]})]})]})]}):null},Xe=s(89354),Qe=s(74598);var $e=e=>{let{isOpen:t,onClose:s,contacts:l,onCleanupComplete:i}=e;const[c,d]=(0,n.useState)([]),[u,m]=(0,n.useState)(new Set),[x,h]=(0,n.useState)(!1),[b,p]=(0,n.useState)(!1),[y,N]=(0,n.useState)(null),[j,v]=(0,n.useState)(""),[w,C]=(0,n.useState)(0),[k,S]=(0,n.useState)(!1);(0,n.useEffect)((()=>{t&&Z()}),[t,l]);const Z=()=>{h(!0),C(0);const e=[],t=l.filter((e=>!e.firstName||""===e.firstName.trim()));t.length>0&&e.push({category:"no_first_name",label:"\u274c No First Name",contacts:t,count:t.length,description:"Contacts missing first name - likely false entries"});const s=l.filter((e=>!e.lastName||""===e.lastName.trim()));s.length>0&&e.push({category:"no_last_name",label:"\u26a0\ufe0f No Last Name",contacts:s,count:s.length,description:"Contacts missing last name"});const a=l.filter((e=>(!e.emails||0===e.emails.length)&&(!e.phoneNumbers||0===e.phoneNumbers.length)));a.length>0&&e.push({category:"no_contact_info",label:"\u26a0\ufe0f No Email or Phone",contacts:a,count:a.length,description:"Contacts with no email or phone number"});const n=l.filter((e=>!e.category||"uncategorized"===e.category||""===e.category));n.length>0&&e.push({category:"uncategorized",label:"\ud83c\udff7\ufe0f Uncategorized",contacts:n,count:n.length,description:"Contacts without a category"});const r=l.filter((e=>"friends"===e.category));r.length>0&&e.push({category:"friends",label:"\ud83d\udc65 Friends",contacts:r,count:r.length,description:"All contacts marked as Friends"});const i=l.filter((e=>"colleagues"===e.category));i.length>0&&e.push({category:"colleagues",label:"\ud83d\udcbc Colleagues",contacts:i,count:i.length,description:"All contacts marked as Colleagues"});const o=l.filter((e=>"family"===e.category));o.length>0&&e.push({category:"family",label:"\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d\udc66 Family",contacts:o,count:o.length,description:"All contacts marked as Family"});const c=l.filter((e=>"business"===e.category));c.length>0&&e.push({category:"business",label:"\ud83c\udfe2 Business",contacts:c,count:c.length,description:"All contacts marked as Business"});const u=l.filter((e=>"service"===e.category));u.length>0&&e.push({category:"service",label:"\u2699\ufe0f Service",contacts:u,count:u.length,description:"All contacts marked as Service"});const x=l.filter((e=>"professional"===e.category));x.length>0&&e.push({category:"professional",label:"\ud83d\udc54 Professional",contacts:x,count:x.length,description:"All contacts marked as Professional"}),d(e),h(!1),m(new Set)},E=()=>c.filter((e=>u.has(e.category))).flatMap((e=>e.contacts)).filter(((e,t,s)=>s.findIndex((t=>t.id===e.id))===t));return t?k?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,className:"fixed inset-0 bg-black/50 z-40"}),(0,a.jsx)(r.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-2xl max-w-sm w-full p-6",children:[(0,a.jsx)(A.Z,{className:"w-16 h-16 text-green-500 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-bold text-center text-slate-900 dark:text-white mb-2",children:"Cleanup Complete!"}),(0,a.jsxs)("p",{className:"text-center text-slate-600 dark:text-slate-400 mb-4",children:[w," contacts have been moved to the Recycle Bin"]}),(0,a.jsx)("div",{className:"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 rounded-lg p-3 mb-4",children:(0,a.jsx)("p",{className:"text-sm text-green-700 dark:text-green-300",children:"\ud83d\udca1 Tip: You can restore them from the Recycle Bin for the next 30 days."})})]})})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:s,className:"fixed inset-0 bg-black/50 z-40"}),(0,a.jsx)(r.E.div,{initial:{scale:.95,opacity:0,y:20},animate:{scale:1,opacity:1,y:0},exit:{scale:.95,opacity:0,y:20},transition:{type:"spring",damping:25,stiffness:300},className:"fixed inset-0 flex items-center justify-center z-50 p-4",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-blue-50 to-indigo-50 dark:from-slate-800 dark:to-slate-800 border-b border-blue-200 dark:border-slate-700 px-6 py-4 flex items-center justify-between",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)("div",{className:"p-2 bg-blue-100 dark:bg-blue-900 rounded-lg",children:(0,a.jsx)(Xe.Z,{className:"w-5 h-5 text-blue-600 dark:text-blue-400"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Clean Database"}),(0,a.jsx)("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Select categories to review and delete"})]})]}),(0,a.jsx)("button",{onClick:s,className:"p-2 hover:bg-white/50 dark:hover:bg-slate-700 rounded-lg transition-colors",children:(0,a.jsx)(f.Z,{className:"w-5 h-5 text-slate-500"})})]}),(0,a.jsx)("div",{className:"p-6 space-y-4",children:x?(0,a.jsx)("div",{className:"flex justify-center py-8",children:(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):0===c.length?(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(A.Z,{className:"w-12 h-12 text-green-500 mx-auto mb-3 opacity-50"}),(0,a.jsx)("p",{className:"text-slate-500 dark:text-slate-400",children:"Database is clean! No issues detected."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-3 w-4 h-4 text-slate-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search contact names...",value:j,onChange:e=>v(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-slate-200 dark:border-slate-700 rounded-lg bg-white dark:bg-slate-800 text-slate-900 dark:text-white placeholder-slate-400"})]}),(0,a.jsx)("button",{onClick:()=>{u.size===c.length?m(new Set):m(new Set(c.map((e=>e.category))))},className:"text-sm text-blue-600 dark:text-blue-400 hover:underline font-medium",children:u.size===c.length?"\ud83d\udd18 Deselect All":"\ud83d\udd18 Select All"}),(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 border border-blue-200 dark:border-blue-800 rounded-lg p-3 flex gap-2",children:[(0,a.jsx)(Qe.Z,{className:"w-4 h-4 text-blue-600 dark:text-blue-400 flex-shrink-0 mt-0.5"}),(0,a.jsx)("p",{className:"text-sm text-blue-700 dark:text-blue-300",children:"Selected contacts will be soft-deleted and moved to the Recycle Bin where they can be restored for 30 days."})]}),(0,a.jsx)("div",{className:"space-y-2",children:c.map(((e,t)=>{const s=y===e.category,n=u.has(e.category);return(0,a.jsxs)("div",{children:[(0,a.jsxs)(r.E.button,{onClick:()=>(e=>{const t=new Set(u);t.has(e)?t.delete(e):t.add(e),m(t)})(e.category),className:"w-full flex items-center gap-3 p-3 rounded-lg border-2 transition-all ".concat(n?"bg-blue-50 dark:bg-blue-900/20 border-blue-500 dark:border-blue-600":"bg-slate-50 dark:bg-slate-800 border-slate-200 dark:border-slate-700 hover:border-slate-300 dark:hover:border-slate-600"),children:[(0,a.jsx)("input",{type:"checkbox",checked:n,onChange:()=>{},className:"w-5 h-5 cursor-pointer"}),(0,a.jsxs)("div",{className:"flex-1 text-left",children:[(0,a.jsx)("p",{className:"font-medium text-slate-900 dark:text-white",children:e.label}),(0,a.jsx)("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:e.description})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("span",{className:"text-lg font-bold text-slate-600 dark:text-slate-300",children:e.count}),(0,a.jsx)(X.Z,{className:"w-5 h-5 text-slate-400 transition-transform ".concat(s?"rotate-180":"")})]})]}),(0,a.jsx)(W.M,{children:s&&n&&(0,a.jsx)(r.E.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},className:"overflow-hidden",children:(0,a.jsxs)("div",{className:"bg-slate-50 dark:bg-slate-800 border border-t-0 border-slate-200 dark:border-slate-700 rounded-b-lg p-3 space-y-2",children:[e.contacts.filter((e=>{if(!j)return!0;return"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(j.toLowerCase())})).slice(0,10).map((e=>(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-700 dark:text-slate-300",children:[(0,a.jsx)("span",{className:"text-slate-400",children:"\u2022"}),(0,a.jsxs)("span",{children:[e.firstName," ",e.lastName]}),e.emails.length>0&&(0,a.jsx)("span",{className:"text-xs text-slate-500 ml-auto",children:e.emails[0]})]},e.id))),e.contacts.length>10&&(0,a.jsxs)("p",{className:"text-xs text-slate-500 italic text-center mt-2",children:["+",e.contacts.length-10," more..."]})]})})})]},e.category)}))}),u.size>0&&(0,a.jsx)("div",{className:"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800 rounded-lg p-3",children:(0,a.jsxs)("p",{className:"text-sm text-red-700 dark:text-red-300",children:["\ud83d\uddd1\ufe0f ",E().length," contact(s) will be deleted"]})})]})}),!x&&c.length>0&&(0,a.jsxs)("div",{className:"sticky bottom-0 bg-slate-50 dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 px-6 py-4 flex gap-3 justify-end",children:[(0,a.jsx)("button",{onClick:s,disabled:b,className:"px-4 py-2 rounded-lg border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-300 hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors disabled:opacity-50",children:"Cancel"}),(0,a.jsx)("button",{onClick:async()=>{const e=E();if(0===e.length)return void alert("Please select at least one category to delete");const t="\u26a0\ufe0f WARNING: You are about to delete ".concat(e.length," contact(s).\n\nThey will be moved to the Recycle Bin and can be restored for 30 days.\n\nContinue?");if(!confirm(t))return;p(!0);let a=0,n=0;try{for(const t of e)try{await I.Z.deleteContact(t.id,""),a++}catch(r){n++}C(a),S(!0),alert("\u2705 Cleanup Complete!\n\n\u2705 Deleted: ".concat(a,"\n\u274c Failed: ").concat(n,"\n\nDeleted contacts are in the Recycle Bin for 30 days.")),setTimeout((()=>{i(a),S(!1),s()}),2e3)}catch(r){alert("\u274c Error during cleanup. Please try again.")}finally{p(!1)}},disabled:b||0===u.size,className:"px-4 py-2 rounded-lg bg-red-600 hover:bg-red-700 text-white font-medium transition-colors disabled:opacity-50 flex items-center gap-2",children:b?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),"Deleting..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(o.Z,{className:"w-4 h-4"}),"Delete Selected"]})})]})]})})]}):null};const et=new class{normalizeEmail(e){return e.toLowerCase().trim()}normalizePhone(e){return e.replace(/\D/g,"")}emailsMatch(e,t){const s=e.map((e=>this.normalizeEmail(e))),a=t.map((e=>this.normalizeEmail(e)));return s.some((e=>a.includes(e)))}phonesMatch(e,t){const s=e.map((e=>this.normalizePhone(e))),a=t.map((e=>this.normalizePhone(e)));return s.some((e=>e&&a.includes(e)))}calculateDistance(e,t){const s=Array(t.length+1).fill(null).map((()=>Array(e.length+1).fill(null)));for(let a=0;a<=e.length;a+=1)s[0][a]=a;for(let a=0;a<=t.length;a+=1)s[a][0]=a;for(let a=1;a<=t.length;a+=1)for(let n=1;n<=e.length;n+=1){const r=e[n-1]===t[a-1]?0:1;s[a][n]=Math.min(s[a][n-1]+1,s[a-1][n]+1,s[a-1][n-1]+r)}return s[t.length][e.length]}calculateNameSimilarity(e,t){const s=this.calculateDistance(e.toLowerCase(),t.toLowerCase()),a=Math.max(e.length,t.length);return Math.round(100*(1-s/a))}extractCity(e){const t=e.split(",");return t[t.length-1].trim().toLowerCase()}addressesMatch(e,t){if(0===e.length||0===t.length)return!1;const s=e.map((e=>this.extractCity(e))),a=t.map((e=>this.extractCity(e)));return s.some((e=>a.some((t=>e===t))))}detectDuplicate(e,t){const s=[],a=[];let n=0;this.emailsMatch(e.emails,t.emails)&&(s.push("Email match"),n+=40),this.phonesMatch(e.phoneNumbers,t.phoneNumbers)&&(s.push("Phone number match"),n+=35);const r=this.calculateNameSimilarity(e.firstName,t.firstName),l=this.calculateNameSimilarity(e.lastName,t.lastName);return r>=85&&l>=85?(s.push("Name match (".concat(Math.round((r+l)/2),"% similar)")),n+=25):l>=90&&(s.push("Last name match (".concat(l,"% similar)")),n+=15),this.addressesMatch(e.addresses,t.addresses)&&(s.push("Same city/region"),n+=20),0===s.length?null:(e.phoneNumbers.length>0&&t.phoneNumbers.length>0&&!this.phonesMatch(e.phoneNumbers,t.phoneNumbers)&&a.push({field:"phoneNumbers",existingValue:e.phoneNumbers.join(", "),newValue:t.phoneNumbers.join(", ")}),e.addresses.length>0&&t.addresses.length>0&&e.addresses[0]!==t.addresses[0]&&a.push({field:"addresses",existingValue:e.addresses.join(", "),newValue:t.addresses.join(", ")}),n=Math.min(100,n),n>=50?{existingContactId:e.id,existingContact:e,newContact:t,confidence:n,matchReasons:s,conflictingFields:a}:null)}findDuplicates(e,t){const s=[];for(const a of t){const t=this.detectDuplicate(a,e);t&&s.push(t)}return s.sort(((e,t)=>t.confidence-e.confidence))}findAllDuplicates(e){const t=[],s=new Set;for(let a=0;a<e.length;a++)for(let n=a+1;n<e.length;n++){const r="".concat(e[a].id,"-").concat(e[n].id);if(s.has(r))continue;const l=this.detectDuplicate(e[a],e[n]);l&&(t.push(l),s.add(r))}return t.sort(((e,t)=>t.confidence-e.confidence))}mergeContacts(e,t,s){const a={...e};for(const n of s)if("emails"===n){const s=new Set([...e.emails,...t.emails]);a.emails=Array.from(s)}else if("phoneNumbers"===n){const s=new Set([...e.phoneNumbers,...t.phoneNumbers]);a.phoneNumbers=Array.from(s)}else if("addresses"===n){const s=new Set([...e.addresses,...t.addresses]);a.addresses=Array.from(s)}else if("tags"===n){const s=new Set([...e.tags,...t.tags]);a.tags=Array.from(s)}else void 0!==t[n]&&(a[n]=t[n]);return a.updatedAt=new Date,a}};var tt=()=>{const{user:e}=(0,v.a)(),[t,s]=(0,n.useState)([]),[C,k]=(0,n.useState)([]),[S,Z]=(0,n.useState)(""),[E,A]=(0,n.useState)("all"),[M,F]=(0,n.useState)("all"),[T,L]=(0,n.useState)(!1),[D,R]=(0,n.useState)(!1),[B,P]=(0,n.useState)(!1),[z,U]=(0,n.useState)(!1),[_,H]=(0,n.useState)(null),[V,J]=(0,n.useState)(!0),[W,Y]=(0,n.useState)("all"),[q,K]=(0,n.useState)(null),[X,Q]=(0,n.useState)(null),[$,ee]=(0,n.useState)(null),[te,se]=(0,n.useState)(!1),[ae,ne]=(0,n.useState)(!1),[re,le]=(0,n.useState)(null),[ie,oe]=(0,n.useState)(null),[ce,de]=(0,n.useState)(!1),[me,ge]=(0,n.useState)(!1),[be,pe]=(0,n.useState)("default"),[ye,fe]=(0,n.useState)(1),Ne=20,[je,ve]=(0,n.useState)("grid"),[we,Ce]=(0,n.useState)(new Set),[ke,Se]=(0,n.useState)(!1),[Ee,Ae]=(0,n.useState)(!1),[Me,Fe]=(0,n.useState)(null);(0,n.useEffect)((()=>{if(e){const t=e.displayName||e.email||"User";return G.initializePresence(e.id,t),()=>{G.cleanupPresence(e.id)}}}),[e]),(0,n.useEffect)((()=>{(async()=>{if(e)try{J(!0);const t=await I.Z.getUserContacts(e.id);s(t)}catch(t){s([])}finally{J(!1)}else J(!1)})()}),[e]),(0,n.useEffect)((()=>{let e=t;S&&(e=e.filter((e=>"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(S.toLowerCase())||e.emails.some((e=>e.toLowerCase().includes(S.toLowerCase())))||e.phoneNumbers.some((e=>e.includes(S)))||e.tags.some((e=>e.toLowerCase().includes(S.toLowerCase())))))),"all"!==E&&(e=e.filter((e=>e.category===E))),"all"!==M&&(e=e.filter((e=>e.tags.includes(M)))),"all"!==W&&(e=e.filter((e=>e.sonnyRole===W))),null!==q&&(e=e.filter((e=>e.isHouseholdMember===q))),null!==X&&(e=e.filter((e=>e.isFamilyMember===X))),"asc"===be?e=[...e].sort(((e,t)=>{const s="".concat(e.firstName," ").concat(e.lastName).toLowerCase(),a="".concat(t.firstName," ").concat(t.lastName).toLowerCase();return s.localeCompare(a)})):"desc"===be&&(e=[...e].sort(((e,t)=>{const s="".concat(e.firstName," ").concat(e.lastName).toLowerCase();return"".concat(t.firstName," ").concat(t.lastName).toLowerCase().localeCompare(s)}))),k(e),fe(1)}),[t,S,E,M,W,q,X,be]);const Te=async t=>{if(confirm("Are you sure you want to delete this contact? You can restore it within 30 days from the Recycle Bin.")&&e)try{await I.Z.deleteContact(t,e.id),s((e=>e.filter((e=>e.id!==t))))}catch(a){alert("Failed to delete contact. Please try again.")}},Le=async a=>{if(e)try{const n=[],r=[];for(const e of a){const s=et.findDuplicates(e,t);s.length>0?n.push(...s):r.push(e)}if(n.length>0)return ee(n[0]),se(!0),sessionStorage.setItem("pendingImports",JSON.stringify(r)),void r.length;if(0===r.length)return alert("No new contacts to import. All contacts appear to be duplicates."),void P(!1);const l=r.map((t=>{const s={...t,firstName:t.firstName||"Unknown",lastName:t.lastName||"",addedBy:e.id,addresses:(t.addresses||[]).filter((e=>e&&e.trim())),phoneNumbers:(t.phoneNumbers||[]).filter((e=>e&&e.trim())),emails:(t.emails||[]).filter((e=>e&&e.trim())),tags:t.tags||[],notes:t.notes||"",category:t.category||"other"},{id:a,...n}=s;return n})),i=await I.Z.addContactsBatch(l),o=await I.Z.getUserContacts(e.id);r.map(((t,s)=>({...t,id:i[s],addedBy:e.id,createdAt:new Date,updatedAt:new Date})));s(o),P(!1),R(!1);const c="\u2705 Import Complete\n\n".concat(r.length," new contacts added\n").concat(n.length," duplicates detected\n\nAll contacts have been saved to your Firestore database.");alert(c)}catch(n){let e="Failed to import contacts. Please try again.";n instanceof Error&&(e+="\n\nError details: ".concat(n.message)),alert(e)}else alert("Error: User not authenticated. Please log in again.")},De=Array.from(new Set(t.flatMap((e=>e.tags))));return V?(0,a.jsx)(w.Z,{title:"Contacts",children:(0,a.jsx)("div",{className:"min-h-screen bg-ubuntu-warm-50 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)(l.Z,{className:"w-12 h-12 text-ubuntu-gold mx-auto mb-4 animate-pulse"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-700",children:"Loading contacts..."})]})})}):(0,a.jsx)(w.Z,{title:"Family Contacts",children:(0,a.jsxs)("div",{className:"min-h-screen bg-ubuntu-warm-50",children:[(0,a.jsx)("div",{className:"bg-white shadow-sm border-b border-ubuntu-warm-200",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-ubuntu font-bold text-ubuntu-warm-900",children:"Family Contacts"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600 mt-1",children:"Manage your family and business contacts in one place"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,a.jsxs)("button",{onClick:()=>U(!0),className:"inline-flex items-center px-4 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors",title:"Presence & Privacy Settings",children:[(0,a.jsx)(i.Z,{className:"w-4 h-4 mr-2"}),"Privacy"]}),(0,a.jsxs)("button",{onClick:()=>Ae(!0),className:"inline-flex items-center px-4 py-2 border border-orange-300 rounded-lg text-orange-700 hover:bg-orange-50 transition-colors font-medium",title:"Review and clean database - remove false entries, duplicates, and organize by category",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Clean Database"]}),(0,a.jsxs)("button",{onClick:()=>P(!0),className:"inline-flex items-center px-4 py-2 border-2 border-indigo-300 rounded-lg text-indigo-700 hover:bg-indigo-50 transition-colors font-medium",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"Import from Family Tree"]}),(0,a.jsxs)("button",{onClick:()=>R(!0),className:"inline-flex items-center px-4 py-2 border border-ubuntu-warm-300 rounded-lg text-ubuntu-warm-700 hover:bg-ubuntu-warm-50 transition-colors",children:[(0,a.jsx)(c.Z,{className:"w-4 h-4 mr-2"}),"Import/Export"]}),(0,a.jsxs)("button",{onClick:()=>de(!0),className:"inline-flex items-center px-4 py-2 border border-purple-300 rounded-lg text-purple-700 hover:bg-purple-50 transition-colors",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Backup/Restore"]}),(0,a.jsxs)("button",{onClick:()=>ge(!0),className:"inline-flex items-center px-4 py-2 border border-red-300 rounded-lg text-red-700 hover:bg-red-50 transition-colors",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Recycle Bin"]}),(0,a.jsxs)("button",{onClick:()=>L(!0),className:"inline-flex items-center px-6 py-2 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-gold/90 transition-colors",children:[(0,a.jsx)(u.Z,{className:"w-4 h-4 mr-2"}),"Add Contact"]})]})]}),(0,a.jsxs)("div",{className:"mt-4 flex items-center gap-2 border-t border-ubuntu-warm-200 pt-4",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-ubuntu-warm-700",children:"View:"}),(0,a.jsx)("button",{onClick:()=>ve("grid"),className:"p-2 rounded-lg transition-colors ".concat("grid"===je?"bg-ubuntu-gold text-white":"bg-ubuntu-warm-100 text-ubuntu-warm-700 hover:bg-ubuntu-warm-200"),title:"Grid View",children:(0,a.jsx)(m.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{ve("list"),fe(1)},className:"p-2 rounded-lg transition-colors ".concat("list"===je?"bg-ubuntu-gold text-white":"bg-ubuntu-warm-100 text-ubuntu-warm-700 hover:bg-ubuntu-warm-200"),title:"List View",children:(0,a.jsx)(x.Z,{className:"w-4 h-4"})}),(0,a.jsx)("button",{onClick:()=>{ve("table"),fe(1)},className:"p-2 rounded-lg transition-colors ".concat("table"===je?"bg-ubuntu-gold text-white":"bg-ubuntu-warm-100 text-ubuntu-warm-700 hover:bg-ubuntu-warm-200"),title:"Table View",children:(0,a.jsx)(h.Z,{className:"w-4 h-4"})})]})]})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-ubuntu-warm-200 mb-8",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(g.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-ubuntu-warm-400"}),(0,a.jsx)(O.Pg,{label:"Search contacts",type:"text",placeholder:"Search contacts...",value:S,onChange:e=>Z(e.target.value),className:"pl-10"})]}),(0,a.jsx)(O.SB,{label:"Filter by category",value:E,onChange:e=>A(e.target.value),options:[{id:"all",name:"All Categories",color:"bg-gray-100 text-gray-700"},{id:"family",name:"Family",color:"bg-blue-100 text-blue-700"},{id:"friend",name:"Friends",color:"bg-green-100 text-green-700"},{id:"business",name:"Business",color:"bg-yellow-100 text-yellow-700"},{id:"professional",name:"Professional",color:"bg-purple-100 text-purple-700"},{id:"service",name:"Services",color:"bg-red-100 text-red-700"}].map((e=>({value:e.id,label:e.name})))}),(0,a.jsx)(O.SB,{label:"Filter by tag",value:M,onChange:e=>F(e.target.value),options:[{value:"all",label:"All Tags"},...De.map((e=>({value:e,label:e})))]}),(0,a.jsx)(O.SB,{label:"Sort contacts",value:be,onChange:e=>pe(e.target.value),options:[{value:"default",label:"Default (Newest)"},{value:"asc",label:"A-Z (A to Z)"},{value:"desc",label:"Z-A (Z to A)"}]}),(0,a.jsxs)("div",{className:"flex items-center text-ubuntu-warm-600",children:[(0,a.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),C.length," contact",1!==C.length?"s":""]})]}),(0,a.jsxs)("div",{className:"mt-4 pt-4 border-t border-ubuntu-warm-200",children:[(0,a.jsxs)("h4",{className:"text-sm font-semibold text-ubuntu-warm-700 mb-3 flex items-center",children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 mr-2 text-indigo-600"}),"Sonny Network Filters"]}),(0,a.jsxs)("div",{className:"flex flex-wrap gap-2",children:[(0,a.jsxs)("button",{onClick:()=>K(!0!==q||null),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat(!0===q?"bg-orange-100 text-orange-700 border-2 border-orange-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:[(0,a.jsx)(p.Z,{className:"w-4 h-4 mr-1.5"}),"Household Only",t.filter((e=>e.isHouseholdMember)).length>0&&(0,a.jsx)("span",{className:"ml-1.5 px-1.5 py-0.5 bg-white rounded text-xs",children:t.filter((e=>e.isHouseholdMember)).length})]}),(0,a.jsxs)("button",{onClick:()=>Q(!0!==X||null),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat(!0===X?"bg-indigo-100 text-indigo-700 border-2 border-indigo-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:[(0,a.jsx)(y.Z,{className:"w-4 h-4 mr-1.5"}),"Family Members",t.filter((e=>e.isFamilyMember)).length>0&&(0,a.jsx)("span",{className:"ml-1.5 px-1.5 py-0.5 bg-white rounded text-xs",children:t.filter((e=>e.isFamilyMember)).length})]}),["monitor","monitored","both"].map((e=>(0,a.jsxs)("button",{onClick:()=>Y(W===e?"all":e),className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium transition-colors ".concat(W===e?"bg-purple-100 text-purple-700 border-2 border-purple-300":"bg-gray-100 text-gray-700 border border-gray-300 hover:bg-gray-200"),children:[(0,a.jsx)(b.Z,{className:"w-4 h-4 mr-1.5"}),"monitor"===e&&"I Monitor","monitored"===e&&"They Monitor","both"===e&&"Mutual",t.filter((t=>t.sonnyRole===e)).length>0&&(0,a.jsx)("span",{className:"ml-1.5 px-1.5 py-0.5 bg-white rounded text-xs",children:t.filter((t=>t.sonnyRole===e)).length})]},e))),(null!==q||null!==X||"all"!==W)&&(0,a.jsxs)("button",{onClick:()=>{K(null),Q(null),Y("all")},className:"inline-flex items-center px-3 py-1.5 rounded-lg text-sm font-medium bg-red-50 text-red-700 border border-red-200 hover:bg-red-100 transition-colors",children:[(0,a.jsx)(f.Z,{className:"w-4 h-4 mr-1.5"}),"Clear Filters"]})]})]})]}),we.size>0&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"bg-white rounded-xl p-4 shadow-lg border-l-4 border-ubuntu-gold mb-6",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("div",{className:"flex items-center gap-4",children:(0,a.jsxs)("div",{className:"flex items-center",children:[(0,a.jsx)("input",{type:"checkbox",checked:we.size===C.length,onChange:()=>{we.size===C.length?Ce(new Set):Ce(new Set(C.map((e=>e.id))))},className:"w-5 h-5 rounded border-gray-300 text-ubuntu-gold cursor-pointer"}),(0,a.jsxs)("span",{className:"ml-3 font-medium text-ubuntu-warm-900",children:[we.size," contact",1!==we.size?"s":""," selected"]})]})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)("button",{onClick:()=>{if(0===we.size)return;const e=prompt("Enter tag name to add to selected contacts:");if(e)try{const a=t.map((t=>{if(we.has(t.id)){const s={...t,tags:Array.from(new Set([...t.tags,e]))};return I.Z.updateContact(t.id,s).catch((e=>console.error("Error updating contact tags:",e))),s}return t}));s(a),Ce(new Set),alert('\u2705 Added tag "'.concat(e,'" to ').concat(we.size," contacts"))}catch(a){alert("Failed to add tags. Please try again.")}},className:"inline-flex items-center px-4 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors font-medium",title:"Add tag to selected contacts",children:[(0,a.jsx)(N.Z,{className:"w-4 h-4 mr-2"}),"Add Tag"]}),(0,a.jsxs)("button",{onClick:()=>{if(0!==we.size)try{const e=C.filter((e=>we.has(e.id))),t=["First Name","Last Name","Email","Phone","Address","Category","Tags","Notes"],s=e.map((e=>{var t,s,a,n;return[e.firstName,e.lastName,e.emails.join(";"),e.phoneNumbers.join(";"),"".concat((null===(t=e.address)||void 0===t?void 0:t.street)||""," ").concat((null===(s=e.address)||void 0===s?void 0:s.city)||""," ").concat((null===(a=e.address)||void 0===a?void 0:a.state)||""," ").concat((null===(n=e.address)||void 0===n?void 0:n.zip)||"").trim(),e.category,e.tags.join(";"),e.notes||""]})),a=[t.join(","),...s.map((e=>e.map((e=>'"'.concat(e.toString().replace(/"/g,'""'),'"'))).join(",")))].join("\n"),n=new Blob([a],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a"),l=URL.createObjectURL(n);r.setAttribute("href",l),r.setAttribute("download","contacts-export-".concat((new Date).toISOString().split("T")[0],".csv")),r.style.visibility="hidden",document.body.appendChild(r),r.click(),document.body.removeChild(r),alert("\u2705 Exported ".concat(we.size," contacts to CSV")),Ce(new Set)}catch(e){alert("Failed to export contacts. Please try again.")}else alert("Please select at least one contact to export")},className:"inline-flex items-center px-4 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors font-medium",title:"Export selected contacts as CSV",children:[(0,a.jsx)(d.Z,{className:"w-4 h-4 mr-2"}),"Export CSV"]}),(0,a.jsxs)("button",{onClick:()=>Se(!0),className:"inline-flex items-center px-4 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors font-medium",title:"Delete selected contacts",children:[(0,a.jsx)(o.Z,{className:"w-4 h-4 mr-2"}),"Delete Selected"]}),(0,a.jsx)("button",{onClick:()=>Ce(new Set),className:"inline-flex items-center px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors",title:"Deselect all",children:(0,a.jsx)(f.Z,{className:"w-4 h-4"})})]})]}),ke&&(0,a.jsxs)(r.E.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg",children:[(0,a.jsxs)("p",{className:"text-red-800 font-medium mb-3",children:["Are you sure you want to delete ",we.size," contact",1!==we.size?"s":"","? This action cannot be undone."]}),(0,a.jsxs)("div",{className:"flex gap-3",children:[(0,a.jsx)("button",{onClick:async()=>{if(0!==we.size&&e&&confirm("Are you sure you want to delete ".concat(we.size," contacts? They can be restored within 30 days from the Recycle Bin.")))try{for(const t of we)await I.Z.deleteContact(t,e.id);s((e=>e.filter((e=>!we.has(e.id))))),Ce(new Set),Se(!1),alert("\u2705 Successfully deleted ".concat(we.size," contacts. You can restore them from the Recycle Bin."))}catch(t){alert("Failed to delete some contacts. Please try again.")}},className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors font-medium",children:"Yes, Delete Permanently"}),(0,a.jsx)("button",{onClick:()=>Se(!1),className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300 transition-colors font-medium",children:"Cancel"})]})]})]}),0===C.length?(0,a.jsxs)("div",{className:"text-center py-12",children:[(0,a.jsx)(l.Z,{className:"w-16 h-16 text-ubuntu-warm-300 mx-auto mb-4"}),(0,a.jsx)("h3",{className:"text-xl font-ubuntu font-semibold text-ubuntu-warm-900 mb-2",children:"No contacts found"}),(0,a.jsx)("p",{className:"text-ubuntu-warm-600 mb-6",children:S||"all"!==E||"all"!==M?"Try adjusting your search or filters":"Start building your contact network"}),!S&&"all"===E&&"all"===M&&(0,a.jsxs)("button",{onClick:()=>L(!0),className:"inline-flex items-center px-6 py-3 bg-ubuntu-gold text-white rounded-lg hover:bg-ubuntu-gold/90 transition-colors",children:[(0,a.jsx)(j.Z,{className:"w-5 h-5 mr-2"}),"Add Your First Contact"]})]}):(0,a.jsxs)("div",{children:["grid"===je?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:C.slice((ye-1)*Ne,ye*Ne).map((s=>(0,a.jsx)(ue,{contact:s,onEdit:()=>H(s),onDelete:()=>Te(s.id),onViewDetails:()=>(e=>{oe(e)})(s),currentUserId:(null===e||void 0===e?void 0:e.id)||"",allContacts:t,isSelected:we.has(s.id),onSelectChange:e=>{Ce(e?e=>new Set([...e,s.id]):e=>{const t=new Set(e);return t.delete(s.id),t})},onContactClick:e=>{Z(""),A("all"),F("all"),fe(1),H(e)}},s.id)))})}):"list"===je?(0,a.jsx)(xe,{contacts:C.slice((ye-1)*Ne,ye*Ne),onEdit:e=>H(e),onDelete:e=>Te(e),currentUserId:(null===e||void 0===e?void 0:e.id)||"",isSelected:e=>we.has(e),onSelect:(e,t)=>{Ce(t?t=>new Set([...t,e]):t=>{const s=new Set(t);return s.delete(e),s})}}):(0,a.jsx)(he,{contacts:C.slice((ye-1)*Ne,ye*Ne),onEdit:e=>H(e),onDelete:e=>Te(e),currentUserId:(null===e||void 0===e?void 0:e.id)||"",isSelected:e=>we.has(e),onSelect:(e,t)=>{Ce(t?t=>new Set([...t,e]):t=>{const s=new Set(t);return s.delete(e),s})}}),C.length>Ne&&(0,a.jsxs)("div",{className:"mt-8 flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-ubuntu-warm-200",children:[(0,a.jsxs)("div",{className:"text-sm text-ubuntu-warm-600",children:["Showing ",(ye-1)*Ne+1," to"," ",Math.min(ye*Ne,C.length)," of"," ",C.length," contacts"]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("button",{onClick:()=>fe(Math.max(1,ye-1)),disabled:1===ye,className:"px-4 py-2 rounded-lg border border-ubuntu-warm-200 text-ubuntu-warm-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-ubuntu-warm-50",children:"Previous"}),(0,a.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.ceil(C.length/Ne)},((e,t)=>t+1)).map((e=>(0,a.jsx)("button",{onClick:()=>fe(e),className:"w-8 h-8 rounded-lg font-medium transition-colors ".concat(ye===e?"bg-ubuntu-gold text-white":"border border-ubuntu-warm-200 text-ubuntu-warm-700 hover:bg-ubuntu-warm-50"),children:e},e)))}),(0,a.jsx)("button",{onClick:()=>fe(Math.min(Math.ceil(C.length/Ne),ye+1)),disabled:ye===Math.ceil(C.length/Ne),className:"px-4 py-2 rounded-lg border border-ubuntu-warm-200 text-ubuntu-warm-700 disabled:opacity-50 disabled:cursor-not-allowed hover:bg-ubuntu-warm-50",children:"Next"})]})]})]})]}),(T||_)&&(0,a.jsx)(Ze,{contact:_,onSave:_?async e=>{if(_)try{await I.Z.updateContact(_.id,e);const t={..._,...e,updatedAt:new Date};s((e=>e.map((e=>e.id===_.id?t:e)))),H(null)}catch(t){alert("Failed to update contact. Please try again.")}}:async t=>{if(e)try{const a=await I.Z.addContact({...t,addedBy:e.id}),n={...t,id:a,addedBy:e.id,createdAt:new Date,updatedAt:new Date};s((e=>[...e,n])),L(!1)}catch(a){alert("Failed to add contact. Please try again.")}},onCancel:()=>{L(!1),H(null)}}),D&&(0,a.jsx)(Re,{contacts:t,onImport:e=>Le(e),onClose:()=>R(!1)}),B&&(0,a.jsx)(Oe,{existingContacts:t,onImport:Le,onClose:()=>P(!1),currentUserId:(null===e||void 0===e?void 0:e.id)||""}),z&&(0,a.jsx)(ze,{isOpen:z,onClose:()=>U(!1)}),ie&&(0,a.jsx)(Ge,{contact:ie,onClose:()=>oe(null),onEdit:()=>{H(ie),oe(null)},allContacts:t,currentUserId:(null===e||void 0===e?void 0:e.id)||""}),ce&&(0,a.jsx)(r.E.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},onClick:()=>de(!1),className:"fixed inset-0 bg-black/50 z-50 flex items-center justify-center p-4",children:(0,a.jsxs)(r.E.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},onClick:e=>e.stopPropagation(),className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[(0,a.jsxs)("div",{className:"sticky top-0 bg-gradient-to-r from-purple-50 to-purple-100 px-6 py-6 border-b border-purple-200 flex items-center justify-between z-10",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold text-purple-900 flex items-center gap-2",children:[(0,a.jsx)(d.Z,{className:"w-6 h-6"}),"Backup & Restore"]}),(0,a.jsx)("button",{onClick:()=>de(!1),className:"p-1 hover:bg-purple-200 rounded-lg transition-colors",children:(0,a.jsx)(f.Z,{className:"w-6 h-6 text-purple-900"})})]}),(0,a.jsx)("div",{className:"p-6",children:(0,a.jsx)(Ye,{contacts:t,onRestore:async t=>{try{for(const s of t){const t={...s,id:void 0,userId:(null===e||void 0===e?void 0:e.id)||""};await I.Z.addContact(t)}const a=await I.Z.getUserContacts((null===e||void 0===e?void 0:e.id)||"");s(a)}catch(a){throw a}},currentUserId:(null===e||void 0===e?void 0:e.id)||""})})]})}),e&&(0,a.jsx)(Ke,{userId:e.id,isOpen:me,onClose:()=>ge(!1),onContactRestored:e=>{s((t=>[...t,e]))}}),(0,a.jsx)($e,{isOpen:Ee,onClose:()=>Ae(!1),contacts:t,onCleanupComplete:t=>{e&&I.Z.getUserContacts(e.id).then((e=>{s(e),Fe({kept:e.length,deleted:t})}))}})]})})}}},function(e){e.O(0,[1255,4179,2023,6545,8264,2257,2888,9774,179],(function(){return t=24069,e(e.s=t);var t}));var t=e.O();_N_E=t}]);