(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5296],{71871:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/intranet/family",function(){return s(37713)}])},23488:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Award",[["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}],["path",{d:"M15.477 12.89 17 22l-5-3-5 3 1.523-9.11",key:"em7aur"}]])},12779:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},71601:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]])},60641:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},82606:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Loader",[["line",{x1:"12",x2:"12",y1:"2",y2:"6",key:"gza1u7"}],["line",{x1:"12",x2:"12",y1:"18",y2:"22",key:"1qhbu9"}],["line",{x1:"4.93",x2:"7.76",y1:"4.93",y2:"7.76",key:"xae44r"}],["line",{x1:"16.24",x2:"19.07",y1:"16.24",y2:"19.07",key:"bxnmvf"}],["line",{x1:"2",x2:"6",y1:"12",y2:"12",key:"89khin"}],["line",{x1:"18",x2:"22",y1:"12",y2:"12",key:"pb8tfm"}],["line",{x1:"4.93",x2:"7.76",y1:"19.07",y2:"16.24",key:"1uxjnu"}],["line",{x1:"16.24",x2:"19.07",y1:"7.76",y2:"4.93",key:"6duxfx"}]])},86691:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},3350:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]])},96815:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]])},21700:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]])},4270:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]])},69819:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]])},36127:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]])},70088:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]])},90437:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]])},43283:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});const a=(0,s(63759).Z)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]])},37920:function(e,t,s){"use strict";s.d(t,{M:function(){return d}});var a=s(85893),i=(s(67294),s(63759));const n=(0,i.Z)("Printer",[["polyline",{points:"6 9 6 2 18 2 18 9",key:"1306q4"}],["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["rect",{width:"12",height:"8",x:"6",y:"14",key:"5ipwut"}]]);var r=s(12779),l=s(43283);const c=(0,i.Z)("FileJson",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]]);var o=s(86501);const d=e=>{let{data:t,filename:s,title:i,onImport:d,printView:m}=e;return(0,a.jsxs)("div",{className:"flex flex-wrap gap-3 no-print",children:[(0,a.jsxs)("button",{onClick:()=>{window.print(),o.Am.success("Opening print dialog...")},className:"flex items-center gap-2 px-4 py-2 bg-white border-2 border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 hover:border-gray-400 transition-colors font-medium",title:"Print this page",children:[(0,a.jsx)(n,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Print"})]}),(0,a.jsxs)("button",{onClick:()=>{try{const e=JSON.stringify(t,null,2),a=new Blob([e],{type:"application/json"}),i=URL.createObjectURL(a),n=document.createElement("a");n.href=i,n.download="".concat(s,"_").concat((new Date).toISOString().split("T")[0],".json"),document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i),o.Am.success("JSON file downloaded successfully!")}catch(e){o.Am.error("Failed to export JSON file")}},className:"flex items-center gap-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors font-medium",title:"Download as JSON",children:[(0,a.jsx)(r.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Export JSON"})]}),d&&(0,a.jsxs)("button",{onClick:()=>{const e=document.createElement("input");e.type="file",e.accept=".json,application/json",e.onchange=async e=>{var t;const s=null===(t=e.target.files)||void 0===t?void 0:t[0];if(s)try{const e=await s.text(),t=JSON.parse(e);d?(d(t),o.Am.success("Data imported successfully!")):o.Am.error("Import functionality not implemented")}catch(a){o.Am.error("Failed to import JSON file. Please check the file format.")}},e.click()},className:"flex items-center gap-2 px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium",title:"Import from JSON",children:[(0,a.jsx)(l.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Import JSON"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,a.jsx)(c,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"JSON format for easy sharing & backup"})]})]})}},37713:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return E}});var a=s(85893),i=s(67294),n=s(35047),r=s(12023),l=s(82606),c=s(43765),o=s(89176),d=s(4270),m=s(36127),u=s(23488),x=s(71601),h=s(90437),p=s(70088),y=s(96815),b=s(23346),v=s(3350),g=s(86691),f=s(21700),j=s(60837),N=s(62190),w=s(60641),k=s(69819),C=s(72577);var Z=e=>{let{member:t,isOpen:s,onClose:n,onSave:r}=e;const{user:l}=(0,j.a)(),[c,o]=(0,i.useState)(!1),[d,m]=(0,i.useState)({bio:t.bio,phone:t.phone,location:t.location,responsibilities:[...t.responsibilities],achievements:[...t.achievements],specializations:[...t.specializations]});(0,i.useEffect)((()=>{m({bio:t.bio,phone:t.phone,location:t.location,responsibilities:[...t.responsibilities],achievements:[...t.achievements],specializations:[...t.specializations]})}),[t]);const u=(e,t)=>{t.trim()&&!d[e].includes(t.trim())&&m((s=>({...s,[e]:[...s[e],t.trim()]})))},x=(e,t)=>{m((s=>({...s,[e]:s[e].filter(((e,s)=>s!==t))})))};return(null===l||void 0===l?void 0:l.email)!==t.email&&"spiceinc@gmail.com"!==(null===l||void 0===l?void 0:l.email)?null:(0,a.jsx)(C.uj,{isOpen:s,onClose:n,title:"Edit Profile - ".concat(t.name),size:"xl",children:(0,a.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o(!0);try{await r(d),n()}catch(t){}finally{o(!1)}},className:"space-y-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bio"}),(0,a.jsx)("textarea",{value:d.bio,onChange:e=>m((t=>({...t,bio:e.target.value}))),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent resize-none",placeholder:"Tell us about yourself..."})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(f.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"tel",value:d.phone,onChange:e=>m((t=>({...t,phone:e.target.value}))),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"+27 XX XXX XXXX"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(v.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",value:d.location,onChange:e=>m((t=>({...t,location:e.target.value}))),className:"w-full pl-10 pr-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",placeholder:"City, Country"})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Key Responsibilities"}),(0,a.jsxs)("div",{className:"space-y-2",children:[d.responsibilities.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{const s=[...d.responsibilities];s[t]=e.target.value,m((e=>({...e,responsibilities:s})))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,a.jsx)("button",{type:"button",onClick:()=>x("responsibilities",t),className:"p-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(N.Z,{className:"h-4 w-4"})})]},t))),(0,a.jsx)("button",{type:"button",onClick:()=>u("responsibilities",""),className:"flex items-center space-x-2 px-3 py-2 text-primary-600 hover:text-primary-700 transition-colors",children:(0,a.jsx)("span",{className:"text-sm",children:"+ Add responsibility"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Recent Achievements"}),(0,a.jsxs)("div",{className:"space-y-2",children:[d.achievements.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{const s=[...d.achievements];s[t]=e.target.value,m((e=>({...e,achievements:s})))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,a.jsx)("button",{type:"button",onClick:()=>x("achievements",t),className:"p-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(N.Z,{className:"h-4 w-4"})})]},t))),(0,a.jsx)("button",{type:"button",onClick:()=>u("achievements",""),className:"flex items-center space-x-2 px-3 py-2 text-primary-600 hover:text-primary-700 transition-colors",children:(0,a.jsx)("span",{className:"text-sm",children:"+ Add achievement"})})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Specializations"}),(0,a.jsxs)("div",{className:"space-y-2",children:[d.specializations.map(((e,t)=>(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("input",{type:"text",value:e,onChange:e=>{const s=[...d.specializations];s[t]=e.target.value,m((e=>({...e,specializations:s})))},className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"}),(0,a.jsx)("button",{type:"button",onClick:()=>x("specializations",t),className:"p-2 text-red-500 hover:text-red-700 transition-colors",children:(0,a.jsx)(N.Z,{className:"h-4 w-4"})})]},t))),(0,a.jsx)("button",{type:"button",onClick:()=>u("specializations",""),className:"flex items-center space-x-2 px-3 py-2 text-primary-600 hover:text-primary-700 transition-colors",children:(0,a.jsx)("span",{className:"text-sm",children:"+ Add specialization"})})]})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 border-t border-gray-200",children:[(0,a.jsx)("button",{type:"button",onClick:n,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",disabled:c,children:"Cancel"}),(0,a.jsx)("button",{type:"submit",className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white hover:bg-primary-700 rounded-lg transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:c,children:c?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(w.Z,{className:"h-4 w-4 animate-spin"}),(0,a.jsx)("span",{children:"Saving..."})]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Save Changes"})]})})]})]})})},I=s(37920),S=s(32257);var M=s(99724),L=s(97042);const A=new class{async initialize(e){if(!this.isInitialized||this.userId!==e){this.userId=e;try{this.setupContactsListener(),this.setupRelationshipsListener(),this.isInitialized=!0}catch(t){throw t}}}setupContactsListener(){if(this.contactUnsubscribe&&this.contactUnsubscribe(),this.userId)try{const e=(0,M.hJ)(L.db,"contacts"),t=(0,M.IO)(e,(0,M.ar)("addedBy","==",this.userId));this.contactUnsubscribe=(0,M.cf)(t,(e=>{e.docChanges().forEach((e=>{var t,s,a;const i={id:e.doc.id,...e.doc.data(),createdAt:(null===(t=e.doc.data().createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(s=e.doc.data().updatedAt)||void 0===s?void 0:s.toDate())||new Date,lastSeen:null===(a=e.doc.data().lastSeen)||void 0===a?void 0:a.toDate()};let n;n="added"===e.type?"contact_added":"modified"===e.type?"contact_updated":"contact_deleted",this.broadcastEvent({type:n,timestamp:new Date,userId:this.userId||void 0,data:{contact:i}})}))}),(e=>{}))}catch(e){}}setupRelationshipsListener(){if(this.relationshipUnsubscribe&&this.relationshipUnsubscribe(),this.userId)try{const e=(0,M.hJ)(L.db,"contact_relationships");this.relationshipUnsubscribe=(0,M.cf)(e,(e=>{e.docChanges().forEach((e=>{var t,s;const a={id:e.doc.id,...e.doc.data(),createdAt:(null===(t=e.doc.data().createdAt)||void 0===t?void 0:t.toDate())||new Date,updatedAt:(null===(s=e.doc.data().updatedAt)||void 0===s?void 0:s.toDate())||new Date};let i;i="added"===e.type?"relationship_added":"modified"===e.type?"relationship_updated":"relationship_deleted",this.broadcastEvent({type:i,timestamp:new Date,userId:this.userId||void 0,data:{relationship:a,affectedContactIds:[a.contactId,a.relatedContactId]}})}))}),(e=>{}))}catch(e){}}subscribe(e,t){const s="listener_".concat(this.nextListenerId++);return this.listeners.set(s,{id:s,callback:e,eventTypes:t}),s}unsubscribe(e){const t=this.listeners.get(e);(null===t||void 0===t?void 0:t.unsubscribe)&&t.unsubscribe(),this.listeners.delete(e)}unsubscribeAll(){this.listeners.forEach((e=>{e.unsubscribe&&e.unsubscribe()})),this.listeners.clear()}broadcastEvent(e){this.listeners.forEach((t=>{if(!t.eventTypes||t.eventTypes.includes(e.type))try{t.callback(e)}catch(s){}}))}broadcastContactUpdate(e){this.broadcastEvent({type:"contact_updated",timestamp:new Date,userId:this.userId||void 0,data:{contact:e}})}broadcastRelationshipChange(e){this.broadcastEvent({type:"relationship_updated",timestamp:new Date,userId:this.userId||void 0,data:{relationship:e,affectedContactIds:[e.contactId,e.relatedContactId]}})}broadcastBatchUpdate(e,t){const s=new Set;e.forEach((e=>s.add(e.id))),t.forEach((e=>{s.add(e.contactId),s.add(e.relatedContactId)})),this.broadcastEvent({type:"batch_update",timestamp:new Date,userId:this.userId||void 0,data:{contacts:e,relationships:t,affectedContactIds:Array.from(s)}})}getListenerCount(){return this.listeners.size}getInitialized(){return this.isInitialized}cleanup(){this.contactUnsubscribe&&(this.contactUnsubscribe(),this.contactUnsubscribe=null),this.relationshipUnsubscribe&&(this.relationshipUnsubscribe(),this.relationshipUnsubscribe=null),this.unsubscribeAll(),this.isInitialized=!1,this.userId=null}constructor(){this.listeners=new Map,this.contactUnsubscribe=null,this.relationshipUnsubscribe=null,this.nextListenerId=0,this.isInitialized=!1,this.userId=null}};const z=()=>{const{user:e}=(0,j.a)(),[t,s]=(0,i.useState)(!1),[a,n]=(0,i.useState)(0);(0,i.useEffect)((()=>((null===e||void 0===e?void 0:e.id)&&A.initialize(e.id).then((()=>{s(!0)})).catch((e=>{})),()=>{A.cleanup(),s(!1)})),[null===e||void 0===e?void 0:e.id]);return{addListener:(0,i.useCallback)(((e,t)=>{const s=A.subscribe(e,t);return n((e=>e+1)),s}),[]),removeListener:(0,i.useCallback)((e=>{A.unsubscribe(e),n((e=>Math.max(0,e-1)))}),[]),initialized:t,listenerCount:a,broadcastContactUpdate:(0,i.useCallback)((e=>{A.broadcastContactUpdate(e)}),[]),broadcastRelationshipChange:(0,i.useCallback)((e=>{A.broadcastRelationshipChange(e)}),[]),broadcastBatchUpdate:(0,i.useCallback)(((e,t)=>{A.broadcastBatchUpdate(e,t)}),[])}};var E=()=>{const{user:e}=(0,j.a)(),{members:t,loading:s,error:N,updateMember:w}=(()=>{const{user:e}=(0,j.a)(),[t,s]=(0,i.useState)([]),[a,n]=(0,i.useState)(!0),[r,l]=(0,i.useState)(null),c=(0,i.useCallback)((async()=>{if(null===e||void 0===e?void 0:e.id)try{n(!0);const t=await S.V.getFamilyMembers(e.id);s(t),l(null)}catch(t){l(t instanceof Error?t.message:"Failed to load family members")}finally{n(!1)}else n(!1)}),[null===e||void 0===e?void 0:e.id]);(0,i.useEffect)((()=>{c()}),[c]);const o=(0,i.useCallback)((async(e,t)=>{try{await S.V.updateContact(e,t),await c()}catch(s){throw s}}),[c]),d=(0,i.useCallback)((async e=>{try{return await S.V.getRelatedContacts(e)}catch(t){return[]}}),[]),m=(0,i.useCallback)((async(e,t)=>{try{return await S.V.getRelationshipsByType(e,t)}catch(s){return[]}}),[]);return{members:t,loading:a,error:r,refresh:c,updateMember:o,getRelatedMembers:d,getMembersByRelationship:m}})(),{addListener:k,removeListener:C}=z(),[M,L]=(0,i.useState)(null),[A,E]=(0,i.useState)("all"),[D,_]=(0,i.useState)(""),[U,O]=(0,i.useState)(null),[R,P]=(0,i.useState)([]);if((0,i.useEffect)((()=>{if((null===t||void 0===t?void 0:t.length)>0){const e=t.map((e=>{var t,s,a;return{...e,role:(null===(t=e.tags)||void 0===t?void 0:t.join(", "))||"Family Member",level:5,experiencePoints:1e3,responsibilities:[],achievements:[],careerPath:"Family",specializations:e.tags||[],trustRating:85,joinDate:null===(a=e.createdAt)||void 0===a||null===(s=a.toISOString())||void 0===s?void 0:s.split("T")[0]}}));P(e)}}),[t]),(0,i.useEffect)((()=>{const e=k((e=>{var t,s,a;"contact_updated"===e.type&&(null===(t=e.data)||void 0===t?void 0:t.contact)?P((t=>t.map((t=>{var s;return t.id===(null===(s=e.data.contact)||void 0===s?void 0:s.id)?{...t,...e.data.contact}:t})))):"contact_added"===e.type&&(null===(s=e.data)||void 0===s?void 0:s.contact)?P((t=>[...t,e.data.contact])):"contact_deleted"===e.type&&(null===(a=e.data)||void 0===a?void 0:a.contact)&&P((t=>t.filter((t=>{var s;return t.id!==(null===(s=e.data.contact)||void 0===s?void 0:s.id)}))))}));return()=>C(e)}),[k,C]),s)return(0,a.jsx)(n.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(l.Z,{className:"w-12 h-12 animate-spin mx-auto text-blue-500"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading family members..."})]})})});if(N)return(0,a.jsx)(n.Z,{children:(0,a.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,a.jsxs)("div",{className:"text-center space-y-4",children:[(0,a.jsx)(c.Z,{className:"w-12 h-12 mx-auto text-red-500"}),(0,a.jsx)("p",{className:"text-red-600 font-semibold",children:"Error loading family members"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:N})]})})});const F=R.filter((e=>{var t,s,a,i;const n="all"===A||(null===(t=e.role)||void 0===t?void 0:t.toLowerCase().includes(A.toLowerCase())),r=(null===(s=e.firstName)||void 0===s?void 0:s.toLowerCase().includes(D.toLowerCase()))||(null===(a=e.lastName)||void 0===a?void 0:a.toLowerCase().includes(D.toLowerCase()))||(null===(i=e.role)||void 0===i?void 0:i.toLowerCase().includes(D.toLowerCase()));return n&&r})),J=t=>{var s;return(null===e||void 0===e?void 0:e.email)===(null===(s=t.emails)||void 0===s?void 0:s[0])||"spiceinc@gmail.com"===(null===e||void 0===e?void 0:e.email)},T=e=>{const t=new Date,s=new Date(e);let a=t.getFullYear()-s.getFullYear();const i=t.getMonth()-s.getMonth();return(i<0||0===i&&t.getDate()<s.getDate())&&a--,a};return(0,a.jsx)(n.Z,{title:"Family Members",children:(0,a.jsxs)("div",{className:"p-6 max-w-7xl mx-auto",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(o.Z,{className:"h-8 w-8 text-primary-600"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Family Members Directory"})]}),(0,a.jsx)("p",{className:"text-gray-600",children:"Mlandeli family leadership, roles, and development tracking"})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,a.jsx)(I.M,{data:{members:R,exportDate:(new Date).toISOString()},filename:"family-members",onImport:e=>{var t;(null===(t=e.members)||void 0===t?void 0:t.length)>0&&P(e.members)}}),(0,a.jsxs)("button",{className:"flex items-center space-x-2 px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:[(0,a.jsx)(d.Z,{className:"h-4 w-4"}),(0,a.jsx)("span",{children:"Add Member"})]})]})]}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[(0,a.jsxs)("div",{className:"flex-1 relative",children:[(0,a.jsx)(m.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,a.jsx)("input",{type:"text",placeholder:"Search family members...",value:D,onChange:e=>_(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),(0,a.jsxs)("select",{value:A,onChange:e=>E(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[(0,a.jsx)("option",{value:"all",children:"All Roles"}),(0,a.jsx)("option",{value:"founder",children:"Founder"}),(0,a.jsx)("option",{value:"lead",children:"Leadership"}),(0,a.jsx)("option",{value:"future",children:"Future Leaders"}),(0,a.jsx)("option",{value:"developing",children:"Developing"})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(o.Z,{className:"h-5 w-5 text-blue-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Total Members"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:R.length})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(u.Z,{className:"h-5 w-5 text-yellow-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Average Level"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:R.length>0?Math.round(R.reduce(((e,t)=>e+(t.level||0)),0)/R.length):0})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(x.Z,{className:"h-5 w-5 text-red-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Trust Rating"})]}),(0,a.jsxs)("div",{className:"text-2xl font-bold text-gray-900",children:[R.length>0?Math.round(R.reduce(((e,t)=>e+(t.trustRating||0)),0)/R.length):0,"%"]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm border border-gray-200",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-3 mb-2",children:[(0,a.jsx)(h.Z,{className:"h-5 w-5 text-green-500"}),(0,a.jsx)("span",{className:"text-sm font-medium text-gray-600",children:"Developing"})]}),(0,a.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:R.filter((e=>"developing"===e.status)).length})]})]})]}),(0,a.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:F.map(((e,t)=>{var s,i,n,l,c,o,d,m,x;return(0,a.jsxs)(r.E.div,{className:"bg-white rounded-xl shadow-sm border border-gray-200 hover:shadow-lg transition-all duration-300 cursor-pointer",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1*t},onClick:()=>L(M===e.id?null:e.id),whileHover:{y:-2},children:[(0,a.jsxs)("div",{className:"p-6 border-b border-gray-100",children:[(0,a.jsxs)("div",{className:"flex items-start space-x-4 mb-4",children:[(0,a.jsx)("div",{className:"w-16 h-16 bg-gradient-to-br from-primary-400 to-primary-600 rounded-full flex items-center justify-center text-white text-xl font-bold",children:null===(s=e.firstName)||void 0===s?void 0:s.substring(0,2)}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("h3",{className:"text-lg font-bold text-gray-900 mb-1",children:e.name||"".concat(e.firstName," ").concat(e.lastName)}),(0,a.jsx)("p",{className:"text-primary-600 font-medium text-sm mb-2",children:e.role}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full border ".concat((x=e.status,{active:"bg-green-100 text-green-800 border-green-200",developing:"bg-blue-100 text-blue-800 border-blue-200",transitioning:"bg-yellow-100 text-yellow-800 border-yellow-200",emeritus:"bg-purple-100 text-purple-800 border-purple-200",deceased:"bg-gray-100 text-gray-800 border-gray-200",unknown:"bg-gray-100 text-gray-800 border-gray-200"}[x]||"bg-gray-100 text-gray-800 border-gray-200")),children:e.status}),(0,a.jsx)(p.Z,{className:"h-3 w-3 ".concat((m=e.trustRating||85,m>=95?"text-green-600":m>=90?"text-blue-600":m>=85?"text-yellow-600":"text-orange-600"))})]})]}),J(e)&&(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),O(e)},className:"p-1 text-primary-600 hover:text-primary-700 transition-colors",children:(0,a.jsx)(y.Z,{className:"h-4 w-4"})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 text-yellow-500"}),(0,a.jsxs)("span",{className:"text-gray-600",children:["Level ",e.level||5]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(h.Z,{className:"h-4 w-4 text-green-500"}),(0,a.jsxs)("span",{className:"text-gray-600",children:[e.experiencePoints||1e3," XP"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(b.Z,{className:"h-4 w-4 text-blue-500"}),(0,a.jsxs)("span",{className:"text-gray-600",children:["Age ",e.dateOfBirth?T(e.dateOfBirth):"N/A"]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 text-purple-500"}),(0,a.jsx)("span",{className:"text-gray-600",children:(null===(i=e.location)||void 0===i?void 0:i.split(",")[0])||"N/A"})]})]})]}),M===e.id&&(0,a.jsxs)(r.E.div,{className:"p-6",initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},children:[e.bio&&(0,a.jsx)("p",{className:"text-gray-600 text-sm mb-6 leading-relaxed",children:e.bio}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Contact Information"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(null===(n=e.emails)||void 0===n?void 0:n[0])&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.emails[0]})]}),(null===(l=e.phoneNumbers)||void 0===l?void 0:l[0])&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.phoneNumbers[0]})]}),e.location&&(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(v.Z,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e.location})]})]})]}),(null===(c=e.responsibilities)||void 0===c?void 0:c.length)>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Responsibilities"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.responsibilities.map(((e,t)=>(0,a.jsx)("span",{className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full",children:e},t)))})]}),(null===(o=e.achievements)||void 0===o?void 0:o.length)>0&&(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Achievements"}),(0,a.jsx)("ul",{className:"space-y-2",children:e.achievements.map(((e,t)=>(0,a.jsxs)("li",{className:"flex items-start space-x-2",children:[(0,a.jsx)(u.Z,{className:"h-4 w-4 text-yellow-500 mt-0.5 flex-shrink-0"}),(0,a.jsx)("span",{className:"text-sm text-gray-600",children:e})]},t)))})]}),(null===(d=e.specializations)||void 0===d?void 0:d.length)>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold text-gray-900 mb-3",children:"Specializations"}),(0,a.jsx)("div",{className:"flex flex-wrap gap-2",children:e.specializations.map(((e,t)=>(0,a.jsx)("span",{className:"px-3 py-1 text-xs bg-green-100 text-green-700 rounded-full",children:e},t)))})]})]})]},e.id)}))}),U&&(0,a.jsx)(Z,{member:U,isOpen:!0,onClose:()=>O(null),onSave:e=>(async e=>{if(U){P((t=>t.map((t=>t.id===U.id?{...t,...e}:t))));try{await w(U.id,e),O(null)}catch(t){}}})(e)})]})})}}},function(e){e.O(0,[4179,2023,5047,2257,2888,9774,179],(function(){return t=71871,e(e.s=t);var t}));var t=e.O();_N_E=t}]);