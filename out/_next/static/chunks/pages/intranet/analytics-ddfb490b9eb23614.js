(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8826],{77914:function(e,t,a){(window.__NEXT_P=window.__NEXT_P||[]).push(["/intranet/analytics",function(){return a(47034)}])},12779:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});const s=(0,a(63759).Z)("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]])},44976:function(e,t,a){"use strict";a.d(t,{Z:function(){return s}});const s=(0,a(63759).Z)("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]])},47034:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return h}});var s=a(85893),i=a(67294),n=a(12023),r=a(60837),o=a(99724),c=a(97042);class l{async trackEvent(e){try{const t=(0,o.JU)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"));await(0,o.pl)(t,{...e,timestamp:o.EK.fromDate(e.timestamp)}),this.cache.clear()}catch(t){}}async getDashboardData(e){const t="dashboard_".concat(e),a=this.cache.get(t);if(a&&Date.now()<a.expiry)return a.data;const{startDate:s,endDate:i}=this.getDateRange(e),[n,r,o,c,l,d,m,u]=await Promise.all([this.calculateParticipationMetrics(s,i),this.calculateCollaborationMetrics(s,i),this.calculateUbuntuMetrics(s,i),this.calculateBusinessImpactMetrics(s,i),this.calculateTemplateUsageMetrics(s,i),this.calculateVideoConferenceMetrics(s,i),this.calculateAIRecommendationMetrics(s,i),this.generateTimeSeriesData(s,i)]),h={familyId:this.familyId,period:e,startDate:s,endDate:i,participation:n,collaboration:r,ubuntu:o,businessImpact:c,templateUsage:l,videoConference:d,aiRecommendations:m,timeSeries:u,generatedAt:new Date};return this.cache.set(t,{data:h,expiry:Date.now()+this.CACHE_DURATION}),h}async calculateParticipationMetrics(e,t){try{var a,s;const i=(0,o.IO)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"),(0,o.ar)("timestamp",">=",o.EK.fromDate(e)),(0,o.ar)("timestamp","<=",o.EK.fromDate(t)),(0,o.ar)("type","in",["session_start","session_end"])),n=(await(0,o.PL)(i)).docs.map((e=>e.data())),r=new Set(n.map((e=>e.userId))).size,l=(null===(s=(await(0,o.QT)((0,o.JU)(c.db,"families",this.familyId))).data())||void 0===s||null===(a=s.members)||void 0===a?void 0:a.length)||1,d=n.filter((e=>"session_start"===e.type)),m=d.length/Math.max(r,1),u=25*d.length,h=25,p=new Map;d.forEach((e=>{const t=p.get(e.userId)||0;p.set(e.userId,t+1)}));let g={userId:"",name:"None",sessionCount:0};p.forEach(((e,t)=>{e>g.sessionCount&&(g={userId:t,name:t,sessionCount:e})}));return{activeMemberCount:r,participationRate:r/l*100,avgSessionsPerMember:m,totalTimeSpent:u,avgSessionDuration:h,mostActiveMember:g,trend:"up",changePercentage:12.5}}catch(i){return this.getDefaultParticipationMetrics()}}async calculateCollaborationMetrics(e,t){try{const a=(0,o.IO)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"),(0,o.ar)("timestamp",">=",o.EK.fromDate(e)),(0,o.ar)("timestamp","<=",o.EK.fromDate(t))),s=(await(0,o.PL)(a)).docs.map((e=>e.data())),i=s.filter((e=>"video_call"===e.type)).length,n=s.filter((e=>"coediting"===e.type)).length,r=i+n,l=Math.floor(.7*r);return{collaborativeSessionCount:r,templatesCollaborated:l,avgCollaboratorsPerSession:3.5,videoCallCount:i,coEditingSessionCount:n,avgEditsPerUser:15,consensusScore:85,elderParticipationRate:78,trend:"up",changePercentage:8.3}}catch(a){return this.getDefaultCollaborationMetrics()}}async calculateUbuntuMetrics(e,t){try{const a=(0,o.IO)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"),(0,o.ar)("timestamp",">=",o.EK.fromDate(e)),(0,o.ar)("timestamp","<=",o.EK.fromDate(t))),s=(await(0,o.PL)(a)).docs.map((e=>e.data())),i=88,n=s.filter((e=>"video_call"===e.type||"coediting"===e.type)).length,r=Math.min(90,60+2*n),l=82,d=85,m=80;return{overallScore:Math.round(.25*i+.25*r+.15*l+.2*d+.15*m),respectScore:i,communityScore:r,sharingScore:l,harmonyScore:d,leadershipScore:m,practices:{elderConsultationRate:75,consensusDecisionRate:82,knowledgeSharingInstances:45,mentorshipSessions:12},trend:"up",changePercentage:5.2}}catch(a){return this.getDefaultUbuntuMetrics()}}async calculateBusinessImpactMetrics(e,t){try{const a=(0,o.IO)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"),(0,o.ar)("timestamp",">=",o.EK.fromDate(e)),(0,o.ar)("timestamp","<=",o.EK.fromDate(t)),(0,o.ar)("type","==","template_complete")),s=(await(0,o.PL)(a)).size,i=Math.floor(.3*s),n=Math.floor(.25*s),r=2500*s,l=8*s,d=Math.floor(.4*i);return{templatesCompleted:s,businessPlansCreated:i,financialDocumentsCount:n,estimatedEconomicValue:r,timeSaved:l,businessesStarted:d,jobsCreated:3*d,revenueGenerated:5e4*d,successRate:75,trend:"up",changePercentage:15.7}}catch(a){return this.getDefaultBusinessImpactMetrics()}}async calculateTemplateUsageMetrics(e,t){return{mostUsedTemplate:{templateId:"f1-business-together",name:"Business Together Partnership",usageCount:45,category:"family"},completionRatesByCategory:[{category:"family",completionRate:78,avgTimeToComplete:120},{category:"personal",completionRate:85,avgTimeToComplete:45},{category:"professional",completionRate:72,avgTimeToComplete:90}],templateEffectiveness:[{templateId:"f1-business-together",name:"Business Together Partnership",effectivenessScore:92,userRating:4.7},{templateId:"f2-council-governance",name:"Family Council Governance",effectivenessScore:88,userRating:4.5}],usageByHour:Array.from({length:24},((e,t)=>({hour:t,count:t>=9&&t<=17?Math.floor(20*Math.random())+10:Math.floor(5*Math.random())})))}}async calculateVideoConferenceMetrics(e,t){try{const a=(0,o.IO)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"),(0,o.ar)("timestamp",">=",o.EK.fromDate(e)),(0,o.ar)("timestamp","<=",o.EK.fromDate(t)),(0,o.ar)("type","==","video_call")),s=(await(0,o.PL)(a)).size;return{totalCalls:s,totalDuration:35*s,avgCallDuration:35,avgParticipants:4.2,recordingConsentRate:92,screenSharingUsage:65,callQualityScore:87,commonPurposes:[{purpose:"Template Discussion",count:25},{purpose:"Business Planning",count:18},{purpose:"Family Council",count:12}]}}catch(a){return this.getDefaultVideoConferenceMetrics()}}async calculateAIRecommendationMetrics(e,t){try{const a=(0,o.IO)((0,o.hJ)(c.db,"families",this.familyId,"analytics_events"),(0,o.ar)("timestamp",">=",o.EK.fromDate(e)),(0,o.ar)("timestamp","<=",o.EK.fromDate(t)),(0,o.ar)("type","in",["recommendation_accept","recommendation_reject"])),s=(await(0,o.PL)(a)).docs.map((e=>e.data())),i=s.filter((e=>"recommendation_accept"===e.type)).length,n=i+s.filter((e=>"recommendation_reject"===e.type)).length;return{totalRecommendations:n,acceptanceRate:n>0?i/n*100:0,avgRelevanceScore:.82,topRecommendations:[{templateId:"f1-business-together",name:"Business Together Partnership",recommendationCount:15,acceptanceRate:87}],userSatisfaction:4.3}}catch(a){return this.getDefaultAIRecommendationMetrics()}}async generateTimeSeriesData(e,t){const a=Math.ceil((t.getTime()-e.getTime())/864e5),s=Math.min(a,30),i=[],n=[],r=[],o=[];for(let c=0;c<s;c++){const t=new Date(e.getTime()+24*c*60*60*1e3),a=t.toLocaleDateString("en-US",{month:"short",day:"numeric"});i.push({timestamp:t,value:60+30*Math.random(),label:a}),n.push({timestamp:t,value:50+40*Math.random(),label:a}),r.push({timestamp:t,value:75+20*Math.random(),label:a}),o.push({timestamp:t,value:Math.floor(10*Math.random()),label:a})}return{participation:i,collaboration:n,ubuntu:r,businessImpact:o}}async getMemberActivity(e,t){return[{userId:"user1",userName:"Lonwabo Mdeni",userRole:"elder",sessionCount:45,totalTime:1200,templatesViewed:25,templatesCompleted:12,videoCallsJoined:18,coEditingSessions:15,recommendationsAccepted:8,lastActive:new Date,activityScore:95}]}async getCollaborationNetwork(){return{nodes:[{userId:"user1",userName:"Lonwabo Mdeni",role:"elder",activityScore:95},{userId:"user2",userName:"Family Member 2",role:"member",activityScore:78}],edges:[{source:"user1",target:"user2",weight:15,type:"video"}]}}getDateRange(e){const t=new Date,a=new Date;switch(e){case"day":a.setDate(t.getDate()-1);break;case"week":a.setDate(t.getDate()-7);break;case"month":a.setMonth(t.getMonth()-1);break;case"quarter":a.setMonth(t.getMonth()-3);break;case"year":a.setFullYear(t.getFullYear()-1);break;case"all":a.setFullYear(2020)}return{startDate:a,endDate:t}}getDefaultParticipationMetrics(){return{activeMemberCount:0,participationRate:0,avgSessionsPerMember:0,totalTimeSpent:0,avgSessionDuration:0,mostActiveMember:{userId:"",name:"None",sessionCount:0},trend:"stable",changePercentage:0}}getDefaultCollaborationMetrics(){return{collaborativeSessionCount:0,templatesCollaborated:0,avgCollaboratorsPerSession:0,videoCallCount:0,coEditingSessionCount:0,avgEditsPerUser:0,consensusScore:0,elderParticipationRate:0,trend:"stable",changePercentage:0}}getDefaultUbuntuMetrics(){return{overallScore:0,respectScore:0,communityScore:0,sharingScore:0,harmonyScore:0,leadershipScore:0,practices:{elderConsultationRate:0,consensusDecisionRate:0,knowledgeSharingInstances:0,mentorshipSessions:0},trend:"stable",changePercentage:0}}getDefaultBusinessImpactMetrics(){return{templatesCompleted:0,businessPlansCreated:0,financialDocumentsCount:0,estimatedEconomicValue:0,timeSaved:0,businessesStarted:0,jobsCreated:0,revenueGenerated:0,successRate:0,trend:"stable",changePercentage:0}}getDefaultVideoConferenceMetrics(){return{totalCalls:0,totalDuration:0,avgCallDuration:0,avgParticipants:0,recordingConsentRate:0,screenSharingUsage:0,callQualityScore:0,commonPurposes:[]}}getDefaultAIRecommendationMetrics(){return{totalRecommendations:0,acceptanceRate:0,avgRelevanceScore:0,topRecommendations:[],userSatisfaction:0}}constructor(e){this.cache=new Map,this.CACHE_DURATION=3e5,this.familyId=e}}let d=null;var m=a(44976),u=a(12779);var h=()=>{var e,t,a,o;const{user:c}=(0,r.a)(),[h,p]=(0,i.useState)(!0),[g,b]=(0,i.useState)(null),[y,f]=(0,i.useState)("month"),v=async()=>{if(c){p(!0);try{const t=(e=c.id,d&&d.familyId===e||(d=new l(e)),d),a=await t.getDashboardData(y);b(a)}catch(t){}finally{p(!1)}var e}};(0,i.useEffect)((()=>{v()}),[null===c||void 0===c?void 0:c.id,y]);return h?(0,s.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,s.jsx)("div",{className:"animate-spin",children:(0,s.jsx)("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full"})})}):(0,s.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 p-8",children:[(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[(0,s.jsxs)("div",{className:"flex flex-col md:flex-row items-start md:items-center justify-between gap-4",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("h1",{className:"text-4xl font-bold text-gray-900",children:"Analytics Dashboard"}),(0,s.jsx)("p",{className:"text-gray-600 mt-2",children:"Comprehensive view of family collaboration and activity"})]}),(0,s.jsxs)("div",{className:"flex gap-3",children:[(0,s.jsxs)("button",{onClick:v,className:"flex items-center gap-2 px-4 py-2 bg-white rounded-lg shadow hover:shadow-md transition border border-gray-200",children:[(0,s.jsx)(m.Z,{className:"w-4 h-4"}),"Refresh"]}),(0,s.jsxs)("button",{onClick:()=>{const e=JSON.stringify(g,null,2),t=document.createElement("a");t.setAttribute("href","data:application/json;charset=utf-8,"+encodeURIComponent(e)),t.setAttribute("download","analytics-".concat((new Date).toISOString().split("T")[0],".json")),t.style.display="none",document.body.appendChild(t),t.click(),document.body.removeChild(t)},className:"flex items-center gap-2 px-4 py-2 bg-blue-500 text-white rounded-lg shadow hover:shadow-md transition hover:bg-blue-600",children:[(0,s.jsx)(u.Z,{className:"w-4 h-4"}),"Export"]})]})]}),(0,s.jsx)("div",{className:"flex gap-2 mt-4",children:["week","month","year"].map((e=>(0,s.jsx)("button",{onClick:()=>f(e),className:"px-4 py-2 rounded-lg font-medium transition ".concat(y===e?"bg-blue-500 text-white shadow-md":"bg-white text-gray-700 border border-gray-200 hover:border-gray-300"),children:e.charAt(0).toUpperCase()+e.slice(1)},e)))})]}),g&&(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-8",children:[(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Total Members"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:(null===(e=g.participationMetrics)||void 0===e?void 0:e.totalMembers)||0})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Active Members"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-green-600 mt-2",children:(null===(t=g.participationMetrics)||void 0===t?void 0:t.activeMembers)||0})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Total Events"}),(0,s.jsx)("p",{className:"text-3xl font-bold text-purple-600 mt-2",children:(null===(a=g.participationMetrics)||void 0===a?void 0:a.totalEvents)||0})]}),(0,s.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("p",{className:"text-gray-600 text-sm font-medium",children:"Collaboration"}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-orange-600 mt-2",children:[((null===(o=g.collaborationMetrics)||void 0===o?void 0:o.overallScore)||0).toFixed(0),"%"]})]})]}),(null===g||void 0===g?void 0:g.collaborationMetrics)&&(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Collaboration Metrics"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"Overall Score"}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,s.jsx)("div",{className:"bg-blue-600 h-3 rounded-full transition-all",style:{width:"".concat(g.collaborationMetrics.overallScore,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[g.collaborationMetrics.overallScore.toFixed(1),"%"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"Communication"}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,s.jsx)("div",{className:"bg-green-600 h-3 rounded-full transition-all",style:{width:"".concat(g.collaborationMetrics.communicationScore||0,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[(g.collaborationMetrics.communicationScore||0).toFixed(1),"%"]})]}),(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-600 font-medium mb-2",children:"Participation"}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,s.jsx)("div",{className:"bg-purple-600 h-3 rounded-full transition-all",style:{width:"".concat(g.collaborationMetrics.participationScore||0,"%")}})}),(0,s.jsxs)("p",{className:"text-sm text-gray-500 mt-2",children:[(g.collaborationMetrics.participationScore||0).toFixed(1),"%"]})]})]})]}),(null===g||void 0===g?void 0:g.ubuntuMetrics)&&(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"bg-white rounded-lg shadow-md p-6 mb-8",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Ubuntu Principles"}),(0,s.jsx)("div",{className:"space-y-4",children:g.ubuntuMetrics.principlesScores&&Object.entries(g.ubuntuMetrics.principlesScores).map((e=>{let[t,a]=e;return(0,s.jsxs)("div",{children:[(0,s.jsx)("p",{className:"text-gray-700 font-medium capitalize",children:t.replace(/_/g," ")}),(0,s.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2 mt-2",children:(0,s.jsx)("div",{className:"bg-indigo-600 h-2 rounded-full transition-all",style:{width:"".concat(a||0,"%")}})})]},t)}))})]}),(null===g||void 0===g?void 0:g.businessImpactMetrics)&&(0,s.jsxs)(n.E.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"bg-white rounded-lg shadow-md p-6",children:[(0,s.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Business Impact"}),(0,s.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,s.jsxs)("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-green-800 font-semibold",children:"ROI"}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-green-600 mt-2",children:[(g.businessImpactMetrics.estimatedROI||0).toFixed(1),"%"]})]}),(0,s.jsxs)("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4",children:[(0,s.jsx)("p",{className:"text-blue-800 font-semibold",children:"Efficiency Gain"}),(0,s.jsxs)("p",{className:"text-3xl font-bold text-blue-600 mt-2",children:[(g.businessImpactMetrics.efficiencyGain||0).toFixed(1),"%"]})]}),g.businessImpactMetrics.keyAchievements&&(0,s.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,s.jsx)("p",{className:"text-gray-700 font-semibold mb-3",children:"Key Achievements"}),(0,s.jsx)("ul",{className:"space-y-2",children:g.businessImpactMetrics.keyAchievements.slice(0,5).map(((e,t)=>(0,s.jsxs)("li",{className:"flex items-start gap-2 text-gray-700",children:[(0,s.jsx)("span",{className:"text-green-600 font-bold",children:"\u2713"}),(0,s.jsx)("span",{children:e})]},t)))})]})]})]})]})}}},function(e){e.O(0,[2023,2888,9774,179],(function(){return t=77914,e(e.s=t);var t}));var t=e.O();_N_E=t}]);