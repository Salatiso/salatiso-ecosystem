(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2888],{99711:function(e,t,n){"use strict";n.d(t,{BH:function(){return m},LL:function(){return P},ZR:function(){return L},tV:function(){return c},L:function(){return a},Sg:function(){return v},ne:function(){return z},vZ:function(){return U},pd:function(){return B},aH:function(){return f},q4:function(){return h},P0:function(){return d},Pz:function(){return p},Rd:function(){return u},m9:function(){return K},z$:function(){return E},ru:function(){return S},Xx:function(){return g},L_:function(){return k},xb:function(){return M},w1:function(){return C},hl:function(){return O},uI:function(){return I},b$:function(){return A},G6:function(){return N},WO:function(){return R},Uo:function(){return y},xO:function(){return F},zd:function(){return j},dp:function(){return _},eu:function(){return x}});var r=n(34155);const i=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},s={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,c=a?e[i+2]:0,u=t>>2,l=(3&t)<<4|o>>4;let h=(15&o)<<2|c>>6,d=63&c;a||(d=64,s||(h=64)),r.push(n[u],n[l],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(i(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const a=i<e.length?n[e.charAt(i)]:64;++i;const c=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==a||null==c)throw new o;const u=t<<2|s>>4;if(r.push(u),64!==a){const e=s<<4&240|a>>2;if(r.push(e),64!==c){const e=a<<6&192|c;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class o extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const a=function(e){return function(e){const t=i(e);return s.encodeByteArray(t,!0)}(e).replace(/\./g,"")},c=function(e){try{return s.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function u(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const l=()=>{try{return u().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof r||"undefined"===typeof r.env)return;const e=r.env.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&c(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},h=e=>l()?.emulatorHosts?.[e],d=e=>{const t=h(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},f=()=>l()?.config,p=e=>l()?.[`_${e}`];class m{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function g(e){try{return(e.startsWith("http://")||e.startsWith("https://")?new URL(e).hostname:e).endsWith(".cloudworkstations.dev")}catch{return!1}}async function y(e){return(await fetch(e,{credentials:"include"})).ok}function v(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s={iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}},...e};return[a(JSON.stringify({alg:"none",type:"JWT"})),a(JSON.stringify(s)),""].join(".")}const w={};let b=!1;function _(e,t){if("undefined"===typeof window||"undefined"===typeof document||!g(window.location.host)||w[e]===t||w[e]||b)return;function n(e){return`__firebase__banner__${e}`}w[e]=t;const r="__firebase__banner",i=function(){const e={prod:[],emulator:[]};for(const t of Object.keys(w))w[t]?e.emulator.push(t):e.prod.push(t);return e}().prod.length>0;function s(){const e=document.createElement("span");return e.style.cursor="pointer",e.style.marginLeft="16px",e.style.fontSize="24px",e.innerHTML=" &times;",e.onclick=()=>{b=!0,function(){const e=document.getElementById(r);e&&e.remove()}()},e}function o(){const e=function(e){let t=document.getElementById(e),n=!1;return t||(t=document.createElement("div"),t.setAttribute("id",e),n=!0),{created:n,element:t}}(r),t=n("text"),o=document.getElementById(t)||document.createElement("span"),a=n("learnmore"),c=document.getElementById(a)||document.createElement("a"),u=n("preprendIcon"),l=document.getElementById(u)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(e.created){const t=e.element;!function(e){e.style.display="flex",e.style.background="#7faaf0",e.style.position="fixed",e.style.bottom="5px",e.style.left="5px",e.style.padding=".5em",e.style.borderRadius="5px",e.style.alignItems="center"}(t),function(e,t){e.setAttribute("id",t),e.innerText="Learn more",e.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",e.setAttribute("target","__blank"),e.style.paddingLeft="5px",e.style.textDecoration="underline"}(c,a);const n=s();!function(e,t){e.setAttribute("width","24"),e.setAttribute("id",t),e.setAttribute("height","24"),e.setAttribute("viewBox","0 0 24 24"),e.setAttribute("fill","none"),e.style.marginLeft="-6px"}(l,u),t.append(l,o,c,n),document.body.appendChild(t)}i?(o.innerText="Preview backend disconnected.",l.innerHTML='<g clip-path="url(#clip0_6013_33858)">\n<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6013_33858">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>'):(l.innerHTML='<g clip-path="url(#clip0_6083_34804)">\n<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>\n</g>\n<defs>\n<clipPath id="clip0_6083_34804">\n<rect width="24" height="24" fill="white"/>\n</clipPath>\n</defs>',o.innerText="Preview backend running in this workspace."),o.setAttribute("id",t)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",o):o()}function E(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function I(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(E())}function T(){const e=l()?.forceEnvironment;if("node"===e)return!0;if("browser"===e)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(t){return!1}}function k(){return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent}function S(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function A(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function C(){const e=E();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function N(){return!T()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function R(){return!T()&&!!navigator.userAgent&&(navigator.userAgent.includes("Safari")||navigator.userAgent.includes("WebKit"))&&!navigator.userAgent.includes("Chrome")}function O(){try{return"object"===typeof indexedDB}catch(e){return!1}}function x(){return new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{t(i.error?.message||"")}}catch(n){t(n)}}))}class L extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,L.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,P.prototype.create)}}class P{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e,...t){const n=t[0]||{},r=`${this.service}/${e}`,i=this.errors[e],s=i?function(e,t){return e.replace(D,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(i,n):"Error",o=`${this.serviceName}: ${s} (${r}).`;return new L(r,o,n)}}const D=/\{\$([^}]+)}/g;function M(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}function U(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(V(n)&&V(s)){if(!U(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function V(e){return null!==e&&"object"===typeof e}function F(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function j(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function B(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function z(e,t){const n=new q(e,t);return n.subscribe.bind(n)}class q{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=$),void 0===r.error&&(r.error=$),void 0===r.complete&&(r.complete=$);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function $(){}function K(e){return e&&e._delegate?e._delegate:e}},79742:function(e,t){"use strict";t.byteLength=function(e){var t=a(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,s=a(e),o=s[0],c=s[1],u=new i(function(e,t,n){return 3*(t+n)/4-n}(0,o,c)),l=0,h=c>0?o-4:o;for(n=0;n<h;n+=4)t=r[e.charCodeAt(n)]<<18|r[e.charCodeAt(n+1)]<<12|r[e.charCodeAt(n+2)]<<6|r[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===c&&(t=r[e.charCodeAt(n)]<<2|r[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===c&&(t=r[e.charCodeAt(n)]<<10|r[e.charCodeAt(n+1)]<<4|r[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,r=e.length,i=r%3,s=[],o=16383,a=0,u=r-i;a<u;a+=o)s.push(c(e,a,a+o>u?u:a+o));1===i?(t=e[r-1],s.push(n[t>>2]+n[t<<4&63]+"==")):2===i&&(t=(e[r-2]<<8)+e[r-1],s.push(n[t>>10]+n[t>>4&63]+n[t<<2&63]+"="));return s.join("")};for(var n=[],r=[],i="undefined"!==typeof Uint8Array?Uint8Array:Array,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0;o<64;++o)n[o]=s[o],r[s.charCodeAt(o)]=o;function a(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function c(e,t,r){for(var i,s,o=[],a=t;a<r;a+=3)i=(e[a]<<16&16711680)+(e[a+1]<<8&65280)+(255&e[a+2]),o.push(n[(s=i)>>18&63]+n[s>>12&63]+n[s>>6&63]+n[63&s]);return o.join("")}r["-".charCodeAt(0)]=62,r["_".charCodeAt(0)]=63},48764:function(e,t,n){"use strict";const r=n(79742),i=n(80645),s="function"===typeof Symbol&&"function"===typeof Symbol.for?Symbol.for("nodejs.util.inspect.custom"):null;t.lW=c,t.h2=50;const o=2147483647;function a(e){if(e>o)throw new RangeError('The value "'+e+'" is invalid for option "size"');const t=new Uint8Array(e);return Object.setPrototypeOf(t,c.prototype),t}function c(e,t,n){if("number"===typeof e){if("string"===typeof t)throw new TypeError('The "string" argument must be of type string. Received type number');return h(e)}return u(e,t,n)}function u(e,t,n){if("string"===typeof e)return function(e,t){"string"===typeof t&&""!==t||(t="utf8");if(!c.isEncoding(t))throw new TypeError("Unknown encoding: "+t);const n=0|m(e,t);let r=a(n);const i=r.write(e,t);i!==n&&(r=r.slice(0,i));return r}(e,t);if(ArrayBuffer.isView(e))return function(e){if(X(e,Uint8Array)){const t=new Uint8Array(e);return f(t.buffer,t.byteOffset,t.byteLength)}return d(e)}(e);if(null==e)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);if(X(e,ArrayBuffer)||e&&X(e.buffer,ArrayBuffer))return f(e,t,n);if("undefined"!==typeof SharedArrayBuffer&&(X(e,SharedArrayBuffer)||e&&X(e.buffer,SharedArrayBuffer)))return f(e,t,n);if("number"===typeof e)throw new TypeError('The "value" argument must not be of type number. Received type number');const r=e.valueOf&&e.valueOf();if(null!=r&&r!==e)return c.from(r,t,n);const i=function(e){if(c.isBuffer(e)){const t=0|p(e.length),n=a(t);return 0===n.length||e.copy(n,0,0,t),n}if(void 0!==e.length)return"number"!==typeof e.length||Q(e.length)?a(0):d(e);if("Buffer"===e.type&&Array.isArray(e.data))return d(e.data)}(e);if(i)return i;if("undefined"!==typeof Symbol&&null!=Symbol.toPrimitive&&"function"===typeof e[Symbol.toPrimitive])return c.from(e[Symbol.toPrimitive]("string"),t,n);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be of type number');if(e<0)throw new RangeError('The value "'+e+'" is invalid for option "size"')}function h(e){return l(e),a(e<0?0:0|p(e))}function d(e){const t=e.length<0?0:0|p(e.length),n=a(t);for(let r=0;r<t;r+=1)n[r]=255&e[r];return n}function f(e,t,n){if(t<0||e.byteLength<t)throw new RangeError('"offset" is outside of buffer bounds');if(e.byteLength<t+(n||0))throw new RangeError('"length" is outside of buffer bounds');let r;return r=void 0===t&&void 0===n?new Uint8Array(e):void 0===n?new Uint8Array(e,t):new Uint8Array(e,t,n),Object.setPrototypeOf(r,c.prototype),r}function p(e){if(e>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return 0|e}function m(e,t){if(c.isBuffer(e))return e.length;if(ArrayBuffer.isView(e)||X(e,ArrayBuffer))return e.byteLength;if("string"!==typeof e)throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof e);const n=e.length,r=arguments.length>2&&!0===arguments[2];if(!r&&0===n)return 0;let i=!1;for(;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":return G(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return H(e).length;default:if(i)return r?-1:G(e).length;t=(""+t).toLowerCase(),i=!0}}function g(e,t,n){let r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return R(this,t,n);case"utf8":case"utf-8":return S(this,t,n);case"ascii":return C(this,t,n);case"latin1":case"binary":return N(this,t,n);case"base64":return k(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function y(e,t,n){const r=e[t];e[t]=e[n],e[n]=r}function v(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),Q(n=+n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=c.from(t,r)),c.isBuffer(t))return 0===t.length?-1:w(e,t,n,r,i);if("number"===typeof t)return t&=255,"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):w(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function w(e,t,n,r,i){let s,o=1,a=e.length,c=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;o=2,a/=2,c/=2,n/=2}function u(e,t){return 1===o?e[t]:e.readUInt16BE(t*o)}if(i){let r=-1;for(s=n;s<a;s++)if(u(e,s)===u(t,-1===r?0:s-r)){if(-1===r&&(r=s),s-r+1===c)return r*o}else-1!==r&&(s-=s-r),r=-1}else for(n+c>a&&(n=a-c),s=n;s>=0;s--){let n=!0;for(let r=0;r<c;r++)if(u(e,s+r)!==u(t,r)){n=!1;break}if(n)return s}return-1}function b(e,t,n,r){n=Number(n)||0;const i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;const s=t.length;let o;for(r>s/2&&(r=s/2),o=0;o<r;++o){const r=parseInt(t.substr(2*o,2),16);if(Q(r))return o;e[n+o]=r}return o}function _(e,t,n,r){return W(G(t,e.length-n),e,n,r)}function E(e,t,n,r){return W(function(e){const t=[];for(let n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function I(e,t,n,r){return W(H(t),e,n,r)}function T(e,t,n,r){return W(function(e,t){let n,r,i;const s=[];for(let o=0;o<e.length&&!((t-=2)<0);++o)n=e.charCodeAt(o),r=n>>8,i=n%256,s.push(i),s.push(r);return s}(t,e.length-n),e,n,r)}function k(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function S(e,t,n){n=Math.min(e.length,n);const r=[];let i=t;for(;i<n;){const t=e[i];let s=null,o=t>239?4:t>223?3:t>191?2:1;if(i+o<=n){let n,r,a,c;switch(o){case 1:t<128&&(s=t);break;case 2:n=e[i+1],128===(192&n)&&(c=(31&t)<<6|63&n,c>127&&(s=c));break;case 3:n=e[i+1],r=e[i+2],128===(192&n)&&128===(192&r)&&(c=(15&t)<<12|(63&n)<<6|63&r,c>2047&&(c<55296||c>57343)&&(s=c));break;case 4:n=e[i+1],r=e[i+2],a=e[i+3],128===(192&n)&&128===(192&r)&&128===(192&a)&&(c=(15&t)<<18|(63&n)<<12|(63&r)<<6|63&a,c>65535&&c<1114112&&(s=c))}}null===s?(s=65533,o=1):s>65535&&(s-=65536,r.push(s>>>10&1023|55296),s=56320|1023&s),r.push(s),i+=o}return function(e){const t=e.length;if(t<=A)return String.fromCharCode.apply(String,e);let n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=A));return n}(r)}c.TYPED_ARRAY_SUPPORT=function(){try{const e=new Uint8Array(1),t={foo:function(){return 42}};return Object.setPrototypeOf(t,Uint8Array.prototype),Object.setPrototypeOf(e,t),42===e.foo()}catch(e){return!1}}(),c.TYPED_ARRAY_SUPPORT||"undefined"===typeof console||"function"!==typeof console.error||console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support."),Object.defineProperty(c.prototype,"parent",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.buffer}}),Object.defineProperty(c.prototype,"offset",{enumerable:!0,get:function(){if(c.isBuffer(this))return this.byteOffset}}),c.poolSize=8192,c.from=function(e,t,n){return u(e,t,n)},Object.setPrototypeOf(c.prototype,Uint8Array.prototype),Object.setPrototypeOf(c,Uint8Array),c.alloc=function(e,t,n){return function(e,t,n){return l(e),e<=0?a(e):void 0!==t?"string"===typeof n?a(e).fill(t,n):a(e).fill(t):a(e)}(e,t,n)},c.allocUnsafe=function(e){return h(e)},c.allocUnsafeSlow=function(e){return h(e)},c.isBuffer=function(e){return null!=e&&!0===e._isBuffer&&e!==c.prototype},c.compare=function(e,t){if(X(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),X(t,Uint8Array)&&(t=c.from(t,t.offset,t.byteLength)),!c.isBuffer(e)||!c.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,r=t.length;for(let i=0,s=Math.min(n,r);i<s;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},c.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},c.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return c.alloc(0);let n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;const r=c.allocUnsafe(t);let i=0;for(n=0;n<e.length;++n){let t=e[n];if(X(t,Uint8Array))i+t.length>r.length?(c.isBuffer(t)||(t=c.from(t)),t.copy(r,i)):Uint8Array.prototype.set.call(r,t,i);else{if(!c.isBuffer(t))throw new TypeError('"list" argument must be an Array of Buffers');t.copy(r,i)}i+=t.length}return r},c.byteLength=m,c.prototype._isBuffer=!0,c.prototype.swap16=function(){const e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)y(this,t,t+1);return this},c.prototype.swap32=function(){const e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)y(this,t,t+3),y(this,t+1,t+2);return this},c.prototype.swap64=function(){const e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)y(this,t,t+7),y(this,t+1,t+6),y(this,t+2,t+5),y(this,t+3,t+4);return this},c.prototype.toString=function(){const e=this.length;return 0===e?"":0===arguments.length?S(this,0,e):g.apply(this,arguments)},c.prototype.toLocaleString=c.prototype.toString,c.prototype.equals=function(e){if(!c.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===c.compare(this,e)},c.prototype.inspect=function(){let e="";const n=t.h2;return e=this.toString("hex",0,n).replace(/(.{2})/g,"$1 ").trim(),this.length>n&&(e+=" ... "),"<Buffer "+e+">"},s&&(c.prototype[s]=c.prototype.inspect),c.prototype.compare=function(e,t,n,r,i){if(X(e,Uint8Array)&&(e=c.from(e,e.offset,e.byteLength)),!c.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;let s=(i>>>=0)-(r>>>=0),o=(n>>>=0)-(t>>>=0);const a=Math.min(s,o),u=this.slice(r,i),l=e.slice(t,n);for(let c=0;c<a;++c)if(u[c]!==l[c]){s=u[c],o=l[c];break}return s<o?-1:o<s?1:0},c.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},c.prototype.indexOf=function(e,t,n){return v(this,e,t,n,!0)},c.prototype.lastIndexOf=function(e,t,n){return v(this,e,t,n,!1)},c.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t>>>=0,isFinite(n)?(n>>>=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}const i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");let s=!1;for(;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return _(this,e,t,n);case"ascii":case"latin1":case"binary":return E(this,e,t,n);case"base64":return I(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return T(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),s=!0}},c.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};const A=4096;function C(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function N(e,t,n){let r="";n=Math.min(e.length,n);for(let i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function R(e,t,n){const r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);let i="";for(let s=t;s<n;++s)i+=Y[e[s]];return i}function O(e,t,n){const r=e.slice(t,n);let i="";for(let s=0;s<r.length-1;s+=2)i+=String.fromCharCode(r[s]+256*r[s+1]);return i}function x(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function L(e,t,n,r,i,s){if(!c.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<s)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function P(e,t,n,r,i){z(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s,s>>=8,e[n++]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,o>>=8,e[n++]=o,n}function D(e,t,n,r,i){z(t,r,i,e,n,7);let s=Number(t&BigInt(4294967295));e[n+7]=s,s>>=8,e[n+6]=s,s>>=8,e[n+5]=s,s>>=8,e[n+4]=s;let o=Number(t>>BigInt(32)&BigInt(4294967295));return e[n+3]=o,o>>=8,e[n+2]=o,o>>=8,e[n+1]=o,o>>=8,e[n]=o,n+8}function M(e,t,n,r,i,s){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function U(e,t,n,r,s){return t=+t,n>>>=0,s||M(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function V(e,t,n,r,s){return t=+t,n>>>=0,s||M(e,0,n,8),i.write(e,t,n,r,52,8),n+8}c.prototype.slice=function(e,t){const n=this.length;(e=~~e)<0?(e+=n)<0&&(e=0):e>n&&(e=n),(t=void 0===t?n:~~t)<0?(t+=n)<0&&(t=0):t>n&&(t=n),t<e&&(t=e);const r=this.subarray(e,t);return Object.setPrototypeOf(r,c.prototype),r},c.prototype.readUintLE=c.prototype.readUIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return r},c.prototype.readUintBE=c.prototype.readUIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=this[e+--t],i=1;for(;t>0&&(i*=256);)r+=this[e+--t]*i;return r},c.prototype.readUint8=c.prototype.readUInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),this[e]},c.prototype.readUint16LE=c.prototype.readUInt16LE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]|this[e+1]<<8},c.prototype.readUint16BE=c.prototype.readUInt16BE=function(e,t){return e>>>=0,t||x(e,2,this.length),this[e]<<8|this[e+1]},c.prototype.readUint32LE=c.prototype.readUInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},c.prototype.readUint32BE=c.prototype.readUInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},c.prototype.readBigUInt64LE=J((function(e){q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=t+256*this[++e]+65536*this[++e]+this[++e]*2**24,i=this[++e]+256*this[++e]+65536*this[++e]+n*2**24;return BigInt(r)+(BigInt(i)<<BigInt(32))})),c.prototype.readBigUInt64BE=J((function(e){q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=t*2**24+65536*this[++e]+256*this[++e]+this[++e],i=this[++e]*2**24+65536*this[++e]+256*this[++e]+n;return(BigInt(r)<<BigInt(32))+BigInt(i)})),c.prototype.readIntLE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=this[e],i=1,s=0;for(;++s<t&&(i*=256);)r+=this[e+s]*i;return i*=128,r>=i&&(r-=Math.pow(2,8*t)),r},c.prototype.readIntBE=function(e,t,n){e>>>=0,t>>>=0,n||x(e,t,this.length);let r=t,i=1,s=this[e+--r];for(;r>0&&(i*=256);)s+=this[e+--r]*i;return i*=128,s>=i&&(s-=Math.pow(2,8*t)),s},c.prototype.readInt8=function(e,t){return e>>>=0,t||x(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},c.prototype.readInt16LE=function(e,t){e>>>=0,t||x(e,2,this.length);const n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt16BE=function(e,t){e>>>=0,t||x(e,2,this.length);const n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},c.prototype.readInt32LE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},c.prototype.readInt32BE=function(e,t){return e>>>=0,t||x(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},c.prototype.readBigInt64LE=J((function(e){q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=this[e+4]+256*this[e+5]+65536*this[e+6]+(n<<24);return(BigInt(r)<<BigInt(32))+BigInt(t+256*this[++e]+65536*this[++e]+this[++e]*2**24)})),c.prototype.readBigInt64BE=J((function(e){q(e>>>=0,"offset");const t=this[e],n=this[e+7];void 0!==t&&void 0!==n||$(e,this.length-8);const r=(t<<24)+65536*this[++e]+256*this[++e]+this[++e];return(BigInt(r)<<BigInt(32))+BigInt(this[++e]*2**24+65536*this[++e]+256*this[++e]+n)})),c.prototype.readFloatLE=function(e,t){return e>>>=0,t||x(e,4,this.length),i.read(this,e,!0,23,4)},c.prototype.readFloatBE=function(e,t){return e>>>=0,t||x(e,4,this.length),i.read(this,e,!1,23,4)},c.prototype.readDoubleLE=function(e,t){return e>>>=0,t||x(e,8,this.length),i.read(this,e,!0,52,8)},c.prototype.readDoubleBE=function(e,t){return e>>>=0,t||x(e,8,this.length),i.read(this,e,!1,52,8)},c.prototype.writeUintLE=c.prototype.writeUIntLE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=1,s=0;for(this[t]=255&e;++s<n&&(i*=256);)this[t+s]=e/i&255;return t+n},c.prototype.writeUintBE=c.prototype.writeUIntBE=function(e,t,n,r){if(e=+e,t>>>=0,n>>>=0,!r){L(this,e,t,n,Math.pow(2,8*n)-1,0)}let i=n-1,s=1;for(this[t+i]=255&e;--i>=0&&(s*=256);)this[t+i]=e/s&255;return t+n},c.prototype.writeUint8=c.prototype.writeUInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,255,0),this[t]=255&e,t+1},c.prototype.writeUint16LE=c.prototype.writeUInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeUint16BE=c.prototype.writeUInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeUint32LE=c.prototype.writeUInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e,t+4},c.prototype.writeUint32BE=c.prototype.writeUInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigUInt64LE=J((function(e,t=0){return P(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeBigUInt64BE=J((function(e,t=0){return D(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))})),c.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=0,s=1,o=0;for(this[t]=255&e;++i<n&&(s*=256);)e<0&&0===o&&0!==this[t+i-1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},c.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t>>>=0,!r){const r=Math.pow(2,8*n-1);L(this,e,t,n,r-1,-r)}let i=n-1,s=1,o=0;for(this[t+i]=255&e;--i>=0&&(s*=256);)e<0&&0===o&&0!==this[t+i+1]&&(o=1),this[t+i]=(e/s>>0)-o&255;return t+n},c.prototype.writeInt8=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=255&e,t+1},c.prototype.writeInt16LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=255&e,this[t+1]=e>>>8,t+2},c.prototype.writeInt16BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=255&e,t+2},c.prototype.writeInt32LE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4},c.prototype.writeInt32BE=function(e,t,n){return e=+e,t>>>=0,n||L(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e,t+4},c.prototype.writeBigInt64LE=J((function(e,t=0){return P(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeBigInt64BE=J((function(e,t=0){return D(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))})),c.prototype.writeFloatLE=function(e,t,n){return U(this,e,t,!0,n)},c.prototype.writeFloatBE=function(e,t,n){return U(this,e,t,!1,n)},c.prototype.writeDoubleLE=function(e,t,n){return V(this,e,t,!0,n)},c.prototype.writeDoubleBE=function(e,t,n){return V(this,e,t,!1,n)},c.prototype.copy=function(e,t,n,r){if(!c.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);const i=r-n;return this===e&&"function"===typeof Uint8Array.prototype.copyWithin?this.copyWithin(t,n,r):Uint8Array.prototype.set.call(e,this.subarray(n,r),t),i},c.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!c.isEncoding(r))throw new TypeError("Unknown encoding: "+r);if(1===e.length){const t=e.charCodeAt(0);("utf8"===r&&t<128||"latin1"===r)&&(e=t)}}else"number"===typeof e?e&=255:"boolean"===typeof e&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;let i;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(i=t;i<n;++i)this[i]=e;else{const s=c.isBuffer(e)?e:c.from(e,r),o=s.length;if(0===o)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(i=0;i<n-t;++i)this[i+t]=s[i%o]}return this};const F={};function j(e,t,n){F[e]=class extends n{constructor(){super(),Object.defineProperty(this,"message",{value:t.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${e}]`,this.stack,delete this.name}get code(){return e}set code(e){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:e,writable:!0})}toString(){return`${this.name} [${e}]: ${this.message}`}}}function B(e){let t="",n=e.length;const r="-"===e[0]?1:0;for(;n>=r+4;n-=3)t=`_${e.slice(n-3,n)}${t}`;return`${e.slice(0,n)}${t}`}function z(e,t,n,r,i,s){if(e>n||e<t){const r="bigint"===typeof t?"n":"";let i;throw i=s>3?0===t||t===BigInt(0)?`>= 0${r} and < 2${r} ** ${8*(s+1)}${r}`:`>= -(2${r} ** ${8*(s+1)-1}${r}) and < 2 ** ${8*(s+1)-1}${r}`:`>= ${t}${r} and <= ${n}${r}`,new F.ERR_OUT_OF_RANGE("value",i,e)}!function(e,t,n){q(t,"offset"),void 0!==e[t]&&void 0!==e[t+n]||$(t,e.length-(n+1))}(r,i,s)}function q(e,t){if("number"!==typeof e)throw new F.ERR_INVALID_ARG_TYPE(t,"number",e)}function $(e,t,n){if(Math.floor(e)!==e)throw q(e,n),new F.ERR_OUT_OF_RANGE(n||"offset","an integer",e);if(t<0)throw new F.ERR_BUFFER_OUT_OF_BOUNDS;throw new F.ERR_OUT_OF_RANGE(n||"offset",`>= ${n?1:0} and <= ${t}`,e)}j("ERR_BUFFER_OUT_OF_BOUNDS",(function(e){return e?`${e} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"}),RangeError),j("ERR_INVALID_ARG_TYPE",(function(e,t){return`The "${e}" argument must be of type number. Received type ${typeof t}`}),TypeError),j("ERR_OUT_OF_RANGE",(function(e,t,n){let r=`The value of "${e}" is out of range.`,i=n;return Number.isInteger(n)&&Math.abs(n)>2**32?i=B(String(n)):"bigint"===typeof n&&(i=String(n),(n>BigInt(2)**BigInt(32)||n<-(BigInt(2)**BigInt(32)))&&(i=B(i)),i+="n"),r+=` It must be ${t}. Received ${i}`,r}),RangeError);const K=/[^+/0-9A-Za-z-_]/g;function G(e,t){let n;t=t||1/0;const r=e.length;let i=null;const s=[];for(let o=0;o<r;++o){if(n=e.charCodeAt(o),n>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&s.push(239,191,189);continue}if(o+1===r){(t-=3)>-1&&s.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&s.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&s.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;s.push(n)}else if(n<2048){if((t-=2)<0)break;s.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;s.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;s.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return s}function H(e){return r.toByteArray(function(e){if((e=(e=e.split("=")[0]).trim().replace(K,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function W(e,t,n,r){let i;for(i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}function X(e,t){return e instanceof t||null!=e&&null!=e.constructor&&null!=e.constructor.name&&e.constructor.name===t.name}function Q(e){return e!==e}const Y=function(){const e="0123456789abcdef",t=new Array(256);for(let n=0;n<16;++n){const r=16*n;for(let i=0;i<16;++i)t[r+i]=e[n]+e[i]}return t}();function J(e){return"undefined"===typeof BigInt?Z:e}function Z(){throw new Error("BigInt not supported")}},80645:function(e,t){t.read=function(e,t,n,r,i){var s,o,a=8*i-r-1,c=(1<<a)-1,u=c>>1,l=-7,h=n?i-1:0,d=n?-1:1,f=e[t+h];for(h+=d,s=f&(1<<-l)-1,f>>=-l,l+=a;l>0;s=256*s+e[t+h],h+=d,l-=8);for(o=s&(1<<-l)-1,s>>=-l,l+=r;l>0;o=256*o+e[t+h],h+=d,l-=8);if(0===s)s=1-u;else{if(s===c)return o?NaN:1/0*(f?-1:1);o+=Math.pow(2,r),s-=u}return(f?-1:1)*o*Math.pow(2,s-r)},t.write=function(e,t,n,r,i,s){var o,a,c,u=8*s-i-1,l=(1<<u)-1,h=l>>1,d=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:s-1,p=r?1:-1,m=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(a=isNaN(t)?1:0,o=l):(o=Math.floor(Math.log(t)/Math.LN2),t*(c=Math.pow(2,-o))<1&&(o--,c*=2),(t+=o+h>=1?d/c:d*Math.pow(2,1-h))*c>=2&&(o++,c/=2),o+h>=l?(a=0,o=l):o+h>=1?(a=(t*c-1)*Math.pow(2,i),o+=h):(a=t*Math.pow(2,h-1)*Math.pow(2,i),o=0));i>=8;e[n+f]=255&a,f+=p,a/=256,i-=8);for(o=o<<i|a,u+=i;u>0;e[n+f]=255&o,f+=p,o/=256,u-=8);e[n+f-p]|=128*m}},6840:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/_app",function(){return n(77452)}])},63759:function(e,t,n){"use strict";n.d(t,{Z:function(){return s}});var r=n(67294),i={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const s=(e,t)=>{const n=(0,r.forwardRef)(((n,s)=>{let{color:o="currentColor",size:a=24,strokeWidth:c=2,absoluteStrokeWidth:u,children:l,...h}=n;return(0,r.createElement)("svg",{ref:s,...i,width:a,height:a,stroke:o,strokeWidth:u?24*Number(c)/Number(a):c,className:"lucide lucide-".concat((d=e,d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase())),...h},[...t.map((e=>{let[t,n]=e;return(0,r.createElement)(t,n)})),...(Array.isArray(l)?l:[l])||[]]);var d}));return n.displayName="".concat(e),n}},43765:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});const r=(0,n(63759).Z)("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]])},60493:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});const r=(0,n(63759).Z)("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["polyline",{points:"22 4 12 14.01 9 11.01",key:"6xbx8j"}]])},74598:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});const r=(0,n(63759).Z)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]])},62190:function(e,t,n){"use strict";n.d(t,{Z:function(){return r}});const r=(0,n(63759).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},38199:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{ACTION_FAST_REFRESH:function(){return a},ACTION_NAVIGATE:function(){return r},ACTION_PREFETCH:function(){return o},ACTION_REFRESH:function(){return n},ACTION_RESTORE:function(){return i},ACTION_SERVER_ACTION:function(){return c},ACTION_SERVER_PATCH:function(){return s},PrefetchCacheEntryStatus:function(){return l},PrefetchKind:function(){return u},isThenable:function(){return h}});const n="refresh",r="navigate",i="restore",s="server-patch",o="prefetch",a="fast-refresh",c="server-action";var u,l;function h(e){return e&&("object"===typeof e||"function"===typeof e)&&"function"===typeof e.then}!function(e){e.AUTO="auto",e.FULL="full",e.TEMPORARY="temporary"}(u||(u={})),function(e){e.fresh="fresh",e.reusable="reusable",e.expired="expired",e.stale="stale"}(l||(l={})),("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&"undefined"===typeof t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},87195:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"getDomainLocale",{enumerable:!0,get:function(){return r}});n(98337);function r(e,t,n,r){return!1}("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&"undefined"===typeof t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},98342:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"default",{enumerable:!0,get:function(){return b}});const r=n(38754),i=n(85893),s=r._(n(67294)),o=n(36075),a=n(53955),c=n(48041),u=n(99903),l=n(65490),h=n(81928),d=n(60257),f=n(84229),p=n(87195),m=n(89470),g=n(38199),y=new Set;function v(e,t,n,r,i,s){if(!s&&!(0,a.isLocalURL)(t))return;if(!r.bypassPrefetchedCheck){const i="undefined"!==typeof r.locale?r.locale:"locale"in e?e.locale:void 0,s=t+"%"+n+"%"+i;if(y.has(s))return;y.add(s)}(async()=>s?e.prefetch(t,i):e.prefetch(t,n,r))().catch((e=>{0}))}function w(e){return"string"===typeof e?e:(0,c.formatUrl)(e)}const b=s.default.forwardRef((function(e,t){let n;const{href:r,as:c,children:y,prefetch:b=null,passHref:_,replace:E,shallow:I,scroll:T,locale:k,onClick:S,onMouseEnter:A,onTouchStart:C,legacyBehavior:N=!1,...R}=e;n=y,!N||"string"!==typeof n&&"number"!==typeof n||(n=(0,i.jsx)("a",{children:n}));const O=s.default.useContext(h.RouterContext),x=s.default.useContext(d.AppRouterContext),L=null!=O?O:x,P=!O,D=!1!==b,M=null===b?g.PrefetchKind.AUTO:g.PrefetchKind.FULL;const{href:U,as:V}=s.default.useMemo((()=>{if(!O){const e=w(r);return{href:e,as:c?w(c):e}}const[e,t]=(0,o.resolveHref)(O,r,!0);return{href:e,as:c?(0,o.resolveHref)(O,c):t||e}}),[O,r,c]),F=s.default.useRef(U),j=s.default.useRef(V);let B;N&&(B=s.default.Children.only(n));const z=N?B&&"object"===typeof B&&B.ref:t,[q,$,K]=(0,f.useIntersection)({rootMargin:"200px"}),G=s.default.useCallback((e=>{j.current===V&&F.current===U||(K(),j.current=V,F.current=U),q(e),z&&("function"===typeof z?z(e):"object"===typeof z&&(z.current=e))}),[V,z,U,K,q]);s.default.useEffect((()=>{L&&$&&D&&v(L,U,V,{locale:k},{kind:M},P)}),[V,U,$,k,D,null==O?void 0:O.locale,L,P,M]);const H={ref:G,onClick(e){N||"function"!==typeof S||S(e),N&&B.props&&"function"===typeof B.props.onClick&&B.props.onClick(e),L&&(e.defaultPrevented||function(e,t,n,r,i,o,c,u,l){const{nodeName:h}=e.currentTarget;if("A"===h.toUpperCase()&&(function(e){const t=e.currentTarget.getAttribute("target");return t&&"_self"!==t||e.metaKey||e.ctrlKey||e.shiftKey||e.altKey||e.nativeEvent&&2===e.nativeEvent.which}(e)||!l&&!(0,a.isLocalURL)(n)))return;e.preventDefault();const d=()=>{const e=null==c||c;"beforePopState"in t?t[i?"replace":"push"](n,r,{shallow:o,locale:u,scroll:e}):t[i?"replace":"push"](r||n,{scroll:e})};l?s.default.startTransition(d):d()}(e,L,U,V,E,I,T,k,P))},onMouseEnter(e){N||"function"!==typeof A||A(e),N&&B.props&&"function"===typeof B.props.onMouseEnter&&B.props.onMouseEnter(e),L&&(!D&&P||v(L,U,V,{locale:k,priority:!0,bypassPrefetchedCheck:!0},{kind:M},P))},onTouchStart:function(e){N||"function"!==typeof C||C(e),N&&B.props&&"function"===typeof B.props.onTouchStart&&B.props.onTouchStart(e),L&&(!D&&P||v(L,U,V,{locale:k,priority:!0,bypassPrefetchedCheck:!0},{kind:M},P))}};if((0,u.isAbsoluteUrl)(V))H.href=V;else if(!N||_||"a"===B.type&&!("href"in B.props)){const e="undefined"!==typeof k?k:null==O?void 0:O.locale,t=(null==O?void 0:O.isLocaleDomain)&&(0,p.getDomainLocale)(V,e,null==O?void 0:O.locales,null==O?void 0:O.domainLocales);H.href=t||(0,m.addBasePath)((0,l.addLocale)(V,e,null==O?void 0:O.defaultLocale))}return N?s.default.cloneElement(B,H):(0,i.jsx)("a",{...R,...H,children:n})}));("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&"undefined"===typeof t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},84229:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"useIntersection",{enumerable:!0,get:function(){return u}});const r=n(67294),i=n(84474),s="function"===typeof IntersectionObserver,o=new Map,a=[];function c(e,t,n){const{id:r,observer:i,elements:s}=function(e){const t={root:e.root||null,margin:e.rootMargin||""},n=a.find((e=>e.root===t.root&&e.margin===t.margin));let r;if(n&&(r=o.get(n),r))return r;const i=new Map,s=new IntersectionObserver((e=>{e.forEach((e=>{const t=i.get(e.target),n=e.isIntersecting||e.intersectionRatio>0;t&&n&&t(n)}))}),e);return r={id:t,observer:s,elements:i},a.push(t),o.set(t,r),r}(n);return s.set(e,t),i.observe(e),function(){if(s.delete(e),i.unobserve(e),0===s.size){i.disconnect(),o.delete(r);const e=a.findIndex((e=>e.root===r.root&&e.margin===r.margin));e>-1&&a.splice(e,1)}}}function u(e){let{rootRef:t,rootMargin:n,disabled:o}=e;const a=o||!s,[u,l]=(0,r.useState)(!1),h=(0,r.useRef)(null),d=(0,r.useCallback)((e=>{h.current=e}),[]);(0,r.useEffect)((()=>{if(s){if(a||u)return;const e=h.current;if(e&&e.tagName){return c(e,(e=>e&&l(e)),{root:null==t?void 0:t.current,rootMargin:n})}}else if(!u){const e=(0,i.requestIdleCallback)((()=>l(!0)));return()=>(0,i.cancelIdleCallback)(e)}}),[a,n,t,u,h.current]);const f=(0,r.useCallback)((()=>{l(!1)}),[]);return[d,u,f]}("function"===typeof t.default||"object"===typeof t.default&&null!==t.default)&&"undefined"===typeof t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},72577:function(e,t,n){"use strict";n.d(t,{QC:function(){return b},dN:function(){return h},Pg:function(){return c},_4:function(){return m},pj:function(){return g},uj:function(){return y},DZ:function(){return d},SB:function(){return l},eP:function(){return u},GX:function(){return s}});var r=n(85893),i=n(67294);const s=e=>{let{href:t,children:n}=e;return(0,r.jsx)("a",{href:t,className:"sr-only focus:not-sr-only focus:absolute focus:top-4 focus:left-4 focus:z-50 focus:px-4 focus:py-2 focus:bg-primary-600 focus:text-white focus:rounded-md focus:shadow-lg transition-all duration-200",children:n})},o=e=>{let{children:t,isActive:n,onEscape:s}=e;const[o,a]=(0,i.useState)(null);return(0,i.useEffect)((()=>{if(!n||!o)return;const e=o.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),t=e[0],r=e[e.length-1],i=e=>{"Escape"===e.key&&s?s():"Tab"===e.key&&(e.shiftKey?document.activeElement===t&&(r.focus(),e.preventDefault()):document.activeElement===r&&(t.focus(),e.preventDefault()))};return document.addEventListener("keydown",i),null===t||void 0===t||t.focus(),()=>{document.removeEventListener("keydown",i)}}),[n,o,s]),(0,r.jsx)("div",{ref:a,children:t})},a=()=>{const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=window.matchMedia("(prefers-reduced-motion: reduce)");t(e.matches);const n=e=>{t(e.matches)};return e.addEventListener("change",n),()=>e.removeEventListener("change",n)}),[]),e},c=(0,i.forwardRef)(((e,t)=>{let{label:n,error:i,hint:s,required:o,className:c="",id:u,...l}=e;const h=u||"input-".concat(Math.random().toString(36).substr(2,9)),d="".concat(h,"-error"),f="".concat(h,"-hint"),p=a();return(0,r.jsxs)("div",{className:"space-y-1 ".concat(c),children:[(0,r.jsxs)("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700",children:[n,o&&(0,r.jsx)("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),s&&(0,r.jsx)("p",{id:f,className:"text-sm text-gray-500",children:s}),(0,r.jsx)("input",{ref:t,id:h,"aria-describedby":i?d:s?f:void 0,"aria-invalid":!!i,"aria-required":o,className:"\n            block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400\n            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\n            ".concat(i?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300","\n            ").concat(p?"":"transition-colors duration-200","\n            sm:text-sm\n          "),...l}),i&&(0,r.jsx)("p",{id:d,className:"text-sm text-red-600",role:"alert",children:i})]})}));c.displayName="AccessibleInput";const u=(0,i.forwardRef)(((e,t)=>{let{label:n,error:i,hint:s,required:o,className:c="",id:u,...l}=e;const h=u||"textarea-".concat(Math.random().toString(36).substr(2,9)),d="".concat(h,"-error"),f="".concat(h,"-hint"),p=a();return(0,r.jsxs)("div",{className:"space-y-1 ".concat(c),children:[(0,r.jsxs)("label",{htmlFor:h,className:"block text-sm font-medium text-gray-700",children:[n,o&&(0,r.jsx)("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),s&&(0,r.jsx)("p",{id:f,className:"text-sm text-gray-500",children:s}),(0,r.jsx)("textarea",{ref:t,id:h,"aria-describedby":i?d:s?f:void 0,"aria-invalid":!!i,"aria-required":o,className:"\n            block w-full px-3 py-2 border rounded-md shadow-sm placeholder-gray-400\n            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\n            ".concat(i?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300","\n            ").concat(p?"":"transition-colors duration-200","\n            sm:text-sm resize-vertical min-h-[80px]\n          "),...l}),i&&(0,r.jsx)("p",{id:d,className:"text-sm text-red-600",role:"alert",children:i})]})}));u.displayName="AccessibleTextarea";const l=(0,i.forwardRef)(((e,t)=>{let{label:n,error:i,hint:s,required:o,options:c,className:u="",id:l,...h}=e;const d=l||"select-".concat(Math.random().toString(36).substr(2,9)),f="".concat(d,"-error"),p="".concat(d,"-hint"),m=a();return(0,r.jsxs)("div",{className:"space-y-1 ".concat(u),children:[(0,r.jsxs)("label",{htmlFor:d,className:"block text-sm font-medium text-gray-700",children:[n,o&&(0,r.jsx)("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),s&&(0,r.jsx)("p",{id:p,className:"text-sm text-gray-500",children:s}),(0,r.jsx)("select",{ref:t,id:d,"aria-describedby":i?f:s?p:void 0,"aria-invalid":!!i,"aria-required":o,className:"\n            block w-full px-3 py-2 border rounded-md shadow-sm\n            focus:outline-none focus:ring-2 focus:ring-primary-500 focus:border-primary-500\n            ".concat(i?"border-red-300 focus:ring-red-500 focus:border-red-500":"border-gray-300","\n            ").concat(m?"":"transition-colors duration-200","\n            sm:text-sm bg-white\n          "),...h,children:c.map((e=>(0,r.jsx)("option",{value:e.value,disabled:e.disabled,children:e.label},e.value)))}),i&&(0,r.jsx)("p",{id:f,className:"text-sm text-red-600",role:"alert",children:i})]})}));l.displayName="AccessibleSelect";const h=(0,i.forwardRef)(((e,t)=>{let{label:n,error:i,hint:s,className:o="",id:c,...u}=e;const l=c||"checkbox-".concat(Math.random().toString(36).substr(2,9)),h="".concat(l,"-error"),d="".concat(l,"-hint"),f=a();return(0,r.jsxs)("div",{className:"space-y-1 ".concat(o),children:[(0,r.jsxs)("div",{className:"flex items-start",children:[(0,r.jsx)("input",{ref:t,id:l,type:"checkbox","aria-describedby":i?h:s?d:void 0,"aria-invalid":!!i,className:"\n              h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded\n              ".concat(f?"":"transition-colors duration-200","\n            "),...u}),(0,r.jsx)("label",{htmlFor:l,className:"ml-2 block text-sm text-gray-700 cursor-pointer",children:n})]}),s&&(0,r.jsx)("p",{id:d,className:"text-sm text-gray-500 ml-6",children:s}),i&&(0,r.jsx)("p",{id:h,className:"text-sm text-red-600 ml-6",role:"alert",children:i})]})}));h.displayName="AccessibleCheckbox";const d=e=>{let{name:t,label:n,options:i,value:s,error:o,hint:c,required:u,onChange:l,className:h=""}=e;const d="radio-group-".concat(Math.random().toString(36).substr(2,9)),f="".concat(d,"-error"),p="".concat(d,"-hint"),m=a();return(0,r.jsxs)("fieldset",{className:"space-y-1 ".concat(h),children:[(0,r.jsxs)("legend",{className:"block text-sm font-medium text-gray-700",children:[n,u&&(0,r.jsx)("span",{className:"text-red-500 ml-1","aria-label":"required",children:"*"})]}),c&&(0,r.jsx)("p",{id:p,className:"text-sm text-gray-500",children:c}),(0,r.jsx)("div",{className:"space-y-2",children:i.map((e=>{const n="".concat(d,"-").concat(e.value);return(0,r.jsxs)("div",{className:"flex items-center",children:[(0,r.jsx)("input",{id:n,name:t,type:"radio",value:e.value,checked:s===e.value,disabled:e.disabled,onChange:e=>null===l||void 0===l?void 0:l(e.target.value),"aria-describedby":o?f:c?p:void 0,className:"\n                  h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300\n                  ".concat(m?"":"transition-colors duration-200","\n                ")}),(0,r.jsx)("label",{htmlFor:n,className:"ml-2 block text-sm cursor-pointer ".concat(e.disabled?"text-gray-400":"text-gray-700"),children:e.label})]},e.value)}))}),o&&(0,r.jsx)("p",{id:f,className:"text-sm text-red-600",role:"alert",children:o})]})};var f=n(41664),p=n.n(f);const m=e=>{let{trigger:t,children:n,isOpen:s,onToggle:c,onClose:u,placement:l="bottom-left",className:h=""}=e;const d=(0,i.useRef)(null),f=(0,i.useRef)(null),{isKeyboardMode:p}=(()=>{const[e,t]=(0,i.useState)(!1);return(0,i.useEffect)((()=>{const e=e=>{"Tab"===e.key&&t(!0)},n=()=>{t(!1)};return document.addEventListener("keydown",e),document.addEventListener("mousedown",n),()=>{document.removeEventListener("keydown",e),document.removeEventListener("mousedown",n)}}),[]),{isKeyboardMode:e}})(),m=a();(0,i.useEffect)((()=>{if(!s)return;const e=e=>{var t;"Escape"===e.key&&(u(),null===(t=f.current)||void 0===t||t.focus())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[s,u]),(0,i.useEffect)((()=>{if(!s)return;const e=e=>{d.current&&!d.current.contains(e.target)&&f.current&&!f.current.contains(e.target)&&u()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[s,u]);return(0,r.jsxs)("div",{className:"relative ".concat(h),children:[(0,r.jsx)("button",{ref:f,onClick:c,"aria-expanded":s,"aria-haspopup":"menu",className:"\n          focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2 rounded-md\n          ".concat(p?"focus:ring-offset-2":"","\n          ").concat(m?"":"transition-all duration-200","\n        "),children:t}),s&&(0,r.jsx)(o,{isActive:s,onEscape:u,children:(0,r.jsx)("div",{ref:d,role:"menu","aria-label":"Menu",className:"\n              absolute z-50 w-56 bg-white border border-gray-200 rounded-md shadow-lg\n              ".concat({"bottom-left":"top-full left-0 mt-1","bottom-right":"top-full right-0 mt-1","top-left":"bottom-full left-0 mb-1","top-right":"bottom-full right-0 mb-1"}[l],"\n              ").concat(m?"":"animate-in fade-in-0 zoom-in-95","\n            "),children:n})})]})},g=e=>{let{children:t,onClick:n,href:i,disabled:s=!1,className:o=""}=e;const c=a(),u=()=>{!s&&n&&n()},l=(0,r.jsx)("div",{role:"menuitem",tabIndex:s?-1:0,onClick:u,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),u())},className:"\n        px-4 py-2 text-sm cursor-pointer focus:outline-none focus:bg-primary-50\n        ".concat(s?"text-gray-400 cursor-not-allowed":"text-gray-700 hover:bg-gray-50 focus:text-primary-700","\n        ").concat(c?"":"transition-colors duration-150","\n        ").concat(o,"\n      "),"aria-disabled":s,children:t});return i&&!s?(0,r.jsx)(p(),{href:i,passHref:!0,children:l}):l},y=e=>{let{isOpen:t,onClose:n,title:s,children:c,size:u="md",className:l=""}=e;const h=(0,i.useRef)(null),d=a();(0,i.useEffect)((()=>{var e;t?(document.body.style.overflow="hidden",null===(e=h.current)||void 0===e||e.focus()):document.body.style.overflow="unset";return()=>{document.body.style.overflow="unset"}}),[t]);return t?(0,r.jsx)("div",{role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",className:"fixed inset-0 z-50 overflow-y-auto",onKeyDown:e=>{"Escape"===e.key&&n()},children:(0,r.jsxs)("div",{className:"flex items-center justify-center min-h-screen px-4 pt-4 pb-20 text-center sm:block sm:p-0",children:[(0,r.jsx)("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:n}),(0,r.jsx)(o,{isActive:t,onEscape:n,children:(0,r.jsxs)("div",{ref:h,tabIndex:-1,className:"\n              inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all\n              ".concat({sm:"max-w-md",md:"max-w-lg",lg:"max-w-2xl",xl:"max-w-4xl"}[u],"\n              ").concat(d?"":"sm:my-8 sm:align-middle","\n              ").concat(l,"\n            "),children:[(0,r.jsx)("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:(0,r.jsx)("div",{className:"sm:flex sm:items-start",children:(0,r.jsxs)("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full",children:[(0,r.jsx)("h3",{id:"modal-title",className:"text-lg leading-6 font-medium text-gray-900",children:s}),(0,r.jsx)("div",{className:"mt-4",children:c})]})})}),(0,r.jsx)("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:(0,r.jsx)("button",{type:"button",onClick:n,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-primary-600 text-base font-medium text-white hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-primary-500 sm:ml-3 sm:w-auto sm:text-sm",children:"Close"})})]})})]})}):null};n(11163);const v={highContrast:!1,reducedMotion:!1,largeText:!1,focusVisible:!0,skipLinks:!0,screenReaderOptimized:!1,announcePageChanges:!0,colorScheme:"default",preferredLanguage:"en",simplifyContent:!1},w=(0,i.createContext)(void 0),b=e=>{let{children:t,initialSettings:n={}}=e;const[s,o]=(0,i.useState)({...v,...n});(0,i.useEffect)((()=>{{const t=localStorage.getItem("accessibility-settings");if(t)try{const e=JSON.parse(t);o((t=>({...t,...e})))}catch(e){}}}),[]),(0,i.useEffect)((()=>{localStorage.setItem("accessibility-settings",JSON.stringify(s))}),[s]),(0,i.useEffect)((()=>{const e=document.documentElement;s.highContrast?e.classList.add("high-contrast"):e.classList.remove("high-contrast"),s.reducedMotion?e.classList.add("reduced-motion"):e.classList.remove("reduced-motion"),s.largeText?e.classList.add("large-text"):e.classList.remove("large-text"),s.screenReaderOptimized?e.classList.add("sr-optimized"):e.classList.remove("sr-optimized"),e.setAttribute("data-color-scheme",s.colorScheme),s.focusVisible?e.classList.add("focus-visible"):e.classList.remove("focus-visible")}),[s]);const a={settings:s,updateSetting:(e,t)=>{o((n=>({...n,[e]:t})))},resetSettings:()=>{o(v)},isHighContrast:s.highContrast,isReducedMotion:s.reducedMotion,isLargeText:s.largeText,isScreenReaderOptimized:s.screenReaderOptimized};return(0,r.jsx)(w.Provider,{value:a,children:t})}},5248:function(e,t,n){"use strict";n.d(t,{Ko:function(){return h},L9:function(){return u},MB:function(){return a},Z0:function(){return c},cY:function(){return o},dW:function(){return s},k5:function(){return d},xP:function(){return l}});var r=n(49089);const i="G-XXXXXXXXXX",s={USER_LOGIN:"user_login",USER_LOGOUT:"user_logout",USER_REGISTER:"user_register",PAGE_VIEW:"page_view",NAVIGATION:"navigation",FAMILY_MEMBER_VIEW:"family_member_view",FAMILY_UPDATE_POST:"family_update_post",FAMILY_ANNOUNCEMENT_READ:"family_announcement_read",COURSE_START:"course_start",COURSE_COMPLETE:"course_complete",LESSON_VIEW:"lesson_view",QUIZ_ATTEMPT:"quiz_attempt",QUIZ_COMPLETE:"quiz_complete",PROJECT_VIEW:"project_view",PROJECT_UPDATE:"project_update",BUSINESS_PLAN_VIEW:"business_plan_view",CAREER_PATH_VIEW:"career_path_view",TEMPLATE_DOWNLOAD:"template_download",TEMPLATE_USE:"template_use",TOOL_USAGE:"tool_usage",ACHIEVEMENT_UNLOCK:"achievement_unlock",BADGE_EARN:"badge_earn",LEVEL_UP:"level_up",LEADERBOARD_VIEW:"leaderboard_view",MESSAGE_SEND:"message_send",NOTIFICATION_CLICK:"notification_click",CONTACT_VIEW:"contact_view",BETA_TEST_START:"beta_test_start",BETA_TEST_COMPLETE:"beta_test_complete",FEEDBACK_SUBMIT:"feedback_submit",SEARCH_PERFORM:"search_perform",CONTENT_SHARE:"content_share",BOOK_DOWNLOAD:"book_download",ERROR_OCCURRED:"error_occurred",PERFORMANCE_METRIC:"performance_metric",FEATURE_USAGE:"feature_usage"},o={USER_ROLE:"user_role",LANGUAGE:"language",FAMILY_BRANCH:"family_branch",USER_LEVEL:"user_level",SESSION_DURATION:"session_duration"},a=()=>{if(i){r.ZP.initialize(i,{gtagOptions:{custom_map:{[o.USER_ROLE]:"dimension1",[o.LANGUAGE]:"dimension2",[o.FAMILY_BRANCH]:"dimension3",[o.USER_LEVEL]:"dimension4",[o.SESSION_DURATION]:"dimension5"}}});const s=localStorage.getItem("user");if(s)try{var e,t;const n=JSON.parse(s);r.ZP.set({user_id:n.id,[o.USER_ROLE]:n.role,[o.LANGUAGE]:(null===(e=n.preferences)||void 0===e?void 0:e.language)||"en",[o.USER_LEVEL]:(null===(t=n.gamification)||void 0===t?void 0:t.level)||1})}catch(n){}}},c=(e,t)=>{i&&r.ZP.send({hitType:"pageview",page:e,title:t||document.title})},u=(e,t,n,s,o)=>{i&&r.ZP.event(e,{category:t,label:n,value:s,...o})},l=e=>{i&&r.ZP.set(e)},h=function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"performance",s=arguments.length>3?arguments[3]:void 0;i&&r.ZP.event("timing_complete",{name:e,value:t,event_category:n,event_label:s})},d=function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];i&&r.ZP.event("exception",{description:e,fatal:t})}},97042:function(e,t,n){"use strict";n.d(t,{I8:function(){return v},db:function(){return w},Fw:function(){return b}});var r=n(33310);(0,r.KN)("firebase","12.3.0","app");var i=n(2353),s=n(99724),o=n(16689),a=n(99711),c=n(75);const u="functions";a.ZR;class l{constructor(e,t,n,i){this.app=e,this.auth=null,this.messaging=null,this.appCheck=null,this.serverAppAppCheckToken=null,(0,r.rh)(e)&&e.settings.appCheckToken&&(this.serverAppAppCheckToken=e.settings.appCheckToken),this.auth=t.getImmediate({optional:!0}),this.messaging=n.getImmediate({optional:!0}),this.auth||t.get().then((e=>this.auth=e),(()=>{})),this.messaging||n.get().then((e=>this.messaging=e),(()=>{})),this.appCheck||i?.get().then((e=>this.appCheck=e),(()=>{}))}async getAuthToken(){if(this.auth)try{const e=await this.auth.getToken();return e?.accessToken}catch(e){return}}async getMessagingToken(){if(this.messaging&&"Notification"in self&&"granted"===Notification.permission)try{return await this.messaging.getToken()}catch(e){return}}async getAppCheckToken(e){if(this.serverAppAppCheckToken)return this.serverAppAppCheckToken;if(this.appCheck){const t=e?await this.appCheck.getLimitedUseToken():await this.appCheck.getToken();return t.error?null:t.token}return null}async getContext(e){return{authToken:await this.getAuthToken(),messagingToken:await this.getMessagingToken(),appCheckToken:await this.getAppCheckToken(e)}}}const h="us-central1";class d{constructor(e,t,n,r,i=h,s=((...e)=>fetch(...e))){this.app=e,this.fetchImpl=s,this.emulatorOrigin=null,this.contextProvider=new l(e,t,n,r),this.cancelAllRequests=new Promise((e=>{this.deleteService=()=>Promise.resolve(e())}));try{const e=new URL(i);this.customDomain=e.origin+("/"===e.pathname?"":e.pathname),this.region=h}catch(o){this.customDomain=null,this.region=i}}_delete(){return this.deleteService()}_url(e){const t=this.app.options.projectId;if(null!==this.emulatorOrigin){return`${this.emulatorOrigin}/${t}/${this.region}/${e}`}return null!==this.customDomain?`${this.customDomain}/${e}`:`https://${this.region}-${t}.cloudfunctions.net/${e}`}}const f="@firebase/functions",p="0.13.1";var m;(0,r.Xd)(new c.wA(u,((e,{instanceIdentifier:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("auth-internal"),i=e.getProvider("messaging-internal"),s=e.getProvider("app-check-internal");return new d(n,r,i,s,t)}),"PUBLIC").setMultipleInstances(!0)),(0,r.KN)(f,p,m),(0,r.KN)(f,p,"esm2020");const g={apiKey:"AIzaSyD_pRVkeVzciCPowxsj44NRVlbyZvFPueI",authDomain:"lifecv-d2724.web.app",projectId:"lifecv-d2724",storageBucket:"lifecv-d2724.firebasestorage.app",messagingSenderId:"1039752653127",appId:"1:1039752653127:web:54afa09b21c98ef231c462"};let y;y=0===(0,r.C6)().length?(0,r.ZF)(g):(0,r.C6)()[0];const v=(0,i.v0)(y),w=(0,s.ad)(y);(0,o.cF)(y),function(e=(0,r.Mq)(),t=h){const n=(0,r.qX)((0,a.m9)(e),u).getImmediate({identifier:t}),i=(0,a.P0)("functions");i&&function(e,t,n){!function(e,t,n){const r=(0,a.Xx)(t);e.emulatorOrigin=`http${r?"s":""}://${t}:${n}`,r&&((0,a.Uo)(e.emulatorOrigin+"/backends"),(0,a.dp)("Functions",!0))}((0,a.m9)(e),t,n)}(n,...i)}(y);const b=null},60837:function(e,t,n){"use strict";n.d(t,{H:function(){return g},a:function(){return y}});var r,i=n(85893),s=n(67294),o=n(2353),a=n(99724),c=n(97042),u=n(34155);const l=(0,s.createContext)(void 0),h=new o.hJ;h.setCustomParameters({prompt:"select_account"});const d=(null===(r="spiceinc@gmail.com,zenzxru@gmail.com,kwakhomdeni@gmail.com,tina@salatiso.com,mdenit21@gmail.com,visasande@gmail.com,mdenivisa@gmail.com,sazisimdeni@gmail.com,milandep.mdeni@gmail.com,milamdeni@gmail.com,azoramdeni@gmail.com,mdeninotembac@gmail.com")?void 0:r.split(","))||["spiceinc@gmail.com","zenzxru@gmail.com","kwakhomdeni@gmail.com","tina@salatiso.com","mdenit21@gmail.com","visasande@gmail.com","mdenivisa@gmail.com","sazisimdeni@gmail.com","milandep.mdeni@gmail.com","milamdeni@gmail.com","azoramdeni@gmail.com","mdeninotembac@gmail.com"],f=(u.env.NEXT_PUBLIC_AUTH_DEBUG,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n]});f("Auth Debug - Environment:","production"),f("Auth Debug - Authorized Emails:",d),f("Auth Debug - Env Variable:","spiceinc@gmail.com,zenzxru@gmail.com,kwakhomdeni@gmail.com,tina@salatiso.com,mdenit21@gmail.com,visasande@gmail.com,mdenivisa@gmail.com,sazisimdeni@gmail.com,milandep.mdeni@gmail.com,milamdeni@gmail.com,azoramdeni@gmail.com,mdeninotembac@gmail.com");const p=e=>{const t=e.toLowerCase();return t.includes("salatiso")?"founder":t.includes("visasande")?"parent_company_lead":t.includes("solo")?"youth_member":t.includes("tina")||t.includes("kwakho")?"general_family_member":"guest"},m=e=>{const t=e.toLowerCase().trim(),n=d.some((e=>e.toLowerCase().trim()===t));return f("Email authorization check:",{email:t,authorizedEmails:d,isAuthorized:n,environment:"production"}),n},g=e=>{let{children:t}=e;const[n,r]=(0,s.useState)(null),[u,g]=(0,s.useState)(null),[y,v]=(0,s.useState)(!0),w=async e=>{try{const t=(0,a.JU)(c.db,"family_codes",e),n=await(0,a.QT)(t);if(!n.exists())return!1;const r=n.data();return r.active&&(!r.expiresAt||r.expiresAt.toDate()>new Date)}catch(t){return!1}},b=async e=>{try{const t=(0,a.JU)(c.db,"emergency_codes",e),n=await(0,a.QT)(t);if(!n.exists())return!1;const r=n.data();return r.active&&r.expiresAt.toDate()>new Date}catch(t){return!1}};(0,s.useEffect)((()=>{const e=(0,o.Aj)(c.I8,(async e=>{if(f("\ud83d\udd04 Auth state changed:",(null===e||void 0===e?void 0:e.email)||"No user"),e){if(!m(e.email))return f("\u274c User email not authorized:",e.email),await(0,o.w7)(c.I8),g(null),r(null),v(!1),void alert("Your email ("+e.email+") is not authorized. Please contact the administrator.\n\nAuthorized emails: "+d.join(", "));try{f("\u2705 Email authorized, initializing user profile for:",e.email);const t=await(async e=>{const t=(0,a.JU)(c.db,"users",e.uid),n=await(0,a.QT)(t);if(n.exists()){var r,i;const t=n.data();return{...t,id:e.uid,createdAt:(null===(r=t.createdAt)||void 0===r?void 0:r.toDate())||new Date,lastLogin:(null===(i=t.lastLogin)||void 0===i?void 0:i.toDate())||new Date,role:t.role||p(e.email),gamification:t.gamification||{level:1,experiencePoints:0,pointsToNextLevel:100,badges:[],achievements:[],streaks:[],leaderboardRank:0},preferences:t.preferences||{theme:"light",language:"en",notifications:{email:!0,push:!0,projectUpdates:!0,careerMilestones:!0,familyAnnouncements:!0},dashboardLayout:[],gamificationEnabled:!0}}}{const n={email:e.email,displayName:e.displayName||"",photoURL:e.photoURL||void 0,role:p(e.email),createdAt:new Date,lastLogin:new Date,preferences:{theme:"light",language:"en",notifications:{email:!0,push:!0,projectUpdates:!0,careerMilestones:!0,familyAnnouncements:!0},dashboardLayout:[],gamificationEnabled:!0},gamification:{level:1,experiencePoints:0,pointsToNextLevel:100,badges:[],achievements:[],streaks:[],leaderboardRank:0,trustScore:{overall:50,ecosystem:50,family:50,business:50,learning:50,lastUpdated:new Date,factors:[]},achievementCategories:[{id:"ecosystem",name:"Ecosystem Builder",description:"Contributions to the broader Salatiso ecosystem",dimension:"ecosystem",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"family",name:"Family Steward",description:"Family governance and relationship building",dimension:"family",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"business",name:"Business Leader",description:"Business development and entrepreneurial achievements",dimension:"business",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"learning",name:"Lifelong Learner",description:"Continuous learning and skill development",dimension:"learning",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0}]},mniProfile:{userId:e.uid,ownerships:[],contributions:[],eligibility:[],performanceMetrics:[],developmentPlan:{id:"dev-plan-".concat(e.uid),goals:[],timeline:"2025-2026",resources:[],progress:0,reviewDate:new Date(Date.now()+31536e6)},lastAssessment:new Date}};return await(0,a.pl)(t,{...n,createdAt:(0,a.Bt)(),lastLogin:(0,a.Bt)()}),{...n,id:e.uid}}})(e);f("\ud83d\udcdd User profile data:",t),await(async e=>{const t=(0,a.JU)(c.db,"users",e);await(0,a.pl)(t,{lastLogin:(0,a.Bt)()},{merge:!0})})(e.uid),g(e),r(t),f("\u2705 User profile initialized successfully"),v(!1)}catch(t){g(null),r(null),v(!1)}}else f("\ud83d\udc4b User signed out"),g(null),r(null);v(!1)}));return e}),[]);const _={user:n,firebaseUser:u,loading:y,login:async(e,t)=>{if(!m(e))throw new Error("Unauthorized email address. Access is restricted to family members.");v(!0);try{await(0,o.e5)(c.I8,e,t)}catch(n){throw v(!1),n}},loginWithGoogle:async()=>{v(!0);try{await(0,o.rh)(c.I8,h);v(!1)}catch(e){if(v(!1),"auth/popup-closed-by-user"===e.code)return;throw alert("Sign-in failed: "+e.message),e}},loginWithFamilyCode:async e=>{v(!0);try{if(!(await w(e)))throw new Error("Invalid family verification code");const t={id:"family_".concat(Date.now()),email:"family@salatiso.com",displayName:"Family Member",role:"general_family_member",createdAt:new Date,lastLogin:new Date,preferences:{theme:"light",language:"en",notifications:{email:!1,push:!1,projectUpdates:!0,careerMilestones:!1,familyAnnouncements:!0},dashboardLayout:[],gamificationEnabled:!0},gamification:{level:1,experiencePoints:0,pointsToNextLevel:100,badges:[],achievements:[],streaks:[],leaderboardRank:0,trustScore:{overall:50,ecosystem:50,family:50,business:50,learning:50,lastUpdated:new Date,factors:[]},achievementCategories:[{id:"ecosystem",name:"Ecosystem Builder",description:"Contributions to the broader Salatiso ecosystem",dimension:"ecosystem",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"family",name:"Family Steward",description:"Family governance and relationship building",dimension:"family",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"business",name:"Business Leader",description:"Business development and entrepreneurial achievements",dimension:"business",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"learning",name:"Lifelong Learner",description:"Continuous learning and skill development",dimension:"learning",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0}]},mniProfile:{userId:u.uid,ownerships:[],contributions:[],eligibility:[],performanceMetrics:[],developmentPlan:{id:"dev-plan-".concat(u.uid),goals:[],timeline:"2025-2026",resources:[],progress:0,reviewDate:new Date(Date.now()+31536e6)},lastAssessment:new Date},familyCode:e,accessLevel:"family"};r(t),v(!1)}catch(t){throw v(!1),t}},loginWithMNI:async(e,t)=>{v(!0);try{const n=(0,a.JU)(c.db,"mni_business",e),i=await(0,a.QT)(n);if(!i.exists())throw new Error("Invalid MNI business ID");const s=i.data();if(s.accessCode!==t)throw new Error("Invalid MNI access code");const o={id:"mni_".concat(e,"_").concat(Date.now()),email:"business@".concat(e,".mni.com"),displayName:s.name||"MNI Business User",role:"business_member",createdAt:new Date,lastLogin:new Date,preferences:{theme:"light",language:"en",notifications:{email:!0,push:!0,projectUpdates:!0,careerMilestones:!0,familyAnnouncements:!1},dashboardLayout:[],gamificationEnabled:!1},gamification:{level:1,experiencePoints:0,pointsToNextLevel:100,badges:[],achievements:[],streaks:[],leaderboardRank:0,trustScore:{overall:50,ecosystem:50,family:50,business:50,learning:50,lastUpdated:new Date,factors:[]},achievementCategories:[{id:"ecosystem",name:"Ecosystem Builder",description:"Contributions to the broader Salatiso ecosystem",dimension:"ecosystem",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"family",name:"Family Steward",description:"Family governance and relationship building",dimension:"family",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"business",name:"Business Leader",description:"Business development and entrepreneurial achievements",dimension:"business",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"learning",name:"Lifelong Learner",description:"Continuous learning and skill development",dimension:"learning",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0}]},mniProfile:{userId:u.uid,ownerships:[],contributions:[],eligibility:[],performanceMetrics:[],developmentPlan:{id:"dev-plan-".concat(u.uid),goals:[],timeline:"2025-2026",resources:[],progress:0,reviewDate:new Date(Date.now()+31536e6)},lastAssessment:new Date},businessId:e,accessLevel:"business"};r(o),v(!1)}catch(n){throw v(!1),n}},loginWithEmergencyCode:async e=>{v(!0);try{if(!(await b(e)))throw new Error("Invalid emergency access code");const t={id:"emergency_".concat(Date.now()),email:"emergency@salatiso.com",displayName:"Emergency Access",role:"emergency_access",createdAt:new Date,lastLogin:new Date,preferences:{theme:"light",language:"en",notifications:{email:!1,push:!1,projectUpdates:!1,careerMilestones:!1,familyAnnouncements:!1},dashboardLayout:[],gamificationEnabled:!1},gamification:{level:1,experiencePoints:0,pointsToNextLevel:100,badges:[],achievements:[],streaks:[],leaderboardRank:0,trustScore:{overall:50,ecosystem:50,family:50,business:50,learning:50,lastUpdated:new Date,factors:[]},achievementCategories:[{id:"ecosystem",name:"Ecosystem Builder",description:"Contributions to the broader Salatiso ecosystem",dimension:"ecosystem",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"family",name:"Family Steward",description:"Family governance and relationship building",dimension:"family",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"business",name:"Business Leader",description:"Business development and entrepreneurial achievements",dimension:"business",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0},{id:"learning",name:"Lifelong Learner",description:"Continuous learning and skill development",dimension:"learning",totalPoints:0,unlockedAchievements:[],availableAchievements:[],progress:0}]},mniProfile:{userId:u.uid,ownerships:[],contributions:[],eligibility:[],performanceMetrics:[],developmentPlan:{id:"dev-plan-".concat(u.uid),goals:[],timeline:"2025-2026",resources:[],progress:0,reviewDate:new Date(Date.now()+31536e6)},lastAssessment:new Date},emergencyCode:e,accessLevel:"emergency"};r(t),v(!1)}catch(t){throw v(!1),t}},register:async(e,t,n)=>{if(!m(e))throw new Error("Unauthorized email address. Access is restricted to family members.");v(!0);try{const{user:n}=await(0,o.Xb)(c.I8,e,t)}catch(r){throw v(!1),r}},logout:async()=>{v(!0);try{await(0,o.w7)(c.I8)}catch(e){throw v(!1),e}},updateUserProfile:async e=>{if(!n)return;const t=(0,a.JU)(c.db,"users",n.id);await(0,a.pl)(t,e,{merge:!0}),r((t=>({...t,...e})))},validateFamilyCode:w,validateEmergencyCode:b,getAuthLayers:()=>{const e=["primary"];return(null===n||void 0===n?void 0:n.familyCode)&&e.push("family"),(null===n||void 0===n?void 0:n.businessId)&&e.push("business"),(null===n||void 0===n?void 0:n.emergencyCode)&&e.push("emergency"),e}};return(0,i.jsx)(l.Provider,{value:_,children:t})},y=()=>{const e=(0,s.useContext)(l);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}},81633:function(e,t,n){"use strict";n.d(t,{$G:function(){return u},bd:function(){return c}});var r=n(85893),i=n(67294);const s={en:{name:"English",flag:"\ud83c\uddec\ud83c\udde7"},xh:{name:"isiXhosa",flag:"\ud83c\uddff\ud83c\udde6"},zu:{name:"isiZulu",flag:"\ud83c\uddff\ud83c\udde6"},af:{name:"Afrikaans",flag:"\ud83c\uddff\ud83c\udde6"},st:{name:"Sesotho",flag:"\ud83c\uddff\ud83c\udde6"},tn:{name:"Setswana",flag:"\ud83c\uddff\ud83c\udde6"},ss:{name:"siSwati",flag:"\ud83c\uddff\ud83c\udde6"},ve:{name:"Tshivenda",flag:"\ud83c\uddff\ud83c\udde6"},ts:{name:"Xitsonga",flag:"\ud83c\uddff\ud83c\udde6"},nr:{name:"isiNdebele",flag:"\ud83c\uddff\ud83c\udde6"},nso:{name:"Sepedi",flag:"\ud83c\uddff\ud83c\udde6"}},o=(0,i.createContext)(void 0),a={en:{common:{loading:"Loading...",error:"Error",success:"Success",save:"Save",cancel:"Cancel",delete:"Delete",edit:"Edit",add:"Add",search:"Search",filter:"Filter",close:"Close",open:"Open",back:"Back",next:"Next",previous:"Previous",home:"Home",about:"About",contact:"Contact",login:"Login",logout:"Logout",welcome:"Welcome"},navigation:{home:"Home",about:"About Us",journey:"Our Journey",training:"Training Academy",kidsZone:"Kids Zone",ecosystem:"Ecosystem",library:"MNI Library (Secure)",contact:"Contact",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Family holding governance for Salatiso ecosystem assets",dashboard:"Dashboard",projects:"Projects",family:"Family",business_plan:"Business Plan",career:"Career Paths",ecosystem:"Ecosystem Apps",learning:"Learning",timeline:"Timeline",lifecv:"LifeCV",simple_dashboard:"Simple Dashboard",login_with_google:"Continue with Google",enter_password:"Enter your password",sign_in:"Sign In",access_denied:"Access denied. Please contact an administrator.",loading:"Loading..."},ecosystem:{title:"Salatiso Ecosystem",subtitle:"Integrated ventures aligned to the Family Value system and Ubuntu governance model.",mission:"All ventures share a central mission: protect and grow family prosperity while transforming the communities we serve. Each product is built with shared components to accelerate time-to-impact.",productLead:"Product Lead",impactSnapshot:"Impact Snapshot",operatingPillars:"Operating Pillars",nextFocus:"Next 12-Month Focus",collaborationRequests:"Collaboration Requests",collaborationDescription:"Teams can submit collaboration ideas, integration requirements, or resource requests using the Family Planning Board. Each request is reviewed weekly by the Ecosystem Steering Committee."},homepage:{hero_title:"Building a Family Legacy Through",hero_subtitle:"Technology & Ubuntu",hero_description:"Mlandeli Notemba Investments is the family holding company behind the Salatiso ecosystem \u2014 consolidating every intellectual property, training asset, and business venture including Sazi Life Academy, Homestead OS, LifeKey, and pending patents.",hero_subtext:"What began as Salatiso.com's books and articles now lives as a family intranet, learning academy, and partner-ready platform that brings the individual story back home under MNI stewardship.",explore_ecosystem:"Explore Our Ecosystem",our_journey:"Our Journey",kids_zone:"Kids Zone",ubuntu_values:"Ubuntu Values",ubuntu_description:"Our foundation is built on Ubuntu philosophy - the belief that our humanity is interconnected and that we achieve our full potential through community and mutual support.",family_first:"Family First Approach",family_description:"Every decision, product, and partnership prioritizes family prosperity and multi-generational legacy building.",innovation_driven:"Innovation Driven",innovation_description:"We leverage cutting-edge technology to solve real problems for families and communities across South Africa.",impact_focused:"Impact Focused",impact_description:"Our ventures are designed to create measurable positive change in education, economic empowerment, and community development."}},xh:{common:{loading:"Iyalayisha...",error:"Impazamo",success:"Impumelelo",save:"Gcina",cancel:"Rhoxisa",delete:"Cima",edit:"Hlela",add:"Yongeza",search:"Khangela",filter:"Hlula",close:"Vala",open:"Vula",back:"Buyela",next:"Okulandelayo",previous:"Okwangaphambili",home:"Ikhaya",about:"Ngathi",contact:"Qhagamshelana",login:"Ngena",logout:"Phuma",welcome:"Wamkelekile"},navigation:{home:"Ikhaya",about:"Ngathi",journey:"Uhambo Lwethu",training:"IAkademi yoQeqesho",kidsZone:"Indawo Yabantwana",ecosystem:"I-Ecosystem",library:"Ithala leencwadi le-MNI (Likhethekileyo)",contact:"Qhagamshelana",intranet:"I-MNI Intranet"},intranet:{title:"I-MNI Intranet",subtitle:"Ulawulo losapho oluphethe iiasethi zeSalatiso",dashboard:"Idashboard",projects:"Iiprojekthi",family:"Usapho",business_plan:"Isicwangciso Seshishini",career:"Iindlela Zomsebenzi",ecosystem:"Ii-Ecosystem Apps",learning:"Ukufunda",timeline:"Ixesha",lifecv:"I-LifeCV",simple_dashboard:"Idashboard Elula",login_with_google:"Qhubeka nge-Google",enter_password:"Ngenisa ipasiwedi yakho",sign_in:"Ngena",access_denied:"Akuvumelekanga ukungena. Nceda uqhagamshelane nomphathi.",loading:"Iyalayisha..."},ecosystem:{title:"I-Salatiso Ecosystem",subtitle:"Amashishini adityanisiweyo anxamene nenkqubo yamaXabiso oSapho kunye nenqubo ye-Ubuntu.",mission:"Onke amashishini abelana ngenjongo ephambili: ukukhusela nokukhulisa impumelelo yosapho ngelixa siguqula uluntu esilusebenzayo. Yonke imveliso yakhelwe ngamacandelo abelanayo ukukhawulezisa ixesha lempembelelo.",productLead:"Umntu okhokelayo kwiMveliso",impactSnapshot:"Umfanekiso weMpembelelo",operatingPillars:"Iintsika Zokusebenza",nextFocus:"Ugxininiso Lweenyanga ezi-12 Ezilandelayo",collaborationRequests:"Izicelo Zentsebenziswano",collaborationDescription:"Amaqela angathumela izimvo zentsebenziswano, iimfuno zomanyano, okanye izicelo zezixhobo sebenzisa iBhodi yoCwangciso loSapho. Isicelo ngasinye siphononongwa veki le ngamaLungu eBhodi yoLawulo lwe-Ecosystem."}},zu:{common:{loading:"Iyalayisha...",error:"Iphutha",success:"Impumelelo",save:"Londoloza",cancel:"Khansela",delete:"Susa",edit:"Hlela",add:"Engeza",search:"Sesha",filter:"Hlushela",close:"Vala",open:"Vula",back:"Emuva",next:"Okulandelayo",previous:"Okwangaphambili",home:"Ikhaya",about:"Ngathi",contact:"Thintana",login:"Ngena",logout:"Phuma",welcome:"Siyakwamukela"},navigation:{home:"Ikhaya",about:"Ngathi",journey:"Uhambo Lwethu",training:"I-Akademi yoQeqesho",kidsZone:"Indawo Yezingane",ecosystem:"I-Ecosystem",library:"Umtapo Wezincwadi we-MNI (Okuvikelekile)",contact:"Thintana",intranet:"I-MNI Intranet"},intranet:{title:"I-MNI Intranet",subtitle:"Ukuphathwa komndeni ophethe izimpahla zeSalatiso",dashboard:"Idashboard",projects:"Amaphrojekthi",family:"Umndeni",business_plan:"Uhlelo Lwebhizinisi",career:"Izindlela Zemisebenzi",ecosystem:"Izinhlelo Zokusebenza Ze-Ecosystem",learning:"Ukufunda",timeline:"Isikhathi",lifecv:"I-LifeCV",simple_dashboard:"Idashboard Elula",login_with_google:"Qhubeka nge-Google",enter_password:"Faka iphasiwedi yakho",sign_in:"Ngena",access_denied:"Akuvunyelwe ukungena. Sicela uxhumane nomphathi.",loading:"Iyalayisha..."},ecosystem:{title:"I-Salatiso Ecosystem",subtitle:"Amabhizinisi ahlanganisiwe ahambisana nohlelo Lwamanani omndeni kanye nenqubo ye-Ubuntu.",mission:"Wonke amabhizinisi abelana ngenjongo eyodwa: ukuvikela nokukhulisa impumelelo yomndeni kuyilapho siguqula imiphakathi esisebenza kuyo. Umkhiqizo ngamunye wakhiwe ngezingxenye ezabelwana ukusheshisa isikhathi sempembelelo.",productLead:"Umholi Womkhiqizo",impactSnapshot:"Isithombe Sempembelelo",operatingPillars:"Izinsika Zokusebenza",nextFocus:"Ukugxila Kwezinyanga ezi-12 Ezilandelayo",collaborationRequests:"Izicelo Zokuhlanganyela",collaborationDescription:"Amathimba angathinta imibono yokuhlanganyela, izidingo zokuhlanganisa, noma izicelo zezinsiza besebenzisa iBhodi Lohlelo Lomndeni. Isicelo ngasinye sibuyekezwa masonto wonke yiKomiti Yohlelo lwe-Ecosystem."}},af:{common:{loading:"Laai...",error:"Fout",success:"Sukses",save:"Stoor",cancel:"Kanselleer",delete:"Verwyder",edit:"Redigeer",add:"Voeg by",search:"Soek",filter:"Filter",close:"Sluit",open:"Maak oop",back:"Terug",next:"Volgende",previous:"Vorige",home:"Tuis",about:"Oor ons",contact:"Kontak",login:"Aanmeld",logout:"Afmeld",welcome:"Welkom"},navigation:{home:"Tuis",about:"Oor Ons",journey:"Ons Reis",training:"Opleidingsakademie",kidsZone:"Kindersone",ecosystem:"Ekosisteem",library:"MNI Biblioteek (Beveilig)",contact:"Kontak",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Familiehoumaatskappy-bestuur van Salatiso-bates",dashboard:"Paneelbord",projects:"Projekte",family:"Familie",business_plan:"Besigheidsplan",career:"Loopbaanpaaie",ecosystem:"Ekosisteem Apps",learning:"Leer",timeline:"Tydlyn",lifecv:"LifeCV",simple_dashboard:"Eenvoudige Paneelbord",login_with_google:"Gaan voort met Google",enter_password:"Voer jou wagwoord in",sign_in:"Meld aan",access_denied:"Toegang geweier. Kontak asseblief 'n administrateur.",loading:"Laai..."},ecosystem:{title:"Salatiso Ekosisteem",subtitle:"Ge\xefntegreerde ondernemings wat aangepas is by die Familie Waardestelsel en Ubuntu bestuurmodel.",mission:"Alle ondernemings deel 'n sentrale missie: beskerm en groei familie welvaart terwyl ons die gemeenskappe wat ons bedien transformeer. Elke produk is gebou met gedeelde komponente om tyd-tot-impak te versnel.",productLead:"Produk Leier",impactSnapshot:"Impak Oorsig",operatingPillars:"Bedryfs Pilare",nextFocus:"Volgende 12-Maand Fokus",collaborationRequests:"Samewerkingsversoeke",collaborationDescription:"Spanne kan samewerkingsidees, integrasievereistes, of hulpbronversoeke indien deur die Familie Beplanningsbord te gebruik. Elke versoek word weekliks hersien deur die Ekosisteem Stuurkomitee."}},st:{common:{loading:"E laela...",error:"Phoso",success:"Katleho",save:"Boloka",cancel:"Hlakola",delete:"Hlakola",edit:"Fetola",add:"Kenyelletsa",search:"Batla",filter:"Kgetha",close:"Koala",open:"Bula",back:"Kgutlela",next:"Latelang",previous:"Pele",home:"Hae",about:"Ka rona",contact:"Ikopanye",login:"Kena",logout:"Tswa",welcome:"O amohelehile"},navigation:{home:"Hae",about:"Ka Rona",journey:"Leeto la Rona",training:"Akademi ya Koetliso",kidsZone:"Sebaka sa Bana",ecosystem:"Ecosystem",library:"Laeborari ya MNI (E sireletsweng)",contact:"Ikopanye",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Puso ya lelapa e okametseng matlotlo a Salatiso",dashboard:"Dashboard",projects:"Merero",family:"Lelapa",business_plan:"Leano la Kgwebo",career:"Ditsela tsa Mosebetsi",ecosystem:"Di-App tsa Ecosystem",learning:"Ho Ithuta",timeline:"Nako",lifecv:"LifeCV",simple_dashboard:"Dashboard e Bonolo",login_with_google:"Tsoela pele ka Google",enter_password:"Kenya password ya hao",sign_in:"Kena",access_denied:"Phihlello e hanotswe. Ka kopo ikopanye le motsamaisi.",loading:"E laela..."},ecosystem:{title:"Salatiso Ecosystem",subtitle:"Dikgwebo tse kopaneng tse lumellanang le tsamaiso ya Boleng ba Lelapa le mokgwa wa puso wa Ubuntu.",mission:"Dikgwebo tsohle di arolelana morero o le mong: ho sireletsa le ho godisa katleho ya lelapa ha re fetola metse eo re e sebeletsang. Sehlahiswa se seng le se seng se ahilwe ka likarolo tse arolelanoang ho potlakisa nako ya tshusumetso.",productLead:"Moetapele wa Sehlahiswa",impactSnapshot:"Setshwantsho sa Tshusumetso",operatingPillars:"Makgokelo a Ts'ebetso",nextFocus:"Tsepamiso ya Dikgwedi tse 12 tse Tlang",collaborationRequests:"Dikopo tsa Ts'ebelisano",collaborationDescription:"Dihlopha di ka romela maikutlo a ts'ebelisano, ditlhoko tsa kopano, kapa dikopo tsa mehlodi ho sebelisa Board ya Moralo wa Lelapa. Kopo e nngwe le e nngwe e hlahlojwa beke le beke ke Komiti ya Tataiso ya Ecosystem."}},tn:{common:{loading:"Go laela...",error:"Phoso",success:"Katlego",save:"Boloka",cancel:"Khansela",delete:"Phimola",edit:"Baakanya",add:"Oketsa",search:"Batla",filter:"Tlhopha",close:"Tswala",open:"Bula",back:"Boela",next:"Go latelang",previous:"Pele",home:"Gae",about:"Ka rona",contact:"Ikgolagane",login:"Tsena",logout:"Tswa",welcome:"O amogeletswe"},navigation:{home:"Gae",about:"Ka Rona",journey:"Loeto lwa Rona",training:"Akademi ya Koetliso",kidsZone:"Lefelo la Bana",ecosystem:"Ecosystem",library:"Laeborari ya MNI (E sireleditswe)",contact:"Ikgolagane",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Puso ya lelapa e okametseng dithoto tsa Salatiso",dashboard:"Dashboard",projects:"Diphrojeke",family:"Lelapa",business_plan:"Leano la Kgwebo",career:"Ditsela tsa Tiro",ecosystem:"Di-App tsa Ecosystem",learning:"Go Ithuta",timeline:"Nako",lifecv:"LifeCV",simple_dashboard:"Dashboard e e Bonolo",login_with_google:"Tswelela ka Google",enter_password:"Tsenya password ya gago",sign_in:"Tsena",access_denied:"Phitlhelelo e gannetswe. Ka kopo ikgolagane le motsamaisi.",loading:"Go laela..."},ecosystem:{title:"Salatiso Ecosystem",subtitle:"Dikgwebo tse di kopantsweng tse di tsamaisanang le tsamaiso ya Boleng jwa Lelapa le mokgwa wa puso wa Ubuntu.",mission:"Dikgwebo tsotlhe di abelana maikaelelo a le mongwe: go sireletsa le go godisa katlego ya lelapa fa re fetola dit\u0161haba tse re di direlang. Setlhagiswa se seng le se seng se agilwe ka dikarolo tse di abelanang go potlakisa nako ya tshusumetso.",productLead:"Moetapele wa Setlhagiswa",impactSnapshot:"Setshwantsho sa Tshusumetso",operatingPillars:"Mekgokgotheto ya Tiro",nextFocus:"Nepiso ya Dikgwedi tse 12 tse di Tlang",collaborationRequests:"Dikopo tsa Tirisanommogo",collaborationDescription:"Ditlhopha di ka romela dikakanyo tsa tirisanommogo, ditlhokego tsa kopano, goba dikopo tsa dithoto ka go dirisa Board ya Thulaganyo ya Lelapa. Kopo nngwe le nngwe e tlhatlhobiwa beke le beke ke Komiti ya Kaelo ya Ecosystem."}},ss:{common:{loading:"Kulayisha...",error:"Liphoso",success:"Inhlanhla",save:"Gcina",cancel:"Khansela",delete:"Susa",edit:"Hlela",add:"Engeta",search:"Sesha",filter:"Khetha",close:"Vala",open:"Vula",back:"Buyela",next:"Lokulandzelako",previous:"Kwangaphambili",home:"Ekhaya",about:"Ngakithi",contact:"Thintana",login:"Ngena",logout:"Phuma",welcome:"Uyemukelekile"},navigation:{home:"Ekhaya",about:"Ngakithi",journey:"Luhambo Lwakithi",training:"I-Akademi YeKuqeqesha",kidsZone:"Indzawo YeBantfwana",ecosystem:"I-Ecosystem",library:"Umtapo weMNI (LoVikelekile)",contact:"Thintana",intranet:"I-MNI Intranet"},intranet:{title:"I-MNI Intranet",subtitle:"Kubusa kwemndeni lokuphatha impahla yeSalatiso",dashboard:"I-Dashboard",projects:"Emaphrojekthi",family:"Umndeni",business_plan:"Luhlelo Lwebhizinisi",career:"Tindlela Temisebenzi",ecosystem:"Tini-App te-Ecosystem",learning:"Kufundza",timeline:"Sikhatsi",lifecv:"I-LifeCV",simple_dashboard:"I-Dashboard Lelula",login_with_google:"Chubeka nge-Google",enter_password:"Faka liphasiwedi lakho",sign_in:"Ngena",access_denied:"Kungene akuvunyelwe. Sicela uthintane nemphathi.",loading:"Kulayisha..."}},ve:{common:{loading:"Ri khou laida...",error:"Vhukambi",success:"U wina",save:"Dzhenisa",cancel:"Khansela",delete:"Bvisa",edit:"Lulamisa",add:"Engedza",search:"Toda",filter:"Nanga",close:"Vhala",open:"Bvula",back:"Buyela",next:"Zwo tevhelaho",previous:"Zwa fhamboni",home:"Hayani",about:"Nga hashu",contact:"Kwamana",login:"Pinda",logout:"Buda",welcome:"Ri a ni tanganedza"},navigation:{home:"Hayani",about:"Nga Hashu",journey:"Lwendo Lwashu",training:"Akademi ya Vhudzidzini",kidsZone:"Vhulongo ha Vhana",ecosystem:"Ecosystem",library:"Laibulare ya MNI (Yo Vhulungwaho)",contact:"Kwamana",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Vhulanguli ha mu\u1e71a ho no fha\u1e71a pfuma dza Salatiso",dashboard:"Dashboard",projects:"Phrojeke",family:"Lushaka",business_plan:"Pulani ya Bindu",career:"Ndila dza Mushumo",ecosystem:"Dziapp dza Ecosystem",learning:"U Guda",timeline:"Tshifhinga",lifecv:"LifeCV",simple_dashboard:"Dashboard yo Takalaho",login_with_google:"Itani mbaho nga Google",enter_password:"Dzhenisani phasiwo yanu",sign_in:"Pindani",access_denied:"A si ni tendeli u pinda. Ri humbela uri ni kwamane na mulanguli.",loading:"Ri khou laida..."}},ts:{common:{loading:"Ri layla...",error:"Xihoxo",success:"Ku humelela",save:"Hlayisa",cancel:"Khansela",delete:"Susa",edit:"Lulamisa",add:"Engetela",search:"Lava",filter:"Hlawula",close:"Pfala",open:"Pfula",back:"Buyela",next:"Lexi landzelaka",previous:"Lero nga mungheni",home:"Ekhaya",about:"Hi hina",contact:"Hlanganisa",login:"Nghena",logout:"Huma",welcome:"U amukeriwe"},navigation:{home:"Ekhaya",about:"Hi Hina",journey:"Riendzo ra Hina",training:"Akademi ya Vundzidzisi",kidsZone:"Ndhawu ya Vana",ecosystem:"Ecosystem",library:"Layiburari ya MNI (Yo Sirhelelekile)",contact:"Hlanganisa",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Vulawuri bya ndyangu lebyi hlayisaka switirhisiwa swa Salatiso",dashboard:"Dashboard",projects:"Tiprojeke",family:"Ndyangu",business_plan:"Pulani ya Bindzu",career:"Tindlela ta Ntirho",ecosystem:"Ti-App ta Ecosystem",learning:"Ku Dyondza",timeline:"Nkarhi",lifecv:"LifeCV",simple_dashboard:"Dashboard yo Olova",login_with_google:"Famba-famba hi Google",enter_password:"Nghenisa phasiwordi ya wena",sign_in:"Nghena",access_denied:"Ku nghena a ku pfumeleriwanga. Hi kombela u hlanganisa na mulawuri.",loading:"Ri layla..."}},nr:{common:{loading:"Kuyalayisha...",error:"Iphuthu",success:"Impumelelo",save:"Gcina",cancel:"Rhoxisa",delete:"Susa",edit:"Lungiselela",add:"Engezelela",search:"Funa",filter:"Khetha",close:"Vala",open:"Vula",back:"Buyela",next:"Okulandelako",previous:"Okungaphambili",home:"Ekhaya",about:"Ngathi",contact:"Thintana",login:"Ngena",logout:"Phuma",welcome:"Wamukelekile"},navigation:{home:"Ekhaya",about:"Ngathi",journey:"Uhambo Wethu",training:"I-Akademi yoQeqesho",kidsZone:"Indawo Yezingane",ecosystem:"I-Ecosystem",library:"Ilayibhrari ye-MNI (Evikelekile)",contact:"Thintana",intranet:"I-MNI Intranet"},intranet:{title:"I-MNI Intranet",subtitle:"Ukuphathwa komndeni okuphethe impahla yeSalatiso",dashboard:"I-Dashboard",projects:"Amaphrojekthi",family:"Umndeni",business_plan:"Isicwangciso Sebhizinisi",career:"Izindlela Zemisebenzi",ecosystem:"Ama-App e-Ecosystem",learning:"Ukufunda",timeline:"Isikhathi",lifecv:"I-LifeCV",simple_dashboard:"I-Dashboard Elula",login_with_google:"Qhubeka nge-Google",enter_password:"Faka iphasiwedi yakho",sign_in:"Ngena",access_denied:"Ukungena akuvumelekile. Sicela uthintane nomphathi.",loading:"Kuyalayisha..."}},nso:{common:{loading:"E a laela...",error:"Pho\u0161o",success:"Katlego",save:"Boloka",cancel:"Khanselela",delete:"Pho\u0161olla",edit:"Loki\u0161a",add:"Oket\u0161a",search:"Nyaka",filter:"Kgetha",close:"Tswalela",open:"Bulela",back:"Boela",next:"Se se latelago",previous:"Se se fetilego",home:"Gae",about:"Ka rena",contact:"Ikgokaganye",login:"Tsena",logout:"T\u0161wa",welcome:"O amoget\u0161we"},navigation:{home:"Gae",about:"Ka Rena",journey:"Leeto la Rena",training:"Akademi ya Thupelo",kidsZone:"Lefelo la Bana",ecosystem:"Ecosystem",library:"Laeborari ya MNI (E sireledit\u0161wego)",contact:"Ikgokaganye",intranet:"MNI Intranet"},intranet:{title:"MNI Intranet",subtitle:"Taolo ya lapa yeo e bolokago dithoto t\u0161a Salatiso",dashboard:"Dashboard",projects:"Diprot\u0161eke",family:"Lapa",business_plan:"Leano la Kgwebo",career:"Ditsela t\u0161a Mo\u0161omo",ecosystem:"Di-App t\u0161a Ecosystem",learning:"Go Ithuta",timeline:"Nako",lifecv:"LifeCV",simple_dashboard:"Dashboard ye e Bonolo",login_with_google:"T\u0161wela pele ka Google",enter_password:"Tsenya password ya gago",sign_in:"Tsena",access_denied:"Phihlelelo e gant\u0161it\u0161we. Ka kgopelo ikgokaganye le motsamaisi.",loading:"E a laela..."}}},c=e=>{let{children:t}=e;const[n,c]=(0,i.useState)("en");(0,i.useEffect)((()=>{const e=localStorage.getItem("locale")||"en";c(e)}),[]);return(0,r.jsx)(o.Provider,{value:{locale:n,setLocale:e=>{c(e),localStorage.setItem("locale",e)},t:(e,t)=>{const r=e.split(".");let i=a[n]||a.en;for(const n of r)if(i=null===i||void 0===i?void 0:i[n],void 0===i)break;if(void 0===i){i=a.en;for(const e of r)if(i=null===i||void 0===i?void 0:i[e],void 0===i)break}return i||t||e},languages:s},children:t})},u=()=>{const e=(0,i.useContext)(o);if(!e)throw new Error("useTranslation must be used within an I18nProvider");return e}},18400:function(e,t,n){"use strict";n.d(t,{z:function(){return o}});var r=n(67294),i=n(60837),s=n(5248);const o=()=>{const{user:e}=(0,i.a)();(0,r.useEffect)((()=>{(0,s.MB)()}),[]),(0,r.useEffect)((()=>{var t,n;e&&(0,s.xP)({user_id:e.id,[s.cY.USER_ROLE]:e.role,[s.cY.LANGUAGE]:(null===(t=e.preferences)||void 0===t?void 0:t.language)||"en",[s.cY.USER_LEVEL]:(null===(n=e.gamification)||void 0===n?void 0:n.level)||1})}),[e]);const t=(0,r.useCallback)(((e,t)=>{(0,s.Z0)(e,t)}),[]),n=(0,r.useCallback)((e=>{(0,s.L9)(s.dW.USER_LOGIN,"authentication",e)}),[]),o=(0,r.useCallback)((()=>{(0,s.L9)(s.dW.USER_LOGOUT,"authentication")}),[]),a=(0,r.useCallback)((e=>{(0,s.L9)(s.dW.USER_REGISTER,"authentication",e)}),[]),c=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.NAVIGATION,"navigation","".concat(e," -> ").concat(t))}),[]),u=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.FAMILY_MEMBER_VIEW,"family",t,void 0,{member_id:e})}),[]),l=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.FAMILY_UPDATE_POST,"family",e,void 0,{update_id:t})}),[]),h=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.FAMILY_ANNOUNCEMENT_READ,"announcements",t,void 0,{announcement_id:e})}),[]),d=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.COURSE_START,"learning",t,void 0,{course_id:e})}),[]),f=(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.COURSE_COMPLETE,"learning",t,n,{course_id:e})}),[]),p=(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.LESSON_VIEW,"learning",t,void 0,{lesson_id:e,course_id:n})}),[]),m=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.QUIZ_ATTEMPT,"learning",t,void 0,{quiz_id:e})}),[]),g=(0,r.useCallback)(((e,t,n,r)=>{(0,s.L9)(s.dW.QUIZ_COMPLETE,"learning",t,n,{quiz_id:e,passed:r?1:0})}),[]),y=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.PROJECT_VIEW,"business",t,void 0,{project_id:e})}),[]),v=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.PROJECT_UPDATE,"business",t,void 0,{project_id:e})}),[]),w=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.BUSINESS_PLAN_VIEW,"business",t,void 0,{plan_id:e})}),[]),b=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.CAREER_PATH_VIEW,"business",t,void 0,{path_id:e})}),[]),_=(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.TEMPLATE_DOWNLOAD,"templates",t,void 0,{template_id:e,category:n})}),[]),E=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.TEMPLATE_USE,"templates",t,void 0,{template_id:e})}),[]),I=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.TOOL_USAGE,"tools",e,void 0,{action:t})}),[]),T=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.ACHIEVEMENT_UNLOCK,"gamification",t,void 0,{achievement_id:e})}),[]),k=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.BADGE_EARN,"gamification",t,void 0,{badge_id:e})}),[]),S=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.LEVEL_UP,"gamification","Level ".concat(e),t,{new_level:e,xp_gained:t})}),[]),A=(0,r.useCallback)((()=>{(0,s.L9)(s.dW.LEADERBOARD_VIEW,"gamification")}),[]),C=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.MESSAGE_SEND,"communication",t,void 0,{recipient_id:e})}),[]),N=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.NOTIFICATION_CLICK,"communication",t,void 0,{notification_id:e})}),[]),R=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.CONTACT_VIEW,"communication",t,void 0,{contact_id:e})}),[]),O=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.BETA_TEST_START,"testing",t,void 0,{test_id:e})}),[]),x=(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.BETA_TEST_COMPLETE,"testing",t,n,{test_id:e})}),[]),L=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.FEEDBACK_SUBMIT,"testing",e,t)}),[]),P=(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.SEARCH_PERFORM,"search",e,t,{category:n})}),[]),D=(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.CONTENT_SHARE,"content",t,void 0,{content_id:e,platform:n})}),[]),M=(0,r.useCallback)(((e,t)=>{(0,s.L9)(s.dW.BOOK_DOWNLOAD,"content",t,void 0,{book_id:e})}),[]),U=(0,r.useCallback)(((e,t)=>{(0,s.k5)("".concat(t?"".concat(t,": "):"").concat(e.message))}),[]),V=(0,r.useCallback)((function(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"performance";(0,s.Ko)(e,t,n)}),[]);return{trackPageView:t,trackLogin:n,trackLogout:o,trackRegistration:a,trackNavigation:c,trackFamilyMemberView:u,trackFamilyUpdate:l,trackAnnouncementRead:h,trackCourseStart:d,trackCourseComplete:f,trackLessonView:p,trackQuizAttempt:m,trackQuizComplete:g,trackProjectView:y,trackProjectUpdate:v,trackBusinessPlanView:w,trackCareerPathView:b,trackTemplateDownload:_,trackTemplateUse:E,trackToolUsage:I,trackAchievementUnlock:T,trackBadgeEarn:k,trackLevelUp:S,trackLeaderboardView:A,trackMessageSend:C,trackNotificationClick:N,trackContactView:R,trackBetaTestStart:O,trackBetaTestComplete:x,trackFeedbackSubmit:L,trackSearch:P,trackContentShare:D,trackBookDownload:M,trackError:U,trackPerformance:V,trackFeatureUsage:(0,r.useCallback)(((e,t,n)=>{(0,s.L9)(s.dW.FEATURE_USAGE,"features",e,void 0,{action:t,...n})}),[]),trackSessionStart:(0,r.useCallback)((()=>{(0,s.L9)("session_start","session")}),[]),trackSessionEnd:(0,r.useCallback)((e=>{(0,s.L9)("session_end","session",void 0,e)}),[])}}},77452:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return O}});var r=n(85893),i=(n(80876),n(1768),n(32712),n(9008)),s=n.n(i),o=n(4298),a=n.n(o),c=n(60837),u=n(81633),l=n(86501),h=n(67294);var d=()=>{const{user:e}=(0,c.a)();return(0,h.useEffect)((()=>{e&&Promise.all([n.e(2806),n.e(9616)]).then(n.bind(n,89616)).then((e=>{let{notificationService:t}=e;t.initializeForegroundMessages()}))}),[e]),null},f=n(11163),p=n(18400);var m=()=>{const e=(0,f.useRouter)(),{user:t}=(0,c.a)(),{trackPageView:n,trackSessionStart:r,trackSessionEnd:i}=(0,p.z)();return(0,h.useEffect)((()=>{const t=e=>{n(e)};return e.events.on("routeChangeComplete",t),()=>{e.events.off("routeChangeComplete",t)}}),[e.events,n]),(0,h.useEffect)((()=>{n(e.pathname)}),[e.pathname,n]),(0,h.useEffect)((()=>{let e=Date.now();r();const t=()=>{const t=Date.now()-e;i(t/1e3)},n=()=>{if("hidden"===document.visibilityState){const t=Date.now()-e;i(t/1e3)}else"visible"===document.visibilityState&&(e=Date.now(),r())};return window.addEventListener("beforeunload",t),document.addEventListener("visibilitychange",n),()=>{window.removeEventListener("beforeunload",t),document.removeEventListener("visibilitychange",n)}}),[r,i]),(0,h.useEffect)((()=>{}),[t]),null};class g extends h.Component{static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,t){try{window.gtag&&window.gtag("event","exception",{description:e.message,fatal:!1,custom_map:{error_stack:e.stack,error_component_stack:t.componentStack}})}catch(n){}this.setState({errorInfo:t}),this.props.onError&&this.props.onError(e,t)}render(){return this.state.hasError?this.props.fallback?this.props.fallback:(0,r.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,r.jsxs)("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[(0,r.jsx)("div",{className:"mb-4",children:(0,r.jsx)("svg",{className:"mx-auto h-12 w-12 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,r.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),(0,r.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Something went wrong"}),(0,r.jsx)("p",{className:"text-gray-600 mb-4",children:"We apologize for the inconvenience. Our team has been notified and is working to fix this issue."}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)("button",{onClick:()=>window.location.reload(),className:"w-full bg-primary-600 text-white px-4 py-2 rounded-lg hover:bg-primary-700 transition-colors",children:"Reload Page"}),(0,r.jsx)("button",{onClick:()=>window.history.back(),className:"w-full bg-gray-200 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-300 transition-colors",children:"Go Back"})]}),!1]})}):this.props.children}constructor(e){super(e),this.state={hasError:!1}}}var y=g,v=n(97679),w=n(72577),b=n(60493),_=n(43765),E=n(74598),I=n(62190);let T=[],k=[];function S(){k.forEach((e=>e([...T])))}function A(e){const t="toast-".concat(Date.now(),"-").concat(Math.random()),n={...e,id:t,duration:e.duration||5e3};return T.push(n),S(),n.duration&&n.duration>0&&setTimeout((()=>{T=T.filter((e=>e.id!==t)),S()}),n.duration),t}const C=()=>{const[e,t]=(0,h.useState)([]);(0,h.useEffect)((()=>{const e=e=>{t(e)};return k.push(e),()=>{k=k.filter((t=>t!==e))}}),[]);const n=e=>{T=T.filter((t=>t.id!==e)),S()},i=e=>{switch(e){case"success":return(0,r.jsx)(b.Z,{className:"w-5 h-5"});case"error":case"warning":return(0,r.jsx)(_.Z,{className:"w-5 h-5"});default:return(0,r.jsx)(E.Z,{className:"w-5 h-5"})}},s=e=>{const t="rounded-lg shadow-lg border p-4 flex items-start gap-3";switch(e){case"success":return"".concat(t," bg-green-50 border-green-200 text-green-800");case"error":return"".concat(t," bg-red-50 border-red-200 text-red-800");case"warning":return"".concat(t," bg-yellow-50 border-yellow-200 text-yellow-800");default:return"".concat(t," bg-blue-50 border-blue-200 text-blue-800")}};return(0,r.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-3 max-w-md",children:e.map((e=>(0,r.jsxs)("div",{className:"".concat(s(e.type)," animate-in slide-in-from-top-2 fade-in"),children:[(0,r.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:i(e.type)}),(0,r.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,r.jsx)("p",{className:"font-semibold",children:e.title}),(0,r.jsx)("p",{className:"text-sm opacity-90",children:e.message}),e.action&&(0,r.jsx)("button",{onClick:()=>{var t;null===(t=e.action)||void 0===t||t.onClick(),n(e.id)},className:"mt-2 text-sm font-medium underline hover:no-underline",children:e.action.label})]}),(0,r.jsx)("button",{onClick:()=>n(e.id),className:"flex-shrink-0 opacity-70 hover:opacity-100",children:(0,r.jsx)(I.Z,{className:"w-4 h-4"})})]},e.id)))})};class N{async registerServiceWorker(){if(!("serviceWorker"in navigator))return null;try{const e=await navigator.serviceWorker.register(this.config.serviceWorkerPath,{scope:"/"});return this.serviceWorkerRegistration=e,e.addEventListener("updatefound",(()=>{const t=e.installing;t&&t.addEventListener("statechange",(()=>{"installed"===t.state&&navigator.serviceWorker.controller&&A({type:"info",title:"App Update Available",message:"A new version is ready. Refresh to update.",action:{label:"Refresh",onClick:()=>window.location.reload()}})}))})),e}catch(e){return null}}async requestPermission(){if(!("Notification"in window))return"denied";if("granted"===Notification.permission)return this.config.onPermissionGranted(),"granted";if("denied"===Notification.permission)return this.config.onPermissionDenied(),"denied";try{const e=await Notification.requestPermission();return"granted"===e?this.config.onPermissionGranted():this.config.onPermissionDenied(),e}catch(e){return this.config.onPermissionDenied(),"denied"}}async subscribeToPush(){if(this.serviceWorkerRegistration||await this.registerServiceWorker(),!this.serviceWorkerRegistration)return null;if("granted"!==await this.requestPermission())return null;try{const e=await this.serviceWorkerRegistration.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.config.vapidKey||void 0});return A({type:"success",title:"Notifications Enabled",message:"You will now receive push notifications"}),e}catch(e){return A({type:"error",title:"Notification Setup Failed",message:"Could not enable notifications. Try again later."}),null}}async unsubscribeFromPush(){if(!this.serviceWorkerRegistration)return!1;try{const e=await this.serviceWorkerRegistration.pushManager.getSubscription();if(e)return await e.unsubscribe(),A({type:"info",title:"Notifications Disabled",message:"Push notifications have been turned off"}),!0}catch(e){}return!1}async getSubscription(){if(!this.serviceWorkerRegistration)return null;try{return await this.serviceWorkerRegistration.pushManager.getSubscription()}catch(e){return null}}isSupported(){return"serviceWorker"in navigator&&"Notification"in window}getPermissionStatus(){return"Notification"in window?Notification.permission:"denied"}async enableBackgroundSync(e){if(this.serviceWorkerRegistration||await this.registerServiceWorker(),!this.serviceWorkerRegistration||!("sync"in this.serviceWorkerRegistration))return!1;try{return await this.serviceWorkerRegistration.sync.register(e),!0}catch(t){return!1}}showNotification(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!("Notification"in window))return null;if("granted"!==Notification.permission)return A({type:"info",title:"Enable Notifications",message:"Please enable notifications to receive alerts"}),null;try{const n=new Notification(e,{icon:"/images/icon-192x192.png",badge:"/images/badge-72x72.png",...t});return n.onclick=()=>{window.focus(),n.close()},n}catch(n){return null}}constructor(e={}){this.serviceWorkerRegistration=null,this.config={vapidKey:e.vapidKey||"",serviceWorkerPath:e.serviceWorkerPath||"/sw.js",onPermissionDenied:e.onPermissionDenied||(()=>{}),onPermissionGranted:e.onPermissionGranted||(()=>{})}}}const R=new N;var O=function(e){let{Component:t,pageProps:n}=e;return(0,h.useEffect)((()=>{(0,v.s8)(),R.registerServiceWorker().then((()=>{})),Notification.permission,"serviceWorker"in navigator&&navigator.serviceWorker.controller&&"sync"in navigator.serviceWorker.controller&&(R.enableBackgroundSync("sync-escalations"),R.enableBackgroundSync("sync-notifications"))}),[]),(0,r.jsxs)(y,{children:[(0,r.jsxs)(s(),{children:[(0,r.jsx)("link",{rel:"icon",type:"image/svg+xml",href:"/favicon.svg"}),(0,r.jsx)("link",{rel:"icon",type:"image/png",href:"/favicon.svg"}),(0,r.jsx)("meta",{name:"theme-color",content:"#2563eb"}),(0,r.jsx)("meta",{name:"viewport",content:"width=device-width, initial-scale=1, viewport-fit=cover, maximum-scale=5"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-capable",content:"true"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-status-bar-style",content:"black-translucent"}),(0,r.jsx)("meta",{name:"apple-mobile-web-app-title",content:"Salatiso"}),(0,r.jsx)("link",{rel:"apple-touch-icon",href:"/images/icon-192x192.png"}),(0,r.jsx)("link",{rel:"manifest",href:"/manifest.json"}),(0,r.jsx)("meta",{name:"description",content:"Salatiso - Family & Business Ecosystem. Manage escalations, teams, and analytics with offline support."})]}),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(a(),{src:"https://www.googletagmanager.com/gtag/js?id=".concat("G-XXXXXXXXXX"),strategy:"afterInteractive"}),(0,r.jsx)(a(),{id:"google-analytics",strategy:"afterInteractive",children:"\n              window.dataLayer = window.dataLayer || [];\n              function gtag(){dataLayer.push(arguments);}\n              gtag('js', new Date());\n              gtag('config', '".concat("G-XXXXXXXXXX","', {\n                page_title: document.title,\n                page_location: window.location.href,\n              });\n            ")})]}),(0,r.jsx)(u.bd,{children:(0,r.jsx)(w.QC,{children:(0,r.jsxs)(c.H,{children:[(0,r.jsx)(C,{}),(0,r.jsx)(d,{}),(0,r.jsx)(m,{}),(0,r.jsx)(t,{...n}),(0,r.jsx)(l.x7,{position:"top-right",toastOptions:{duration:4e3,style:{background:"#363636",color:"#fff"}}})]})})})]})}},97679:function(e,t,n){"use strict";n.d(t,{kg:function(){return i},s8:function(){return s}});var r=n(5248);const i=new class{createLogEntry(e,t,n,r){return{level:e,message:t,error:n,context:r,timestamp:(new Date).toISOString(),userId:this.getUserId(),sessionId:this.getSessionId(),url:window.location.href,userAgent:navigator.userAgent}}getUserId(){try{const e=localStorage.getItem("user");if(e){return JSON.parse(e).id}}catch(e){}}getSessionId(){return sessionStorage.getItem("sessionId")||void 0}addLog(e){this.logs.push(e),this.logs.length>this.maxLogs&&this.logs.shift()}error(e,t,n){const i=this.createLogEntry("error",e,t,n);this.addLog(i),(0,r.k5)((null===t||void 0===t?void 0:t.message)||e,!1),this.reportError(i)}warn(e,t){const n=this.createLogEntry("warn",e,void 0,t);this.addLog(n)}info(e,t){const n=this.createLogEntry("info",e,void 0,t);this.addLog(n)}debug(e,t){const n=this.createLogEntry("debug",e,void 0,t);this.addLog(n)}async reportError(e){try{const t=JSON.parse(localStorage.getItem("errorLogs")||"[]");t.push(e),t.length>50&&t.splice(0,t.length-50),localStorage.setItem("errorLogs",JSON.stringify(t))}catch(t){}}getLogs(){return[...this.logs]}clearLogs(){this.logs=[]}exportLogs(){return JSON.stringify(this.logs,null,2)}constructor(){this.logs=[],this.maxLogs=100}},s=()=>{window.addEventListener("unhandledrejection",(e=>{i.error("Unhandled promise rejection",new Error(e.reason),{type:"unhandledrejection",promise:e.promise})})),window.addEventListener("error",(e=>{i.error("Uncaught error",e.error,{type:"uncaughterror",filename:e.filename,lineno:e.lineno,colno:e.colno})})),sessionStorage.getItem("sessionId")||sessionStorage.setItem("sessionId","session_".concat(Date.now(),"_").concat(Math.random().toString(36).substr(2,9)))}},32712:function(){},80876:function(){},1768:function(){},9008:function(e,t,n){e.exports=n(23867)},41664:function(e,t,n){e.exports=n(98342)},11163:function(e,t,n){e.exports=n(43079)},4298:function(e,t,n){e.exports=n(23381)},34155:function(e){var t,n,r=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function o(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"===typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"===typeof clearTimeout?clearTimeout:s}catch(e){n=s}}();var a,c=[],u=!1,l=-1;function h(){u&&a&&(u=!1,a.length?c=a.concat(c):l=-1,c.length&&d())}function d(){if(!u){var e=o(h);u=!0;for(var t=c.length;t;){for(a=c,c=[];++l<t;)a&&a[l].run();l=-1,t=c.length}a=null,u=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function p(){}r.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new f(e,t)),1!==c.length||u||o(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={},r.on=p,r.addListener=p,r.once=p,r.off=p,r.removeListener=p,r.removeAllListeners=p,r.emit=p,r.prependListener=p,r.prependOnceListener=p,r.listeners=function(e){return[]},r.binding=function(e){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(e){throw new Error("process.chdir is not supported")},r.umask=function(){return 0}},49559:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],i=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=e||"";t&&(s=e.toString().trim().replace(/[A-Za-z0-9\u00C0-\u00FF]+[^\s-]*/g,(function(e,t,r){return t>0&&t+e.length!==r.length&&e.search(n)>-1&&":"!==r.charAt(t-2)&&("-"!==r.charAt(t+e.length)||"-"===r.charAt(t-1))&&r.charAt(t-1).search(/[^\s-]/)<0?e.toLowerCase():e.substr(1).search(/[A-Z]|\../)>-1?e:e.charAt(0).toUpperCase()+e.substr(1)})));i&&(s=function(e){if(function(e){return"string"===typeof e&&-1!==e.indexOf("@")}(e))return console.warn("This arg looks like an email address, redacting."),r;return e}(s));return s};var n=/^(a|an|and|as|at|but|by|en|for|if|in|nor|of|on|or|per|the|to|vs?\.?|via)$/i;var r="REDACTED (Potential Email Address)"},41638:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.GA4=void 0;var r=c(n(76161)),i=c(n(49559)),s=["eventCategory","eventAction","eventLabel","eventValue","hitType"],o=["title","location"],a=["page","hitType"];function c(e){return e&&e.__esModule?e:{default:e}}function u(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},s=Object.keys(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(r=0;r<s.length;r++)n=s[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function l(e){return l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l(e)}function h(e){return function(e){if(Array.isArray(e))return g(e)}(e)||function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||m(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){v(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function p(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,i,s,o,a=[],c=!0,u=!1;try{if(s=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=s.call(n)).done)&&(a.push(r.value),a.length!==t);c=!0);}catch(l){u=!0,i=l}finally{try{if(!c&&null!=n.return&&(o=n.return(),Object(o)!==o))return}finally{if(u)throw i}}return a}}(e,t)||m(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function m(e,t){if(e){if("string"===typeof e)return g(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?g(e,t):void 0}}function g(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function y(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,w(r.key),r)}}function v(e,t,n){return(t=w(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function w(e){var t=function(e,t){if("object"!==l(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==l(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===l(t)?t:String(t)}var b=function(){function e(){var t=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),v(this,"reset",(function(){t.isInitialized=!1,t._testMode=!1,t._currentMeasurementId,t._hasLoadedGA=!1,t._isQueuing=!1,t._queueGtag=[]})),v(this,"_gtag",(function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];t._testMode||t._isQueuing?t._queueGtag.push(n):r.default.apply(void 0,n)})),v(this,"_loadGA",(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"https://www.googletagmanager.com/gtag/js";if("undefined"!==typeof window&&"undefined"!==typeof document&&!t._hasLoadedGA){var i=document.createElement("script");i.async=!0,i.src="".concat(r,"?id=").concat(e),n&&i.setAttribute("nonce",n),document.body.appendChild(i),window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)},t._hasLoadedGA=!0}})),v(this,"_toGtagOptions",(function(e){if(e){var t={cookieUpdate:"cookie_update",cookieExpires:"cookie_expires",cookieDomain:"cookie_domain",cookieFlags:"cookie_flags",userId:"user_id",clientId:"client_id",anonymizeIp:"anonymize_ip",contentGroup1:"content_group1",contentGroup2:"content_group2",contentGroup3:"content_group3",contentGroup4:"content_group4",contentGroup5:"content_group5",allowAdFeatures:"allow_google_signals",allowAdPersonalizationSignals:"allow_ad_personalization_signals",nonInteraction:"non_interaction",page:"page_path",hitCallback:"event_callback"};return Object.entries(e).reduce((function(e,n){var r=p(n,2),i=r[0],s=r[1];return t[i]?e[t[i]]=s:e[i]=s,e}),{})}})),v(this,"initialize",(function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!e)throw new Error("Require GA_MEASUREMENT_ID");var r="string"===typeof e?[{trackingId:e}]:e;t._currentMeasurementId=r[0].trackingId;var i=n.gaOptions,s=n.gtagOptions,o=n.nonce,a=n.testMode,c=void 0!==a&&a,u=n.gtagUrl;if(t._testMode=c,c||t._loadGA(t._currentMeasurementId,o,u),t.isInitialized||(t._gtag("js",new Date),r.forEach((function(e){var n=f(f(f({},t._toGtagOptions(f(f({},i),e.gaOptions))),s),e.gtagOptions);Object.keys(n).length?t._gtag("config",e.trackingId,n):t._gtag("config",e.trackingId)}))),t.isInitialized=!0,!c){var l=h(t._queueGtag);for(t._queueGtag=[],t._isQueuing=!1;l.length;){var d=l.shift();t._gtag.apply(t,h(d)),"get"===d[0]&&(t._isQueuing=!0)}}})),v(this,"set",(function(e){e?"object"===l(e)?(0===Object.keys(e).length&&console.warn("empty `fieldsObject` given to .set()"),t._gaCommand("set",e)):console.warn("Expected `fieldsObject` arg to be an Object"):console.warn("`fieldsObject` is required in .set()")})),v(this,"_gaCommandSendEvent",(function(e,n,r,i,s){t._gtag("event",n,f(f({event_category:e,event_label:r,value:i},s&&{non_interaction:s.nonInteraction}),t._toGtagOptions(s)))})),v(this,"_gaCommandSendEventParameters",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if("string"===typeof n[0])t._gaCommandSendEvent.apply(t,h(n.slice(1)));else{var i=n[0],o=i.eventCategory,a=i.eventAction,c=i.eventLabel,l=i.eventValue,d=(i.hitType,u(i,s));t._gaCommandSendEvent(o,a,c,l,d)}})),v(this,"_gaCommandSendTiming",(function(e,n,r,i){t._gtag("event","timing_complete",{name:n,value:r,event_category:e,event_label:i})})),v(this,"_gaCommandSendPageview",(function(e,n){if(n&&Object.keys(n).length){var r=t._toGtagOptions(n),i=r.title,s=r.location,a=u(r,o);t._gtag("event","page_view",f(f(f(f({},e&&{page_path:e}),i&&{page_title:i}),s&&{page_location:s}),a))}else e?t._gtag("event","page_view",{page_path:e}):t._gtag("event","page_view")})),v(this,"_gaCommandSendPageviewParameters",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if("string"===typeof n[0])t._gaCommandSendPageview.apply(t,h(n.slice(1)));else{var i=n[0],s=i.page,o=(i.hitType,u(i,a));t._gaCommandSendPageview(s,o)}})),v(this,"_gaCommandSend",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i="string"===typeof n[0]?n[0]:n[0].hitType;switch(i){case"event":t._gaCommandSendEventParameters.apply(t,n);break;case"pageview":t._gaCommandSendPageviewParameters.apply(t,n);break;case"timing":t._gaCommandSendTiming.apply(t,h(n.slice(1)));break;case"screenview":case"transaction":case"item":case"social":case"exception":console.warn("Unsupported send command: ".concat(i));break;default:console.warn("Send command doesn't exist: ".concat(i))}})),v(this,"_gaCommandSet",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];"string"===typeof n[0]&&(n[0]=v({},n[0],n[1])),t._gtag("set",t._toGtagOptions(n[0]))})),v(this,"_gaCommand",(function(e){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];switch(e){case"send":t._gaCommandSend.apply(t,r);break;case"set":t._gaCommandSet.apply(t,r);break;default:console.warn("Command doesn't exist: ".concat(e))}})),v(this,"ga",(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];if("string"===typeof n[0])t._gaCommand.apply(t,n);else{var i=n[0];t._gtag("get",t._currentMeasurementId,"client_id",(function(e){t._isQueuing=!1;var n=t._queueGtag;for(i({get:function(n){return"clientId"===n?e:"trackingId"===n?t._currentMeasurementId:"apiVersion"===n?"1":void 0}});n.length;){var r=n.shift();t._gtag.apply(t,h(r))}})),t._isQueuing=!0}return t.ga})),v(this,"event",(function(e,n){if("string"===typeof e)t._gtag("event",e,t._toGtagOptions(n));else{var r=e.action,s=e.category,o=e.label,a=e.value,c=e.nonInteraction,u=e.transport;if(!s||!r)return void console.warn("args.category AND args.action are required in event()");var l={hitType:"event",eventCategory:(0,i.default)(s),eventAction:(0,i.default)(r)};o&&(l.eventLabel=(0,i.default)(o)),"undefined"!==typeof a&&("number"!==typeof a?console.warn("Expected `args.value` arg to be a Number."):l.eventValue=a),"undefined"!==typeof c&&("boolean"!==typeof c?console.warn("`args.nonInteraction` must be a boolean."):l.nonInteraction=c),"undefined"!==typeof u&&("string"!==typeof u?console.warn("`args.transport` must be a string."):(-1===["beacon","xhr","image"].indexOf(u)&&console.warn("`args.transport` must be either one of these values: `beacon`, `xhr` or `image`"),l.transport=u)),t._gaCommand("send",l)}})),v(this,"send",(function(e){t._gaCommand("send",e)})),this.reset()}var t,n,c;return t=e,n=[{key:"gtag",value:function(){this._gtag.apply(this,arguments)}}],n&&y(t.prototype,n),c&&y(t,c),Object.defineProperty(t,"prototype",{writable:!1}),e}();t.GA4=b;var _=new b;t.default=_},76161:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var n=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r;"undefined"!==typeof window&&("undefined"===typeof window.gtag&&(window.dataLayer=window.dataLayer||[],window.gtag=function(){window.dataLayer.push(arguments)}),(r=window).gtag.apply(r,t))};t.default=n},49089:function(e,t,n){"use strict";function r(e){return r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}t.ZP=void 0;var i=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==r(e)&&"function"!==typeof e)return{default:e};var n=s(t);if(n&&n.has(e))return n.get(e);var i={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var a in e)if("default"!==a&&Object.prototype.hasOwnProperty.call(e,a)){var c=o?Object.getOwnPropertyDescriptor(e,a):null;c&&(c.get||c.set)?Object.defineProperty(i,a,c):i[a]=e[a]}i.default=e,n&&n.set(e,i);return i}(n(41638));function s(e){if("function"!==typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(s=function(e){return e?n:t})(e)}i.GA4;var o=i.default;t.ZP=o},33310:function(e,t,n){"use strict";n.d(t,{C6:function(){return S},Jn:function(){return I},KN:function(){return A},Mq:function(){return k},Xd:function(){return y},ZF:function(){return T},qX:function(){return v},rh:function(){return w}});var r=n(75),i=n(44645),s=n(99711),o=n(26531);class a{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===t?.type}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const c="@firebase/app",u="0.14.3",l=new i.Yd("@firebase/app"),h="[DEFAULT]",d={[c]:"fire-core","@firebase/app-compat":"fire-core-compat","@firebase/analytics":"fire-analytics","@firebase/analytics-compat":"fire-analytics-compat","@firebase/app-check":"fire-app-check","@firebase/app-check-compat":"fire-app-check-compat","@firebase/auth":"fire-auth","@firebase/auth-compat":"fire-auth-compat","@firebase/database":"fire-rtdb","@firebase/data-connect":"fire-data-connect","@firebase/database-compat":"fire-rtdb-compat","@firebase/functions":"fire-fn","@firebase/functions-compat":"fire-fn-compat","@firebase/installations":"fire-iid","@firebase/installations-compat":"fire-iid-compat","@firebase/messaging":"fire-fcm","@firebase/messaging-compat":"fire-fcm-compat","@firebase/performance":"fire-perf","@firebase/performance-compat":"fire-perf-compat","@firebase/remote-config":"fire-rc","@firebase/remote-config-compat":"fire-rc-compat","@firebase/storage":"fire-gcs","@firebase/storage-compat":"fire-gcs-compat","@firebase/firestore":"fire-fst","@firebase/firestore-compat":"fire-fst-compat","@firebase/ai":"fire-vertex","fire-js":"fire-js",firebase:"fire-js-all"},f=new Map,p=new Map,m=new Map;function g(e,t){try{e.container.addComponent(t)}catch(n){l.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function y(e){const t=e.name;if(m.has(t))return l.debug(`There were multiple attempts to register component ${t}.`),!1;m.set(t,e);for(const n of f.values())g(n,e);for(const n of p.values())g(n,e);return!0}function v(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function w(e){return null!==e&&void 0!==e&&void 0!==e.settings}const b={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},_=new s.LL("app","Firebase",b);class E{constructor(e,t,n){this._isDeleted=!1,this._options={...e},this._config={...t},this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new r.wA("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw _.create("app-deleted",{appName:this._name})}}const I="12.3.0";function T(e,t={}){let n=e;if("object"!==typeof t){t={name:t}}const i={name:h,automaticDataCollectionEnabled:!0,...t},o=i.name;if("string"!==typeof o||!o)throw _.create("bad-app-name",{appName:String(o)});if(n||(n=(0,s.aH)()),!n)throw _.create("no-options");const a=f.get(o);if(a){if((0,s.vZ)(n,a.options)&&(0,s.vZ)(i,a.config))return a;throw _.create("duplicate-app",{appName:o})}const c=new r.H0(o);for(const r of m.values())c.addComponent(r);const u=new E(n,i,c);return f.set(o,u),u}function k(e=h){const t=f.get(e);if(!t&&e===h&&(0,s.aH)())return T();if(!t)throw _.create("no-app",{appName:e});return t}function S(){return Array.from(f.values())}function A(e,t,n){let i=d[e]??e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void l.warn(e.join(" "))}y(new r.wA(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}const C="firebase-heartbeat-database",N=1,R="firebase-heartbeat-store";let O=null;function x(){return O||(O=(0,o.X3)(C,N,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(R)}catch(n){console.warn(n)}}}).catch((e=>{throw _.create("idb-open",{originalErrorMessage:e.message})}))),O}async function L(e,t){try{const n=(await x()).transaction(R,"readwrite"),r=n.objectStore(R);await r.put(t,P(e)),await n.done}catch(n){if(n instanceof s.ZR)l.warn(n.message);else{const e=_.create("idb-set",{originalErrorMessage:n?.message});l.warn(e.message)}}}function P(e){return`${e.name}!${e.options.appId}`}class D{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new U(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){try{const e=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),t=M();if(null==this._heartbeatsCache?.heartbeats&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats))return;if(this._heartbeatsCache.lastSentHeartbeatDate===t||this._heartbeatsCache.heartbeats.some((e=>e.date===t)))return;if(this._heartbeatsCache.heartbeats.push({date:t,agent:e}),this._heartbeatsCache.heartbeats.length>30){const e=function(e){if(0===e.length)return-1;let t=0,n=e[0].date;for(let r=1;r<e.length;r++)e[r].date<n&&(n=e[r].date,t=r);return t}(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(e,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(e){l.warn(e)}}async getHeartbeatsHeader(){try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==this._heartbeatsCache?.heartbeats||0===this._heartbeatsCache.heartbeats.length)return"";const e=M(),{heartbeatsToSend:t,unsentEntries:n}=function(e,t=1024){const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),V(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),V(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),r=(0,s.L)(JSON.stringify({version:2,heartbeats:t}));return this._heartbeatsCache.lastSentHeartbeatDate=e,n.length>0?(this._heartbeatsCache.heartbeats=n,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),r}catch(e){return l.warn(e),""}}}function M(){return(new Date).toISOString().substring(0,10)}class U{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!(0,s.hl)()&&(0,s.eu)().then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await x()).transaction(R),n=await t.objectStore(R).get(P(e));return await t.done,n}catch(t){if(t instanceof s.ZR)l.warn(t.message);else{const e=_.create("idb-get",{originalErrorMessage:t?.message});l.warn(e.message)}}}(this.app);return e?.heartbeats?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return L(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){if(await this._canUseIndexedDBPromise){const t=await this.read();return L(this.app,{lastSentHeartbeatDate:e.lastSentHeartbeatDate??t.lastSentHeartbeatDate,heartbeats:[...t.heartbeats,...e.heartbeats]})}}}function V(e){return(0,s.L)(JSON.stringify({version:2,heartbeats:e})).length}var F;F="",y(new r.wA("platform-logger",(e=>new a(e)),"PRIVATE")),y(new r.wA("heartbeat",(e=>new D(e)),"PRIVATE")),A(c,u,F),A(c,u,"esm2020"),A("fire-js","")},75:function(e,t,n){"use strict";n.d(t,{H0:function(){return a},wA:function(){return i}});var r=n(99711);class i{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const s="[DEFAULT]";class o{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new r.BH;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){const t=this.normalizeInstanceIdentifier(e?.identifier),n=e?.optional??!1;if(!this.isInitialized(t)&&!this.shouldAutoInitialize()){if(n)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:t})}catch(r){if(n)return null;throw r}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:s})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(e=s){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(e=s){return this.instances.has(e)}getOptions(e=s){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){const n=this.normalizeInstanceIdentifier(t),r=this.onInitCallbacks.get(n)??new Set;r.add(e),this.onInitCallbacks.set(n,r);const i=this.instances.get(n);return i&&e(i,n),()=>{r.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const r of n)try{r(e,t)}catch{}}getOrInitializeService({instanceIdentifier:e,options:t={}}){let n=this.instances.get(e);if(!n&&this.component&&(n=this.component.instanceFactory(this.container,{instanceIdentifier:(r=e,r===s?void 0:r),options:t}),this.instances.set(e,n),this.instancesOptions.set(e,t),this.invokeOnInitCallbacks(n,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,n)}catch{}var r;return n||null}normalizeInstanceIdentifier(e=s){return this.component?this.component.multipleInstances?e:s:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class a{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new o(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}},44645:function(e,t,n){"use strict";n.d(t,{Yd:function(){return u},in:function(){return i}});const r=[];var i;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(i||(i={}));const s={debug:i.DEBUG,verbose:i.VERBOSE,info:i.INFO,warn:i.WARN,error:i.ERROR,silent:i.SILENT},o=i.INFO,a={[i.DEBUG]:"log",[i.VERBOSE]:"log",[i.INFO]:"info",[i.WARN]:"warn",[i.ERROR]:"error"},c=(e,t,...n)=>{if(t<e.logLevel)return;const r=(new Date).toISOString(),i=a[t];if(!i)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);console[i](`[${r}]  ${e.name}:`,...n)};class u{constructor(e){this.name=e,this._logLevel=o,this._logHandler=c,this._userLogHandler=null,r.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in i))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?s[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,i.DEBUG,...e),this._logHandler(this,i.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,i.VERBOSE,...e),this._logHandler(this,i.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,i.INFO,...e),this._logHandler(this,i.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,i.WARN,...e),this._logHandler(this,i.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,i.ERROR,...e),this._logHandler(this,i.ERROR,...e)}}},2353:function(e,t,n){"use strict";n.d(t,{hJ:function(){return Xe},Xb:function(){return ct},v0:function(){return Vn},Aj:function(){return lt},e5:function(){return ut},rh:function(){return Xt},w7:function(){return ht}});var r=n(33310),i=n(99711),s=n(44645),o=n(75);function a(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const c=a,u=new i.LL("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),l=new s.Yd("@firebase/auth");function h(e,...t){l.logLevel<=s.in.ERROR&&l.error(`Auth (${r.Jn}): ${e}`,...t)}function d(e,...t){throw y(e,...t)}function f(e,...t){return y(e,...t)}function p(e,t,n){const r={...c(),[t]:n};return new i.LL("auth","Firebase",r).create(t,{appName:e.name})}function m(e){return p(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function g(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&d(e,"argument-error"),p(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function y(e,...t){if("string"!==typeof e){const n=t[0],r=[...t.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(n,...r)}return u.create(e,...t)}function v(e,t,...n){if(!e)throw y(t,...n)}function w(e){const t="INTERNAL ASSERTION FAILED: "+e;throw h(t),new Error(t)}function b(e,t){e||w(t)}function _(){return"undefined"!==typeof self&&self.location?.href||""}function E(){return"http:"===I()||"https:"===I()}function I(){return"undefined"!==typeof self&&self.location?.protocol||null}class T{constructor(e,t){this.shortDelay=e,this.longDelay=t,b(t>e,"Short delay should be less than long delay!"),this.isMobile=(0,i.uI)()||(0,i.b$)()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(E()||(0,i.ru)()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function k(e,t){b(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class S{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void w("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void w("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void w("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const A={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},C=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],N=new T(3e4,6e4);function R(e,t){return e.tenantId&&!t.tenantId?{...t,tenantId:e.tenantId}:t}async function O(e,t,n,r,s={}){return x(e,s,(async()=>{let s={},o={};r&&("GET"===t?o=r:s={body:JSON.stringify(r)});const a=(0,i.xO)({key:e.config.apiKey,...o}).slice(1),c=await e._getAdditionalHeaders();c["Content-Type"]="application/json",e.languageCode&&(c["X-Firebase-Locale"]=e.languageCode);const u={method:t,headers:c,...s};return(0,i.L_)()||(u.referrerPolicy="no-referrer"),e.emulatorConfig&&(0,i.Xx)(e.emulatorConfig.host)&&(u.credentials="include"),S.fetch()(await P(e,e.config.apiHost,n,a),u)}))}async function x(e,t,n){e._canInitEmulator=!1;const r={...A,...t};try{const t=new M(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw U(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw U(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw U(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw U(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw p(e,a,o);d(e,a)}}catch(s){if(s instanceof i.ZR)throw s;d(e,"network-request-failed",{message:String(s)})}}async function L(e,t,n,r,i={}){const s=await O(e,t,n,r,i);return"mfaPendingCredential"in s&&d(e,"multi-factor-auth-required",{_serverResponse:s}),s}async function P(e,t,n,r){const i=`${t}${n}?${r}`,s=e,o=s.config.emulator?k(e.config,i):`${e.config.apiScheme}://${i}`;if(C.includes(n)&&(await s._persistenceManagerAvailable,"COOKIE"===s._getPersistenceType())){return s._getPersistence()._getFinalTarget(o).toString()}return o}function D(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class M{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(f(this.auth,"network-request-failed"))),N.get())}))}}function U(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=f(e,t,r);return i.customData._tokenResponse=n,i}function V(e){return void 0!==e&&void 0!==e.enterprise}class F{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return D(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function j(e,t){return O(e,"GET","/v2/recaptchaConfig",R(e,t))}async function B(e,t){return O(e,"POST","/v1/accounts:lookup",t)}function z(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function q(e){return 1e3*Number(e)}function $(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return h("JWT malformed, contained fewer than 3 sections"),null;try{const e=(0,i.tV)(n);return e?JSON.parse(e):(h("Failed to decode base64 JWT payload"),null)}catch(s){return h("Caught error parsing JWT payload as JSON",s?.toString()),null}}function K(e){const t=$(e);return v(t,"internal-error"),v("undefined"!==typeof t.exp,"internal-error"),v("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function G(e,t,n=!1){if(n)return t;try{return await t}catch(r){throw r instanceof i.ZR&&function({code:e}){return"auth/user-disabled"===e||"auth/user-token-expired"===e}(r)&&e.auth.currentUser===e&&await e.auth.signOut(),r}}class H{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(this.user.stsTokenManager.expirationTime??0)-Date.now()-3e5;return Math.max(0,e)}}schedule(e=!1){if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===e?.code&&this.schedule(!0))}this.schedule()}}class W{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=z(this.lastLoginAt),this.creationTime=z(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function X(e){const t=e.auth,n=await e.getIdToken(),r=await G(e,B(t,{idToken:n}));v(r?.users.length,t,"internal-error");const i=r.users[0];e._notifyReloadListener(i);const s=i.providerUserInfo?.length?Q(i.providerUserInfo):[],o=(a=e.providerData,c=s,[...a.filter((e=>!c.some((t=>t.providerId===e.providerId)))),...c]);var a,c;const u=e.isAnonymous,l=!(e.email&&i.passwordHash)&&!o?.length,h=!!u&&l,d={uid:i.localId,displayName:i.displayName||null,photoURL:i.photoUrl||null,email:i.email||null,emailVerified:i.emailVerified||!1,phoneNumber:i.phoneNumber||null,tenantId:i.tenantId||null,providerData:o,metadata:new W(i.createdAt,i.lastLoginAt),isAnonymous:h};Object.assign(e,d)}function Q(e){return e.map((({providerId:e,...t})=>({providerId:e,uid:t.rawId||"",displayName:t.displayName||null,email:t.email||null,phoneNumber:t.phoneNumber||null,photoURL:t.photoUrl||null})))}class Y{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){v(e.idToken,"internal-error"),v("undefined"!==typeof e.idToken,"internal-error"),v("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):K(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){v(0!==e.length,"internal-error");const t=K(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e,t=!1){return t||!this.accessToken||this.isExpired?(v(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:s}=await async function(e,t){const n=await x(e,{},(async()=>{const n=(0,i.xO)({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:s}=e.config,o=await P(e,r,"/v1/token",`key=${s}`),a=await e._getAdditionalHeaders();a["Content-Type"]="application/x-www-form-urlencoded";const c={method:"POST",headers:a,body:n};return e.emulatorConfig&&(0,i.Xx)(e.emulatorConfig.host)&&(c.credentials="include"),S.fetch()(o,c)}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(s))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new Y;return n&&(v("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(v("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(v("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Y,this.toJSON())}_performRefresh(){return w("not implemented")}}function J(e,t){v("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class Z{constructor({uid:e,auth:t,stsTokenManager:n,...r}){this.providerId="firebase",this.proactiveRefresh=new H(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=e,this.auth=t,this.stsTokenManager=n,this.accessToken=n.accessToken,this.displayName=r.displayName||null,this.email=r.email||null,this.emailVerified=r.emailVerified||!1,this.phoneNumber=r.phoneNumber||null,this.photoURL=r.photoURL||null,this.isAnonymous=r.isAnonymous||!1,this.tenantId=r.tenantId||null,this.providerData=r.providerData?[...r.providerData]:[],this.metadata=new W(r.createdAt||void 0,r.lastLoginAt||void 0)}async getIdToken(e){const t=await G(this,this.stsTokenManager.getToken(this.auth,e));return v(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e,t=!1){const n=(0,i.m9)(e),r=await n.getIdToken(t),s=$(r);v(s&&s.exp&&s.auth_time&&s.iat,n.auth,"internal-error");const o="object"===typeof s.firebase?s.firebase:void 0,a=o?.sign_in_provider;return{claims:s,token:r,authTime:z(q(s.auth_time)),issuedAtTime:z(q(s.iat)),expirationTime:z(q(s.exp)),signInProvider:a||null,signInSecondFactor:o?.sign_in_second_factor||null}}(this,e)}reload(){return async function(e){const t=(0,i.m9)(e);await X(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(v(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>({...e}))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new Z({...this,auth:e,stsTokenManager:this.stsTokenManager._clone()});return t.metadata._copy(this.metadata),t}_onReload(e){v(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,t=!1){let n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await X(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if((0,r.rh)(this.auth.app))return Promise.reject(m(this.auth));const e=await this.getIdToken();return await G(this,async function(e,t){return O(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return{uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>({...e}))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId,...this.metadata.toJSON(),apiKey:this.auth.config.apiKey,appName:this.auth.name}}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){const n=t.displayName??void 0,r=t.email??void 0,i=t.phoneNumber??void 0,s=t.photoURL??void 0,o=t.tenantId??void 0,a=t._redirectEventId??void 0,c=t.createdAt??void 0,u=t.lastLoginAt??void 0,{uid:l,emailVerified:h,isAnonymous:d,providerData:f,stsTokenManager:p}=t;v(l&&p,e,"internal-error");const m=Y.fromJSON(this.name,p);v("string"===typeof l,e,"internal-error"),J(n,e.name),J(r,e.name),v("boolean"===typeof h,e,"internal-error"),v("boolean"===typeof d,e,"internal-error"),J(i,e.name),J(s,e.name),J(o,e.name),J(a,e.name),J(c,e.name),J(u,e.name);const g=new Z({uid:l,auth:e,email:r,emailVerified:h,displayName:n,isAnonymous:d,photoURL:s,phoneNumber:i,tenantId:o,stsTokenManager:m,createdAt:c,lastLoginAt:u});return f&&Array.isArray(f)&&(g.providerData=f.map((e=>({...e})))),a&&(g._redirectEventId=a),g}static async _fromIdTokenResponse(e,t,n=!1){const r=new Y;r.updateFromServerResponse(t);const i=new Z({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await X(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];v(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?Q(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!i?.length,o=new Y;o.updateFromIdToken(n);const a=new Z({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),c={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new W(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!i?.length};return Object.assign(a,c),a}}const ee=new Map;function te(e){b(e instanceof Function,"Expected a class definition");let t=ee.get(e);return t?(b(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,ee.set(e,t),t)}class ne{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}ne.type="NONE";const re=ne;function ie(e,t,n){return`firebase:${e}:${t}:${n}`}class se{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=ie(this.userKey,r.apiKey,i),this.fullPersistenceKey=ie("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if("string"===typeof e){const t=await B(this.auth,{idToken:e}).catch((()=>{}));return t?Z._fromGetAccountInfoResponse(this.auth,t,e):null}return Z._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t,n="authUser"){if(!t.length)return new se(te(re),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||te(re);const s=ie(n,e.config.apiKey,e.name);let o=null;for(const c of t)try{const t=await c._get(s);if(t){let n;if("string"===typeof t){const r=await B(e,{idToken:t}).catch((()=>{}));if(!r)break;n=await Z._fromGetAccountInfoResponse(e,r,t)}else n=Z._fromJSON(e,t);c!==i&&(o=n),i=c;break}}catch{}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch{}}))),new se(i,e,n)):new se(i,e,n)}}function oe(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(le(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(ae(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(de(t))return"Blackberry";if(fe(t))return"Webos";if(ce(t))return"Safari";if((t.includes("chrome/")||ue(t))&&!t.includes("edge/"))return"Chrome";if(he(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===n?.length)return n[1]}return"Other"}function ae(e=(0,i.z$)()){return/firefox\//i.test(e)}function ce(e=(0,i.z$)()){const t=e.toLowerCase();return t.includes("safari/")&&!t.includes("chrome/")&&!t.includes("crios/")&&!t.includes("android")}function ue(e=(0,i.z$)()){return/crios\//i.test(e)}function le(e=(0,i.z$)()){return/iemobile/i.test(e)}function he(e=(0,i.z$)()){return/android/i.test(e)}function de(e=(0,i.z$)()){return/blackberry/i.test(e)}function fe(e=(0,i.z$)()){return/webos/i.test(e)}function pe(e=(0,i.z$)()){return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function me(e=(0,i.z$)()){return pe(e)||he(e)||fe(e)||de(e)||/windows phone/i.test(e)||le(e)}function ge(e,t=[]){let n;switch(e){case"Browser":n=oe((0,i.z$)());break;case"Worker":n=`${oe((0,i.z$)())}-${e}`;break;default:n=e}const s=t.length?t.join(","):"FirebaseCore-web";return`${n}/JsCore/${r.Jn}/${s}`}class ye{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:n?.message})}}}class ve{constructor(e){const t=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=t.minPasswordLength??6,t.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=t.maxPasswordLength),void 0!==t.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=t.containsLowercaseCharacter),void 0!==t.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=t.containsUppercaseCharacter),void 0!==t.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=t.containsNumericCharacter),void 0!==t.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=t.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=e.allowedNonAlphanumericCharacters?.join("")??"",this.forceUpgradeOnSignin=e.forceUpgradeOnSignin??!1,this.schemaVersion=e.schemaVersion}validatePassword(e){const t={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,t),this.validatePasswordCharacterOptions(e,t),t.isValid&&(t.isValid=t.meetsMinPasswordLength??!0),t.isValid&&(t.isValid=t.meetsMaxPasswordLength??!0),t.isValid&&(t.isValid=t.containsLowercaseLetter??!0),t.isValid&&(t.isValid=t.containsUppercaseLetter??!0),t.isValid&&(t.isValid=t.containsNumericCharacter??!0),t.isValid&&(t.isValid=t.containsNonAlphanumericCharacter??!0),t}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class we{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new _e(this),this.idTokenSubscription=new _e(this),this.beforeStateQueue=new ye(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=u,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion,this._persistenceManagerAvailable=new Promise((e=>this._resolvePersistenceManagerAvailable=e))}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=te(t)),this._initializationPromise=this.queue((async()=>{if(!this._deleted&&(this.persistenceManager=await se.create(this,e),this._resolvePersistenceManagerAvailable?.(),!this._deleted)){if(this._popupRedirectResolver?._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(n){}await this.initializeCurrentUser(t),this.lastNotifiedUid=this.currentUser?.uid||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void(await this.currentUser.getIdToken())):void(await this._updateCurrentUser(e,!0)):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await B(this,{idToken:e}),n=await Z._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){if((0,r.rh)(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const t=await this.assertedPersistence.getCurrentUser();let n=t,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const t=this.redirectUser?._redirectEventId,r=n?._redirectEventId,s=await this.tryRedirectSignIn(e);t&&t!==r||!s?.user||(n=s.user,i=!0)}if(!n)return this.directlySetCurrentUser(null);if(!n._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(n)}catch(s){n=t,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(s)))}return n?this.reloadAndSetCurrentUserOrClear(n):this.directlySetCurrentUser(null)}return v(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===n._redirectEventId?this.directlySetCurrentUser(n):this.reloadAndSetCurrentUserOrClear(n)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await X(e)}catch(t){if("auth/network-request-failed"!==t?.code)return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if((0,r.rh)(this.app))return Promise.reject(m(this));const t=e?(0,i.m9)(e):null;return t&&v(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e,t=!1){if(!this._deleted)return e&&v(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return(0,r.rh)(this.app)?Promise.reject(m(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return(0,r.rh)(this.app)?Promise.reject(m(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(te(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e,t={}){return O(e,"GET","/v2/passwordPolicy",R(e,t))}(this),t=new ve(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new i.LL("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return O(e,"POST","/v2/accounts:revokeToken",R(e,t))}(this,t)}}toJSON(){return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:this._currentUser?.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&te(e)||this._popupRedirectResolver;v(t,this,"argument-error"),this.redirectPersistenceManager=await se.create(this,[te(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){return this._isInitialized&&await this.queue((async()=>{})),this._currentUser?._redirectEventId===e?this._currentUser:this.redirectUser?._redirectEventId===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const e=this.currentUser?.uid??null;this.lastNotifiedUid!==e&&(this.lastNotifiedUid=e,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(v(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return v(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ge(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){const e={"X-Client-Version":this.clientVersion};this.app.options.appId&&(e["X-Firebase-gmpid"]=this.app.options.appId);const t=await(this.heartbeatServiceProvider.getImmediate({optional:!0})?.getHeartbeatsHeader());t&&(e["X-Firebase-Client"]=t);const n=await this._getAppCheckToken();return n&&(e["X-Firebase-AppCheck"]=n),e}async _getAppCheckToken(){if((0,r.rh)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=await(this.appCheckServiceProvider.getImmediate({optional:!0})?.getToken());return e?.error&&function(e,...t){l.logLevel<=s.in.WARN&&l.warn(`Auth (${r.Jn}): ${e}`,...t)}(`Error while retrieving App Check token: ${e.error}`),e?.token}}function be(e){return(0,i.m9)(e)}class _e{constructor(e){this.auth=e,this.observer=null,this.addObserver=(0,i.ne)((e=>this.observer=e))}get next(){return v(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let Ee={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ie(e){return Ee.loadJS(e)}function Te(e){return`__${e}${Math.floor(1e6*Math.random())}`}class ke{constructor(){this.enterprise=new Se}ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}class Se{ready(e){e()}execute(e,t){return Promise.resolve("token")}render(e,t){return""}}const Ae="NO_RECAPTCHA";class Ce{constructor(e){this.type="recaptcha-enterprise",this.auth=be(e)}async verify(e="verify",t=!1){function n(t,n,r){const i=window.grecaptcha;V(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n(Ae)}))})):r(Error("No reCAPTCHA enterprise script loaded."))}if(this.auth.settings.appVerificationDisabledForTesting){return(new ke).execute("siteKey",{action:"verify"})}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{j(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new F(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&V(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=Ee.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Ie(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Ne(e,t,n,r=!1,i=!1){const s=new Ce(e);let o;if(i)o=Ae;else try{o=await s.verify(n)}catch(c){o=await s.verify(n,!0)}const a={...t};if("mfaSmsEnrollment"===n||"mfaSmsSignIn"===n){if("phoneEnrollmentInfo"in a){const e=a.phoneEnrollmentInfo.phoneNumber,t=a.phoneEnrollmentInfo.recaptchaToken;Object.assign(a,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:t,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in a){const e=a.phoneSignInInfo.recaptchaToken;Object.assign(a,{phoneSignInInfo:{recaptchaToken:e,captchaResponse:o,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return a}return r?Object.assign(a,{captchaResp:o}):Object.assign(a,{captchaResponse:o}),Object.assign(a,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(a,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),a}async function Re(e,t,n,r,i){if("EMAIL_PASSWORD_PROVIDER"===i){if(e._getRecaptchaConfig()?.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Ne(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Ne(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}if("PHONE_PROVIDER"===i){if(e._getRecaptchaConfig()?.isProviderEnabled("PHONE_PROVIDER")){const i=await Ne(e,t,n);return r(e,i).catch((async i=>{if("AUDIT"===e._getRecaptchaConfig()?.getProviderEnforcementState("PHONE_PROVIDER")&&("auth/missing-recaptcha-token"===i.code||"auth/invalid-app-credential"===i.code)){console.log(`Failed to verify with reCAPTCHA Enterprise. Automatically triggering the reCAPTCHA v2 flow to complete the ${n} flow.`);const i=await Ne(e,t,n,!1,!0);return r(e,i)}return Promise.reject(i)}))}{const i=await Ne(e,t,n,!1,!0);return r(e,i)}}return Promise.reject(i+" provider is not supported.")}async function Oe(e){const t=be(e),n=await j(t,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}),r=new F(n);if(null==t.tenantId?t._agentRecaptchaConfig=r:t._tenantRecaptchaConfigs[t.tenantId]=r,r.isAnyProviderEnabled()){new Ce(t).verify()}}function xe(e,t,n){const r=be(e);v(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const s=!!n?.disableWarnings,o=Le(t),{host:a,port:c}=function(e){const t=Le(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Pe(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Pe(t)}}}(t),u=null===c?"":`:${c}`,l={url:`${o}//${a}${u}/`},h=Object.freeze({host:a,port:c,protocol:o.replace(":",""),options:Object.freeze({disableWarnings:s})});if(!r._canInitEmulator)return v(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),void v((0,i.vZ)(l,r.config.emulator)&&(0,i.vZ)(h,r.emulatorConfig),r,"emulator-config-failed");r.config.emulator=l,r.emulatorConfig=h,r.settings.appVerificationDisabledForTesting=!0,(0,i.Xx)(a)?((0,i.Uo)(`${o}//${a}${u}`),(0,i.dp)("Auth",!0)):s||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Le(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Pe(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class De{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return w("not implemented")}_getIdTokenResponse(e){return w("not implemented")}_linkToIdToken(e,t){return w("not implemented")}_getReauthenticationResolver(e){return w("not implemented")}}async function Me(e,t){return O(e,"POST","/v1/accounts:signUp",t)}async function Ue(e,t){return L(e,"POST","/v1/accounts:signInWithPassword",R(e,t))}class Ve extends De{constructor(e,t,n,r=null){super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new Ve(e,t,"password")}static _fromEmailAndCode(e,t,n=null){return new Ve(e,t,"emailLink",n)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if(t?.email&&t?.password){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Re(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Ue,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return L(e,"POST","/v1/accounts:signInWithEmailLink",R(e,t))}(e,{email:this._email,oobCode:this._password});default:d(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Re(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Me,"EMAIL_PASSWORD_PROVIDER");case"emailLink":return async function(e,t){return L(e,"POST","/v1/accounts:signInWithEmailLink",R(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:d(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Fe(e,t){return L(e,"POST","/v1/accounts:signInWithIdp",R(e,t))}class je extends De{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new je(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):d("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,...i}=t;if(!n||!r)return null;const s=new je(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Fe(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Fe(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Fe(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=(0,i.xO)(t)}return e}}async function Be(e,t){return O(e,"POST","/v1/accounts:sendVerificationCode",R(e,t))}const ze={USER_NOT_FOUND:"user-not-found"};class qe extends De{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new qe({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new qe({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return L(e,"POST","/v1/accounts:signInWithPhoneNumber",R(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await L(e,"POST","/v1/accounts:signInWithPhoneNumber",R(e,t));if(n.temporaryProof)throw U(e,"account-exists-with-different-credential",n);return n}(e,{idToken:t,...this._makeVerificationRequest()})}_getReauthenticationResolver(e){return async function(e,t){return L(e,"POST","/v1/accounts:signInWithPhoneNumber",R(e,{...t,operation:"REAUTH"}),ze)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new qe({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class $e{constructor(e){const t=(0,i.zd)((0,i.pd)(e)),n=t.apiKey??null,r=t.oobCode??null,s=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(t.mode??null);v(n&&r&&s,"argument-error"),this.apiKey=n,this.operation=s,this.code=r,this.continueUrl=t.continueUrl??null,this.languageCode=t.lang??null,this.tenantId=t.tenantId??null}static parseLink(e){const t=function(e){const t=(0,i.zd)((0,i.pd)(e)).link,n=t?(0,i.zd)((0,i.pd)(t)).deep_link_id:null,r=(0,i.zd)((0,i.pd)(e)).deep_link_id;return(r?(0,i.zd)((0,i.pd)(r)).link:null)||r||n||t||e}(e);try{return new $e(t)}catch{return null}}}class Ke{constructor(){this.providerId=Ke.PROVIDER_ID}static credential(e,t){return Ve._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=$e.parseLink(t);return v(n,"argument-error"),Ve._fromEmailAndCode(e,n.code,n.tenantId)}}Ke.PROVIDER_ID="password",Ke.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Ke.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Ge{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class He extends Ge{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class We extends He{constructor(){super("facebook.com")}static credential(e){return je._fromParams({providerId:We.PROVIDER_ID,signInMethod:We.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return We.credentialFromTaggedObject(e)}static credentialFromError(e){return We.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return We.credential(e.oauthAccessToken)}catch{return null}}}We.FACEBOOK_SIGN_IN_METHOD="facebook.com",We.PROVIDER_ID="facebook.com";class Xe extends He{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return je._fromParams({providerId:Xe.PROVIDER_ID,signInMethod:Xe.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return Xe.credentialFromTaggedObject(e)}static credentialFromError(e){return Xe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:t,oauthAccessToken:n}=e;if(!t&&!n)return null;try{return Xe.credential(t,n)}catch{return null}}}Xe.GOOGLE_SIGN_IN_METHOD="google.com",Xe.PROVIDER_ID="google.com";class Qe extends He{constructor(){super("github.com")}static credential(e){return je._fromParams({providerId:Qe.PROVIDER_ID,signInMethod:Qe.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Qe.credentialFromTaggedObject(e)}static credentialFromError(e){return Qe.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e))return null;if(!e.oauthAccessToken)return null;try{return Qe.credential(e.oauthAccessToken)}catch{return null}}}Qe.GITHUB_SIGN_IN_METHOD="github.com",Qe.PROVIDER_ID="github.com";class Ye extends He{constructor(){super("twitter.com")}static credential(e,t){return je._fromParams({providerId:Ye.PROVIDER_ID,signInMethod:Ye.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return Ye.credentialFromTaggedObject(e)}static credentialFromError(e){return Ye.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:t,oauthTokenSecret:n}=e;if(!t||!n)return null;try{return Ye.credential(t,n)}catch{return null}}}async function Je(e,t){return L(e,"POST","/v1/accounts:signUp",R(e,t))}Ye.TWITTER_SIGN_IN_METHOD="twitter.com",Ye.PROVIDER_ID="twitter.com";class Ze{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n,r=!1){const i=await Z._fromIdTokenResponse(e,n,r),s=et(n);return new Ze({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=et(n);return new Ze({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function et(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class tt extends i.ZR{constructor(e,t,n,r){super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,tt.prototype),this.customData={appName:e.name,tenantId:e.tenantId??void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new tt(e,t,n,r)}}function nt(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw tt._fromErrorAndOperation(e,n,t,r);throw n}))}async function rt(e,t,n=!1){const r=await G(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return Ze._forOperation(e,"link",r)}async function it(e,t,n=!1){const{auth:i}=e;if((0,r.rh)(i.app))return Promise.reject(m(i));const s="reauthenticate";try{const r=await G(e,nt(i,s,t,e),n);v(r.idToken,i,"internal-error");const o=$(r.idToken);v(o,i,"internal-error");const{sub:a}=o;return v(e.uid===a,i,"user-mismatch"),Ze._forOperation(e,s,r)}catch(o){throw"auth/user-not-found"===o?.code&&d(i,"user-mismatch"),o}}async function st(e,t,n=!1){if((0,r.rh)(e.app))return Promise.reject(m(e));const i="signIn",s=await nt(e,i,t),o=await Ze._fromIdTokenResponse(e,i,s);return n||await e._updateCurrentUser(o.user),o}async function ot(e,t){return st(be(e),t)}async function at(e){const t=be(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function ct(e,t,n){if((0,r.rh)(e.app))return Promise.reject(m(e));const i=be(e),s=Re(i,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",Je,"EMAIL_PASSWORD_PROVIDER"),o=await s.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&at(e),t})),a=await Ze._fromIdTokenResponse(i,"signIn",o);return await i._updateCurrentUser(a.user),a}function ut(e,t,n){return(0,r.rh)(e.app)?Promise.reject(m(e)):ot((0,i.m9)(e),Ke.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&at(e),t}))}function lt(e,t,n,r){return(0,i.m9)(e).onAuthStateChanged(t,n,r)}function ht(e){return(0,i.m9)(e).signOut()}function dt(e,t){return O(e,"POST","/v2/accounts/mfaEnrollment:start",R(e,t))}new WeakMap;const ft="__sak";class pt{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem(ft,"1"),this.storage.removeItem(ft),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class mt extends pt{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=me(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e,t=!1){if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},s=this.storage.getItem(n);(0,i.w1)()&&10===document.documentMode&&s!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}mt.type="LOCAL";const gt=mt;function yt(e){const t=e.replace(/[\\^$.*+?()[\]{}|]/g,"\\$&"),n=RegExp(`${t}=([^;]+)`);return document.cookie.match(n)?.[1]??null}function vt(e){return`${"http:"===window.location.protocol?"__dev_":"__HOST-"}FIREBASE_${e.split(":")[3]}`}class wt{constructor(){this.type="COOKIE",this.listenerUnsubscribes=new Map}_getFinalTarget(e){if(void 0===typeof window)return e;const t=new URL(`${window.location.origin}/__cookies__`);return t.searchParams.set("finalTarget",e),t}async _isAvailable(){return!("boolean"===typeof isSecureContext&&!isSecureContext)&&("undefined"!==typeof navigator&&"undefined"!==typeof document&&(navigator.cookieEnabled??!0))}async _set(e,t){}async _get(e){if(!this._isAvailable())return null;const t=vt(e);if(window.cookieStore){const e=await window.cookieStore.get(t);return e?.value}return yt(t)}async _remove(e){if(!this._isAvailable())return;if(!(await this._get(e)))return;const t=vt(e);document.cookie=`${t}=;Max-Age=34560000;Partitioned;Secure;SameSite=Strict;Path=/;Priority=High`,await fetch("/__cookies__",{method:"DELETE"}).catch((()=>{}))}_addListener(e,t){if(!this._isAvailable())return;const n=vt(e);if(window.cookieStore){const e=e=>{const r=e.changed.find((e=>e.name===n));r&&t(r.value);e.deleted.find((e=>e.name===n))&&t(null)},r=()=>window.cookieStore.removeEventListener("change",e);return this.listenerUnsubscribes.set(t,r),window.cookieStore.addEventListener("change",e)}let r=yt(n);const i=setInterval((()=>{const e=yt(n);e!==r&&(t(e),r=e)}),1e3);this.listenerUnsubscribes.set(t,(()=>clearInterval(i)))}_removeListener(e,t){const n=this.listenerUnsubscribes.get(t);n&&(n(),this.listenerUnsubscribes.delete(t))}}wt.type="COOKIE";class bt extends pt{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}bt.type="SESSION";const _t=bt;class Et{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Et(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!s?.size)return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function It(e="",t=10){let n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Et.receivers=[];class Tt{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t,n=50){const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const c=It("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===c)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:c,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function kt(){return window}function St(){return"undefined"!==typeof kt().WorkerGlobalScope&&"function"===typeof kt().importScripts}const At="firebaseLocalStorageDb",Ct="firebaseLocalStorage",Nt="fbase_key";class Rt{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function Ot(e,t){return e.transaction([Ct],t?"readwrite":"readonly").objectStore(Ct)}function xt(){const e=indexedDB.open(At,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(Ct,{keyPath:Nt})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(Ct)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(At);return new Rt(e).toPromise()}(),t(await xt()))}))}))}async function Lt(e,t,n){const r=Ot(e,!0).put({[Nt]:t,value:n});return new Rt(r).toPromise()}function Pt(e,t){const n=Ot(e,!0).delete(t);return new Rt(n).toPromise()}class Dt{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await xt()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return St()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Et._getInstance(St()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){if(this.activeServiceWorker=await async function(){if(!navigator?.serviceWorker)return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}(),!this.activeServiceWorker)return;this.sender=new Tt(this.activeServiceWorker);const e=await this.sender._send("ping",{},800);e&&e[0]?.fulfilled&&e[0]?.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&(navigator?.serviceWorker?.controller||null)===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await xt();return await Lt(e,ft,"1"),await Pt(e,ft),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>Lt(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=Ot(e,!1).get(t),r=await new Rt(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>Pt(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=Ot(e,!1).getAll();return new Rt(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}Dt.type="LOCAL";const Mt=Dt;function Ut(e,t){return O(e,"POST","/v2/accounts/mfaSignIn:start",R(e,t))}Te("rcb"),new T(3e4,6e4);const Vt="recaptcha";async function Ft(e,t,n){if(!e._getRecaptchaConfig())try{await Oe(e)}catch(r){console.log("Failed to initialize reCAPTCHA Enterprise config. Triggering the reCAPTCHA v2 verification.")}try{let r;if(r="string"===typeof t?{phoneNumber:t}:t,"session"in r){const t=r.session;if("phoneNumber"in r){v("enroll"===t.type,e,"internal-error");const i={idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"}},s=Re(e,i,"mfaSmsEnrollment",(async(e,t)=>{if(t.phoneEnrollmentInfo.captchaResponse===Ae){v(n?.type===Vt,e,"argument-error");return dt(e,await jt(e,t,n))}return dt(e,t)}),"PHONE_PROVIDER");return(await s.catch((e=>Promise.reject(e)))).phoneSessionInfo.sessionInfo}{v("signin"===t.type,e,"internal-error");const i=r.multiFactorHint?.uid||r.multiFactorUid;v(i,e,"missing-multi-factor-info");const s={mfaPendingCredential:t.credential,mfaEnrollmentId:i,phoneSignInInfo:{clientType:"CLIENT_TYPE_WEB"}},o=Re(e,s,"mfaSmsSignIn",(async(e,t)=>{if(t.phoneSignInInfo.captchaResponse===Ae){v(n?.type===Vt,e,"argument-error");return Ut(e,await jt(e,t,n))}return Ut(e,t)}),"PHONE_PROVIDER");return(await o.catch((e=>Promise.reject(e)))).phoneResponseInfo.sessionInfo}}{const t={phoneNumber:r.phoneNumber,clientType:"CLIENT_TYPE_WEB"},i=Re(e,t,"sendVerificationCode",(async(e,t)=>{if(t.captchaResponse===Ae){v(n?.type===Vt,e,"argument-error");return Be(e,await jt(e,t,n))}return Be(e,t)}),"PHONE_PROVIDER");return(await i.catch((e=>Promise.reject(e)))).sessionInfo}}finally{n?._reset()}}async function jt(e,t,n){v(n.type===Vt,e,"argument-error");const r=await n.verify();v("string"===typeof r,e,"argument-error");const i={...t};if("phoneEnrollmentInfo"in i){const e=i.phoneEnrollmentInfo.phoneNumber,t=i.phoneEnrollmentInfo.captchaResponse,n=i.phoneEnrollmentInfo.clientType,s=i.phoneEnrollmentInfo.recaptchaVersion;return Object.assign(i,{phoneEnrollmentInfo:{phoneNumber:e,recaptchaToken:r,captchaResponse:t,clientType:n,recaptchaVersion:s}}),i}if("phoneSignInInfo"in i){const e=i.phoneSignInInfo.captchaResponse,t=i.phoneSignInInfo.clientType,n=i.phoneSignInInfo.recaptchaVersion;return Object.assign(i,{phoneSignInInfo:{recaptchaToken:r,captchaResponse:e,clientType:t,recaptchaVersion:n}}),i}return Object.assign(i,{recaptchaToken:r}),i}class Bt{constructor(e){this.providerId=Bt.PROVIDER_ID,this.auth=be(e)}verifyPhoneNumber(e,t){return Ft(this.auth,e,(0,i.m9)(t))}static credential(e,t){return qe._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Bt.credentialFromTaggedObject(t)}static credentialFromError(e){return Bt.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{phoneNumber:t,temporaryProof:n}=e;return t&&n?qe._fromTokenResponse(t,n):null}}function zt(e,t){return t?te(t):(v(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Bt.PROVIDER_ID="phone",Bt.PHONE_SIGN_IN_METHOD="phone";class qt extends De{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Fe(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Fe(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Fe(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function $t(e){return st(e.auth,new qt(e),e.bypassAuthState)}function Kt(e){const{auth:t,user:n}=e;return v(n,t,"internal-error"),it(n,new qt(e),e.bypassAuthState)}async function Gt(e){const{auth:t,user:n}=e;return v(n,t,"internal-error"),rt(n,new qt(e),e.bypassAuthState)}class Ht{constructor(e,t,n,r,i=!1){this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(c){this.reject(c)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return $t;case"linkViaPopup":case"linkViaRedirect":return Gt;case"reauthViaPopup":case"reauthViaRedirect":return Kt;default:d(this.auth,"internal-error")}}resolve(e){b(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){b(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Wt=new T(2e3,1e4);async function Xt(e,t,n){if((0,r.rh)(e.app))return Promise.reject(f(e,"operation-not-supported-in-this-environment"));const i=be(e);g(e,t,Ge);const s=zt(i,n);return new Qt(i,"signInViaPopup",t,s).executeNotNull()}class Qt extends Ht{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Qt.currentPopupAction&&Qt.currentPopupAction.cancel(),Qt.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return v(e,this.auth,"internal-error"),e}async onExecution(){b(1===this.filter.length,"Popup operations only handle one event");const e=It();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(f(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){return this.authWindow?.associatedEvent||null}cancel(){this.reject(f(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Qt.currentPopupAction=null}pollUserCancellation(){const e=()=>{this.authWindow?.window?.closed?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(f(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Wt.get())};e()}}Qt.currentPopupAction=null;const Yt="pendingRedirect",Jt=new Map;class Zt extends Ht{constructor(e,t,n=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,n),this.eventId=null}async execute(){let e=Jt.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=nn(t),r=tn(e);if(!(await r._isAvailable()))return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(t)}catch(t){e=()=>Promise.reject(t)}Jt.set(this.auth._key(),e)}return this.bypassAuthState||Jt.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}function en(e,t){Jt.set(e._key(),t)}function tn(e){return te(e._redirectPersistence)}function nn(e){return ie(Yt,e.config.apiKey,e.name)}async function rn(e,t,n=!1){if((0,r.rh)(e.app))return Promise.reject(m(e));const i=be(e),s=zt(i,t),o=new Zt(i,s,n),a=await o.execute();return a&&!n&&(delete a.user._redirectEventId,await i._persistUserIfCurrent(a.user),await i._setRedirectUser(null,t)),a}class sn{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return an(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){if(e.error&&!an(e)){const n=e.error.code?.split("auth/")[1]||"internal-error";t.onError(f(this.auth,n))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has(on(e))}saveEventToCache(e){this.cachedEventUids.add(on(e)),this.lastProcessedEventTime=Date.now()}}function on(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function an({type:e,error:t}){return"unknown"===e&&"auth/no-auth-event"===t?.code}const cn=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,un=/^https?/;async function ln(e){if(e.config.emulator)return;const{authorizedDomains:t}=await async function(e,t={}){return O(e,"GET","/v1/projects",t)}(e);for(const n of t)try{if(hn(n))return}catch{}d(e,"unauthorized-domain")}function hn(e){const t=_(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!un.test(n))return!1;if(cn.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const dn=new T(3e4,6e4);function fn(){const e=kt().___jsl;if(e?.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function pn(e){return new Promise(((t,n)=>{function r(){fn(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{fn(),n(f(e,"network-request-failed"))},timeout:dn.get()})}if(kt().gapi?.iframes?.Iframe)t(gapi.iframes.getContext());else{if(!kt().gapi?.load){const t=Te("iframefcb");return kt()[t]=()=>{gapi.load?r():n(f(e,"network-request-failed"))},Ie(`${Ee.gapiScript}?onload=${t}`).catch((e=>n(e)))}r()}})).catch((e=>{throw mn=null,e}))}let mn=null;const gn=new T(5e3,15e3),yn="__/auth/iframe",vn="emulator/auth/iframe",wn={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},bn=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function _n(e){const t=e.config;v(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?k(t,vn):`https://${e.config.authDomain}/${yn}`,s={apiKey:t.apiKey,appName:e.name,v:r.Jn},o=bn.get(e.config.apiHost);o&&(s.eid=o);const a=e._getFrameworks();return a.length&&(s.fw=a.join(",")),`${n}?${(0,i.xO)(s).slice(1)}`}async function En(e){const t=await function(e){return mn=mn||pn(e),mn}(e),n=kt().gapi;return v(n,e,"internal-error"),t.open({where:document.body,url:_n(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:wn,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=f(e,"network-request-failed"),s=kt().setTimeout((()=>{r(i)}),gn.get());function o(){kt().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const In={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class Tn{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function kn(e,t,n,r=500,s=600){const o=Math.max((window.screen.availHeight-s)/2,0).toString(),a=Math.max((window.screen.availWidth-r)/2,0).toString();let c="";const u={...In,width:r.toString(),height:s.toString(),top:o,left:a},l=(0,i.z$)().toLowerCase();n&&(c=ue(l)?"_blank":n),ae(l)&&(t=t||"http://localhost",u.scrollbars="yes");const h=Object.entries(u).reduce(((e,[t,n])=>`${e}${t}=${n},`),"");if(function(e=(0,i.z$)()){return pe(e)&&!!window.navigator?.standalone}(l)&&"_self"!==c)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",c),new Tn(null);const d=window.open(t||"",c,h);v(d,e,"popup-blocked");try{d.focus()}catch(f){}return new Tn(d)}const Sn="__/auth/handler",An="emulator/auth/handler",Cn=encodeURIComponent("fac");async function Nn(e,t,n,s,o,a){v(e.config.authDomain,e,"auth-domain-config-required"),v(e.config.apiKey,e,"invalid-api-key");const c={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:s,v:r.Jn,eventId:o};if(t instanceof Ge){t.setDefaultLanguage(e.languageCode),c.providerId=t.providerId||"",(0,i.xb)(t.getCustomParameters())||(c.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(a||{}))c[e]=t}if(t instanceof He){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(c.scopes=e.join(","))}e.tenantId&&(c.tid=e.tenantId);const u=c;for(const r of Object.keys(u))void 0===u[r]&&delete u[r];const l=await e._getAppCheckToken(),h=l?`#${Cn}=${encodeURIComponent(l)}`:"";return`${function({config:e}){if(!e.emulator)return`https://${e.authDomain}/${Sn}`;return k(e,An)}(e)}?${(0,i.xO)(u).slice(1)}${h}`}const Rn="webStorageSupport";const On=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=_t,this._completeRedirectFn=rn,this._overrideRedirectResult=en}async _openPopup(e,t,n,r){b(this.eventManagers[e._key()]?.manager,"_initialize() not called before _openPopup()");return kn(e,await Nn(e,t,n,_(),r),It())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){kt().location.href=e}(await Nn(e,t,n,_(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(b(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await En(e),n=new sn(e);return t.register("authEvent",(t=>{v(t?.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(Rn,{type:Rn},(n=>{const r=n?.[0]?.[Rn];void 0!==r&&t(!!r),d(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=ln(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return me()||ce()||pe()}};var xn="@firebase/auth",Ln="1.11.0";class Pn{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){return this.assertAuthConfigured(),this.auth.currentUser?.uid||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e(t?.stsTokenManager.accessToken||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){v(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}const Dn=(0,i.Pz)("authIdTokenMaxAge")||300;let Mn=null;const Un=e=>async t=>{const n=t&&await t.getIdTokenResult(),r=n&&((new Date).getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>Dn)return;const i=n?.token;Mn!==i&&(Mn=i,await fetch(e,{method:i?"POST":"DELETE",headers:i?{Authorization:`Bearer ${i}`}:{}}))};function Vn(e=(0,r.Mq)()){const t=(0,r.qX)(e,"auth");if(t.isInitialized())return t.getImmediate();const n=function(e,t){const n=(0,r.qX)(e,"auth");if(n.isInitialized()){const e=n.getImmediate(),r=n.getOptions();if((0,i.vZ)(r,t??{}))return e;d(e,"already-initialized")}return n.initialize({options:t})}(e,{popupRedirectResolver:On,persistence:[Mt,gt,_t]}),s=(0,i.Pz)("authTokenSyncURL");if(s&&"boolean"===typeof isSecureContext&&isSecureContext){const e=new URL(s,location.origin);if(location.origin===e.origin){const t=Un(e.toString());!function(e,t,n){(0,i.m9)(e).beforeAuthStateChanged(t,n)}(n,t,(()=>t(n.currentUser))),function(e,t,n,r){(0,i.m9)(e).onIdTokenChanged(t,n,r)}(n,(e=>t(e)))}}const o=(0,i.q4)("auth");return o&&xe(n,`http://${o}`),n}var Fn;Ee={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=f("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",(document.getElementsByTagName("head")?.[0]??document).appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},Fn="Browser",(0,r.Xd)(new o.wA("auth",((e,{options:t})=>{const n=e.getProvider("app").getImmediate(),r=e.getProvider("heartbeat"),i=e.getProvider("app-check-internal"),{apiKey:s,authDomain:o}=n.options;v(s&&!s.includes(":"),"invalid-api-key",{appName:n.name});const a={apiKey:s,authDomain:o,clientPlatform:Fn,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ge(Fn)},c=new we(n,r,i,a);return function(e,t){const n=t?.persistence||[],r=(Array.isArray(n)?n:[n]).map(te);t?.errorMap&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,t?.popupRedirectResolver)}(c,t),c}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),(0,r.Xd)(new o.wA("auth-internal",(e=>(e=>new Pn(e))(be(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),(0,r.KN)(xn,Ln,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(Fn)),(0,r.KN)(xn,Ln,"esm2020")},99724:function(e,t,n){"use strict";n.d(t,{EK:function(){return ve},ET:function(){return pu},hJ:function(){return tc},oe:function(){return fu},JU:function(){return nc},QT:function(){return cu},PL:function(){return lu},ad:function(){return cc},b9:function(){return Yc},cf:function(){return mu},Xo:function(){return Xc},IO:function(){return $c},Bt:function(){return bu},pl:function(){return hu},r7:function(){return du},ar:function(){return Gc},qs:function(){return _u}});var r,i,s=n(33310),o=n(75),a=n(44645),c=n(99711),u="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},l={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.C=Array(this.blockSize),this.o=this.h=0,this.u()}function n(e,t,n){n||(n=0);const r=Array(16);if("string"===typeof t)for(var i=0;i<16;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;i<16;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];let s,o=e.g[3];s=t+(o^n&(i^o))+r[0]+3614090360&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[1]+3905402710&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[2]+606105819&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[3]+3250441966&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[4]+4118548399&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[5]+1200080426&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[6]+2821735955&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[7]+4249261313&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[8]+1770035416&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[9]+2336552879&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[10]+4294925233&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[11]+2304563134&4294967295,s=t+(o^(n=i+(s<<22&4294967295|s>>>10))&(i^o))+r[12]+1804603682&4294967295,s=o+(i^(t=n+(s<<7&4294967295|s>>>25))&(n^i))+r[13]+4254626195&4294967295,o=t+(s<<12&4294967295|s>>>20),s=i+(n^o&(t^n))+r[14]+2792965006&4294967295,s=n+(t^(i=o+(s<<17&4294967295|s>>>15))&(o^t))+r[15]+1236535329&4294967295,s=t+(i^o&((n=i+(s<<22&4294967295|s>>>10))^i))+r[1]+4129170786&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[6]+3225465664&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[11]+643717713&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[0]+3921069994&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[5]+3593408605&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[10]+38016083&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[15]+3634488961&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[4]+3889429448&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[9]+568446438&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[14]+3275163606&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[3]+4107603335&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[8]+1163531501&4294967295,s=t+(i^o&((n=i+(s<<20&4294967295|s>>>12))^i))+r[13]+2850285829&4294967295,s=o+(n^i&((t=n+(s<<5&4294967295|s>>>27))^n))+r[2]+4243563512&4294967295,o=t+(s<<9&4294967295|s>>>23),s=i+(t^n&(o^t))+r[7]+1735328473&4294967295,s=n+(o^t&((i=o+(s<<14&4294967295|s>>>18))^o))+r[12]+2368359562&4294967295,s=t+((n=i+(s<<20&4294967295|s>>>12))^i^o)+r[5]+4294588738&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[8]+2272392833&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[11]+1839030562&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[14]+4259657740&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[1]+2763975236&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[4]+1272893353&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[7]+4139469664&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[10]+3200236656&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[13]+681279174&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[0]+3936430074&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[3]+3572445317&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[6]+76029189&4294967295,s=t+((n=i+(s<<23&4294967295|s>>>9))^i^o)+r[9]+3654602809&4294967295,s=o+((t=n+(s<<4&4294967295|s>>>28))^n^i)+r[12]+3873151461&4294967295,o=t+(s<<11&4294967295|s>>>21),s=i+(o^t^n)+r[15]+530742520&4294967295,s=n+((i=o+(s<<16&4294967295|s>>>16))^o^t)+r[2]+3299628645&4294967295,s=t+(i^((n=i+(s<<23&4294967295|s>>>9))|~o))+r[0]+4096336452&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[7]+1126891415&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[14]+2878612391&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[5]+4237533241&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[12]+1700485571&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[3]+2399980690&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[10]+4293915773&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[1]+2240044497&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[8]+1873313359&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[15]+4264355552&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[6]+2734768916&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[13]+1309151649&4294967295,s=t+(i^((n=i+(s<<21&4294967295|s>>>11))|~o))+r[4]+4149444226&4294967295,s=o+(n^((t=n+(s<<6&4294967295|s>>>26))|~i))+r[11]+3174756917&4294967295,o=t+(s<<10&4294967295|s>>>22),s=i+(t^(o|~n))+r[2]+718787259&4294967295,s=n+(o^((i=o+(s<<15&4294967295|s>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(s<<21&4294967295|s>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+o&4294967295}function s(e,t){this.h=t;const n=[];let r=!0;for(let i=e.length-1;i>=0;i--){const s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.F=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.D=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.u=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.v=function(e,t){void 0===t&&(t=e.length);const r=t-this.blockSize,i=this.C;let s=this.h,o=0;for(;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.A=function(){var e=Array((this.h<56?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;t=8*this.o;for(var n=e.length-8;n<e.length;++n)e[n]=255&t,t/=256;for(this.v(e),e=Array(16),t=0,n=0;n<4;++n)for(let r=0;r<32;r+=8)e[t++]=this.g[n]>>>r&255;return e};var o={};function a(e){return-128<=e&&e<128?function(e,t){var n=o;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new s([0|e],e<0?-1:0)})):new s([0|e],e<0?-1:0)}function c(e){if(isNaN(e)||!isFinite(e))return u;if(e<0)return m(c(-e));const t=[];let n=1;for(let r=0;e>=n;r++)t[r]=e/n|0,n*=4294967296;return new s(t,0)}var u=a(0),h=a(1),d=a(16777216);function f(e){if(0!=e.h)return!1;for(let t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function p(e){return-1==e.h}function m(e){const t=e.g.length,n=[];for(let r=0;r<t;r++)n[r]=~e.g[r];return new s(n,~e.h).add(h)}function g(e,t){return e.add(m(t))}function y(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function v(e,t){this.g=e,this.h=t}function w(e,t){if(f(t))throw Error("division by zero");if(f(e))return new v(u,u);if(p(e))return t=w(m(e),t),new v(m(t.g),m(t.h));if(p(t))return t=w(e,m(t)),new v(m(t.g),t.h);if(e.g.length>30){if(p(e)||p(t))throw Error("slowDivide_ only works with positive integers.");for(var n=h,r=t;r.l(e)<=0;)n=b(n),r=b(r);var i=_(n,1),s=_(r,1);for(r=_(r,2),n=_(n,2);!f(r);){var o=s.add(r);o.l(e)<=0&&(i=i.add(n),s=o),r=_(r,1),n=_(n,1)}return t=g(e,i.j(t)),new v(i,t)}for(i=u;e.l(t)>=0;){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=(r=Math.ceil(Math.log(n)/Math.LN2))<=48?1:Math.pow(2,r-48),o=(s=c(n)).j(t);p(o)||o.l(e)>0;)o=(s=c(n-=r)).j(t);f(s)&&(s=h),i=i.add(s),e=g(e,o)}return new v(i,e)}function b(e){const t=e.g.length+1,n=[];for(let r=0;r<t;r++)n[r]=e.i(r)<<1|e.i(r-1)>>>31;return new s(n,e.h)}function _(e,t){const n=t>>5;t%=32;const r=e.g.length-n,i=[];for(let s=0;s<r;s++)i[s]=t>0?e.i(s+n)>>>t|e.i(s+n+1)<<32-t:e.i(s+n);return new s(i,e.h)}(e=s.prototype).m=function(){if(p(this))return-m(this).m();let e=0,t=1;for(let n=0;n<this.g.length;n++){const r=this.i(n);e+=(r>=0?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if((e=e||10)<2||36<e)throw Error("radix out of range: "+e);if(f(this))return"0";if(p(this))return"-"+m(this).toString(e);const t=c(Math.pow(e,6));var n=this;let r="";for(;;){const i=w(n,t).g;let s=(((n=g(n,i.j(t))).g.length>0?n.g[0]:n.h)>>>0).toString(e);if(f(n=i))return s+r;for(;s.length<6;)s="0"+s;r=s+r}},e.i=function(e){return e<0?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return p(e=g(this,e))?-1:f(e)?0:1},e.abs=function(){return p(this)?m(this):this},e.add=function(e){const t=Math.max(this.g.length,e.g.length),n=[];let r=0;for(let i=0;i<=t;i++){let t=r+(65535&this.i(i))+(65535&e.i(i)),s=(t>>>16)+(this.i(i)>>>16)+(e.i(i)>>>16);r=s>>>16,t&=65535,s&=65535,n[i]=s<<16|t}return new s(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(f(this)||f(e))return u;if(p(this))return p(e)?m(this).j(m(e)):m(m(this).j(e));if(p(e))return m(this.j(m(e)));if(this.l(d)<0&&e.l(d)<0)return c(this.m()*e.m());const t=this.g.length+e.g.length,n=[];for(var r=0;r<2*t;r++)n[r]=0;for(r=0;r<this.g.length;r++)for(let t=0;t<e.g.length;t++){const i=this.i(r)>>>16,s=65535&this.i(r),o=e.i(t)>>>16,a=65535&e.i(t);n[2*r+2*t]+=s*a,y(n,2*r+2*t),n[2*r+2*t+1]+=i*a,y(n,2*r+2*t+1),n[2*r+2*t+1]+=s*o,y(n,2*r+2*t+1),n[2*r+2*t+2]+=i*o,y(n,2*r+2*t+2)}for(e=0;e<t;e++)n[e]=n[2*e+1]<<16|n[2*e];for(e=t;e<2*t;e++)n[e]=0;return new s(n,0)},e.B=function(e){return w(this,e).h},e.and=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)&e.i(r);return new s(n,this.h&e.h)},e.or=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)|e.i(r);return new s(n,this.h|e.h)},e.xor=function(e){const t=Math.max(this.g.length,e.g.length),n=[];for(let r=0;r<t;r++)n[r]=this.i(r)^e.i(r);return new s(n,this.h^e.h)},t.prototype.digest=t.prototype.A,t.prototype.reset=t.prototype.u,t.prototype.update=t.prototype.v,i=l.Md5=t,s.prototype.add=s.prototype.add,s.prototype.multiply=s.prototype.j,s.prototype.modulo=s.prototype.B,s.prototype.compare=s.prototype.l,s.prototype.toNumber=s.prototype.m,s.prototype.toString=s.prototype.toString,s.prototype.getBits=s.prototype.i,s.fromNumber=c,s.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if((n=n||10)<2||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return m(e(t.substring(1),n));if(t.indexOf("-")>=0)throw Error('number format error: interior "-" character');const r=c(Math.pow(n,8));let i=u;for(let o=0;o<t.length;o+=8){var s=Math.min(8,t.length-o);const e=parseInt(t.substring(o,o+s),n);s<8?(s=c(Math.pow(n,s)),i=i.j(s).add(c(e))):(i=i.j(r),i=i.add(c(e)))}return i},r=l.Integer=s}).apply("undefined"!==typeof u?u:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var h,d,f,p,m,g,y,v,w="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},b={};(function(){var e,t=Object.defineProperty;var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof w&&w];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);function r(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}r("Symbol.dispose",(function(e){return e||Symbol("Symbol.dispose")})),r("Array.prototype.values",(function(e){return e||function(){return this[Symbol.iterator]()}})),r("Object.entries",(function(e){return e||function(e){var t,n=[];for(t in e)Object.prototype.hasOwnProperty.call(e,t)&&n.push([t,e[t]]);return n}}));var i=i||{},s=this||self;function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function c(e,t,n){return(c=a).apply(null,arguments)}function u(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function l(e,t){function n(){}n.prototype=t.prototype,e.Z=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Ob=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}var _="undefined"!==typeof AsyncContext&&"function"===typeof AsyncContext.Snapshot?e=>e&&AsyncContext.Snapshot.wrap(e):e=>e;function E(e){const t=e.length;if(t>0){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function T(e,t){for(let r=1;r<arguments.length;r++){const t=arguments[r];var n=typeof t;if("array"==(n="object"!=n?n:t?Array.isArray(t)?"array":n:"null")||"object"==n&&"number"==typeof t.length){n=e.length||0;const r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function k(e){s.setTimeout((()=>{throw e}),0)}function S(){var e=O;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var A=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return this.h>0?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new C),(e=>e.reset()));class C{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let N,R=!1,O=new class{constructor(){this.h=this.g=null}add(e,t){const n=A.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},x=()=>{const e=Promise.resolve(void 0);N=()=>{e.then(L)}};function L(){for(var e;e=S();){try{e.h.call(e.g)}catch(n){k(n)}var t=A;t.j(e),t.h<100&&(t.h++,e.next=t.g,t.g=e)}R=!1}function P(){this.u=this.u,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}P.prototype.u=!1,P.prototype.dispose=function(){this.u||(this.u=!0,this.N())},P.prototype[Symbol.dispose]=function(){this.dispose()},P.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var M=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};s.addEventListener("test",e,t),s.removeEventListener("test",e,t)}catch(n){}return e}();function U(e){return/^[\s\xa0]*$/.test(e)}function V(e,t){D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e&&this.init(e,t)}l(V,D),V.prototype.init=function(e,t){const n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;this.target=e.target||e.srcElement,this.g=t,(t=e.relatedTarget)||("mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement)),this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=e.pointerType,this.state=e.state,this.i=e,e.defaultPrevented&&V.Z.h.call(this)},V.prototype.h=function(){V.Z.h.call(this);const e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),j=0;function B(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++j,this.da=this.fa=!1}function z(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function q(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function $(e){const t={};for(const n in e)t[n]=e[n];return t}const K="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function G(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<K.length;t++)n=K[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function H(e){this.src=e,this.g={},this.h=0}function W(e,t){const n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=s>=0)&&Array.prototype.splice.call(i,s,1),r&&(z(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function X(e,t,n,r){for(let i=0;i<e.length;++i){const s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}H.prototype.add=function(e,t,n,r,i){const s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);const o=X(e,t,r,i);return o>-1?(t=e[o],n||(t.fa=!1)):((t=new B(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var Q="closure_lm_"+(1e6*Math.random()|0),Y={};function J(e,t,n,r,i){if(r&&r.once)return ee(e,t,n,r,i);if(Array.isArray(t)){for(let s=0;s<t.length;s++)J(e,t[s],n,r,i);return null}return n=ce(n),e&&e[F]?e.J(t,n,o(r)?!!r.capture:!!r,i):Z(e,t,n,!1,r,i)}function Z(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");const a=o(i)?!!i.capture:!!i;let c=oe(e);if(c||(e[Q]=c=new H(e)),(n=c.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=se;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)M||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(ie(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function ee(e,t,n,r,i){if(Array.isArray(t)){for(let s=0;s<t.length;s++)ee(e,t[s],n,r,i);return null}return n=ce(n),e&&e[F]?e.K(t,n,o(r)?!!r.capture:!!r,i):Z(e,t,n,!0,r,i)}function ne(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)ne(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=ce(n),e&&e[F]?(e=e.i,(s=String(t).toString())in e.g&&((n=X(t=e.g[s],n,r,i))>-1&&(z(t[n]),Array.prototype.splice.call(t,n,1),0==t.length&&(delete e.g[s],e.h--)))):e&&(e=oe(e))&&(t=e.g[t.toString()],e=-1,t&&(e=X(t,n,r,i)),(n=e>-1?t[e]:null)&&re(n))}function re(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])W(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(ie(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=oe(t))?(W(n,e),0==n.h&&(n.src=null,t[Q]=null)):z(e)}}}function ie(e){return e in Y?Y[e]:Y[e]="on"+e}function se(e,t){if(e.da)e=!0;else{t=new V(t,this);const n=e.listener,r=e.ha||e.src;e.fa&&re(e),e=n.call(r,t)}return e}function oe(e){return(e=e[Q])instanceof H?e:null}var ae="__closure_events_fn_"+(1e9*Math.random()>>>0);function ce(e){return"function"===typeof e?e:(e[ae]||(e[ae]=function(t){return e.handleEvent(t)}),e[ae])}function ue(){P.call(this),this.i=new H(this),this.M=this,this.G=null}function le(e,t){var n,r=e.G;if(r)for(n=[];r;r=r.G)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;G(t=new D(r,e),i)}let s,o;if(i=!0,n)for(o=n.length-1;o>=0;o--)s=t.g=n[o],i=he(s,r,!0,t)&&i;if(s=t.g=e,i=he(s,r,!0,t)&&i,i=he(s,r,!1,t)&&i,n)for(o=0;o<n.length;o++)s=t.g=n[o],i=he(s,r,!1,t)&&i}function he(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();let i=!0;for(let s=0;s<t.length;++s){const o=t[s];if(o&&!o.da&&o.capture==n){const t=o.listener,n=o.ha||o.src;o.fa&&W(e.i,o),i=!1!==t.call(n,r)&&i}}return i&&!r.defaultPrevented}function de(e){e.g=function(e,t){if("function"!==typeof e){if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=c(e.handleEvent,e)}return Number(t)>2147483647?-1:s.setTimeout(e,t||0)}((()=>{e.g=null,e.i&&(e.i=!1,de(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}l(ue,P),ue.prototype[F]=!0,ue.prototype.removeEventListener=function(e,t,n,r){ne(this,e,t,n,r)},ue.prototype.N=function(){if(ue.Z.N.call(this),this.i){var e=this.i;for(const t in e.g){const n=e.g[t];for(let e=0;e<n.length;e++)z(n[e]);delete e.g[t],e.h--}}this.G=null},ue.prototype.J=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ue.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class fe extends P{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:de(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function pe(e){P.call(this),this.h=e,this.g={}}l(pe,P);var me=[];function ge(e){q(e.g,(function(e,t){this.g.hasOwnProperty(t)&&re(e)}),e),e.g={}}pe.prototype.N=function(){pe.Z.N.call(this),ge(this)},pe.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ye=s.JSON.stringify,ve=s.JSON.parse,we=class{stringify(e){return s.JSON.stringify(e,void 0)}parse(e){return s.JSON.parse(e,void 0)}};function be(){}function _e(){}var Ee={OPEN:"a",hb:"b",ERROR:"c",tb:"d"};function Ie(){D.call(this,"d")}function Te(){D.call(this,"c")}l(Ie,D),l(Te,D);var ke={},Se=null;function Ae(){return Se=Se||new ue}function Ce(e){D.call(this,ke.Ia,e)}function Ne(e){const t=Ae();le(t,new Ce(t))}function Re(e,t){D.call(this,ke.STAT_EVENT,e),this.stat=t}function Oe(e){const t=Ae();le(t,new Re(t,e))}function xe(e,t){D.call(this,ke.Ja,e),this.size=t}function Le(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return s.setTimeout((function(){e()}),t)}function Pe(){this.g=!0}function De(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{const s=JSON.parse(t);if(s)for(e=0;e<s.length;e++)if(Array.isArray(s[e])){var n=s[e];if(!(n.length<2)){var r=n[1];if(Array.isArray(r)&&!(r.length<1)){var i=r[0];if("noop"!=i&&"stop"!=i&&"close"!=i)for(let e=1;e<r.length;e++)r[e]=""}}}return ye(s)}catch(s){return t}}(e,n)+(r?" "+r:"")}))}ke.Ia="serverreachability",l(Ce,D),ke.STAT_EVENT="statevent",l(Re,D),ke.Ja="timingevent",l(xe,D),Pe.prototype.ua=function(){this.g=!1},Pe.prototype.info=function(){};var Me,Ue={NO_ERROR:0,cb:1,qb:2,pb:3,kb:4,ob:5,rb:6,Ga:7,TIMEOUT:8,ub:9},Ve={ib:"complete",Fb:"success",ERROR:"error",Ga:"abort",xb:"ready",yb:"readystatechange",TIMEOUT:"timeout",sb:"incrementaldata",wb:"progress",lb:"downloadprogress",Nb:"uploadprogress"};function Fe(){}function je(e){return encodeURIComponent(String(e))}function Be(e){var t=1;e=e.split(":");const n=[];for(;t>0&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function ze(e,t,n,r){this.j=e,this.i=t,this.l=n,this.S=r||1,this.V=new pe(this),this.H=45e3,this.J=null,this.o=!1,this.u=this.B=this.A=this.M=this.F=this.T=this.D=null,this.G=[],this.g=null,this.C=0,this.m=this.v=null,this.X=-1,this.K=!1,this.P=0,this.O=null,this.W=this.L=this.U=this.R=!1,this.h=new qe}function qe(){this.i=null,this.g="",this.h=!1}l(Fe,be),Fe.prototype.g=function(){return new XMLHttpRequest},Me=new Fe;var $e={},Ke={};function Ge(e,t,n){e.M=1,e.A=yt(dt(t)),e.u=n,e.R=!0,He(e,null)}function He(e,t){e.F=Date.now(),Qe(e),e.B=dt(e.A);var n=e.B,r=e.S;Array.isArray(r)||(r=[String(r)]),Ot(n.i,"t",r),e.C=0,n=e.j.L,e.h=new qe,e.g=vn(e.j,n?t:null,!e.u),e.P>0&&(e.O=new fe(c(e.Y,e,e.g),e.P)),t=e.V,n=e.g,r=e.ba;var i="readystatechange";Array.isArray(i)||(i&&(me[0]=i.toString()),i=me);for(let s=0;s<i.length;s++){const e=J(n,i[s],r||t.handleEvent,!1,t.h||t);if(!e)break;t.g[e.key]=e}t=e.J?$(e.J):{},e.u?(e.v||(e.v="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.B,e.v,e.u,t)):(e.v="GET",e.g.ea(e.B,e.v,null,t)),Ne(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s){var o="",a=s.split("&");for(let e=0;e<a.length;e++){var c=a[e].split("=");if(c.length>1){const e=c[0];c=c[1];const t=e.split("_");o=t.length>=2&&"type"==t[1]?o+(e+"=")+c+"&":o+(e+"=redacted&")}}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.v,e.B,e.l,e.S,e.u)}function We(e){return!!e.g&&("GET"==e.v&&2!=e.M&&e.j.Aa)}function Xe(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ke:(n=Number(t.substring(n,r)),isNaN(n)?$e:(r+=1)+n>t.length?Ke:(t=t.slice(r,r+n),e.C=r+n,t))}function Qe(e){e.T=Date.now()+e.H,Ye(e,e.H)}function Ye(e,t){if(null!=e.D)throw Error("WatchDog timer not null");e.D=Le(c(e.aa,e),t)}function Je(e){e.D&&(s.clearTimeout(e.D),e.D=null)}function Ze(e){0==e.j.I||e.K||fn(e.j,e)}function et(e){Je(e);var t=e.O;t&&"function"==typeof t.dispose&&t.dispose(),e.O=null,ge(e.V),e.g&&(t=e.g,e.g=null,t.abort(),t.dispose())}function tt(e,t){try{var n=e.j;if(0!=n.I&&(n.g==e||ot(n.h,e)))if(!e.L&&ot(n.h,e)&&3==n.I){try{var r=n.Ba.g.parse(t)}catch(l){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.v){if(n.g){if(!(n.g.F+3e3<e.F))break e;dn(n),tn(n)}un(n),Oe(18)}}else n.xa=i[1],0<n.xa-n.K&&i[2]<37500&&n.F&&0==n.A&&!n.C&&(n.C=Le(c(n.Va,n),6e3));st(n.h)<=1&&n.ta&&(n.ta=void 0)}else mn(n,11)}else if((e.L||n.g==e)&&dn(n),!U(t))for(i=n.Ba.g.parse(t),t=0;t<i.length;t++){let c=i[t];const l=c[0];if(!(l<=n.K))if(n.K=l,c=c[1],2==n.I)if("c"==c[0]){n.M=c[1],n.ba=c[2];const t=c[3];null!=t&&(n.ka=t,n.j.info("VER="+n.ka));const i=c[4];null!=i&&(n.za=i,n.j.info("SVER="+n.za));const l=c[5];null!=l&&"number"===typeof l&&l>0&&(r=1.5*l,n.O=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(at(s,s.h),s.h=null))}if(r.G){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.wa=e,gt(r.J,r.G,e))}}n.I=3,n.l&&n.l.ra(),n.aa&&(n.T=Date.now()-e.F,n.j.info("Handshake RTT: "+n.T+"ms"));var o=e;if((r=n).na=yn(r,r.L?r.ba:null,r.W),o.L){ct(r.h,o);var a=o,u=r.O;u&&(a.H=u),a.D&&(Je(a),Qe(a)),r.g=o}else cn(r);n.i.length>0&&rn(n)}else"stop"!=c[0]&&"close"!=c[0]||mn(n,7);else 3==n.I&&("stop"==c[0]||"close"==c[0]?"stop"==c[0]?mn(n,7):en(n):"noop"!=c[0]&&n.l&&n.l.qa(c),n.A=0)}Ne()}catch(l){}}ze.prototype.ba=function(e){e=e.target;const t=this.O;t&&3==Qt(e)?t.j():this.Y(e)},ze.prototype.Y=function(e){try{if(e==this.g)e:{const c=Qt(this.g),u=this.g.ya();this.g.ca();if(!(c<3)&&(3!=c||this.g&&(this.h.h||this.g.la()||Yt(this.g)))){this.K||4!=c||7==u||Ne(),Je(this);var t=this.g.ca();this.X=t;var n=function(e){if(!We(e))return e.g.la();const t=Yt(e.g);if(""===t)return"";let n="";const r=t.length,i=4==Qt(e.g);if(!e.h.i){if("undefined"===typeof TextDecoder)return et(e),Ze(e),"";e.h.i=new s.TextDecoder}for(let s=0;s<r;s++)e.h.h=!0,n+=e.h.i.decode(t[s],{stream:!(i&&s==r-1)});return t.length=0,e.h.g+=n,e.C=0,e.h.g}(this);if(this.o=200==t,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.i,this.v,this.B,this.l,this.S,c,t),this.o){if(this.U&&!this.L){t:{if(this.g){var r,i=this.g;if((r=i.g?i.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!U(r)){var o=r;break t}}o=null}if(!(e=o)){this.o=!1,this.m=3,Oe(12),et(this),Ze(this);break e}De(this.i,this.l,e,"Initial handshake response via X-HTTP-Initial-Response"),this.L=!0,tt(this,e)}if(this.R){let t;for(e=!0;!this.K&&this.C<n.length;){if(t=Xe(this,n),t==Ke){4==c&&(this.m=4,Oe(14),e=!1),De(this.i,this.l,null,"[Incomplete Response]");break}if(t==$e){this.m=4,Oe(15),De(this.i,this.l,n,"[Invalid Chunk]"),e=!1;break}De(this.i,this.l,t,null),tt(this,t)}if(We(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=c||0!=n.length||this.h.h||(this.m=1,Oe(16),e=!1),this.o=this.o&&e,e){if(n.length>0&&!this.W){this.W=!0;var a=this.j;a.g==this&&a.aa&&!a.P&&(a.j.info("Great, no buffering proxy detected. Bytes received: "+n.length),ln(a),a.P=!0,Oe(11))}}else De(this.i,this.l,n,"[Invalid Chunked Response]"),et(this),Ze(this)}else De(this.i,this.l,n,null),tt(this,n);4==c&&et(this),this.o&&!this.K&&(4==c?fn(this.j,this):(this.o=!1,Qe(this)))}else(function(e){const t={};e=(e.g&&Qt(e)>=2&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(U(e[r]))continue;var n=Be(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==t&&n.indexOf("Unknown SID")>0?(this.m=3,Oe(12)):(this.m=0,Oe(13)),et(this),Ze(this)}}}catch(te){}},ze.prototype.cancel=function(){this.K=!0,et(this)},ze.prototype.aa=function(){this.D=null;const e=Date.now();e-this.T>=0?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.B),2!=this.M&&(Ne(),Oe(17)),et(this),this.m=2,Ze(this)):Ye(this,this.T-e)};var nt=class{constructor(e,t){this.g=e,this.map=t}};function rt(e){this.l=e||10,s.PerformanceNavigationTiming?e=(e=s.performance.getEntriesByType("navigation")).length>0&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,this.j>1&&(this.g=new Set),this.h=null,this.i=[]}function it(e){return!!e.h||!!e.g&&e.g.size>=e.j}function st(e){return e.h?1:e.g?e.g.size:0}function ot(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function at(e,t){e.g?e.g.add(t):e.h=t}function ct(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function ut(e){if(null!=e.h)return e.i.concat(e.h.G);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.G);return t}return E(e.i)}rt.prototype.cancel=function(){if(this.i=ut(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var lt=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function ht(e){let t;this.g=this.o=this.j="",this.u=null,this.m=this.h="",this.l=!1,e instanceof ht?(this.l=e.l,ft(this,e.j),this.o=e.o,this.g=e.g,pt(this,e.u),this.h=e.h,mt(this,xt(e.i)),this.m=e.m):e&&(t=String(e).match(lt))?(this.l=!1,ft(this,t[1]||"",!0),this.o=vt(t[2]||""),this.g=vt(t[3]||"",!0),pt(this,t[4]),this.h=vt(t[5]||"",!0),mt(this,t[6]||"",!0),this.m=vt(t[7]||"")):(this.l=!1,this.i=new St(null,this.l))}function dt(e){return new ht(e)}function ft(e,t,n){e.j=n?vt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function pt(e,t){if(t){if(t=Number(t),isNaN(t)||t<0)throw Error("Bad port number "+t);e.u=t}else e.u=null}function mt(e,t,n){t instanceof St?(e.i=t,function(e,t){t&&!e.j&&(At(e),e.i=null,e.g.forEach((function(e,t){const n=t.toLowerCase();t!=n&&(Ct(this,t),Ot(this,n,e))}),e)),e.j=t}(e.i,e.l)):(n||(t=wt(t,Tt)),e.i=new St(t,e.l))}function gt(e,t,n){e.i.set(t,n)}function yt(e){return gt(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function vt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function wt(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,bt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function bt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}ht.prototype.toString=function(){const e=[];var t=this.j;t&&e.push(wt(t,_t,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(wt(t,_t,!0),"@"),e.push(je(n).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.u)&&e.push(":",String(n))),(n=this.h)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(wt(n,"/"==n.charAt(0)?It:Et,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",wt(n,kt)),e.join("")},ht.prototype.resolve=function(e){const t=dt(this);let n=!!e.j;n?ft(t,e.j):n=!!e.o,n?t.o=e.o:n=!!e.g,n?t.g=e.g:n=null!=e.u;var r=e.h;if(n)pt(t,e.u);else if(n=!!e.h){if("/"!=r.charAt(0))if(this.g&&!this.h)r="/"+r;else{var i=t.h.lastIndexOf("/");-1!=i&&(r=t.h.slice(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");const e=[];for(let t=0;t<i.length;){const n=i[t++];"."==n?r&&t==i.length&&e.push(""):".."==n?((e.length>1||1==e.length&&""!=e[0])&&e.pop(),r&&t==i.length&&e.push("")):(e.push(n),r=!0)}r=e.join("/")}else r=i}return n?t.h=r:n=""!==e.i.toString(),n?mt(t,xt(e.i)):n=!!e.m,n&&(t.m=e.m),t};var _t=/[#\/\?@]/g,Et=/[#\?:]/g,It=/[#\?]/g,Tt=/[#\?@]/g,kt=/#/g;function St(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function At(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(let n=0;n<e.length;n++){const r=e[n].indexOf("=");let i,s=null;r>=0?(i=e[n].substring(0,r),s=e[n].substring(r+1)):i=e[n],t(i,s?decodeURIComponent(s.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function Ct(e,t){At(e),t=Lt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Nt(e,t){return At(e),t=Lt(e,t),e.g.has(t)}function Rt(e,t){At(e);let n=[];if("string"===typeof t)Nt(e,t)&&(n=n.concat(e.g.get(Lt(e,t))));else for(e=Array.from(e.g.values()),t=0;t<e.length;t++)n=n.concat(e[t]);return n}function Ot(e,t,n){Ct(e,t),n.length>0&&(e.i=null,e.g.set(Lt(e,t),E(n)),e.h+=n.length)}function xt(e){const t=new St;return t.i=e.i,e.g&&(t.g=new Map(e.g),t.h=e.h),t}function Lt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Pt(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function Dt(){this.g=new we}function Mt(e){this.i=e.Sb||null,this.h=e.ab||!1}function Ut(e,t){ue.call(this),this.H=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.A=new Headers,this.h=null,this.F="GET",this.D="",this.g=!1,this.B=this.j=this.l=null,this.v=new AbortController}function Vt(e){e.j.read().then(e.Ma.bind(e)).catch(e.ga.bind(e))}function Ft(e){e.readyState=4,e.l=null,e.j=null,e.B=null,jt(e)}function jt(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Bt(e){let t="";return q(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function zt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Bt(n),"string"===typeof e?null!=n&&je(n):gt(e,t,n))}function qt(e){ue.call(this),this.headers=new Map,this.L=e||null,this.h=!1,this.g=null,this.D="",this.o=0,this.l="",this.j=this.B=this.v=this.A=!1,this.m=null,this.F="",this.H=!1}(e=St.prototype).add=function(e,t){At(this),this.i=null,e=Lt(this,e);let n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){At(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.set=function(e,t){return At(this),this.i=null,Nt(this,e=Lt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&(e=Rt(this,e)).length>0?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(let r=0;r<t.length;r++){var n=t[r];const i=je(n);n=Rt(this,n);for(let t=0;t<n.length;t++){let r=i;""!==n[t]&&(r+="="+je(n[t])),e.push(r)}}return this.i=e.join("&")},l(Mt,be),Mt.prototype.g=function(){return new Ut(this.i,this.h)},l(Ut,ue),(e=Ut.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.F=e,this.D=t,this.readyState=1,jt(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");if(this.v.signal.aborted)throw this.abort(),Error("Request was aborted.");this.g=!0;const t={headers:this.A,method:this.F,credentials:this.m,cache:void 0,signal:this.v.signal};e&&(t.body=e),(this.H||s).fetch(new Request(this.D,t)).then(this.Pa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.A=new Headers,this.status=0,this.v.abort(),this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),this.readyState>=1&&this.g&&4!=this.readyState&&(this.g=!1,Ft(this)),this.readyState=0},e.Pa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,jt(this)),this.g&&(this.readyState=3,jt(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Na.bind(this),this.ga.bind(this));else if("undefined"!==typeof s.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.B=new TextDecoder;Vt(this)}else e.text().then(this.Oa.bind(this),this.ga.bind(this))},e.Ma=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.B.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Ft(this):jt(this),3==this.readyState&&Vt(this)}},e.Oa=function(e){this.g&&(this.response=this.responseText=e,Ft(this))},e.Na=function(e){this.g&&(this.response=e,Ft(this))},e.ga=function(){this.g&&Ft(this)},e.setRequestHeader=function(e,t){this.A.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Ut.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),l(qt,ue);var $t=/^https?$/i,Kt=["POST","PUT"];function Gt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.o=5,Ht(e),Xt(e)}function Ht(e){e.A||(e.A=!0,le(e,"complete"),le(e,"error"))}function Wt(e){if(e.h&&"undefined"!=typeof i)if(e.v&&4==Qt(e))setTimeout(e.Ca.bind(e),0);else if(le(e,"readystatechange"),4==Qt(e)){e.h=!1;try{const i=e.ca();e:switch(i){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var r;if(r=0===i){let t=String(e.D).match(lt)[1]||null;!t&&s.self&&s.self.location&&(t=s.self.location.protocol.slice(0,-1)),r=!$t.test(t?t.toLowerCase():"")}n=r}if(n)le(e,"complete"),le(e,"success");else{e.o=6;try{var o=Qt(e)>2?e.g.statusText:""}catch(a){o=""}e.l=o+" ["+e.ca()+"]",Ht(e)}}finally{Xt(e)}}}function Xt(e,t){if(e.g){e.m&&(clearTimeout(e.m),e.m=null);const r=e.g;e.g=null,t||le(e,"ready");try{r.onreadystatechange=null}catch(n){}}}function Qt(e){return e.g?e.g.readyState:0}function Yt(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.F){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(t){return null}}function Jt(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function Zt(e){this.za=0,this.i=[],this.j=new Pe,this.ba=this.na=this.J=this.W=this.g=this.wa=this.G=this.H=this.u=this.U=this.o=null,this.Ya=this.V=0,this.Sa=Jt("failFast",!1,e),this.F=this.C=this.v=this.m=this.l=null,this.X=!0,this.xa=this.K=-1,this.Y=this.A=this.D=0,this.Qa=Jt("baseRetryDelayMs",5e3,e),this.Za=Jt("retryDelaySeedMs",1e4,e),this.Ta=Jt("forwardChannelMaxRetries",2,e),this.va=Jt("forwardChannelRequestTimeoutMs",2e4,e),this.ma=e&&e.xmlHttpFactory||void 0,this.Ua=e&&e.Rb||void 0,this.Aa=e&&e.useFetchStreams||!1,this.O=void 0,this.L=e&&e.supportsCrossDomainXhr||!1,this.M="",this.h=new rt(e&&e.concurrentRequestLimit),this.Ba=new Dt,this.S=e&&e.fastHandshake||!1,this.R=e&&e.encodeInitMessageHeaders||!1,this.S&&this.R&&(this.R=!1),this.Ra=e&&e.Pb||!1,e&&e.ua&&this.j.ua(),e&&e.forceLongPolling&&(this.X=!1),this.aa=!this.S&&this.X&&e&&e.detectBufferingProxy||!1,this.ia=void 0,e&&e.longPollingTimeout&&e.longPollingTimeout>0&&(this.ia=e.longPollingTimeout),this.ta=void 0,this.T=0,this.P=!1,this.ja=this.B=null}function en(e){if(nn(e),3==e.I){var t=e.V++,n=dt(e.J);if(gt(n,"SID",e.M),gt(n,"RID",t),gt(n,"TYPE","terminate"),on(e,n),(t=new ze(e,e.j,t)).M=2,t.A=yt(dt(n)),n=!1,s.navigator&&s.navigator.sendBeacon)try{n=s.navigator.sendBeacon(t.A.toString(),"")}catch(r){}!n&&s.Image&&((new Image).src=t.A,n=!0),n||(t.g=vn(t.j,null),t.g.ea(t.A)),t.F=Date.now(),Qe(t)}gn(e)}function tn(e){e.g&&(ln(e),e.g.cancel(),e.g=null)}function nn(e){tn(e),e.v&&(s.clearTimeout(e.v),e.v=null),dn(e),e.h.cancel(),e.m&&("number"===typeof e.m&&s.clearTimeout(e.m),e.m=null)}function rn(e){if(!it(e.h)&&!e.m){e.m=!0;var t=e.Ea;N||x(),R||(N(),R=!0),O.add(t,e),e.D=0}}function sn(e,t){var n;n=t?t.l:e.V++;const r=dt(e.J);gt(r,"SID",e.M),gt(r,"RID",n),gt(r,"AID",e.K),on(e,r),e.u&&e.o&&zt(r,e.u,e.o),n=new ze(e,e.j,n,e.D+1),null===e.u&&(n.J=e.o),t&&(e.i=t.G.concat(e.i)),t=an(e,n,1e3),n.H=Math.round(.5*e.va)+Math.round(.5*e.va*Math.random()),at(e.h,n),Ge(n,r,t)}function on(e,t){e.H&&q(e.H,(function(e,n){gt(t,n,e)})),e.l&&q({},(function(e,n){gt(t,n,e)}))}function an(e,t,n){n=Math.min(e.i.length,n);const r=e.l?c(e.l.Ka,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?n>0?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let c=!0;for(let u=0;u<n;u++){var s=i[u].g;const n=i[u].map;if((s-=t)<0)t=Math.max(0,i[u].g-100),c=!1;else try{s="req"+s+"_"||0;try{var a=n instanceof Map?n:Object.entries(n);for(const[t,n]of a){let r=n;o(n)&&(r=ye(n)),e.push(s+t+"="+encodeURIComponent(r))}}catch(I){throw e.push(s+"type="+encodeURIComponent("_badmap")),I}}catch(I){r&&r(n)}}if(c){a=e.join("&");break e}}a=void 0}return e=e.i.splice(0,n),t.G=e,a}function cn(e){if(!e.g&&!e.v){e.Y=1;var t=e.Da;N||x(),R||(N(),R=!0),O.add(t,e),e.A=0}}function un(e){return!(e.g||e.v||e.A>=3)&&(e.Y++,e.v=Le(c(e.Da,e),pn(e,e.A)),e.A++,!0)}function ln(e){null!=e.B&&(s.clearTimeout(e.B),e.B=null)}function hn(e){e.g=new ze(e,e.j,"rpc",e.Y),null===e.u&&(e.g.J=e.o),e.g.P=0;var t=dt(e.na);gt(t,"RID","rpc"),gt(t,"SID",e.M),gt(t,"AID",e.K),gt(t,"CI",e.F?"0":"1"),!e.F&&e.ia&&gt(t,"TO",e.ia),gt(t,"TYPE","xmlhttp"),on(e,t),e.u&&e.o&&zt(t,e.u,e.o),e.O&&(e.g.H=e.O);var n=e.g;e=e.ba,n.M=1,n.A=yt(dt(t)),n.u=null,n.R=!0,He(n,e)}function dn(e){null!=e.C&&(s.clearTimeout(e.C),e.C=null)}function fn(e,t){var n=null;if(e.g==t){dn(e),ln(e),e.g=null;var r=2}else{if(!ot(e.h,t))return;n=t.G,ct(e.h,t),r=1}if(0!=e.I)if(t.o)if(1==r){n=t.u?t.u.length:0,t=Date.now()-t.F;var i=e.D;le(r=Ae(),new xe(r,n)),rn(e)}else cn(e);else if(3==(i=t.m)||0==i&&t.X>0||!(1==r&&function(e,t){return!(st(e.h)>=e.h.j-(e.m?1:0))&&(e.m?(e.i=t.G.concat(e.i),!0):!(1==e.I||2==e.I||e.D>=(e.Sa?0:e.Ta))&&(e.m=Le(c(e.Ea,e,t),pn(e,e.D)),e.D++,!0))}(e,t)||2==r&&un(e)))switch(n&&n.length>0&&(t=e.h,t.i=t.i.concat(n)),i){case 1:mn(e,5);break;case 4:mn(e,10);break;case 3:mn(e,6);break;default:mn(e,2)}}function pn(e,t){let n=e.Qa+Math.floor(Math.random()*e.Za);return e.isActive()||(n*=2),n*t}function mn(e,t){if(e.j.info("Error code "+t),2==t){var n=c(e.bb,e),r=e.Ua;const t=!r;r=new ht(r||"//www.google.com/images/cleardot.gif"),s.location&&"http"==s.location.protocol||ft(r,"https"),yt(r),t?function(e,t){const n=new Pe;if(s.Image){const r=new Image;r.onload=u(Pt,n,"TestLoadImage: loaded",!0,t,r),r.onerror=u(Pt,n,"TestLoadImage: error",!1,t,r),r.onabort=u(Pt,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=u(Pt,n,"TestLoadImage: timeout",!1,t,r),s.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Pe;const n=new AbortController,r=setTimeout((()=>{n.abort(),Pt(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Pt(0,0,!0,t):Pt(0,0,!1,t)})).catch((()=>{clearTimeout(r),Pt(0,0,!1,t)}))}(r.toString(),n)}else Oe(2);e.I=0,e.l&&e.l.pa(t),gn(e),nn(e)}function gn(e){if(e.I=0,e.ja=[],e.l){const t=ut(e.h);0==t.length&&0==e.i.length||(T(e.ja,t),T(e.ja,e.i),e.h.i.length=0,E(e.i),e.i.length=0),e.l.oa()}}function yn(e,t,n){var r=n instanceof ht?dt(n):new ht(n);if(""!=r.g)t&&(r.g=t+"."+r.g),pt(r,r.u);else{var i=s.location;r=i.protocol,t=t?t+"."+i.hostname:i.hostname,i=+i.port;const e=new ht(null);r&&ft(e,r),t&&(e.g=t),i&&pt(e,i),n&&(e.h=n),r=e}return n=e.G,t=e.wa,n&&t&&gt(r,n,t),gt(r,"VER",e.ka),on(e,r),r}function vn(e,t,n){if(t&&!e.L)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Aa&&!e.ma?new qt(new Mt({ab:n})):new qt(e.ma)).Fa(e.L),t}function wn(){}function bn(){}function _n(e,t){ue.call(this),this.g=new Zt(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.sa&&(e?e["X-WebChannel-Client-Profile"]=t.sa:e={"X-WebChannel-Client-Profile":t.sa}),this.g.U=e,(e=t&&t.Qb)&&!U(e)&&(this.g.u=e),this.A=t&&t.supportsCrossDomainXhr||!1,this.v=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!U(t)&&(this.g.G=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Tn(this)}function En(e){Ie.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function In(){Te.call(this),this.status=1}function Tn(e){this.g=e}(e=qt.prototype).Fa=function(e){this.H=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.o=0,this.A=!1,this.h=!0,this.g=this.L?this.L.g():Me.g(),this.g.onreadystatechange=_(c(this.Ca,this));try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Gt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var i in r)n.set(i,r[i]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),i=s.FormData&&e instanceof s.FormData,!(Array.prototype.indexOf.call(Kt,t,void 0)>=0)||r||i||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[s,a]of n)this.g.setRequestHeader(s,a);this.F&&(this.g.responseType=this.F),"withCredentials"in this.g&&this.g.withCredentials!==this.H&&(this.g.withCredentials=this.H);try{this.m&&(clearTimeout(this.m),this.m=null),this.v=!0,this.g.send(e),this.v=!1}catch(o){Gt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.o=e||7,le(this,"complete"),le(this,"abort"),Xt(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),Xt(this,!0)),qt.Z.N.call(this)},e.Ca=function(){this.u||(this.B||this.v||this.j?Wt(this):this.Xa())},e.Xa=function(){Wt(this)},e.isActive=function(){return!!this.g},e.ca=function(){try{return Qt(this)>2?this.g.status:-1}catch(e){return-1}},e.la=function(){try{return this.g?this.g.responseText:""}catch(e){return""}},e.La=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),ve(t)}},e.ya=function(){return this.o},e.Ha=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=Zt.prototype).ka=8,e.I=1,e.connect=function(e,t,n,r){Oe(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.J=yn(this,null,this.W),rn(this)},e.Ea=function(e){if(this.m)if(this.m=null,1==this.I){if(!e){this.V=Math.floor(1e5*Math.random()),e=this.V++;const i=new ze(this,this.j,e);let s=this.o;if(this.U&&(s?(s=$(s),G(s,this.U)):s=this.U),null!==this.u||this.R||(i.J=s,s=null),this.S)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if((t+=r)>4096){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=an(this,i,t),gt(n=dt(this.J),"RID",e),gt(n,"CVER",22),this.G&&gt(n,"X-HTTP-Session-Id",this.G),on(this,n),s&&(this.R?t="headers="+je(Bt(s))+"&"+t:this.u&&zt(n,this.u,s)),at(this.h,i),this.Ra&&gt(n,"TYPE","init"),this.S?(gt(n,"$req",t),gt(n,"SID","null"),i.U=!0,Ge(i,n,null)):Ge(i,n,t),this.I=2}}else 3==this.I&&(e?sn(this,e):0==this.i.length||it(this.h)||sn(this))},e.Da=function(){if(this.v=null,hn(this),this.aa&&!(this.P||null==this.g||this.T<=0)){var e=4*this.T;this.j.info("BP detection timer enabled: "+e),this.B=Le(c(this.Wa,this),e)}},e.Wa=function(){this.B&&(this.B=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.P=!0,Oe(10),tn(this),hn(this))},e.Va=function(){null!=this.C&&(this.C=null,tn(this),un(this),Oe(19))},e.bb=function(e){e?(this.j.info("Successfully pinged google.com"),Oe(2)):(this.j.info("Failed to ping google.com"),Oe(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=wn.prototype).ra=function(){},e.qa=function(){},e.pa=function(){},e.oa=function(){},e.isActive=function(){return!0},e.Ka=function(){},bn.prototype.g=function(e,t){return new _n(e,t)},l(_n,ue),_n.prototype.m=function(){this.g.l=this.j,this.A&&(this.g.L=!0),this.g.connect(this.l,this.h||void 0)},_n.prototype.close=function(){en(this.g)},_n.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.v&&((n={}).__data__=ye(e),e=n);t.i.push(new nt(t.Ya++,e)),3==t.I&&rn(t)},_n.prototype.N=function(){this.g.l=null,delete this.j,en(this.g),delete this.g,_n.Z.N.call(this)},l(En,Ie),l(In,Te),l(Tn,wn),Tn.prototype.ra=function(){le(this.g,"a")},Tn.prototype.qa=function(e){le(this.g,new En(e))},Tn.prototype.pa=function(e){le(this.g,new In)},Tn.prototype.oa=function(){le(this.g,"b")},bn.prototype.createWebChannel=bn.prototype.g,_n.prototype.send=_n.prototype.o,_n.prototype.open=_n.prototype.m,_n.prototype.close=_n.prototype.close,v=b.createWebChannelTransport=function(){return new bn},y=b.getStatEventTarget=function(){return Ae()},g=b.Event=ke,m=b.Stat={jb:0,mb:1,nb:2,Hb:3,Mb:4,Jb:5,Kb:6,Ib:7,Gb:8,Lb:9,PROXY:10,NOPROXY:11,Eb:12,Ab:13,Bb:14,zb:15,Cb:16,Db:17,fb:18,eb:19,gb:20},Ue.NO_ERROR=0,Ue.TIMEOUT=8,Ue.HTTP_ERROR=6,p=b.ErrorCode=Ue,Ve.COMPLETE="complete",f=b.EventType=Ve,_e.EventType=Ee,Ee.OPEN="a",Ee.CLOSE="b",Ee.ERROR="c",Ee.MESSAGE="d",ue.prototype.listen=ue.prototype.J,d=b.WebChannel=_e,b.FetchXmlHttpFactory=Mt,qt.prototype.listenOnce=qt.prototype.K,qt.prototype.getLastError=qt.prototype.Ha,qt.prototype.getLastErrorCode=qt.prototype.ya,qt.prototype.getStatus=qt.prototype.ca,qt.prototype.getResponseJson=qt.prototype.La,qt.prototype.getResponseText=qt.prototype.la,qt.prototype.send=qt.prototype.ea,qt.prototype.setWithCredentials=qt.prototype.Fa,h=b.XhrIo=qt}).apply("undefined"!==typeof w?w:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});n(34155);var _=n(48764).lW;const E="@firebase/firestore",I="4.9.2";class T{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}T.UNAUTHENTICATED=new T(null),T.GOOGLE_CREDENTIALS=new T("google-credentials-uid"),T.FIRST_PARTY=new T("first-party-uid"),T.MOCK_USER=new T("mock-user");let k="12.3.0";const S=new a.Yd("@firebase/firestore");function A(){return S.logLevel}function C(e,...t){if(S.logLevel<=a.in.DEBUG){const n=t.map(O);S.debug(`Firestore (${k}): ${e}`,...n)}}function N(e,...t){if(S.logLevel<=a.in.ERROR){const n=t.map(O);S.error(`Firestore (${k}): ${e}`,...n)}}function R(e,...t){if(S.logLevel<=a.in.WARN){const n=t.map(O);S.warn(`Firestore (${k}): ${e}`,...n)}}function O(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function x(e,t,n){let r="Unexpected state";"string"==typeof t?r=t:n=t,L(e,r,n)}function L(e,t,n){let r=`FIRESTORE (${k}) INTERNAL ASSERTION FAILED: ${t} (ID: ${e.toString(16)})`;if(void 0!==n)try{r+=" CONTEXT: "+JSON.stringify(n)}catch(e){r+=" CONTEXT: "+n}throw N(r),new Error(r)}function P(e,t,n,r){let i="Unexpected state";"string"==typeof n?i=n:r=n,e||L(t,i,r)}function D(e,t){return e}const M={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class U extends c.ZR{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class V{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class F{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class j{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(T.UNAUTHENTICATED)))}shutdown(){}}class B{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class z{constructor(e){this.t=e,this.currentUser=T.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){P(void 0===this.o,42304);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new V;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new V,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{C("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(C("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new V)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(C("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(P("string"==typeof t.accessToken,31837,{l:t}),new F(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return P(null===e||"string"==typeof e,2055,{h:e}),new T(e)}}class q{constructor(e,t,n){this.P=e,this.T=t,this.I=n,this.type="FirstParty",this.user=T.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class ${constructor(e,t,n){this.P=e,this.T=t,this.I=n}getToken(){return Promise.resolve(new q(this.P,this.T,this.I))}start(e,t){e.enqueueRetryable((()=>t(T.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class K{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class G{constructor(e,t){this.V=t,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,(0,s.rh)(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,t){P(void 0===this.o,3512);const n=e=>{null!=e.error&&C("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.m;return this.m=e.token,C("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{C("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.V.getImmediate({optional:!0});e?r(e):C("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){if(this.p)return Promise.resolve(new K(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(P("string"==typeof e.token,44558,{tokenResult:e}),this.m=e.token,new K(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function H(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class W{static newId(){const e=62*Math.floor(256/62);let t="";for(;t.length<20;){const n=H(40);for(let r=0;r<n.length;++r)t.length<20&&n[r]<e&&(t+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".charAt(n[r]%62))}return t}}function X(e,t){return e<t?-1:e>t?1:0}function Q(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.charAt(r),i=t.charAt(r);if(n!==i)return Z(n)===Z(i)?X(n,i):Z(n)?1:-1}return X(e.length,t.length)}const Y=55296,J=57343;function Z(e){const t=e.charCodeAt(0);return t>=Y&&t<=J}function ee(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}const te="__name__";class ne{constructor(e,t,n){void 0===t?t=0:t>e.length&&x(637,{offset:t,range:e.length}),void 0===n?n=e.length-t:n>e.length-t&&x(1746,{length:n,range:e.length-t}),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===ne.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof ne?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=ne.compareSegments(e.get(r),t.get(r));if(0!==n)return n}return X(e.length,t.length)}static compareSegments(e,t){const n=ne.isNumericId(e),r=ne.isNumericId(t);return n&&!r?-1:!n&&r?1:n&&r?ne.extractNumericId(e).compare(ne.extractNumericId(t)):Q(e,t)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return r.fromString(e.substring(4,e.length-2))}}class re extends ne{construct(e,t,n){return new re(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const t=[];for(const n of e){if(n.indexOf("//")>=0)throw new U(M.INVALID_ARGUMENT,`Invalid segment (${n}). Paths must not contain // in them.`);t.push(...n.split("/").filter((e=>e.length>0)))}return new re(t)}static emptyPath(){return new re([])}}const ie=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class se extends ne{construct(e,t,n){return new se(e,t,n)}static isValidIdentifier(e){return ie.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),se.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&this.get(0)===te}static keyField(){return new se([te])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new U(M.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new U(M.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new U(M.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new U(M.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new se(t)}static emptyPath(){return new se([])}}class oe{constructor(e){this.path=e}static fromPath(e){return new oe(re.fromString(e))}static fromName(e){return new oe(re.fromString(e).popFirst(5))}static empty(){return new oe(re.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===re.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return re.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new oe(new re(e.slice()))}}function ae(e,t,n){if(!n)throw new U(M.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ce(e){if(!oe.isDocumentKey(e))throw new U(M.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ue(e){if(oe.isDocumentKey(e))throw new U(M.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function le(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}function he(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":x(12329,{type:typeof e})}function de(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new U(M.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=he(e);throw new U(M.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function fe(e,t){if(t<=0)throw new U(M.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}function pe(e,t){const n={typeString:e};return t&&(n.value=t),n}function me(e,t){if(!le(e))throw new U(M.INVALID_ARGUMENT,"JSON must be an object");let n;for(const r in t)if(t[r]){const i=t[r].typeString,s="value"in t[r]?{value:t[r].value}:void 0;if(!(r in e)){n=`JSON missing required field: '${r}'`;break}const o=e[r];if(i&&typeof o!==i){n=`JSON field '${r}' must be a ${i}.`;break}if(void 0!==s&&o!==s.value){n=`Expected '${r}' field to equal '${s.value}'`;break}}if(n)throw new U(M.INVALID_ARGUMENT,n);return!0}const ge=-62135596800,ye=1e6;class ve{static now(){return ve.fromMillis(Date.now())}static fromDate(e){return ve.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor((e-1e3*t)*ye);return new ve(t,n)}constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new U(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new U(M.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<ge)throw new U(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new U(M.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/ye}_compareTo(e){return this.seconds===e.seconds?X(this.nanoseconds,e.nanoseconds):X(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{type:ve._jsonSchemaVersion,seconds:this.seconds,nanoseconds:this.nanoseconds}}static fromJSON(e){if(me(e,ve._jsonSchema))return new ve(e.seconds,e.nanoseconds)}valueOf(){const e=this.seconds-ge;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}ve._jsonSchemaVersion="firestore/timestamp/1.0",ve._jsonSchema={type:pe("string",ve._jsonSchemaVersion),seconds:pe("number"),nanoseconds:pe("number")};class we{static fromTimestamp(e){return new we(e)}static min(){return new we(new ve(0,0))}static max(){return new we(new ve(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}const be=-1;class _e{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}_e.UNKNOWN_ID=-1;function Ee(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=we.fromTimestamp(1e9===r?new ve(n+1,0):new ve(n,r));return new Te(i,oe.empty(),t)}function Ie(e){return new Te(e.readTime,e.key,be)}class Te{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Te(we.min(),oe.empty(),be)}static max(){return new Te(we.max(),oe.empty(),be)}}function ke(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=oe.comparator(e.documentKey,t.documentKey),0!==n?n:X(e.largestBatchId,t.largestBatchId))}const Se="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Ae{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function Ce(e){if(e.code!==M.FAILED_PRECONDITION||e.message!==Se)throw e;C("LocalStore","Unexpectedly lost primary lease")}class Ne{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&x(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Ne(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Ne?t:Ne.resolve(t)}catch(e){return Ne.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Ne.reject(t)}static resolve(e){return new Ne(((t,n)=>{t(e)}))}static reject(e){return new Ne(((t,n)=>{n(e)}))}static waitFor(e){return new Ne(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Ne.resolve(!1);for(const n of e)t=t.next((e=>e?Ne.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Ne(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const c=a;t(e[c]).next((e=>{s[c]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new Ne(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}function Re(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function Oe(e){return"IndexedDbTransactionError"===e.name}class xe{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ae(e),this.ue=e=>t.writeSequenceNumber(e))}ae(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ue&&this.ue(e),e}}xe.ce=-1;const Le=-1;function Pe(e){return null==e}function De(e){return 0===e&&1/e==-1/0}function Me(e){return"number"==typeof e&&Number.isInteger(e)&&!De(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}const Ue="\x01";function Ve(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=je(t)),t=Fe(e.get(n),t);return je(t)}function Fe(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case Ue:n+="\x01\x11";break;default:n+=t}}return n}function je(e){return e+Ue+"\x01"}const Be="remoteDocuments",ze="owner",qe="mutationQueues",$e="mutations";const Ke="documentMutations",Ge="remoteDocumentsV14",He="remoteDocumentGlobal",We="targets",Xe="targetDocuments",Qe="targetGlobal",Ye="collectionParents",Je="clientMetadata",Ze="bundles",et="namedQueries",tt="indexConfiguration",nt="indexState",rt="indexEntries",it="documentOverlays",st="globals",ot=[qe,$e,Ke,Be,We,ze,Qe,Xe,Je,He,Ye,Ze,et],at=[qe,$e,Ke,Ge,We,ze,Qe,Xe,Je,He,Ye,Ze,et,it],ct=at,ut=[...ct,tt,nt,rt];function lt(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function ht(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function dt(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class ft{constructor(e,t){this.comparator=e,this.root=t||mt.EMPTY}insert(e,t){return new ft(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,mt.BLACK,null,null))}remove(e){return new ft(this.comparator,this.root.remove(e,this.comparator).copy(null,null,mt.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new pt(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new pt(this.root,e,this.comparator,!1)}getReverseIterator(){return new pt(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new pt(this.root,e,this.comparator,!0)}}class pt{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class mt{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:mt.RED,this.left=null!=r?r:mt.EMPTY,this.right=null!=i?i:mt.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new mt(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return mt.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return mt.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,mt.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,mt.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw x(43730,{key:this.key,value:this.value});if(this.right.isRed())throw x(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw x(27949);return e+(this.isRed()?0:1)}}mt.EMPTY=null,mt.RED=!0,mt.BLACK=!1,mt.EMPTY=new class{constructor(){this.size=0}get key(){throw x(57766)}get value(){throw x(16141)}get color(){throw x(16727)}get left(){throw x(29726)}get right(){throw x(36894)}copy(e,t,n,r,i){return this}insert(e,t,n){return new mt(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class gt{constructor(e){this.comparator=e,this.data=new ft(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new yt(this.data.getIterator())}getIteratorFrom(e){return new yt(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof gt))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new gt(this.comparator);return t.data=e,t}}class yt{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}class vt{constructor(e){this.fields=e,e.sort(se.comparator)}static empty(){return new vt([])}unionWith(e){let t=new gt(se.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new vt(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return ee(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class wt extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class bt{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new wt("Invalid base64 string: "+e):e}}(e);return new bt(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new bt(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return X(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}bt.EMPTY_BYTE_STRING=new bt("");const _t=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Et(e){if(P(!!e,39018),"string"==typeof e){let t=0;const n=_t.exec(e);if(P(!!n,46558,{timestamp:e}),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:It(e.seconds),nanos:It(e.nanos)}}function It(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Tt(e){return"string"==typeof e?bt.fromBase64String(e):bt.fromUint8Array(e)}const kt="server_timestamp",St="__type__",At="__previous_value__",Ct="__local_write_time__";function Nt(e){const t=(e?.mapValue?.fields||{})[St]?.stringValue;return t===kt}function Rt(e){const t=e.mapValue.fields[At];return Nt(t)?Rt(t):t}function Ot(e){const t=Et(e.mapValue.fields[Ct].timestampValue);return new ve(t.seconds,t.nanos)}class xt{constructor(e,t,n,r,i,s,o,a,c,u){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=c,this.isUsingEmulator=u}}const Lt="(default)";class Pt{constructor(e,t){this.projectId=e,this.database=t||Lt}static empty(){return new Pt("","")}get isDefaultDatabase(){return this.database===Lt}isEqual(e){return e instanceof Pt&&e.projectId===this.projectId&&e.database===this.database}}const Dt="__type__",Mt="__max__",Ut={mapValue:{fields:{__type__:{stringValue:Mt}}}},Vt="__vector__",Ft="value";function jt(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Nt(e)?4:rn(e)?9007199254740991:tn(e)?10:11:x(28295,{value:e})}function Bt(e,t){if(e===t)return!0;const n=jt(e);if(n!==jt(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return Ot(e).isEqual(Ot(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Et(e.timestampValue),r=Et(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Tt(e.bytesValue).isEqual(Tt(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return It(e.geoPointValue.latitude)===It(t.geoPointValue.latitude)&&It(e.geoPointValue.longitude)===It(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return It(e.integerValue)===It(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=It(e.doubleValue),r=It(t.doubleValue);return n===r?De(n)===De(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return ee(e.arrayValue.values||[],t.arrayValue.values||[],Bt);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(lt(n)!==lt(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!Bt(n[i],r[i])))return!1;return!0}(e,t);default:return x(52216,{left:e})}}function zt(e,t){return void 0!==(e.values||[]).find((e=>Bt(e,t)))}function qt(e,t){if(e===t)return 0;const n=jt(e),r=jt(t);if(n!==r)return X(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return X(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=It(e.integerValue||e.doubleValue),r=It(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return $t(e.timestampValue,t.timestampValue);case 4:return $t(Ot(e),Ot(t));case 5:return Q(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Tt(e),r=Tt(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=X(n[i],r[i]);if(0!==e)return e}return X(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=X(It(e.latitude),It(t.latitude));return 0!==n?n:X(It(e.longitude),It(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return Kt(e.arrayValue,t.arrayValue);case 10:return function(e,t){const n=e.fields||{},r=t.fields||{},i=n[Ft]?.arrayValue,s=r[Ft]?.arrayValue,o=X(i?.values?.length||0,s?.values?.length||0);return 0!==o?o:Kt(i,s)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===Ut.mapValue&&t===Ut.mapValue)return 0;if(e===Ut.mapValue)return 1;if(t===Ut.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=Q(r[o],s[o]);if(0!==e)return e;const t=qt(n[r[o]],i[s[o]]);if(0!==t)return t}return X(r.length,s.length)}(e.mapValue,t.mapValue);default:throw x(23264,{he:n})}}function $t(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return X(e,t);const n=Et(e),r=Et(t),i=X(n.seconds,r.seconds);return 0!==i?i:X(n.nanos,r.nanos)}function Kt(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=qt(n[i],r[i]);if(e)return e}return X(n.length,r.length)}function Gt(e){return Ht(e)}function Ht(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Et(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Tt(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return oe.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=Ht(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${Ht(e.fields[i])}`;return n+"}"}(e.mapValue):x(61005,{value:e})}function Wt(e){switch(jt(e)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const t=Rt(e);return t?16+Wt(t):16;case 5:return 2*e.stringValue.length;case 6:return Tt(e.bytesValue).approximateByteSize();case 7:return e.referenceValue.length;case 9:return function(e){return(e.values||[]).reduce(((e,t)=>e+Wt(t)),0)}(e.arrayValue);case 10:case 11:return function(e){let t=0;return ht(e.fields,((e,n)=>{t+=e.length+Wt(n)})),t}(e.mapValue);default:throw x(13486,{value:e})}}function Xt(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function Qt(e){return!!e&&"integerValue"in e}function Yt(e){return!!e&&"arrayValue"in e}function Jt(e){return!!e&&"nullValue"in e}function Zt(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function en(e){return!!e&&"mapValue"in e}function tn(e){const t=(e?.mapValue?.fields||{})[Dt]?.stringValue;return t===Vt}function nn(e){if(e.geoPointValue)return{geoPointValue:{...e.geoPointValue}};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:{...e.timestampValue}};if(e.mapValue){const t={mapValue:{fields:{}}};return ht(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=nn(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=nn(e.arrayValue.values[n]);return t}return{...e}}function rn(e){return(((e.mapValue||{}).fields||{}).__type__||{}).stringValue===Mt}class sn{constructor(e){this.value=e}static empty(){return new sn({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!en(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=nn(t)}setAll(e){let t=se.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=nn(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());en(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return Bt(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];en(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){ht(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new sn(nn(this.value))}}function on(e){const t=[];return ht(e.fields,((e,n)=>{const r=new se([e]);if(en(n)){const e=on(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new vt(t)}class an{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new an(e,0,we.min(),we.min(),we.min(),sn.empty(),0)}static newFoundDocument(e,t,n,r){return new an(e,1,t,we.min(),n,r,0)}static newNoDocument(e,t){return new an(e,2,t,we.min(),we.min(),sn.empty(),0)}static newUnknownDocument(e,t){return new an(e,3,t,we.min(),we.min(),sn.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(we.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=sn.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=sn.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=we.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof an&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new an(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class cn{constructor(e,t){this.position=e,this.inclusive=t}}function un(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?oe.comparator(oe.fromName(o.referenceValue),n.key):qt(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function ln(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!Bt(e.position[n],t.position[n]))return!1;return!0}class hn{constructor(e,t="asc"){this.field=e,this.dir=t}}function dn(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class fn{}class pn extends fn{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new En(e,t,n):"array-contains"===t?new Sn(e,n):"in"===t?new An(e,n):"not-in"===t?new Cn(e,n):"array-contains-any"===t?new Nn(e,n):new pn(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new In(e,n):new Tn(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&void 0===t.nullValue&&this.matchesComparison(qt(t,this.value)):null!==t&&jt(this.value)===jt(t)&&this.matchesComparison(qt(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return x(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class mn extends fn{constructor(e,t){super(),this.filters=e,this.op=t,this.Pe=null}static create(e,t){return new mn(e,t)}matches(e){return gn(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.Pe||(this.Pe=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.Pe}getFilters(){return Object.assign([],this.filters)}}function gn(e){return"and"===e.op}function yn(e){return vn(e)&&gn(e)}function vn(e){for(const t of e.filters)if(t instanceof mn)return!1;return!0}function wn(e){if(e instanceof pn)return e.field.canonicalString()+e.op.toString()+Gt(e.value);if(yn(e))return e.filters.map((e=>wn(e))).join(",");{const t=e.filters.map((e=>wn(e))).join(",");return`${e.op}(${t})`}}function bn(e,t){return e instanceof pn?function(e,t){return t instanceof pn&&e.op===t.op&&e.field.isEqual(t.field)&&Bt(e.value,t.value)}(e,t):e instanceof mn?function(e,t){return t instanceof mn&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&bn(n,t.filters[r])),!0)}(e,t):void x(19439)}function _n(e){return e instanceof pn?function(e){return`${e.field.canonicalString()} ${e.op} ${Gt(e.value)}`}(e):e instanceof mn?function(e){return e.op.toString()+" {"+e.getFilters().map(_n).join(" ,")+"}"}(e):"Filter"}class En extends pn{constructor(e,t,n){super(e,t,n),this.key=oe.fromName(n.referenceValue)}matches(e){const t=oe.comparator(e.key,this.key);return this.matchesComparison(t)}}class In extends pn{constructor(e,t){super(e,"in",t),this.keys=kn("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Tn extends pn{constructor(e,t){super(e,"not-in",t),this.keys=kn("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function kn(e,t){return(t.arrayValue?.values||[]).map((e=>oe.fromName(e.referenceValue)))}class Sn extends pn{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return Yt(t)&&zt(t.arrayValue,this.value)}}class An extends pn{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&zt(this.value.arrayValue,t)}}class Cn extends pn{constructor(e,t){super(e,"not-in",t)}matches(e){if(zt(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&void 0===t.nullValue&&!zt(this.value.arrayValue,t)}}class Nn extends pn{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!Yt(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>zt(this.value.arrayValue,e)))}}class Rn{constructor(e,t=null,n=[],r=[],i=null,s=null,o=null){this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.Te=null}}function On(e,t=null,n=[],r=[],i=null,s=null,o=null){return new Rn(e,t,n,r,i,s,o)}function xn(e){const t=D(e);if(null===t.Te){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>wn(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),Pe(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>Gt(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>Gt(e))).join(",")),t.Te=e}return t.Te}function Ln(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!dn(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!bn(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!ln(e.startAt,t.startAt)&&ln(e.endAt,t.endAt)}function Pn(e){return oe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}class Dn{constructor(e,t=null,n=[],r=[],i=null,s="F",o=null,a=null){this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.Ie=null,this.Ee=null,this.de=null,this.startAt,this.endAt}}function Mn(e,t,n,r,i,s,o,a){return new Dn(e,t,n,r,i,s,o,a)}function Un(e){return new Dn(e)}function Vn(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function Fn(e){return null!==e.collectionGroup}function jn(e){const t=D(e);if(null===t.Ie){t.Ie=[];const e=new Set;for(const i of t.explicitOrderBy)t.Ie.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new gt(se.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.Ie.push(new hn(r,n))})),e.has(se.keyField().canonicalString())||t.Ie.push(new hn(se.keyField(),n))}return t.Ie}function Bn(e){const t=D(e);return t.Ee||(t.Ee=zn(t,jn(e))),t.Ee}function zn(e,t){if("F"===e.limitType)return On(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new hn(e.field,t)}));const n=e.endAt?new cn(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new cn(e.startAt.position,e.startAt.inclusive):null;return On(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function qn(e,t){const n=e.filters.concat([t]);return new Dn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function $n(e,t,n){return new Dn(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function Kn(e,t){return Ln(Bn(e),Bn(t))&&e.limitType===t.limitType}function Gn(e){return`${xn(Bn(e))}|lt:${e.limitType}`}function Hn(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>_n(e))).join(", ")}]`),Pe(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>Gt(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>Gt(e))).join(",")),`Target(${t})`}(Bn(e))}; limitType=${e.limitType})`}function Wn(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):oe.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of jn(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=un(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,jn(e),t))&&!(e.endAt&&!function(e,t,n){const r=un(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,jn(e),t))}(e,t)}function Xn(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Qn(e){return(t,n)=>{let r=!1;for(const i of jn(e)){const e=Yn(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Yn(e,t,n){const r=e.field.isKeyField()?oe.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?qt(r,i):x(42886)}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return x(19790,{direction:e.dir})}}class Jn{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){ht(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return dt(this.inner)}size(){return this.innerSize}}const Zn=new ft(oe.comparator);function er(){return Zn}const tr=new ft(oe.comparator);function nr(...e){let t=tr;for(const n of e)t=t.insert(n.key,n);return t}function rr(e){let t=tr;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function ir(){return or()}function sr(){return or()}function or(){return new Jn((e=>e.toString()),((e,t)=>e.isEqual(t)))}const ar=new ft(oe.comparator),cr=new gt(oe.comparator);function ur(...e){let t=cr;for(const n of e)t=t.add(n);return t}const lr=new gt(X);function hr(){return lr}function dr(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:De(t)?"-0":t}}function fr(e){return{integerValue:""+e}}function pr(e,t){return Me(t)?fr(t):dr(e,t)}class mr{constructor(){this._=void 0}}function gr(e,t,n){return e instanceof wr?function(e,t){const n={fields:{[St]:{stringValue:kt},[Ct]:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Nt(t)&&(t=Rt(t)),t&&(n.fields[At]=t),{mapValue:n}}(n,t):e instanceof br?_r(e,t):e instanceof Er?Ir(e,t):function(e,t){const n=vr(e,t),r=kr(n)+kr(e.Ae);return Qt(n)&&Qt(e.Ae)?fr(r):dr(e.serializer,r)}(e,t)}function yr(e,t,n){return e instanceof br?_r(e,t):e instanceof Er?Ir(e,t):n}function vr(e,t){return e instanceof Tr?function(e){return Qt(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class wr extends mr{}class br extends mr{constructor(e){super(),this.elements=e}}function _r(e,t){const n=Sr(t);for(const r of e.elements)n.some((e=>Bt(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Er extends mr{constructor(e){super(),this.elements=e}}function Ir(e,t){let n=Sr(t);for(const r of e.elements)n=n.filter((e=>!Bt(e,r)));return{arrayValue:{values:n}}}class Tr extends mr{constructor(e,t){super(),this.serializer=e,this.Ae=t}}function kr(e){return It(e.integerValue||e.doubleValue)}function Sr(e){return Yt(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class Ar{constructor(e,t){this.field=e,this.transform=t}}class Cr{constructor(e,t){this.version=e,this.transformResults=t}}class Nr{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new Nr}static exists(e){return new Nr(void 0,e)}static updateTime(e){return new Nr(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function Rr(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class Or{}function xr(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new zr(e.key,Nr.none()):new Ur(e.key,e.data,Nr.none());{const n=e.data,r=sn.empty();let i=new gt(se.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new Vr(e.key,r,new vt(i.toArray()),Nr.none())}}function Lr(e,t,n){e instanceof Ur?function(e,t,n){const r=e.value.clone(),i=jr(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof Vr?function(e,t,n){if(!Rr(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=jr(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(Fr(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function Pr(e,t,n,r){return e instanceof Ur?function(e,t,n,r){if(!Rr(e.precondition,t))return n;const i=e.value.clone(),s=Br(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof Vr?function(e,t,n,r){if(!Rr(e.precondition,t))return n;const i=Br(e.fieldTransforms,r,t),s=t.data;return s.setAll(Fr(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return Rr(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function Dr(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=vr(r.transform,e||null);null!=i&&(null===n&&(n=sn.empty()),n.set(r.field,i))}return n||null}function Mr(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&ee(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof br&&t instanceof br||e instanceof Er&&t instanceof Er?ee(e.elements,t.elements,Bt):e instanceof Tr&&t instanceof Tr?Bt(e.Ae,t.Ae):e instanceof wr&&t instanceof wr}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class Ur extends Or{constructor(e,t,n,r=[]){super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class Vr extends Or{constructor(e,t,n,r,i=[]){super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function Fr(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function jr(e,t,n){const r=new Map;P(e.length===n.length,32656,{Re:n.length,Ve:e.length});for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,yr(o,a,n[i]))}return r}function Br(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,gr(e,s,t))}return r}class zr extends Or{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class qr extends Or{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class $r{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&Lr(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=Pr(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=Pr(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=sr();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=xr(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(we.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),ur())}isEqual(e){return this.batchId===e.batchId&&ee(this.mutations,e.mutations,((e,t)=>Mr(e,t)))&&ee(this.baseMutations,e.baseMutations,((e,t)=>Mr(e,t)))}}class Kr{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){P(e.mutations.length===n.length,58842,{me:e.mutations.length,fe:n.length});let r=ar;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new Kr(e,t,n,r)}}class Gr{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class Hr{constructor(e,t){this.count=e,this.unchangedNames=t}}var Wr,Xr;function Qr(e){switch(e){case M.OK:return x(64938);case M.CANCELLED:case M.UNKNOWN:case M.DEADLINE_EXCEEDED:case M.RESOURCE_EXHAUSTED:case M.INTERNAL:case M.UNAVAILABLE:case M.UNAUTHENTICATED:return!1;case M.INVALID_ARGUMENT:case M.NOT_FOUND:case M.ALREADY_EXISTS:case M.PERMISSION_DENIED:case M.FAILED_PRECONDITION:case M.ABORTED:case M.OUT_OF_RANGE:case M.UNIMPLEMENTED:case M.DATA_LOSS:return!0;default:return x(15467,{code:e})}}function Yr(e){if(void 0===e)return N("GRPC error has no .code"),M.UNKNOWN;switch(e){case Wr.OK:return M.OK;case Wr.CANCELLED:return M.CANCELLED;case Wr.UNKNOWN:return M.UNKNOWN;case Wr.DEADLINE_EXCEEDED:return M.DEADLINE_EXCEEDED;case Wr.RESOURCE_EXHAUSTED:return M.RESOURCE_EXHAUSTED;case Wr.INTERNAL:return M.INTERNAL;case Wr.UNAVAILABLE:return M.UNAVAILABLE;case Wr.UNAUTHENTICATED:return M.UNAUTHENTICATED;case Wr.INVALID_ARGUMENT:return M.INVALID_ARGUMENT;case Wr.NOT_FOUND:return M.NOT_FOUND;case Wr.ALREADY_EXISTS:return M.ALREADY_EXISTS;case Wr.PERMISSION_DENIED:return M.PERMISSION_DENIED;case Wr.FAILED_PRECONDITION:return M.FAILED_PRECONDITION;case Wr.ABORTED:return M.ABORTED;case Wr.OUT_OF_RANGE:return M.OUT_OF_RANGE;case Wr.UNIMPLEMENTED:return M.UNIMPLEMENTED;case Wr.DATA_LOSS:return M.DATA_LOSS;default:return x(39323,{code:e})}}(Xr=Wr||(Wr={}))[Xr.OK=0]="OK",Xr[Xr.CANCELLED=1]="CANCELLED",Xr[Xr.UNKNOWN=2]="UNKNOWN",Xr[Xr.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",Xr[Xr.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",Xr[Xr.NOT_FOUND=5]="NOT_FOUND",Xr[Xr.ALREADY_EXISTS=6]="ALREADY_EXISTS",Xr[Xr.PERMISSION_DENIED=7]="PERMISSION_DENIED",Xr[Xr.UNAUTHENTICATED=16]="UNAUTHENTICATED",Xr[Xr.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",Xr[Xr.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",Xr[Xr.ABORTED=10]="ABORTED",Xr[Xr.OUT_OF_RANGE=11]="OUT_OF_RANGE",Xr[Xr.UNIMPLEMENTED=12]="UNIMPLEMENTED",Xr[Xr.INTERNAL=13]="INTERNAL",Xr[Xr.UNAVAILABLE=14]="UNAVAILABLE",Xr[Xr.DATA_LOSS=15]="DATA_LOSS";let Jr=null;function Zr(){return new TextEncoder}const ei=new r([4294967295,4294967295],0);function ti(e){const t=Zr().encode(e),n=new i;return n.update(t),new Uint8Array(n.digest())}function ni(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),i=t.getUint32(4,!0),s=t.getUint32(8,!0),o=t.getUint32(12,!0);return[new r([n,i],0),new r([s,o],0)]}class ri{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new ii(`Invalid padding: ${t}`);if(n<0)throw new ii(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new ii(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new ii(`Invalid padding when bitmap length is 0: ${t}`);this.ge=8*e.length-t,this.pe=r.fromNumber(this.ge)}ye(e,t,n){let i=e.add(t.multiply(r.fromNumber(n)));return 1===i.compare(ei)&&(i=new r([i.getBits(0),i.getBits(1)],0)),i.modulo(this.pe).toNumber()}we(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.ge)return!1;const t=ti(e),[n,r]=ni(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);if(!this.we(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new ri(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.ge)return;const t=ti(e),[n,r]=ni(t);for(let i=0;i<this.hashCount;i++){const e=this.ye(n,r,i);this.Se(e)}}Se(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class ii extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class si{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,oi.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new si(we.min(),r,new ft(X),er(),ur())}}class oi{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new oi(n,t,ur(),ur(),ur())}}class ai{constructor(e,t,n,r){this.be=e,this.removedTargetIds=t,this.key=n,this.De=r}}class ci{constructor(e,t){this.targetId=e,this.Ce=t}}class ui{constructor(e,t,n=bt.EMPTY_BYTE_STRING,r=null){this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class li{constructor(){this.ve=0,this.Fe=fi(),this.Me=bt.EMPTY_BYTE_STRING,this.xe=!1,this.Oe=!0}get current(){return this.xe}get resumeToken(){return this.Me}get Ne(){return 0!==this.ve}get Be(){return this.Oe}Le(e){e.approximateByteSize()>0&&(this.Oe=!0,this.Me=e)}ke(){let e=ur(),t=ur(),n=ur();return this.Fe.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:x(38017,{changeType:i})}})),new oi(this.Me,this.xe,e,t,n)}qe(){this.Oe=!1,this.Fe=fi()}Qe(e,t){this.Oe=!0,this.Fe=this.Fe.insert(e,t)}$e(e){this.Oe=!0,this.Fe=this.Fe.remove(e)}Ue(){this.ve+=1}Ke(){this.ve-=1,P(this.ve>=0,3241,{ve:this.ve})}We(){this.Oe=!0,this.xe=!0}}class hi{constructor(e){this.Ge=e,this.ze=new Map,this.je=er(),this.Je=di(),this.He=di(),this.Ye=new ft(X)}Ze(e){for(const t of e.be)e.De&&e.De.isFoundDocument()?this.Xe(t,e.De):this.et(t,e.key,e.De);for(const t of e.removedTargetIds)this.et(t,e.key,e.De)}tt(e){this.forEachTarget(e,(t=>{const n=this.nt(t);switch(e.state){case 0:this.rt(t)&&n.Le(e.resumeToken);break;case 1:n.Ke(),n.Ne||n.qe(),n.Le(e.resumeToken);break;case 2:n.Ke(),n.Ne||this.removeTarget(t);break;case 3:this.rt(t)&&(n.We(),n.Le(e.resumeToken));break;case 4:this.rt(t)&&(this.it(t),n.Le(e.resumeToken));break;default:x(56790,{state:e.state})}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.ze.forEach(((e,n)=>{this.rt(n)&&t(n)}))}st(e){const t=e.targetId,n=e.Ce.count,r=this.ot(t);if(r){const i=r.target;if(Pn(i))if(0===n){const e=new oe(i.path);this.et(t,e,an.newNoDocument(e,we.min()))}else P(1===n,20013,{expectedCount:n});else{const r=this._t(t);if(r!==n){const n=this.ut(e),i=n?this.ct(n,e,r):1;if(0!==i){this.it(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ye=this.Ye.insert(t,e)}Jr?.lt(function(e,t,n,r,i){const s={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},o=t.unchangedNames;return o&&(s.bloomFilter={applied:0===i,hashCount:o?.hashCount??0,bitmapLength:o?.bits?.bitmap?.length??0,padding:o?.bits?.padding??0,mightContain:e=>r?.mightContain(e)??!1}),s}(r,e.Ce,this.Ge.ht(),n,i))}}}}ut(e){const t=e.Ce.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Tt(n).toUint8Array()}catch(e){if(e instanceof wt)return R("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new ri(s,r,i)}catch(e){return R(e instanceof ii?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.ge?null:o}ct(e,t,n){return t.Ce.count===n-this.Pt(e,t.targetId)?0:2}Pt(e,t){const n=this.Ge.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Ge.ht(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.et(t,n,null),r++)})),r}Tt(e){const t=new Map;this.ze.forEach(((n,r)=>{const i=this.ot(r);if(i){if(n.current&&Pn(i.target)){const t=new oe(i.target.path);this.It(t).has(r)||this.Et(r,t)||this.et(r,t,an.newNoDocument(t,e))}n.Be&&(t.set(r,n.ke()),n.qe())}}));let n=ur();this.He.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.ot(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.je.forEach(((t,n)=>n.setReadTime(e)));const r=new si(e,t,this.Ye,this.je,n);return this.je=er(),this.Je=di(),this.He=di(),this.Ye=new ft(X),r}Xe(e,t){if(!this.rt(e))return;const n=this.Et(e,t.key)?2:0;this.nt(e).Qe(t.key,n),this.je=this.je.insert(t.key,t),this.Je=this.Je.insert(t.key,this.It(t.key).add(e)),this.He=this.He.insert(t.key,this.dt(t.key).add(e))}et(e,t,n){if(!this.rt(e))return;const r=this.nt(e);this.Et(e,t)?r.Qe(t,1):r.$e(t),this.He=this.He.insert(t,this.dt(t).delete(e)),this.He=this.He.insert(t,this.dt(t).add(e)),n&&(this.je=this.je.insert(t,n))}removeTarget(e){this.ze.delete(e)}_t(e){const t=this.nt(e).ke();return this.Ge.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}Ue(e){this.nt(e).Ue()}nt(e){let t=this.ze.get(e);return t||(t=new li,this.ze.set(e,t)),t}dt(e){let t=this.He.get(e);return t||(t=new gt(X),this.He=this.He.insert(e,t)),t}It(e){let t=this.Je.get(e);return t||(t=new gt(X),this.Je=this.Je.insert(e,t)),t}rt(e){const t=null!==this.ot(e);return t||C("WatchChangeAggregator","Detected inactive target",e),t}ot(e){const t=this.ze.get(e);return t&&t.Ne?null:this.Ge.At(e)}it(e){this.ze.set(e,new li),this.Ge.getRemoteKeysForTarget(e).forEach((t=>{this.et(e,t,null)}))}Et(e,t){return this.Ge.getRemoteKeysForTarget(e).has(t)}}function di(){return new ft(oe.comparator)}function fi(){return new ft(oe.comparator)}const pi={asc:"ASCENDING",desc:"DESCENDING"},mi={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},gi={and:"AND",or:"OR"};class yi{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function vi(e,t){return e.useProto3Json||Pe(t)?t:{value:t}}function wi(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function bi(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function _i(e,t){return wi(e,t.toTimestamp())}function Ei(e){return P(!!e,49232),we.fromTimestamp(function(e){const t=Et(e);return new ve(t.seconds,t.nanos)}(e))}function Ii(e,t){return Ti(e,t).canonicalString()}function Ti(e,t){const n=function(e){return new re(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function ki(e){const t=re.fromString(e);return P(Ki(t),10190,{key:t.toString()}),t}function Si(e,t){return Ii(e.databaseId,t.path)}function Ai(e,t){const n=ki(t);if(n.get(1)!==e.databaseId.projectId)throw new U(M.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new U(M.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new oe(Oi(n))}function Ci(e,t){return Ii(e.databaseId,t)}function Ni(e){const t=ki(e);return 4===t.length?re.emptyPath():Oi(t)}function Ri(e){return new re(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function Oi(e){return P(e.length>4&&"documents"===e.get(4),29091,{key:e.toString()}),e.popFirst(5)}function xi(e,t,n){return{name:Si(e,t),fields:n.value.mapValue.fields}}function Li(e,t){let n;if(t instanceof Ur)n={update:xi(e,t.key,t.value)};else if(t instanceof zr)n={delete:Si(e,t.key)};else if(t instanceof Vr)n={update:xi(e,t.key,t.data),updateMask:$i(t.fieldMask)};else{if(!(t instanceof qr))return x(16599,{Vt:t.type});n={verify:Si(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof wr)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof br)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Er)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Tr)return{fieldPath:t.field.canonicalString(),increment:n.Ae};throw x(20930,{transform:t.transform})}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:_i(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:x(27497)}(e,t.precondition)),n}function Pi(e,t){return{documents:[Ci(e,t.path)]}}function Di(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=Ci(e,i);const s=function(e){if(0!==e.length)return qi(mn.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:Bi(e.field),direction:Vi(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=vi(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{ft:n,parent:i}}function Mi(e){let t=Ni(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){P(1===r,65062);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=Ui(e);return t instanceof mn&&yn(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new hn(zi(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,Pe(t)?null:t}(n.limit));let c=null;n.startAt&&(c=function(e){const t=!!e.before,n=e.values||[];return new cn(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new cn(n,t)}(n.endAt)),Mn(t,i,o,s,a,"F",c,u)}function Ui(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=zi(e.unaryFilter.field);return pn.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=zi(e.unaryFilter.field);return pn.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=zi(e.unaryFilter.field);return pn.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=zi(e.unaryFilter.field);return pn.create(i,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return x(61313);default:return x(60726)}}(e):void 0!==e.fieldFilter?function(e){return pn.create(zi(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return x(58110);default:return x(50506)}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return mn.create(e.compositeFilter.filters.map((e=>Ui(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return x(1026)}}(e.compositeFilter.op))}(e):x(30097,{filter:e})}function Vi(e){return pi[e]}function Fi(e){return mi[e]}function ji(e){return gi[e]}function Bi(e){return{fieldPath:e.canonicalString()}}function zi(e){return se.fromServerFormat(e.fieldPath)}function qi(e){return e instanceof pn?function(e){if("=="===e.op){if(Zt(e.value))return{unaryFilter:{field:Bi(e.field),op:"IS_NAN"}};if(Jt(e.value))return{unaryFilter:{field:Bi(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(Zt(e.value))return{unaryFilter:{field:Bi(e.field),op:"IS_NOT_NAN"}};if(Jt(e.value))return{unaryFilter:{field:Bi(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Bi(e.field),op:Fi(e.op),value:e.value}}}(e):e instanceof mn?function(e){const t=e.getFilters().map((e=>qi(e)));return 1===t.length?t[0]:{compositeFilter:{op:ji(e.op),filters:t}}}(e):x(54877,{filter:e})}function $i(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function Ki(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Gi{constructor(e,t,n,r,i=we.min(),s=we.min(),o=bt.EMPTY_BYTE_STRING,a=null){this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Gi(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Gi(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Hi{constructor(e){this.yt=e}}function Wi(e){const t=Mi({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?$n(t,t.limit,"L"):t}class Xi{constructor(){}Dt(e,t){this.Ct(e,t),t.vt()}Ct(e,t){if("nullValue"in e)this.Ft(t,5);else if("booleanValue"in e)this.Ft(t,10),t.Mt(e.booleanValue?1:0);else if("integerValue"in e)this.Ft(t,15),t.Mt(It(e.integerValue));else if("doubleValue"in e){const n=It(e.doubleValue);isNaN(n)?this.Ft(t,13):(this.Ft(t,15),De(n)?t.Mt(0):t.Mt(n))}else if("timestampValue"in e){let n=e.timestampValue;this.Ft(t,20),"string"==typeof n&&(n=Et(n)),t.xt(`${n.seconds||""}`),t.Mt(n.nanos||0)}else if("stringValue"in e)this.Ot(e.stringValue,t),this.Nt(t);else if("bytesValue"in e)this.Ft(t,30),t.Bt(Tt(e.bytesValue)),this.Nt(t);else if("referenceValue"in e)this.Lt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.Ft(t,45),t.Mt(n.latitude||0),t.Mt(n.longitude||0)}else"mapValue"in e?rn(e)?this.Ft(t,Number.MAX_SAFE_INTEGER):tn(e)?this.kt(e.mapValue,t):(this.qt(e.mapValue,t),this.Nt(t)):"arrayValue"in e?(this.Qt(e.arrayValue,t),this.Nt(t)):x(19022,{$t:e})}Ot(e,t){this.Ft(t,25),this.Ut(e,t)}Ut(e,t){t.xt(e)}qt(e,t){const n=e.fields||{};this.Ft(t,55);for(const r of Object.keys(n))this.Ot(r,t),this.Ct(n[r],t)}kt(e,t){const n=e.fields||{};this.Ft(t,53);const r=Ft,i=n[r].arrayValue?.values?.length||0;this.Ft(t,15),t.Mt(It(i)),this.Ot(r,t),this.Ct(n[r],t)}Qt(e,t){const n=e.values||[];this.Ft(t,50);for(const r of n)this.Ct(r,t)}Lt(e,t){this.Ft(t,37),oe.fromName(e).path.forEach((e=>{this.Ft(t,60),this.Ut(e,t)}))}Ft(e,t){e.Mt(t)}Nt(e){e.Mt(2)}}Xi.Kt=new Xi;class Qi{constructor(){this.Cn=new Yi}addToCollectionParentIndex(e,t){return this.Cn.add(t),Ne.resolve()}getCollectionParents(e,t){return Ne.resolve(this.Cn.getEntries(t))}addFieldIndex(e,t){return Ne.resolve()}deleteFieldIndex(e,t){return Ne.resolve()}deleteAllFieldIndexes(e){return Ne.resolve()}createTargetIndexes(e,t){return Ne.resolve()}getDocumentsMatchingTarget(e,t){return Ne.resolve(null)}getIndexType(e,t){return Ne.resolve(0)}getFieldIndexes(e,t){return Ne.resolve([])}getNextCollectionGroupToUpdate(e){return Ne.resolve(null)}getMinOffset(e,t){return Ne.resolve(Te.min())}getMinOffsetFromCollectionGroup(e,t){return Ne.resolve(Te.min())}updateCollectionGroup(e,t,n){return Ne.resolve()}updateIndexEntries(e,t){return Ne.resolve()}}class Yi{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new gt(re.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new gt(re.comparator)).toArray()}}new Uint8Array(0);const Ji={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Zi=41943040;class es{static withCacheSize(e){return new es(e,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}}es.DEFAULT_COLLECTION_PERCENTILE=10,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,es.DEFAULT=new es(Zi,es.DEFAULT_COLLECTION_PERCENTILE,es.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),es.DISABLED=new es(-1,0,0);class ts{constructor(e){this.ar=e}next(){return this.ar+=2,this.ar}static ur(){return new ts(0)}static cr(){return new ts(-1)}}const ns="LruGarbageCollector",rs=1048576;function is([e,t],[n,r]){const i=X(e,n);return 0===i?X(t,r):i}class ss{constructor(e){this.Ir=e,this.buffer=new gt(is),this.Er=0}dr(){return++this.Er}Ar(e){const t=[e,this.dr()];if(this.buffer.size<this.Ir)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();is(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class os{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.Rr=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Vr(6e4)}stop(){this.Rr&&(this.Rr.cancel(),this.Rr=null)}get started(){return null!==this.Rr}Vr(e){C(ns,`Garbage collection scheduled in ${e}ms`),this.Rr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.Rr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Oe(e)?C(ns,"Ignoring IndexedDB error during garbage collection: ",e):await Ce(e)}await this.Vr(3e5)}))}}class as{constructor(e,t){this.mr=e,this.params=t}calculateTargetCount(e,t){return this.mr.gr(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Ne.resolve(xe.ce);const n=new ss(t);return this.mr.forEachTarget(e,(e=>n.Ar(e.sequenceNumber))).next((()=>this.mr.pr(e,(e=>n.Ar(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.mr.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.mr.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector","Garbage collection skipped; disabled"),Ne.resolve(Ji)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(C("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Ji):this.yr(e,t)))}getCacheSize(e){return this.mr.getCacheSize(e)}yr(e,t){let n,r,i,s,o,c,u;const l=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(C("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,c=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(u=Date.now(),A()<=a.in.DEBUG&&C("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-l}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(c-o)+"ms\n"+`\tRemoved ${e} documents in `+(u-c)+"ms\n"+`Total Duration: ${u-l}ms`),Ne.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function cs(e,t){return new as(e,t)}class us{constructor(){this.changes=new Jn((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,an.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Ne.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class ls{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class hs{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&Pr(n.mutation,e,vt.empty(),ve.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,ur()).next((()=>t))))}getLocalViewOfDocuments(e,t,n=ur()){const r=ir();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=nr();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=ir();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,ur())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=er();const s=or(),o=or();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof Vr)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),Pr(o.mutation,t,o.mutation.getFieldMask(),ve.now())):s.set(t.key,vt.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>o.set(e,new ls(t,s.get(e)??null)))),o)))}recalculateAndSaveOverlays(e,t){const n=or();let r=new ft(((e,t)=>e-t)),i=ur();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||vt.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||ur()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,c=r.value,u=sr();c.forEach((e=>{if(!i.has(e)){const r=xr(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Ne.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return oe.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):Fn(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Ne.resolve(ir());let o=be,a=i;return s.next((t=>Ne.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Ne.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,ur()))).next((e=>({batchId:o,changes:rr(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new oe(t)).next((e=>{let t=nr();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=nr();return this.indexManager.getCollectionParents(e,i).next((o=>Ne.forEach(o,(o=>{const a=function(e,t){return new Dn(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,an.newInvalidDocument(r)))}));let n=nr();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&Pr(s.mutation,r,vt.empty(),ve.now()),Wn(t,r)&&(n=n.insert(e,r))})),n}))}}class ds{constructor(e){this.serializer=e,this.Lr=new Map,this.kr=new Map}getBundleMetadata(e,t){return Ne.resolve(this.Lr.get(t))}saveBundleMetadata(e,t){return this.Lr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Ei(e.createTime)}}(t)),Ne.resolve()}getNamedQuery(e,t){return Ne.resolve(this.kr.get(t))}saveNamedQuery(e,t){return this.kr.set(t.name,function(e){return{name:e.name,query:Wi(e.bundledQuery),readTime:Ei(e.readTime)}}(t)),Ne.resolve()}}class fs{constructor(){this.overlays=new ft(oe.comparator),this.qr=new Map}getOverlay(e,t){return Ne.resolve(this.overlays.get(t))}getOverlays(e,t){const n=ir();return Ne.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.St(e,t,r)})),Ne.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.qr.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.qr.delete(n)),Ne.resolve()}getOverlaysForCollection(e,t,n){const r=ir(),i=t.length+1,s=new oe(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Ne.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new ft(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=ir(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=ir(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Ne.resolve(o)}St(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.qr.get(r.largestBatchId).delete(n.key);this.qr.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new Gr(t,n));let i=this.qr.get(t);void 0===i&&(i=ur(),this.qr.set(t,i)),this.qr.set(t,i.add(n.key))}}class ps{constructor(){this.sessionToken=bt.EMPTY_BYTE_STRING}getSessionToken(e){return Ne.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Ne.resolve()}}class ms{constructor(){this.Qr=new gt(gs.$r),this.Ur=new gt(gs.Kr)}isEmpty(){return this.Qr.isEmpty()}addReference(e,t){const n=new gs(e,t);this.Qr=this.Qr.add(n),this.Ur=this.Ur.add(n)}Wr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Gr(new gs(e,t))}zr(e,t){e.forEach((e=>this.removeReference(e,t)))}jr(e){const t=new oe(new re([])),n=new gs(t,e),r=new gs(t,e+1),i=[];return this.Ur.forEachInRange([n,r],(e=>{this.Gr(e),i.push(e.key)})),i}Jr(){this.Qr.forEach((e=>this.Gr(e)))}Gr(e){this.Qr=this.Qr.delete(e),this.Ur=this.Ur.delete(e)}Hr(e){const t=new oe(new re([])),n=new gs(t,e),r=new gs(t,e+1);let i=ur();return this.Ur.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new gs(e,0),n=this.Qr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class gs{constructor(e,t){this.key=e,this.Yr=t}static $r(e,t){return oe.comparator(e.key,t.key)||X(e.Yr,t.Yr)}static Kr(e,t){return X(e.Yr,t.Yr)||oe.comparator(e.key,t.key)}}class ys{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.tr=1,this.Zr=new gt(gs.$r)}checkEmpty(e){return Ne.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.tr;this.tr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new $r(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.Zr=this.Zr.add(new gs(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Ne.resolve(s)}lookupMutationBatch(e,t){return Ne.resolve(this.Xr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.ei(n),i=r<0?0:r;return Ne.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Ne.resolve(0===this.mutationQueue.length?Le:this.tr-1)}getAllMutationBatches(e){return Ne.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new gs(t,0),r=new gs(t,Number.POSITIVE_INFINITY),i=[];return this.Zr.forEachInRange([n,r],(e=>{const t=this.Xr(e.Yr);i.push(t)})),Ne.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new gt(X);return t.forEach((e=>{const t=new gs(e,0),r=new gs(e,Number.POSITIVE_INFINITY);this.Zr.forEachInRange([t,r],(e=>{n=n.add(e.Yr)}))})),Ne.resolve(this.ti(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;oe.isDocumentKey(i)||(i=i.child(""));const s=new gs(new oe(i),0);let o=new gt(X);return this.Zr.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.Yr)),!0)}),s),Ne.resolve(this.ti(o))}ti(e){const t=[];return e.forEach((e=>{const n=this.Xr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){P(0===this.ni(t.batchId,"removed"),55003),this.mutationQueue.shift();let n=this.Zr;return Ne.forEach(t.mutations,(r=>{const i=new gs(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.Zr=n}))}ir(e){}containsKey(e,t){const n=new gs(t,0),r=this.Zr.firstAfterOrEqual(n);return Ne.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Ne.resolve()}ni(e,t){return this.ei(e)}ei(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Xr(e){const t=this.ei(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class vs{constructor(e){this.ri=e,this.docs=new ft(oe.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.ri(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Ne.resolve(n?n.document.mutableCopy():an.newInvalidDocument(t))}getEntries(e,t){let n=er();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():an.newInvalidDocument(e))})),Ne.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=er();const s=t.path,o=new oe(s.child("__id-9223372036854775808__")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||ke(Ie(o),n)<=0||(r.has(o.key)||Wn(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Ne.resolve(i)}getAllFromCollectionGroup(e,t,n,r){x(9500)}ii(e,t){return Ne.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new ws(this)}getSize(e){return Ne.resolve(this.size)}}class ws extends us{constructor(e){super(),this.Nr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.Nr.addEntry(e,r)):this.Nr.removeEntry(n)})),Ne.waitFor(t)}getFromCache(e,t){return this.Nr.getEntry(e,t)}getAllFromCache(e,t){return this.Nr.getEntries(e,t)}}class bs{constructor(e){this.persistence=e,this.si=new Jn((e=>xn(e)),Ln),this.lastRemoteSnapshotVersion=we.min(),this.highestTargetId=0,this.oi=0,this._i=new ms,this.targetCount=0,this.ai=ts.ur()}forEachTarget(e,t){return this.si.forEach(((e,n)=>t(n))),Ne.resolve()}getLastRemoteSnapshotVersion(e){return Ne.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Ne.resolve(this.oi)}allocateTargetId(e){return this.highestTargetId=this.ai.next(),Ne.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.oi&&(this.oi=t),Ne.resolve()}Pr(e){this.si.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.ai=new ts(t),this.highestTargetId=t),e.sequenceNumber>this.oi&&(this.oi=e.sequenceNumber)}addTargetData(e,t){return this.Pr(t),this.targetCount+=1,Ne.resolve()}updateTargetData(e,t){return this.Pr(t),Ne.resolve()}removeTargetData(e,t){return this.si.delete(t.target),this._i.jr(t.targetId),this.targetCount-=1,Ne.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.si.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.si.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Ne.waitFor(i).next((()=>r))}getTargetCount(e){return Ne.resolve(this.targetCount)}getTargetData(e,t){const n=this.si.get(t)||null;return Ne.resolve(n)}addMatchingKeys(e,t,n){return this._i.Wr(t,n),Ne.resolve()}removeMatchingKeys(e,t,n){this._i.zr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Ne.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this._i.jr(t),Ne.resolve()}getMatchingKeysForTargetId(e,t){const n=this._i.Hr(t);return Ne.resolve(n)}containsKey(e,t){return Ne.resolve(this._i.containsKey(t))}}class _s{constructor(e,t){this.ui={},this.overlays={},this.ci=new xe(0),this.li=!1,this.li=!0,this.hi=new ps,this.referenceDelegate=e(this),this.Pi=new bs(this),this.indexManager=new Qi,this.remoteDocumentCache=function(e){return new vs(e)}((e=>this.referenceDelegate.Ti(e))),this.serializer=new Hi(t),this.Ii=new ds(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.li=!1,Promise.resolve()}get started(){return this.li}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new fs,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.ui[e.toKey()];return n||(n=new ys(t,this.referenceDelegate),this.ui[e.toKey()]=n),n}getGlobalsCache(){return this.hi}getTargetCache(){return this.Pi}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ii}runTransaction(e,t,n){C("MemoryPersistence","Starting transaction:",e);const r=new Es(this.ci.next());return this.referenceDelegate.Ei(),n(r).next((e=>this.referenceDelegate.di(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Ai(e,t){return Ne.or(Object.values(this.ui).map((n=>()=>n.containsKey(e,t))))}}class Es extends Ae{constructor(e){super(),this.currentSequenceNumber=e}}class Is{constructor(e){this.persistence=e,this.Ri=new ms,this.Vi=null}static mi(e){return new Is(e)}get fi(){if(this.Vi)return this.Vi;throw x(60996)}addReference(e,t,n){return this.Ri.addReference(n,t),this.fi.delete(n.toString()),Ne.resolve()}removeReference(e,t,n){return this.Ri.removeReference(n,t),this.fi.add(n.toString()),Ne.resolve()}markPotentiallyOrphaned(e,t){return this.fi.add(t.toString()),Ne.resolve()}removeTarget(e,t){this.Ri.jr(t.targetId).forEach((e=>this.fi.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.fi.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}Ei(){this.Vi=new Set}di(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Ne.forEach(this.fi,(n=>{const r=oe.fromPath(n);return this.gi(e,r).next((e=>{e||t.removeEntry(r,we.min())}))})).next((()=>(this.Vi=null,t.apply(e))))}updateLimboDocument(e,t){return this.gi(e,t).next((e=>{e?this.fi.delete(t.toString()):this.fi.add(t.toString())}))}Ti(e){return 0}gi(e,t){return Ne.or([()=>Ne.resolve(this.Ri.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Ai(e,t)])}}class Ts{constructor(e,t){this.persistence=e,this.pi=new Jn((e=>Ve(e.path)),((e,t)=>e.isEqual(t))),this.garbageCollector=cs(this,t)}static mi(e,t){return new Ts(e,t)}Ei(){}di(e){return Ne.resolve()}forEachTarget(e,t){return this.persistence.getTargetCache().forEachTarget(e,t)}gr(e){const t=this.wr(e);return this.persistence.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}wr(e){let t=0;return this.pr(e,(e=>{t++})).next((()=>t))}pr(e,t){return Ne.forEach(this.pi,((n,r)=>this.br(e,n,r).next((e=>e?Ne.resolve():t(r)))))}removeTargets(e,t,n){return this.persistence.getTargetCache().removeTargets(e,t,n)}removeOrphanedDocuments(e,t){let n=0;const r=this.persistence.getRemoteDocumentCache(),i=r.newChangeBuffer();return r.ii(e,(r=>this.br(e,r,t).next((e=>{e||(n++,i.removeEntry(r,we.min()))})))).next((()=>i.apply(e))).next((()=>n))}markPotentiallyOrphaned(e,t){return this.pi.set(t,e.currentSequenceNumber),Ne.resolve()}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,n)}addReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ne.resolve()}removeReference(e,t,n){return this.pi.set(n,e.currentSequenceNumber),Ne.resolve()}updateLimboDocument(e,t){return this.pi.set(t,e.currentSequenceNumber),Ne.resolve()}Ti(e){let t=e.key.toString().length;return e.isFoundDocument()&&(t+=Wt(e.data.value)),t}br(e,t,n){return Ne.or([()=>this.persistence.Ai(e,t),()=>this.persistence.getTargetCache().containsKey(e,t),()=>{const e=this.pi.get(t);return Ne.resolve(void 0!==e&&e>n)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}class ks{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.Es=n,this.ds=r}static As(e,t){let n=ur(),r=ur();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new ks(e,t.fromCache,n,r)}}class Ss{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class As{constructor(){this.Rs=!1,this.Vs=!1,this.fs=100,this.gs=(0,c.G6)()?8:Re((0,c.z$)())>0?6:4}initialize(e,t){this.ps=e,this.indexManager=t,this.Rs=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.ys(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.ws(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new Ss;return this.Ss(e,t,n).next((r=>{if(i.result=r,this.Vs)return this.bs(e,t,n,r.size)}))})).next((()=>i.result))}bs(e,t,n,r){return n.documentReadCount<this.fs?(A()<=a.in.DEBUG&&C("QueryEngine","SDK will not create cache indexes for query:",Hn(t),"since it only creates cache indexes for collection contains","more than or equal to",this.fs,"documents"),Ne.resolve()):(A()<=a.in.DEBUG&&C("QueryEngine","Query:",Hn(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.gs*r?(A()<=a.in.DEBUG&&C("QueryEngine","The SDK decides to create cache indexes for query:",Hn(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Bn(t))):Ne.resolve())}ys(e,t){if(Vn(t))return Ne.resolve(null);let n=Bn(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=$n(t,null,"F"),n=Bn(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=ur(...r);return this.ps.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.Ds(t,r);return this.Cs(t,s,i,n.readTime)?this.ys(e,$n(t,null,"F")):this.vs(e,s,t,n)}))))})))))}ws(e,t,n,r){return Vn(t)||r.isEqual(we.min())?Ne.resolve(null):this.ps.getDocuments(e,n).next((i=>{const s=this.Ds(t,i);return this.Cs(t,s,n,r)?Ne.resolve(null):(A()<=a.in.DEBUG&&C("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Hn(t)),this.vs(e,s,t,Ee(r,be)).next((e=>e)))}))}Ds(e,t){let n=new gt(Qn(e));return t.forEach(((t,r)=>{Wn(e,r)&&(n=n.add(r))})),n}Cs(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Ss(e,t,n){return A()<=a.in.DEBUG&&C("QueryEngine","Using full collection scan to execute query:",Hn(t)),this.ps.getDocumentsMatchingQuery(e,t,Te.min(),n)}vs(e,t,n,r){return this.ps.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}const Cs="LocalStore",Ns=3e8;class Rs{constructor(e,t,n,r){this.persistence=e,this.Fs=t,this.serializer=r,this.Ms=new ft(X),this.xs=new Jn((e=>xn(e)),Ln),this.Os=new Map,this.Ns=e.getRemoteDocumentCache(),this.Pi=e.getTargetCache(),this.Ii=e.getBundleCache(),this.Bs(n)}Bs(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new hs(this.Ns,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Ns.setIndexManager(this.indexManager),this.Fs.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.Ms)))}}function Os(e,t,n,r){return new Rs(e,t,n,r)}async function xs(e,t){const n=D(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.Bs(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=ur();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({Ls:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function Ls(e){const t=D(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Pi.getLastRemoteSnapshotVersion(e)))}function Ps(e,t,n){let r=ur(),i=ur();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=er();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(we.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):C(Cs,"Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{ks:r,qs:i}}))}function Ds(e,t){const n=D(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=Le),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Ms(e,t){const n=D(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Pi.getTargetData(e,t).next((i=>i?(r=i,Ne.resolve(r)):n.Pi.allocateTargetId(e).next((i=>(r=new Gi(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Pi.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.Ms.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.Ms=n.Ms.insert(e.targetId,e),n.xs.set(t,e.targetId)),e}))}async function Us(e,t,n){const r=D(e),i=r.Ms.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Oe(e))throw e;C(Cs,`Failed to update sequence numbers for target ${t}: ${e}`)}r.Ms=r.Ms.remove(t),r.xs.delete(i.target)}function Vs(e,t,n){const r=D(e);let i=we.min(),s=ur();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=D(e),i=r.xs.get(n);return void 0!==i?Ne.resolve(r.Ms.get(i)):r.Pi.getTargetData(t,n)}(r,e,Bn(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Pi.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.Fs.getDocumentsMatchingQuery(e,t,n?i:we.min(),n?s:ur()))).next((e=>(Fs(r,Xn(t),e),{documents:e,Qs:s})))))}function Fs(e,t,n){let r=e.Os.get(t)||we.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.Os.set(t,r)}class js{constructor(){this.activeTargetIds=hr()}zs(e){this.activeTargetIds=this.activeTargetIds.add(e)}js(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Gs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Bs{constructor(){this.Mo=new js,this.xo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e,t=!0){return t&&this.Mo.zs(e),this.xo[e]||"not-current"}updateQueryState(e,t,n){this.xo[e]=t}removeLocalQueryTarget(e){this.Mo.js(e)}isLocalQueryTarget(e){return this.Mo.activeTargetIds.has(e)}clearQueryState(e){delete this.xo[e]}getAllActiveQueryTargets(){return this.Mo.activeTargetIds}isActiveQueryTarget(e){return this.Mo.activeTargetIds.has(e)}start(){return this.Mo=new js,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class zs{Oo(e){}shutdown(){}}const qs="ConnectivityMonitor";class $s{constructor(){this.No=()=>this.Bo(),this.Lo=()=>this.ko(),this.qo=[],this.Qo()}Oo(e){this.qo.push(e)}shutdown(){window.removeEventListener("online",this.No),window.removeEventListener("offline",this.Lo)}Qo(){window.addEventListener("online",this.No),window.addEventListener("offline",this.Lo)}Bo(){C(qs,"Network connectivity changed: AVAILABLE");for(const e of this.qo)e(0)}ko(){C(qs,"Network connectivity changed: UNAVAILABLE");for(const e of this.qo)e(1)}static v(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let Ks=null;function Gs(){return null===Ks?Ks=268435456+Math.round(2147483648*Math.random()):Ks++,"0x"+Ks.toString(16)}const Hs="RestConnection",Ws={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class Xs{get $o(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Uo=t+"://"+e.host,this.Ko=`projects/${n}/databases/${r}`,this.Wo=this.databaseId.database===Lt?`project_id=${n}`:`project_id=${n}&database_id=${r}`}Go(e,t,n,r,i){const s=Gs(),o=this.zo(e,t.toUriEncodedString());C(Hs,`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.Ko,"x-goog-request-params":this.Wo};this.jo(a,r,i);const{host:u}=new URL(o),l=(0,c.Xx)(u);return this.Jo(e,o,a,n,l).then((t=>(C(Hs,`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw R(Hs,`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Ho(e,t,n,r,i,s){return this.Go(e,t,n,r,i)}jo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+k,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}zo(e,t){const n=Ws[e];return`${this.Uo}/v1/${t}:${n}`}terminate(){}}class Qs{constructor(e){this.Yo=e.Yo,this.Zo=e.Zo}Xo(e){this.e_=e}t_(e){this.n_=e}r_(e){this.i_=e}onMessage(e){this.s_=e}close(){this.Zo()}send(e){this.Yo(e)}o_(){this.e_()}__(){this.n_()}a_(e){this.i_(e)}u_(e){this.s_(e)}}const Ys="WebChannelConnection";class Js extends Xs{constructor(e){super(e),this.c_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,t,n,r,i){const s=Gs();return new Promise(((i,o)=>{const a=new h;a.setWithCredentials(!0),a.listenOnce(f.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case p.NO_ERROR:const t=a.getResponseJson();C(Ys,`XHR for RPC '${e}' ${s} received:`,JSON.stringify(t)),i(t);break;case p.TIMEOUT:C(Ys,`RPC '${e}' ${s} timed out`),o(new U(M.DEADLINE_EXCEEDED,"Request time out"));break;case p.HTTP_ERROR:const n=a.getStatus();if(C(Ys,`RPC '${e}' ${s} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=e?.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(M).indexOf(t)>=0?t:M.UNKNOWN}(t.status);o(new U(e,t.message))}else o(new U(M.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new U(M.UNAVAILABLE,"Connection failed."));break;default:x(9055,{l_:e,streamId:s,h_:a.getLastErrorCode(),P_:a.getLastError()})}}finally{C(Ys,`RPC '${e}' ${s} completed.`)}}));const c=JSON.stringify(r);C(Ys,`RPC '${e}' ${s} sending request:`,r),a.send(t,"POST",c,n,15)}))}T_(e,t,n){const r=Gs(),i=[this.Uo,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=v(),o=y(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},c=this.longPollingOptions.timeoutSeconds;void 0!==c&&(a.longPollingTimeout=Math.round(1e3*c)),this.useFetchStreams&&(a.useFetchStreams=!0),this.jo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");C(Ys,`Creating RPC '${e}' stream ${r}: ${u}`,a);const l=s.createWebChannel(u,a);this.I_(l);let h=!1,f=!1;const p=new Qs({Yo:t=>{f?C(Ys,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(C(Ys,`Opening RPC '${e}' stream ${r} transport.`),l.open(),h=!0),C(Ys,`RPC '${e}' stream ${r} sending:`,t),l.send(t))},Zo:()=>l.close()}),w=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return w(l,d.EventType.OPEN,(()=>{f||(C(Ys,`RPC '${e}' stream ${r} transport opened.`),p.o_())})),w(l,d.EventType.CLOSE,(()=>{f||(f=!0,C(Ys,`RPC '${e}' stream ${r} transport closed`),p.a_(),this.E_(l))})),w(l,d.EventType.ERROR,(t=>{f||(f=!0,R(Ys,`RPC '${e}' stream ${r} transport errored. Name:`,t.name,"Message:",t.message),p.a_(new U(M.UNAVAILABLE,"The operation could not be completed")))})),w(l,d.EventType.MESSAGE,(t=>{if(!f){const n=t.data[0];P(!!n,16349);const i=n,s=i?.error||i[0]?.error;if(s){C(Ys,`RPC '${e}' stream ${r} received error:`,s);const t=s.status;let n=function(e){const t=Wr[e];if(void 0!==t)return Yr(t)}(t),i=s.message;void 0===n&&(n=M.INTERNAL,i="Unknown error status: "+t+" with message "+s.message),f=!0,p.a_(new U(n,i)),l.close()}else C(Ys,`RPC '${e}' stream ${r} received:`,n),p.u_(n)}})),w(o,g.STAT_EVENT,(t=>{t.stat===m.PROXY?C(Ys,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===m.NOPROXY&&C(Ys,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{p.__()}),0),p}terminate(){this.c_.forEach((e=>e.close())),this.c_=[]}I_(e){this.c_.push(e)}E_(e){this.c_=this.c_.filter((t=>t===e))}}function Zs(){return"undefined"!=typeof document?document:null}function eo(e){return new yi(e,!0)}class to{constructor(e,t,n=1e3,r=1.5,i=6e4){this.Mi=e,this.timerId=t,this.d_=n,this.A_=r,this.R_=i,this.V_=0,this.m_=null,this.f_=Date.now(),this.reset()}reset(){this.V_=0}g_(){this.V_=this.R_}p_(e){this.cancel();const t=Math.floor(this.V_+this.y_()),n=Math.max(0,Date.now()-this.f_),r=Math.max(0,t-n);r>0&&C("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.V_} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.m_=this.Mi.enqueueAfterDelay(this.timerId,r,(()=>(this.f_=Date.now(),e()))),this.V_*=this.A_,this.V_<this.d_&&(this.V_=this.d_),this.V_>this.R_&&(this.V_=this.R_)}w_(){null!==this.m_&&(this.m_.skipDelay(),this.m_=null)}cancel(){null!==this.m_&&(this.m_.cancel(),this.m_=null)}y_(){return(Math.random()-.5)*this.V_}}const no="PersistentStream";class ro{constructor(e,t,n,r,i,s,o,a){this.Mi=e,this.S_=n,this.b_=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.D_=0,this.C_=null,this.v_=null,this.stream=null,this.F_=0,this.M_=new to(e,t)}x_(){return 1===this.state||5===this.state||this.O_()}O_(){return 2===this.state||3===this.state}start(){this.F_=0,4!==this.state?this.auth():this.N_()}async stop(){this.x_()&&await this.close(0)}B_(){this.state=0,this.M_.reset()}L_(){this.O_()&&null===this.C_&&(this.C_=this.Mi.enqueueAfterDelay(this.S_,6e4,(()=>this.k_())))}q_(e){this.Q_(),this.stream.send(e)}async k_(){if(this.O_())return this.close(0)}Q_(){this.C_&&(this.C_.cancel(),this.C_=null)}U_(){this.v_&&(this.v_.cancel(),this.v_=null)}async close(e,t){this.Q_(),this.U_(),this.M_.cancel(),this.D_++,4!==e?this.M_.reset():t&&t.code===M.RESOURCE_EXHAUSTED?(N(t.toString()),N("Using maximum backoff delay to prevent overloading the backend."),this.M_.g_()):t&&t.code===M.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.K_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.r_(t)}K_(){}auth(){this.state=1;const e=this.W_(this.D_),t=this.D_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((([e,n])=>{this.D_===t&&this.G_(e,n)}),(t=>{e((()=>{const e=new U(M.UNKNOWN,"Fetching auth token failed: "+t.message);return this.z_(e)}))}))}G_(e,t){const n=this.W_(this.D_);this.stream=this.j_(e,t),this.stream.Xo((()=>{n((()=>this.listener.Xo()))})),this.stream.t_((()=>{n((()=>(this.state=2,this.v_=this.Mi.enqueueAfterDelay(this.b_,1e4,(()=>(this.O_()&&(this.state=3),Promise.resolve()))),this.listener.t_())))})),this.stream.r_((e=>{n((()=>this.z_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.F_?this.J_(e):this.onNext(e)))}))}N_(){this.state=5,this.M_.p_((async()=>{this.state=0,this.start()}))}z_(e){return C(no,`close with error: ${e}`),this.stream=null,this.close(4,e)}W_(e){return t=>{this.Mi.enqueueAndForget((()=>this.D_===e?t():(C(no,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class io extends ro{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}j_(e,t){return this.connection.T_("Listen",e,t)}J_(e){return this.onNext(e)}onNext(e){this.M_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:x(39313,{state:e})}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(P(void 0===t||"string"==typeof t,58123),bt.fromBase64String(t||"")):(P(void 0===t||t instanceof _||t instanceof Uint8Array,16193),bt.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?M.UNKNOWN:Yr(e.code);return new U(t,e.message||"")}(o);n=new ui(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=Ai(e,r.document.name),s=Ei(r.document.updateTime),o=r.document.createTime?Ei(r.document.createTime):we.min(),a=new sn({mapValue:{fields:r.document.fields}}),c=an.newFoundDocument(i,s,o,a),u=r.targetIds||[],l=r.removedTargetIds||[];n=new ai(u,l,c.key,c)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=Ai(e,r.document),s=r.readTime?Ei(r.readTime):we.min(),o=an.newNoDocument(i,s),a=r.removedTargetIds||[];n=new ai([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=Ai(e,r.document),s=r.removedTargetIds||[];n=new ai([],s,i,null)}else{if(!("filter"in t))return x(11601,{Rt:t});{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new Hr(r,i),o=e.targetId;n=new ci(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return we.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?we.min():t.readTime?Ei(t.readTime):we.min()}(e);return this.listener.H_(t,n)}Y_(e){const t={};t.database=Ri(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=Pn(r)?{documents:Pi(e,r)}:{query:Di(e,r).ft},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=bi(e,t.resumeToken);const r=vi(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(we.min())>0){n.readTime=wi(e,t.snapshotVersion.toTimestamp());const r=vi(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return x(28987,{purpose:e})}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.q_(t)}Z_(e){const t={};t.database=Ri(this.serializer),t.removeTarget=e,this.q_(t)}}class so extends ro{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get X_(){return this.F_>0}start(){this.lastStreamToken=void 0,super.start()}K_(){this.X_&&this.ea([])}j_(e,t){return this.connection.T_("Write",e,t)}J_(e){return P(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,P(!e.writeResults||0===e.writeResults.length,55816),this.listener.ta()}onNext(e){P(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.M_.reset();const t=function(e,t){return e&&e.length>0?(P(void 0!==t,14353),e.map((e=>function(e,t){let n=e.updateTime?Ei(e.updateTime):Ei(t);return n.isEqual(we.min())&&(n=Ei(t)),new Cr(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Ei(e.commitTime);return this.listener.na(n,t)}ra(){const e={};e.database=Ri(this.serializer),this.q_(e)}ea(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>Li(this.serializer,e)))};this.q_(t)}}class oo{}class ao extends oo{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.ia=!1}sa(){if(this.ia)throw new U(M.FAILED_PRECONDITION,"The client has already been terminated.")}Go(e,t,n,r){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([i,s])=>this.connection.Go(e,Ti(t,n),r,i,s))).catch((e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new U(M.UNKNOWN,e.toString())}))}Ho(e,t,n,r,i){return this.sa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((([s,o])=>this.connection.Ho(e,Ti(t,n),r,s,o,i))).catch((e=>{throw"FirebaseError"===e.name?(e.code===M.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new U(M.UNKNOWN,e.toString())}))}terminate(){this.ia=!0,this.connection.terminate()}}class co{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.oa=0,this._a=null,this.aa=!0}ua(){0===this.oa&&(this.ca("Unknown"),this._a=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this._a=null,this.la("Backend didn't respond within 10 seconds."),this.ca("Offline"),Promise.resolve()))))}ha(e){"Online"===this.state?this.ca("Unknown"):(this.oa++,this.oa>=1&&(this.Pa(),this.la(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.ca("Offline")))}set(e){this.Pa(),this.oa=0,"Online"===e&&(this.aa=!1),this.ca(e)}ca(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}la(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.aa?(N(t),this.aa=!1):C("OnlineStateTracker",t)}Pa(){null!==this._a&&(this._a.cancel(),this._a=null)}}const uo="RemoteStore";class lo{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.Ta=[],this.Ia=new Map,this.Ea=new Set,this.da=[],this.Aa=i,this.Aa.Oo((e=>{n.enqueueAndForget((async()=>{bo(this)&&(C(uo,"Restarting streams for network reachability change."),await async function(e){const t=D(e);t.Ea.add(4),await fo(t),t.Ra.set("Unknown"),t.Ea.delete(4),await ho(t)}(this))}))})),this.Ra=new co(n,r)}}async function ho(e){if(bo(e))for(const t of e.da)await t(!0)}async function fo(e){for(const t of e.da)await t(!1)}function po(e,t){const n=D(e);n.Ia.has(t.targetId)||(n.Ia.set(t.targetId,t),wo(n)?vo(n):Fo(n).O_()&&go(n,t))}function mo(e,t){const n=D(e),r=Fo(n);n.Ia.delete(t),r.O_()&&yo(n,t),0===n.Ia.size&&(r.O_()?r.L_():bo(n)&&n.Ra.set("Unknown"))}function go(e,t){if(e.Va.Ue(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(we.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Fo(e).Y_(t)}function yo(e,t){e.Va.Ue(t),Fo(e).Z_(t)}function vo(e){e.Va=new hi({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),At:t=>e.Ia.get(t)||null,ht:()=>e.datastore.serializer.databaseId}),Fo(e).start(),e.Ra.ua()}function wo(e){return bo(e)&&!Fo(e).x_()&&e.Ia.size>0}function bo(e){return 0===D(e).Ea.size}function _o(e){e.Va=void 0}async function Eo(e){e.Ra.set("Online")}async function Io(e){e.Ia.forEach(((t,n)=>{go(e,t)}))}async function To(e,t){_o(e),wo(e)?(e.Ra.ha(t),vo(e)):e.Ra.set("Unknown")}async function ko(e,t,n){if(e.Ra.set("Online"),t instanceof ui&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.Ia.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.Ia.delete(r),e.Va.removeTarget(r))}(e,t)}catch(n){C(uo,"Failed to remove targets %s: %s ",t.targetIds.join(","),n),await So(e,n)}else if(t instanceof ai?e.Va.Ze(t):t instanceof ci?e.Va.st(t):e.Va.tt(t),!n.isEqual(we.min()))try{const t=await Ls(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Va.Tt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.Ia.get(r);i&&e.Ia.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.Ia.get(t);if(!r)return;e.Ia.set(t,r.withResumeToken(bt.EMPTY_BYTE_STRING,r.snapshotVersion)),yo(e,t);const i=new Gi(r.target,t,n,r.sequenceNumber);go(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){C(uo,"Failed to raise snapshot:",t),await So(e,t)}}async function So(e,t,n){if(!Oe(t))throw t;e.Ea.add(1),await fo(e),e.Ra.set("Offline"),n||(n=()=>Ls(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{C(uo,"Retrying IndexedDB access"),await n(),e.Ea.delete(1),await ho(e)}))}function Ao(e,t){return t().catch((n=>So(e,n,t)))}async function Co(e){const t=D(e),n=jo(t);let r=t.Ta.length>0?t.Ta[t.Ta.length-1].batchId:Le;for(;No(t);)try{const e=await Ds(t.localStore,r);if(null===e){0===t.Ta.length&&n.L_();break}r=e.batchId,Ro(t,e)}catch(e){await So(t,e)}Oo(t)&&xo(t)}function No(e){return bo(e)&&e.Ta.length<10}function Ro(e,t){e.Ta.push(t);const n=jo(e);n.O_()&&n.X_&&n.ea(t.mutations)}function Oo(e){return bo(e)&&!jo(e).x_()&&e.Ta.length>0}function xo(e){jo(e).start()}async function Lo(e){jo(e).ra()}async function Po(e){const t=jo(e);for(const n of e.Ta)t.ea(n.mutations)}async function Do(e,t,n){const r=e.Ta.shift(),i=Kr.from(r,t,n);await Ao(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await Co(e)}async function Mo(e,t){t&&jo(e).X_&&await async function(e,t){if(function(e){return Qr(e)&&e!==M.ABORTED}(t.code)){const n=e.Ta.shift();jo(e).B_(),await Ao(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await Co(e)}}(e,t),Oo(e)&&xo(e)}async function Uo(e,t){const n=D(e);n.asyncQueue.verifyOperationInProgress(),C(uo,"RemoteStore received new credentials");const r=bo(n);n.Ea.add(3),await fo(n),r&&n.Ra.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.Ea.delete(3),await ho(n)}async function Vo(e,t){const n=D(e);t?(n.Ea.delete(2),await ho(n)):t||(n.Ea.add(2),await fo(n),n.Ra.set("Unknown"))}function Fo(e){return e.ma||(e.ma=function(e,t,n){const r=D(e);return r.sa(),new io(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:Eo.bind(null,e),t_:Io.bind(null,e),r_:To.bind(null,e),H_:ko.bind(null,e)}),e.da.push((async t=>{t?(e.ma.B_(),wo(e)?vo(e):e.Ra.set("Unknown")):(await e.ma.stop(),_o(e))}))),e.ma}function jo(e){return e.fa||(e.fa=function(e,t,n){const r=D(e);return r.sa(),new so(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Xo:()=>Promise.resolve(),t_:Lo.bind(null,e),r_:Mo.bind(null,e),ta:Po.bind(null,e),na:Do.bind(null,e)}),e.da.push((async t=>{t?(e.fa.B_(),await Co(e)):(await e.fa.stop(),e.Ta.length>0&&(C(uo,`Stopping write stream with ${e.Ta.length} pending writes`),e.Ta=[]))}))),e.fa}class Bo{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new V,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Bo(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new U(M.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function zo(e,t){if(N("AsyncQueue",`${t}: ${e}`),Oe(e))return new U(M.UNAVAILABLE,`${t}: ${e}`);throw e}class qo{static emptySet(e){return new qo(e.comparator)}constructor(e){this.comparator=e?(t,n)=>e(t,n)||oe.comparator(t.key,n.key):(e,t)=>oe.comparator(e.key,t.key),this.keyedMap=nr(),this.sortedSet=new ft(this.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof qo))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new qo;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class $o{constructor(){this.ga=new ft(oe.comparator)}track(e){const t=e.doc.key,n=this.ga.get(t);n?0!==e.type&&3===n.type?this.ga=this.ga.insert(t,e):3===e.type&&1!==n.type?this.ga=this.ga.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.ga=this.ga.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.ga=this.ga.remove(t):1===e.type&&2===n.type?this.ga=this.ga.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.ga=this.ga.insert(t,{type:2,doc:e.doc}):x(63341,{Rt:e,pa:n}):this.ga=this.ga.insert(t,e)}ya(){const e=[];return this.ga.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Ko{constructor(e,t,n,r,i,s,o,a,c){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=c}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Ko(e,t,qo.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&Kn(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Go{constructor(){this.wa=void 0,this.Sa=[]}ba(){return this.Sa.some((e=>e.Da()))}}class Ho{constructor(){this.queries=Wo(),this.onlineState="Unknown",this.Ca=new Set}terminate(){!function(e,t){const n=D(e),r=n.queries;n.queries=Wo(),r.forEach(((e,n)=>{for(const r of n.Sa)r.onError(t)}))}(this,new U(M.ABORTED,"Firestore shutting down"))}}function Wo(){return new Jn((e=>Gn(e)),Kn)}async function Xo(e,t){const n=D(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.ba()&&t.Da()&&(r=2):(s=new Go,r=t.Da()?0:1);try{switch(r){case 0:s.wa=await n.onListen(i,!0);break;case 1:s.wa=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=zo(e,`Initialization of query '${Hn(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.Sa.push(t),t.va(n.onlineState),s.wa&&t.Fa(s.wa)&&Zo(n)}async function Qo(e,t){const n=D(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.Sa.indexOf(t);e>=0&&(s.Sa.splice(e,1),0===s.Sa.length?i=t.Da()?0:1:!s.ba()&&t.Da()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Yo(e,t){const n=D(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.Sa)e.Fa(i)&&(r=!0);t.wa=i}}r&&Zo(n)}function Jo(e,t,n){const r=D(e),i=r.queries.get(t);if(i)for(const s of i.Sa)s.onError(n);r.queries.delete(t)}function Zo(e){e.Ca.forEach((e=>{e.next()}))}var ea,ta;(ta=ea||(ea={})).Ma="default",ta.Cache="cache";class na{constructor(e,t,n){this.query=e,this.xa=t,this.Oa=!1,this.Na=null,this.onlineState="Unknown",this.options=n||{}}Fa(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Ko(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.Oa?this.Ba(e)&&(this.xa.next(e),t=!0):this.La(e,this.onlineState)&&(this.ka(e),t=!0),this.Na=e,t}onError(e){this.xa.error(e)}va(e){this.onlineState=e;let t=!1;return this.Na&&!this.Oa&&this.La(this.Na,e)&&(this.ka(this.Na),t=!0),t}La(e,t){if(!e.fromCache)return!0;if(!this.Da())return!0;const n="Offline"!==t;return(!this.options.qa||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}Ba(e){if(e.docChanges.length>0)return!0;const t=this.Na&&this.Na.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}ka(e){e=Ko.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Oa=!0,this.xa.next(e)}Da(){return this.options.source!==ea.Cache}}class ra{constructor(e){this.key=e}}class ia{constructor(e){this.key=e}}class sa{constructor(e,t){this.query=e,this.Ya=t,this.Za=null,this.hasCachedResults=!1,this.current=!1,this.Xa=ur(),this.mutatedKeys=ur(),this.eu=Qn(e),this.tu=new qo(this.eu)}get nu(){return this.Ya}ru(e,t){const n=t?t.iu:new $o,r=t?t.tu:this.tu;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,c="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),l=Wn(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!l&&(l.hasLocalMutations||this.mutatedKeys.has(l.key)&&l.hasCommittedMutations);let f=!1;u&&l?u.data.isEqual(l.data)?h!==d&&(n.track({type:3,doc:l}),f=!0):this.su(u,l)||(n.track({type:2,doc:l}),f=!0,(a&&this.eu(l,a)>0||c&&this.eu(l,c)<0)&&(o=!0)):!u&&l?(n.track({type:0,doc:l}),f=!0):u&&!l&&(n.track({type:1,doc:u}),f=!0,(a||c)&&(o=!0)),f&&(l?(s=s.add(l),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{tu:s,iu:n,Cs:o,mutatedKeys:i}}su(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.tu;this.tu=e.tu,this.mutatedKeys=e.mutatedKeys;const s=e.iu.ya();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return x(20277,{Rt:e})}};return n(e)-n(t)}(e.type,t.type)||this.eu(e.doc,t.doc))),this.ou(n),r=r??!1;const o=t&&!r?this._u():[],a=0===this.Xa.size&&this.current&&!r?1:0,c=a!==this.Za;return this.Za=a,0!==s.length||c?{snapshot:new Ko(this.query,e.tu,i,s,e.mutatedKeys,0===a,c,!1,!!n&&n.resumeToken.approximateByteSize()>0),au:o}:{au:o}}va(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({tu:this.tu,iu:new $o,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{au:[]}}uu(e){return!this.Ya.has(e)&&!!this.tu.has(e)&&!this.tu.get(e).hasLocalMutations}ou(e){e&&(e.addedDocuments.forEach((e=>this.Ya=this.Ya.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ya=this.Ya.delete(e))),this.current=e.current)}_u(){if(!this.current)return[];const e=this.Xa;this.Xa=ur(),this.tu.forEach((e=>{this.uu(e.key)&&(this.Xa=this.Xa.add(e.key))}));const t=[];return e.forEach((e=>{this.Xa.has(e)||t.push(new ia(e))})),this.Xa.forEach((n=>{e.has(n)||t.push(new ra(n))})),t}cu(e){this.Ya=e.Qs,this.Xa=ur();const t=this.ru(e.documents);return this.applyChanges(t,!0)}lu(){return Ko.fromInitialDocuments(this.query,this.tu,this.mutatedKeys,0===this.Za,this.hasCachedResults)}}const oa="SyncEngine";class aa{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class ca{constructor(e){this.key=e,this.hu=!1}}class ua{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Pu={},this.Tu=new Jn((e=>Gn(e)),Kn),this.Iu=new Map,this.Eu=new Set,this.du=new ft(oe.comparator),this.Au=new Map,this.Ru=new ms,this.Vu={},this.mu=new Map,this.fu=ts.cr(),this.onlineState="Unknown",this.gu=void 0}get isPrimaryClient(){return!0===this.gu}}async function la(e,t,n=!0){const r=Oa(e);let i;const s=r.Tu.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.lu()):i=await da(r,t,n,!0),i}async function ha(e,t){const n=Oa(e);await da(n,t,!0,!1)}async function da(e,t,n,r){const i=await Ms(e.localStore,Bn(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await fa(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&po(e.remoteStore,i),a}async function fa(e,t,n,r,i){e.pu=(t,n,r)=>async function(e,t,n,r){let i=t.view.ru(n);i.Cs&&(i=await Vs(e.localStore,t.query,!1).then((({documents:e})=>t.view.ru(e,i))));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return ka(e,t.targetId,a.au),a.snapshot}(e,t,n,r);const s=await Vs(e.localStore,t,!0),o=new sa(t,s.Qs),a=o.ru(s.documents),c=oi.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,c);ka(e,n,u.au);const l=new aa(t,n,o);return e.Tu.set(t,l),e.Iu.has(n)?e.Iu.get(n).push(t):e.Iu.set(n,[t]),u.snapshot}async function pa(e,t,n){const r=D(e),i=r.Tu.get(t),s=r.Iu.get(i.targetId);if(s.length>1)return r.Iu.set(i.targetId,s.filter((e=>!Kn(e,t)))),void r.Tu.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Us(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&mo(r.remoteStore,i.targetId),Ia(r,i.targetId)})).catch(Ce)):(Ia(r,i.targetId),await Us(r.localStore,i.targetId,!0))}async function ma(e,t){const n=D(e),r=n.Tu.get(t),i=n.Iu.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),mo(n.remoteStore,r.targetId))}async function ga(e,t){const n=D(e);try{const e=await function(e,t){const n=D(e),r=t.snapshotVersion;let i=n.Ms;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.Ns.newChangeBuffer({trackRemovals:!0});i=n.Ms;const o=[];t.targetChanges.forEach(((s,a)=>{const c=i.get(a);if(!c)return;o.push(n.Pi.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Pi.addMatchingKeys(e,s.addedDocuments,a))));let u=c.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(bt.EMPTY_BYTE_STRING,we.min()).withLastLimboFreeSnapshotVersion(we.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||(t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=Ns||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0)}(c,u,s)&&o.push(n.Pi.updateTargetData(e,u))}));let a=er(),c=ur();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(Ps(e,s,t.documentUpdates).next((e=>{a=e.ks,c=e.qs}))),!r.isEqual(we.min())){const t=n.Pi.getLastRemoteSnapshotVersion(e).next((t=>n.Pi.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Ne.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,c))).next((()=>a))})).then((e=>(n.Ms=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Au.get(t);r&&(P(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1,22616),e.addedDocuments.size>0?r.hu=!0:e.modifiedDocuments.size>0?P(r.hu,14607):e.removedDocuments.size>0&&(P(r.hu,42227),r.hu=!1))})),await Ca(n,e,t)}catch(e){await Ce(e)}}function ya(e,t,n){const r=D(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Tu.forEach(((n,r)=>{const i=r.view.va(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=D(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.Sa)i.va(t)&&(r=!0)})),r&&Zo(n)}(r.eventManager,t),e.length&&r.Pu.H_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function va(e,t,n){const r=D(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Au.get(t),s=i&&i.key;if(s){let e=new ft(oe.comparator);e=e.insert(s,an.newNoDocument(s,we.min()));const n=ur().add(s),i=new si(we.min(),new Map,new ft(X),e,n);await ga(r,i),r.du=r.du.remove(s),r.Au.delete(t),Aa(r)}else await Us(r.localStore,t,!1).then((()=>Ia(r,t,n))).catch(Ce)}async function wa(e,t){const n=D(e),r=t.batch.batchId;try{const e=await function(e,t){const n=D(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.Ns.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Ne.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);P(null!==s,48541),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=ur();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);Ea(n,r,null),_a(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ca(n,e)}catch(e){await Ce(e)}}async function ba(e,t,n){const r=D(e);try{const e=await function(e,t){const n=D(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(P(null!==t,37113),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);Ea(r,t,n),_a(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Ca(r,e)}catch(n){await Ce(n)}}function _a(e,t){(e.mu.get(t)||[]).forEach((e=>{e.resolve()})),e.mu.delete(t)}function Ea(e,t,n){const r=D(e);let i=r.Vu[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Vu[r.currentUser.toKey()]=i}}function Ia(e,t,n=null){e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Iu.get(t))e.Tu.delete(r),n&&e.Pu.yu(r,n);e.Iu.delete(t),e.isPrimaryClient&&e.Ru.jr(t).forEach((t=>{e.Ru.containsKey(t)||Ta(e,t)}))}function Ta(e,t){e.Eu.delete(t.path.canonicalString());const n=e.du.get(t);null!==n&&(mo(e.remoteStore,n),e.du=e.du.remove(t),e.Au.delete(n),Aa(e))}function ka(e,t,n){for(const r of n)r instanceof ra?(e.Ru.addReference(r.key,t),Sa(e,r)):r instanceof ia?(C(oa,"Document no longer in limbo: "+r.key),e.Ru.removeReference(r.key,t),e.Ru.containsKey(r.key)||Ta(e,r.key)):x(19791,{wu:r})}function Sa(e,t){const n=t.key,r=n.path.canonicalString();e.du.get(n)||e.Eu.has(r)||(C(oa,"New document in limbo: "+n),e.Eu.add(r),Aa(e))}function Aa(e){for(;e.Eu.size>0&&e.du.size<e.maxConcurrentLimboResolutions;){const t=e.Eu.values().next().value;e.Eu.delete(t);const n=new oe(re.fromString(t)),r=e.fu.next();e.Au.set(r,new ca(n)),e.du=e.du.insert(n,r),po(e.remoteStore,new Gi(Bn(Un(n.path)),r,"TargetPurposeLimboResolution",xe.ce))}}async function Ca(e,t,n){const r=D(e),i=[],s=[],o=[];r.Tu.isEmpty()||(r.Tu.forEach(((e,a)=>{o.push(r.pu(a,t,n).then((e=>{if((e||n)&&r.isPrimaryClient){const t=e?!e.fromCache:n?.targetChanges.get(a.targetId)?.current;r.sharedClientState.updateQueryState(a.targetId,t?"current":"not-current")}if(e){i.push(e);const t=ks.As(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Pu.H_(i),await async function(e,t){const n=D(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Ne.forEach(t,(t=>Ne.forEach(t.Es,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Ne.forEach(t.ds,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Oe(e))throw e;C(Cs,"Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.Ms.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.Ms=n.Ms.insert(e,i)}}}(r.localStore,s))}async function Na(e,t){const n=D(e);if(!n.currentUser.isEqual(t)){C(oa,"User change. New user:",t.toKey());const e=await xs(n.localStore,t);n.currentUser=t,function(e,t){e.mu.forEach((e=>{e.forEach((e=>{e.reject(new U(M.CANCELLED,t))}))})),e.mu.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ca(n,e.Ls)}}function Ra(e,t){const n=D(e),r=n.Au.get(t);if(r&&r.hu)return ur().add(r.key);{let e=ur();const r=n.Iu.get(t);if(!r)return e;for(const t of r){const r=n.Tu.get(t);e=e.unionWith(r.view.nu)}return e}}function Oa(e){const t=D(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ga.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Ra.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=va.bind(null,t),t.Pu.H_=Yo.bind(null,t.eventManager),t.Pu.yu=Jo.bind(null,t.eventManager),t}function xa(e){const t=D(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=wa.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ba.bind(null,t),t}class La{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=eo(e.databaseInfo.databaseId),this.sharedClientState=this.Du(e),this.persistence=this.Cu(e),await this.persistence.start(),this.localStore=this.vu(e),this.gcScheduler=this.Fu(e,this.localStore),this.indexBackfillerScheduler=this.Mu(e,this.localStore)}Fu(e,t){return null}Mu(e,t){return null}vu(e){return Os(this.persistence,new As,e.initialUser,this.serializer)}Cu(e){return new _s(Is.mi,this.serializer)}Du(e){return new Bs}async terminate(){this.gcScheduler?.stop(),this.indexBackfillerScheduler?.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}La.provider={build:()=>new La};class Pa extends La{constructor(e){super(),this.cacheSizeBytes=e}Fu(e,t){P(this.persistence.referenceDelegate instanceof Ts,46915);const n=this.persistence.referenceDelegate.garbageCollector;return new os(n,e.asyncQueue,t)}Cu(e){const t=void 0!==this.cacheSizeBytes?es.withCacheSize(this.cacheSizeBytes):es.DEFAULT;return new _s((e=>Ts.mi(e,t)),this.serializer)}}class Da{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>ya(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Na.bind(null,this.syncEngine),await Vo(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Ho}createDatastore(e){const t=eo(e.databaseInfo.databaseId),n=function(e){return new Js(e)}(e.databaseInfo);return function(e,t,n,r){return new ao(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new lo(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>ya(this.syncEngine,e,0)),$s.v()?new $s:new zs)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new ua(e,t,n,r,i,s);return o&&(a.gu=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){await async function(e){const t=D(e);C(uo,"RemoteStore shutting down."),t.Ea.add(5),await fo(t),t.Aa.shutdown(),t.Ra.set("Unknown")}(this.remoteStore),this.datastore?.terminate(),this.eventManager?.terminate()}}Da.provider={build:()=>new Da};class Ma{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ou(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ou(this.observer.error,e):N("Uncaught Error in snapshot listener:",e.toString()))}Nu(){this.muted=!0}Ou(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}const Ua="FirestoreClient";class Va{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=T.UNAUTHENTICATED,this.clientId=W.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{C(Ua,"Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(C(Ua,"Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new V;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=zo(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Fa(e,t){e.asyncQueue.verifyOperationInProgress(),C(Ua,"Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await xs(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function ja(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Ba(e);C(Ua,"Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>Uo(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>Uo(t.remoteStore,n))),e._onlineComponents=t}async function Ba(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){C(Ua,"Using user provided OfflineComponentProvider");try{await Fa(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===M.FAILED_PRECONDITION||e.code===M.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;R("Error using user provided cache. Falling back to memory cache: "+n),await Fa(e,new La)}}else C(Ua,"Using default OfflineComponentProvider"),await Fa(e,new Pa(void 0));return e._offlineComponents}async function za(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(C(Ua,"Using user provided OnlineComponentProvider"),await ja(e,e._uninitializedComponentsProvider._online)):(C(Ua,"Using default OnlineComponentProvider"),await ja(e,new Da))),e._onlineComponents}function qa(e){return za(e).then((e=>e.syncEngine))}async function $a(e){const t=await za(e),n=t.eventManager;return n.onListen=la.bind(null,t.syncEngine),n.onUnlisten=pa.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=ha.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=ma.bind(null,t.syncEngine),n}function Ka(e,t,n={}){const r=new V;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Ma({next:a=>{s.Nu(),t.enqueueAndForget((()=>Qo(e,o)));const c=a.docs.has(n);!c&&a.fromCache?i.reject(new U(M.UNAVAILABLE,"Failed to get document because the client is offline.")):c&&a.fromCache&&r&&"server"===r.source?i.reject(new U(M.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new na(Un(n.path),s,{includeMetadataChanges:!0,qa:!0});return Xo(e,o)}(await $a(e),e.asyncQueue,t,n,r))),r.promise}function Ga(e,t,n={}){const r=new V;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Ma({next:n=>{s.Nu(),t.enqueueAndForget((()=>Qo(e,o))),n.fromCache&&"server"===r.source?i.reject(new U(M.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new na(n,s,{includeMetadataChanges:!0,qa:!0});return Xo(e,o)}(await $a(e),e.asyncQueue,t,n,r))),r.promise}function Ha(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const Wa=new Map,Xa="firestore.googleapis.com";class Qa{constructor(e){if(void 0===e.host){if(void 0!==e.ssl)throw new U(M.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Xa,this.ssl=true}else this.host=e.host,this.ssl=e.ssl??true;if(this.isUsingEmulator=void 0!==e.emulatorOptions,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=Zi;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<rs)throw new U(M.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}(function(e,t,n,r){if(!0===t&&!0===r)throw new U(M.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)})("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=Ha(e.experimentalLongPollingOptions??{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new U(M.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new U(M.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new U(M.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class Ya{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Qa({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new U(M.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new U(M.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Qa(e),this._emulatorOptions=e.emulatorOptions||{},void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new j;switch(e.type){case"firstParty":return new $(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new U(M.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=Wa.get(e);t&&(C("ComponentProvider","Removing Datastore"),Wa.delete(e),t.terminate())}(this),Promise.resolve()}}class Ja{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new Ja(this.firestore,e,this._query)}}class Za{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new ec(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Za(this.firestore,e,this._key)}toJSON(){return{type:Za._jsonSchemaVersion,referencePath:this._key.toString()}}static fromJSON(e,t,n){if(me(t,Za._jsonSchema))return new Za(e,n||null,new oe(re.fromString(t.referencePath)))}}Za._jsonSchemaVersion="firestore/documentReference/1.0",Za._jsonSchema={type:pe("string",Za._jsonSchemaVersion),referencePath:pe("string")};class ec extends Ja{constructor(e,t,n){super(e,t,Un(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Za(this.firestore,null,new oe(e))}withConverter(e){return new ec(this.firestore,e,this._path)}}function tc(e,t,...n){if(e=(0,c.m9)(e),ae("collection","path",t),e instanceof Ya){const r=re.fromString(t,...n);return ue(r),new ec(e,null,r)}{if(!(e instanceof Za||e instanceof ec))throw new U(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(re.fromString(t,...n));return ue(r),new ec(e.firestore,null,r)}}function nc(e,t,...n){if(e=(0,c.m9)(e),1===arguments.length&&(t=W.newId()),ae("doc","path",t),e instanceof Ya){const r=re.fromString(t,...n);return ce(r),new Za(e,null,new oe(r))}{if(!(e instanceof Za||e instanceof ec))throw new U(M.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=e._path.child(re.fromString(t,...n));return ce(r),new Za(e.firestore,e instanceof ec?e.converter:null,new oe(r))}}const rc="AsyncQueue";class ic{constructor(e=Promise.resolve()){this.Xu=[],this.ec=!1,this.tc=[],this.nc=null,this.rc=!1,this.sc=!1,this.oc=[],this.M_=new to(this,"async_queue_retry"),this._c=()=>{const e=Zs();e&&C(rc,"Visibility state changed to "+e.visibilityState),this.M_.w_()},this.ac=e;const t=Zs();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this._c)}get isShuttingDown(){return this.ec}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.uc(),this.cc(e)}enterRestrictedMode(e){if(!this.ec){this.ec=!0,this.sc=e||!1;const t=Zs();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this._c)}}enqueue(e){if(this.uc(),this.ec)return new Promise((()=>{}));const t=new V;return this.cc((()=>this.ec&&this.sc?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Xu.push(e),this.lc())))}async lc(){if(0!==this.Xu.length){try{await this.Xu[0](),this.Xu.shift(),this.M_.reset()}catch(e){if(!Oe(e))throw e;C(rc,"Operation failed with retryable error: "+e)}this.Xu.length>0&&this.M_.p_((()=>this.lc()))}}cc(e){const t=this.ac.then((()=>(this.rc=!0,e().catch((e=>{throw this.nc=e,this.rc=!1,N("INTERNAL UNHANDLED ERROR: ",sc(e)),e})).then((e=>(this.rc=!1,e))))));return this.ac=t,t}enqueueAfterDelay(e,t,n){this.uc(),this.oc.indexOf(e)>-1&&(t=0);const r=Bo.createAndSchedule(this,e,t,n,(e=>this.hc(e)));return this.tc.push(r),r}uc(){this.nc&&x(47125,{Pc:sc(this.nc)})}verifyOperationInProgress(){}async Tc(){let e;do{e=this.ac,await e}while(e!==this.ac)}Ic(e){for(const t of this.tc)if(t.timerId===e)return!0;return!1}Ec(e){return this.Tc().then((()=>{this.tc.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.tc)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.Tc()}))}dc(e){this.oc.push(e)}hc(e){const t=this.tc.indexOf(e);this.tc.splice(t,1)}}function sc(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}function oc(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class ac extends Ya{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new ic,this._persistenceKey=r?.name||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new ic(e),this._firestoreClient=void 0,await e}}}function cc(e,t){const n="object"==typeof e?e:(0,s.Mq)(),r="string"==typeof e?e:t||Lt,i=(0,s.qX)(n,"firestore").getImmediate({identifier:r});if(!i._initialized){const e=(0,c.P0)("firestore");e&&function(e,t,n,r={}){e=de(e,Ya);const i=(0,c.Xx)(t),s=e._getSettings(),o={...s,emulatorOptions:e._getEmulatorOptions()},a=`${t}:${n}`;i&&((0,c.Uo)(`https://${a}`),(0,c.dp)("Firestore",!0)),s.host!==Xa&&s.host!==a&&R("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const u={...s,host:a,ssl:i,emulatorOptions:r};if(!(0,c.vZ)(u,o)&&(e._setSettings(u),r.mockUserToken)){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=T.MOCK_USER;else{t=(0,c.Sg)(r.mockUserToken,e._app?.options.projectId);const i=r.mockUserToken.sub||r.mockUserToken.user_id;if(!i)throw new U(M.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new T(i)}e._authCredentials=new B(new F(t,n))}}(i,...e)}return i}function uc(e){if(e._terminated)throw new U(M.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||lc(e),e._firestoreClient}function lc(e){const t=e._freezeSettings(),n=function(e,t,n,r){return new xt(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,Ha(r.experimentalLongPollingOptions),r.useFetchStreams,r.isUsingEmulator)}(e._databaseId,e._app?.options.appId||"",e._persistenceKey,t);e._componentsProvider||t.localCache?._offlineComponentProvider&&t.localCache?._onlineComponentProvider&&(e._componentsProvider={_offline:t.localCache._offlineComponentProvider,_online:t.localCache._onlineComponentProvider}),e._firestoreClient=new Va(e._authCredentials,e._appCheckCredentials,e._queue,n,e._componentsProvider&&function(e){const t=e?._online.build();return{_offline:e?._offline.build(t),_online:t}}(e._componentsProvider))}class hc{constructor(e){this._byteString=e}static fromBase64String(e){try{return new hc(bt.fromBase64String(e))}catch(e){throw new U(M.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new hc(bt.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}toJSON(){return{type:hc._jsonSchemaVersion,bytes:this.toBase64()}}static fromJSON(e){if(me(e,hc._jsonSchema))return hc.fromBase64String(e.bytes)}}hc._jsonSchemaVersion="firestore/bytes/1.0",hc._jsonSchema={type:pe("string",hc._jsonSchemaVersion),bytes:pe("string")};class dc{constructor(...e){for(let t=0;t<e.length;++t)if(0===e[t].length)throw new U(M.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new se(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class fc{constructor(e){this._methodName=e}}class pc{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new U(M.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new U(M.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}_compareTo(e){return X(this._lat,e._lat)||X(this._long,e._long)}toJSON(){return{latitude:this._lat,longitude:this._long,type:pc._jsonSchemaVersion}}static fromJSON(e){if(me(e,pc._jsonSchema))return new pc(e.latitude,e.longitude)}}pc._jsonSchemaVersion="firestore/geoPoint/1.0",pc._jsonSchema={type:pe("string",pc._jsonSchemaVersion),latitude:pe("number"),longitude:pe("number")};class mc{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}toJSON(){return{type:mc._jsonSchemaVersion,vectorValues:this._values}}static fromJSON(e){if(me(e,mc._jsonSchema)){if(Array.isArray(e.vectorValues)&&e.vectorValues.every((e=>"number"==typeof e)))return new mc(e.vectorValues);throw new U(M.INVALID_ARGUMENT,"Expected 'vectorValues' field to be a number array")}}}mc._jsonSchemaVersion="firestore/vectorValue/1.0",mc._jsonSchema={type:pe("string",mc._jsonSchemaVersion),vectorValues:pe("object")};const gc=/^__.*__$/;class yc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms):new Ur(e,this.data,t,this.fieldTransforms)}}class vc{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new Vr(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function wc(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw x(40011,{Ac:e})}}class bc{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.Rc(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Ac(){return this.settings.Ac}Vc(e){return new bc({...this.settings,...e},this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}mc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.gc(e),n}yc(e){const t=this.path?.child(e),n=this.Vc({path:t,fc:!1});return n.Rc(),n}wc(e){return this.Vc({path:void 0,fc:!0})}Sc(e){return Mc(e,this.settings.methodName,this.settings.bc||!1,this.path,this.settings.Dc)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}Rc(){if(this.path)for(let e=0;e<this.path.length;e++)this.gc(this.path.get(e))}gc(e){if(0===e.length)throw this.Sc("Document fields must not be empty");if(wc(this.Ac)&&gc.test(e))throw this.Sc('Document fields cannot begin and end with "__"')}}class _c{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||eo(e)}Cc(e,t,n,r=!1){return new bc({Ac:e,methodName:t,Dc:n,path:se.emptyPath(),fc:!1,bc:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Ec(e){const t=e._freezeSettings(),n=eo(e._databaseId);return new _c(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Ic(e,t,n,r,i,s={}){const o=e.Cc(s.merge||s.mergeFields?2:0,t,n,i);xc("Data must be an object, but it was:",o,r);const a=Rc(r,o);let c,u;if(s.merge)c=new vt(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=Lc(t,r,n);if(!o.contains(i))throw new U(M.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);Uc(e,i)||e.push(i)}c=new vt(e),u=o.fieldTransforms.filter((e=>c.covers(e.field)))}else c=null,u=o.fieldTransforms;return new yc(new sn(a),c,u)}class Tc extends fc{_toFieldTransform(e){if(2!==e.Ac)throw 1===e.Ac?e.Sc(`${this._methodName}() can only appear at the top level of your update data`):e.Sc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Tc}}class kc extends fc{_toFieldTransform(e){return new Ar(e.path,new wr)}isEqual(e){return e instanceof kc}}function Sc(e,t,n,r){const i=e.Cc(1,t,n);xc("Data must be an object, but it was:",i,r);const s=[],o=sn.empty();ht(r,((e,r)=>{const a=Dc(t,e,n);r=(0,c.m9)(r);const u=i.yc(a);if(r instanceof Tc)s.push(a);else{const e=Nc(r,u);null!=e&&(s.push(a),o.set(a,e))}}));const a=new vt(s);return new vc(o,a,i.fieldTransforms)}function Ac(e,t,n,r,i,s){const o=e.Cc(1,t,n),a=[Lc(t,r,n)],u=[i];if(s.length%2!=0)throw new U(M.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let c=0;c<s.length;c+=2)a.push(Lc(t,s[c])),u.push(s[c+1]);const l=[],h=sn.empty();for(let f=a.length-1;f>=0;--f)if(!Uc(l,a[f])){const e=a[f];let t=u[f];t=(0,c.m9)(t);const n=o.yc(e);if(t instanceof Tc)l.push(e);else{const r=Nc(t,n);null!=r&&(l.push(e),h.set(e,r))}}const d=new vt(l);return new vc(h,d,o.fieldTransforms)}function Cc(e,t,n,r=!1){return Nc(n,e.Cc(r?4:3,t))}function Nc(e,t){if(Oc(e=(0,c.m9)(e)))return xc("Unsupported field value:",t,e),Rc(e,t);if(e instanceof fc)return function(e,t){if(!wc(t.Ac))throw t.Sc(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Sc(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.fc&&4!==t.Ac)throw t.Sc("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=Nc(i,t.wc(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=(0,c.m9)(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return pr(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=ve.fromDate(e);return{timestampValue:wi(t.serializer,n)}}if(e instanceof ve){const n=new ve(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:wi(t.serializer,n)}}if(e instanceof pc)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof hc)return{bytesValue:bi(t.serializer,e._byteString)};if(e instanceof Za){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Sc(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Ii(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof mc)return function(e,t){return{mapValue:{fields:{[Dt]:{stringValue:Vt},[Ft]:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Sc("VectorValues must only contain numeric values.");return dr(t.serializer,e)}))}}}}}}(e,t);throw t.Sc(`Unsupported field value: ${he(e)}`)}(e,t)}function Rc(e,t){const n={};return dt(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):ht(e,((e,r)=>{const i=Nc(r,t.mc(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function Oc(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof ve||e instanceof pc||e instanceof hc||e instanceof Za||e instanceof fc||e instanceof mc)}function xc(e,t,n){if(!Oc(n)||!le(n)){const r=he(n);throw"an object"===r?t.Sc(e+" a custom object"):t.Sc(e+" "+r)}}function Lc(e,t,n){if((t=(0,c.m9)(t))instanceof dc)return t._internalPath;if("string"==typeof t)return Dc(e,t);throw Mc("Field path arguments must be of type string or ",e,!1,void 0,n)}const Pc=new RegExp("[~\\*/\\[\\]]");function Dc(e,t,n){if(t.search(Pc)>=0)throw Mc(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new dc(...t.split("."))._internalPath}catch(r){throw Mc(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function Mc(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${r}`),o&&(c+=` in document ${i}`),c+=")"),new U(M.INVALID_ARGUMENT,a+e+c)}function Uc(e,t){return e.some((e=>e.isEqual(t)))}class Vc{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new Za(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new Fc(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(jc("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class Fc extends Vc{data(){return super.data()}}function jc(e,t){return"string"==typeof t?Dc(e,t):t instanceof dc?t._internalPath:t._delegate._internalPath}function Bc(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new U(M.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class zc{}class qc extends zc{}function $c(e,t,...n){let r=[];t instanceof zc&&r.push(t),r=r.concat(n),function(e){const t=e.filter((e=>e instanceof Hc)).length,n=e.filter((e=>e instanceof Kc)).length;if(t>1||t>0&&n>0)throw new U(M.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const i of r)e=i._apply(e);return e}class Kc extends qc{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new Kc(e,t,n)}_apply(e){const t=this._parse(e);return eu(e._query,t),new Ja(e.firestore,e.converter,qn(e._query,t))}_parse(e){const t=Ec(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new U(M.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){Zc(o,s);const t=[];for(const n of o)t.push(Jc(r,e,n));a={arrayValue:{values:t}}}else a=Jc(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||Zc(o,s),a=Cc(n,t,o,"in"===s||"not-in"===s);return pn.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}function Gc(e,t,n){const r=t,i=jc("where",e);return Kc._create(i,r,n)}class Hc extends zc{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new Hc(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:mn.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)eu(n,i),n=qn(n,i)}(e._query,t),new Ja(e.firestore,e.converter,qn(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class Wc extends qc{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new Wc(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new U(M.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new U(M.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new hn(t,n)}(e._query,this._field,this._direction);return new Ja(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new Dn(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}function Xc(e,t="asc"){const n=t,r=jc("orderBy",e);return Wc._create(r,n)}class Qc extends qc{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Qc(e,t,n)}_apply(e){return new Ja(e.firestore,e.converter,$n(e._query,this._limit,this._limitType))}}function Yc(e){return fe("limit",e),Qc._create("limit",e,"F")}function Jc(e,t,n){if("string"==typeof(n=(0,c.m9)(n))){if(""===n)throw new U(M.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Fn(t)&&-1!==n.indexOf("/"))throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(re.fromString(n));if(!oe.isDocumentKey(r))throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return Xt(e,new oe(r))}if(n instanceof Za)return Xt(e,n._key);throw new U(M.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${he(n)}.`)}function Zc(e,t){if(!Array.isArray(e)||0===e.length)throw new U(M.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function eu(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new U(M.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new U(M.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class tu{convertValue(e,t="none"){switch(jt(e)){case 0:return null;case 1:return e.booleanValue;case 2:return It(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Tt(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw x(62114,{value:e})}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e,t="none"){const n={};return ht(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){const t=e.fields?.[Ft].arrayValue?.values?.map((e=>It(e.doubleValue)));return new mc(t)}convertGeoPoint(e){return new pc(It(e.latitude),It(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Rt(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(Ot(e));default:return null}}convertTimestamp(e){const t=Et(e);return new ve(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=re.fromString(e);P(Ki(n),9688,{name:e});const r=new Pt(n.get(1),n.get(3)),i=new oe(n.popFirst(5));return r.isEqual(t)||N(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function nu(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class ru{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class iu extends Vc{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const t=new su(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,t={}){if(this._document){const n=this._document.data.field(jc("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}toJSON(){if(this.metadata.hasPendingWrites)throw new U(M.FAILED_PRECONDITION,"DocumentSnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e=this._document,t={};return t.type=iu._jsonSchemaVersion,t.bundle="",t.bundleSource="DocumentSnapshot",t.bundleName=this._key.toString(),e&&e.isValidDocument()&&e.isFoundDocument()?(this._userDataWriter.convertObjectMap(e.data.value.mapValue.fields,"previous"),t.bundle=(this._firestore,this.ref.path,"NOT SUPPORTED"),t):t}}iu._jsonSchemaVersion="firestore/documentSnapshot/1.0",iu._jsonSchema={type:pe("string",iu._jsonSchemaVersion),bundleSource:pe("string","DocumentSnapshot"),bundleName:pe("string"),bundle:pe("string")};class su extends iu{data(e={}){return super.data(e)}}class ou{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new ru(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new su(this._firestore,this._userDataWriter,n.key,n,new ru(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(e={}){const t=!!e.includeMetadataChanges;if(t&&this._snapshot.excludesMetadataChanges)throw new U(M.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===t||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new su(e._firestore,e._userDataWriter,n.doc.key,n.doc,new ru(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new su(e._firestore,e._userDataWriter,t.doc.key,t.doc,new ru(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:au(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,t),this._cachedChangesIncludeMetadataChanges=t),this._cachedChanges}toJSON(){if(this.metadata.hasPendingWrites)throw new U(M.FAILED_PRECONDITION,"QuerySnapshot.toJSON() attempted to serialize a document with pending writes. Await waitForPendingWrites() before invoking toJSON().");const e={};e.type=ou._jsonSchemaVersion,e.bundleSource="QuerySnapshot",e.bundleName=W.newId(),this._firestore._databaseId.database,this._firestore._databaseId.projectId;const t=[],n=[],r=[];return this.docs.forEach((e=>{null!==e._document&&(t.push(e._document),n.push(this._userDataWriter.convertObjectMap(e._document.data.value.mapValue.fields,"previous")),r.push(e.ref.path))})),e.bundle=(this._firestore,this.query._query,e.bundleName,"NOT SUPPORTED"),e}}function au(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return x(61501,{type:e})}}function cu(e){e=de(e,Za);const t=de(e.firestore,ac);return Ka(uc(t),e._key).then((n=>yu(t,e,n)))}ou._jsonSchemaVersion="firestore/querySnapshot/1.0",ou._jsonSchema={type:pe("string",ou._jsonSchemaVersion),bundleSource:pe("string","QuerySnapshot"),bundleName:pe("string"),bundle:pe("string")};class uu extends tu{constructor(e){super(),this.firestore=e}convertBytes(e){return new hc(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new Za(this.firestore,null,t)}}function lu(e){e=de(e,Ja);const t=de(e.firestore,ac),n=uc(t),r=new uu(t);return Bc(e._query),Ga(n,e._query).then((n=>new ou(t,r,e,n)))}function hu(e,t,n){e=de(e,Za);const r=de(e.firestore,ac),i=nu(e.converter,t,n);return gu(r,[Ic(Ec(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,Nr.none())])}function du(e,t,n,...r){e=de(e,Za);const i=de(e.firestore,ac),s=Ec(i);let o;return o="string"==typeof(t=(0,c.m9)(t))||t instanceof dc?Ac(s,"updateDoc",e._key,t,n,r):Sc(s,"updateDoc",e._key,t),gu(i,[o.toMutation(e._key,Nr.exists(!0))])}function fu(e){return gu(de(e.firestore,ac),[new zr(e._key,Nr.none())])}function pu(e,t){const n=de(e.firestore,ac),r=nc(e),i=nu(e.converter,t);return gu(n,[Ic(Ec(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,Nr.exists(!1))]).then((()=>r))}function mu(e,...t){e=(0,c.m9)(e);let n={includeMetadataChanges:!1,source:"default"},r=0;"object"!=typeof t[r]||oc(t[r])||(n=t[r++]);const i={includeMetadataChanges:n.includeMetadataChanges,source:n.source};if(oc(t[r])){const e=t[r];t[r]=e.next?.bind(e),t[r+1]=e.error?.bind(e),t[r+2]=e.complete?.bind(e)}let s,o,a;if(e instanceof Za)o=de(e.firestore,ac),a=Un(e._key.path),s={next:n=>{t[r]&&t[r](yu(o,e,n))},error:t[r+1],complete:t[r+2]};else{const n=de(e,Ja);o=de(n.firestore,ac),a=n._query;const i=new uu(o);s={next:e=>{t[r]&&t[r](new ou(o,i,n,e))},error:t[r+1],complete:t[r+2]},Bc(e._query)}return function(e,t,n,r){const i=new Ma(r),s=new na(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Xo(await $a(e),s))),()=>{i.Nu(),e.asyncQueue.enqueueAndForget((async()=>Qo(await $a(e),s)))}}(uc(o),a,i,s)}function gu(e,t){return function(e,t){const n=new V;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=xa(e);try{const e=await function(e,t){const n=D(e),r=ve.now(),i=t.reduce(((e,t)=>e.add(t.key)),ur());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=er(),c=ur();return n.Ns.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(c=c.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=Dr(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new Vr(e.key,t,on(t.value.mapValue),Nr.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,c);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:rr(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Vu[e.currentUser.toKey()];r||(r=new ft(X)),r=r.insert(t,n),e.Vu[e.currentUser.toKey()]=r}(r,e.batchId,n),await Ca(r,e.changes),await Co(r.remoteStore)}catch(e){const t=zo(e,"Failed to persist write");n.reject(t)}}(await qa(e),t,n))),n.promise}(uc(e),t)}function yu(e,t,n){const r=n.docs.get(t._key),i=new uu(e);return new iu(e,i,t._key,r,new ru(n.hasPendingWrites,n.fromCache),t.converter)}class vu{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Ec(e)}set(e,t,n){this._verifyNotCommitted();const r=wu(e,this._firestore),i=nu(r.converter,t,n),s=Ic(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,Nr.none())),this}update(e,t,n,...r){this._verifyNotCommitted();const i=wu(e,this._firestore);let s;return s="string"==typeof(t=(0,c.m9)(t))||t instanceof dc?Ac(this._dataReader,"WriteBatch.update",i._key,t,n,r):Sc(this._dataReader,"WriteBatch.update",i._key,t),this._mutations.push(s.toMutation(i._key,Nr.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=wu(e,this._firestore);return this._mutations=this._mutations.concat(new zr(t._key,Nr.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new U(M.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function wu(e,t){if((e=(0,c.m9)(e)).firestore!==t)throw new U(M.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}function bu(){return new kc("serverTimestamp")}function _u(e){return uc(e=de(e,ac)),new vu(e,(t=>gu(e,t)))}new WeakMap;!function(e,t=!0){!function(e){k=e}(s.Jn),(0,s.Xd)(new o.wA("firestore",((e,{instanceIdentifier:n,options:r})=>{const i=e.getProvider("app").getImmediate(),s=new ac(new z(e.getProvider("auth-internal")),new G(i,e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new U(M.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Pt(e.options.projectId,t)}(i,n),i);return r={useFetchStreams:t,...r},s._setSettings(r),s}),"PUBLIC").setMultipleInstances(!0)),(0,s.KN)(E,I,e),(0,s.KN)(E,I,"esm2020")}()},16689:function(e,t,n){"use strict";n.d(t,{Jt:function(){return be},cF:function(){return Ee},iH:function(){return _e},KV:function(){return we}});var r=n(33310),i=n(99711),s=n(75);const o="firebasestorage.googleapis.com",a="storageBucket";class c extends i.ZR{constructor(e,t,n=0){super(h(e),`Firebase Storage: ${t} (${h(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,c.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return h(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var u,l;function h(e){return"storage/"+e}function d(){return new c(u.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function f(){return new c(u.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function p(){return new c(u.CANCELED,"User canceled the upload/download.")}function m(){return new c(u.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function g(e){return new c(u.INVALID_ARGUMENT,e)}function y(){return new c(u.APP_DELETED,"The Firebase app was deleted.")}function v(e,t){return new c(u.INVALID_FORMAT,"String does not match format '"+e+"': "+t)}function w(e){throw new c(u.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(u||(u={}));class b{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=b.makeFromUrl(e,t)}catch(i){return new b(e,"")}if(""===n.path)return n;throw r=e,new c(u.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const a=t.replace(/[.]/g,"\\."),l=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${a}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===o?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let o=0;o<l.length;o++){const t=l[o],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new b(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new c(u.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class _{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(e=!1){}}function E(e){return"string"===typeof e||e instanceof String}function I(e){return T()&&e instanceof Blob}function T(){return"undefined"!==typeof Blob}function k(e,t,n,r){if(r<t)throw g(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw g(`Invalid value for '${e}'. Expected ${n} or less.`)}function S(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function A(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function C(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(l||(l={}));class N{constructor(e,t,n,r,i,s,o,a,c,u,l,h=!0,d=!1){this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=c,this.progressCallback_=u,this.connectionFactory_=l,this.retry=h,this.isUsingEmulator=d,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new R(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.isUsingEmulator,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===l.NO_ERROR,i=n.getStatus();if(!t||C(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===l.ABORT;return void e(!1,new R(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new R(s,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(s){r(s)}else if(null!==i){const e=d();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?y():p())}else{r(f())}};this.canceled_?t(0,new R(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function c(){return 2===a}let u=!1;function l(...e){u||(u=!0,t.apply(null,e))}function h(t){i=setTimeout((()=>{i=null,e(f,c())}),t)}function d(){s&&clearTimeout(s)}function f(e,...t){if(u)return void d();if(e)return d(),void l.call(null,e,...t);if(c()||o)return d(),void l.call(null,e,...t);let n;r<64&&(r*=2),1===a?(a=2,n=0):n=1e3*(r+Math.random()),h(n)}let p=!1;function m(e){p||(p=!0,d(),u||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,m(!0)}),n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class R{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function O(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function x(...e){const t=O();if(void 0!==t){const n=new t;for(let t=0;t<e.length;t++)n.append(e[t]);return n.getBlob()}if(T())return new Blob(e);throw new c(u.UNSUPPORTED_ENVIRONMENT,"This browser doesn't seem to support creating Blobs")}function L(e){if("undefined"===typeof atob)throw t="base-64",new c(u.UNSUPPORTED_ENVIRONMENT,`${t} is missing. Make sure to install the required polyfills. See https://firebase.google.com/docs/web/environments-js-sdk#polyfills for more information.`);var t;return atob(e)}const P={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"};class D{constructor(e,t){this.data=e,this.contentType=t||null}}function M(e,t){switch(e){case P.RAW:return new D(U(t));case P.BASE64:case P.BASE64URL:return new D(V(e,t));case P.DATA_URL:return new D(function(e){const t=new F(e);return t.base64?V(P.BASE64,t.rest):function(e){let t;try{t=decodeURIComponent(e)}catch(n){throw v(P.DATA_URL,"Malformed data URL.")}return U(t)}(t.rest)}(t),new F(t).contentType)}throw d()}function U(e){const t=[];for(let n=0;n<e.length;n++){let r=e.charCodeAt(n);if(r<=127)t.push(r);else if(r<=2047)t.push(192|r>>6,128|63&r);else if(55296===(64512&r)){if(n<e.length-1&&56320===(64512&e.charCodeAt(n+1))){r=65536|(1023&r)<<10|1023&e.charCodeAt(++n),t.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else t.push(239,191,189)}else 56320===(64512&r)?t.push(239,191,189):t.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(t)}function V(e,t){switch(e){case P.BASE64:{const n=-1!==t.indexOf("-"),r=-1!==t.indexOf("_");if(n||r){throw v(e,"Invalid character '"+(n?"-":"_")+"' found: is it base64url encoded?")}break}case P.BASE64URL:{const n=-1!==t.indexOf("+"),r=-1!==t.indexOf("/");if(n||r){throw v(e,"Invalid character '"+(n?"+":"/")+"' found: is it base64 encoded?")}t=t.replace(/-/g,"+").replace(/_/g,"/");break}}let n;try{n=L(t)}catch(i){if(i.message.includes("polyfill"))throw i;throw v(e,"Invalid character found")}const r=new Uint8Array(n.length);for(let s=0;s<n.length;s++)r[s]=n.charCodeAt(s);return r}class F{constructor(e){this.base64=!1,this.contentType=null;const t=e.match(/^data:([^,]+)?,/);if(null===t)throw v(P.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");const n=t[1]||null;null!=n&&(this.base64=function(e,t){if(!(e.length>=t.length))return!1;return e.substring(e.length-t.length)===t}(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-7):n),this.rest=e.substring(e.indexOf(",")+1)}}class j{constructor(e,t){let n=0,r="";I(e)?(this.data_=e,n=e.size,r=e.type):e instanceof ArrayBuffer?(t?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),n=this.data_.length):e instanceof Uint8Array&&(t?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),n=e.length),this.size_=n,this.type_=r}size(){return this.size_}type(){return this.type_}slice(e,t){if(I(this.data_)){const n=function(e,t,n){return e.webkitSlice?e.webkitSlice(t,n):e.mozSlice?e.mozSlice(t,n):e.slice?e.slice(t,n):null}(this.data_,e,t);return null===n?null:new j(n)}{const n=new Uint8Array(this.data_.buffer,e,t-e);return new j(n,!0)}}static getBlob(...e){if(T()){const t=e.map((e=>e instanceof j?e.data_:e));return new j(x.apply(null,t))}{const t=e.map((e=>E(e)?M(P.RAW,e).data:e.data_));let n=0;t.forEach((e=>{n+=e.byteLength}));const r=new Uint8Array(n);let i=0;return t.forEach((e=>{for(let t=0;t<e.length;t++)r[i++]=e[t]})),new j(r,!0)}}uploadData(){return this.data_}}function B(e){let t;try{t=JSON.parse(e)}catch(r){return null}return"object"!==typeof(n=t)||Array.isArray(n)?null:t;var n}function z(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function q(e,t){return t}class ${constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||q}}let K=null;function G(){if(K)return K;const e=[];e.push(new $("bucket")),e.push(new $("generation")),e.push(new $("metageneration")),e.push(new $("name","fullPath",!0));const t=new $("name");t.xform=function(e,t){return function(e){return!E(e)||e.length<2?e:z(e)}(t)},e.push(t);const n=new $("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new $("timeCreated")),e.push(new $("updated")),e.push(new $("md5Hash",null,!0)),e.push(new $("cacheControl",null,!0)),e.push(new $("contentDisposition",null,!0)),e.push(new $("contentEncoding",null,!0)),e.push(new $("contentLanguage",null,!0)),e.push(new $("contentType",null,!0)),e.push(new $("metadata","customMetadata",!0)),K=e,K}function H(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new b(n,r);return t._makeStorageReference(i)}})}(r,e),r}function W(e,t,n){const r=B(t);if(null===r)return null;return H(e,r,n)}function X(e,t){const n={},r=t.length;for(let i=0;i<r;i++){const r=t[i];r.writable&&(n[r.server]=e[r.local])}return JSON.stringify(n)}class Q{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Y(e){if(!e)throw d()}function J(e,t){return function(n,r){const i=W(e,r,t);return Y(null!==i),i}}function Z(e,t){return function(n,r){const i=W(e,r,t);return Y(null!==i),function(e,t,n,r){const i=B(t);if(null===i)return null;if(!E(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const i=e.bucket,s=e.fullPath;return S("/b/"+o(i)+"/o/"+o(s),n,r)+A({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function ee(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new c(u.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new c(u.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new c(u.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new c(u.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function te(e){const t=ee(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new c(u.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}function ne(e,t,n){const r=Object.assign({},n);return r.fullPath=e.path,r.size=t.size(),r.contentType||(r.contentType=function(e,t){return e&&e.contentType||t&&t.type()||"application/octet-stream"}(null,t)),r}function re(e,t,n,r,i){const s=t.bucketOnlyServerUrl(),o={"X-Goog-Upload-Protocol":"multipart"};const a=function(){let e="";for(let t=0;t<2;t++)e+=Math.random().toString().slice(2);return e}();o["Content-Type"]="multipart/related; boundary="+a;const c=ne(t,r,i),u="--"+a+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+X(c,n)+"\r\n--"+a+"\r\nContent-Type: "+c.contentType+"\r\n\r\n",l="\r\n--"+a+"--",h=j.getBlob(u,r,l);if(null===h)throw m();const d={name:c.fullPath},f=S(s,e.host,e._protocol),p=e.maxUploadRetryTime,g=new Q(f,"POST",J(e,n),p);return g.urlParams=d,g.headers=o,g.body=h.uploadData(),g.errorHandler=ee(t),g}let ie=null;class se{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=l.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=l.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=l.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r,s){if(this.sent_)throw w("cannot .send() more than once");if((0,i.Xx)(e)&&n&&(this.xhr_.withCredentials=!0),this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==s)for(const i in s)s.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,s[i].toString());return void 0!==r?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw w("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw w("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw w("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw w("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class oe extends se{initXhr(){this.xhr_.responseType="text"}}function ae(){return ie?ie():new oe}class ce{constructor(e,t){this._service=e,this._location=t instanceof b?t:b.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new ce(e,t)}get root(){const e=new b(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return z(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new b(this._location.bucket,e);return new ce(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new c(u.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function ue(e,t,n){e._throwIfRoot("uploadBytes");const r=re(e.storage,e._location,G(),new j(t,!0),n);return e.storage.makeRequestWithTokens(r,ae).then((t=>({metadata:t,ref:e})))}function le(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=S(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new Q(r,"GET",Z(e,n),i);return s.errorHandler=te(t),s}(e.storage,e._location,G());return e.storage.makeRequestWithTokens(t,ae).then((e=>{if(null===e)throw new c(u.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function he(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new b(e._location.bucket,n);return new ce(e.storage,r)}function de(e,t){if(e instanceof me){const n=e;if(null==n._bucket)throw new c(u.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+a+"' property when initializing the app?");const r=new ce(n,n._bucket);return null!=t?de(r,t):r}return void 0!==t?he(e,t):e}function fe(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof me)return new ce(e,t);throw g("To use ref(service, url), the first argument must be a Storage instance.")}return de(e,t)}function pe(e,t){const n=t?.[a];return null==n?null:b.makeFromBucketSpec(n,e)}class me{constructor(e,t,n,r,i,s=!1){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._isUsingEmulator=s,this._bucket=null,this._host=o,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?b.makeFromBucketSpec(r,this._host):pe(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=b.makeFromBucketSpec(this._url,e):this._bucket=pe(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){k("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){k("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){if((0,r.rh)(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new ce(this,e)}_makeRequest(e,t,n,r,i=!0){if(this._deleted)return new _(y());{const s=function(e,t,n,r,i,s,o=!0,a=!1){const c=A(e.urlParams),u=e.url+c,l=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(l,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(l,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(t??"AppManager")}(l,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(l,r),new N(u,e.method,l,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o,a)}(e,this._appId,n,r,t,this._firebaseVersion,i,this._isUsingEmulator);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const ge="@firebase/storage",ye="0.14.0",ve="storage";function we(e,t,n){return ue(e=(0,i.m9)(e),t,n)}function be(e){return le(e=(0,i.m9)(e))}function _e(e,t){return fe(e=(0,i.m9)(e),t)}function Ee(e=(0,r.Mq)(),t){e=(0,i.m9)(e);const n=(0,r.qX)(e,ve).getImmediate({identifier:t}),s=(0,i.P0)("storage");return s&&function(e,t,n,r={}){!function(e,t,n,r={}){e.host=`${t}:${n}`;const s=(0,i.Xx)(t);s&&((0,i.Uo)(`https://${e.host}/b`),(0,i.dp)("Storage",!0)),e._isUsingEmulator=!0,e._protocol=s?"https":"http";const{mockUserToken:o}=r;o&&(e._overrideAuthToken="string"===typeof o?o:(0,i.Sg)(o,e.app.options.projectId))}(e,t,n,r)}(n,...s),n}function Ie(e,{instanceIdentifier:t}){const n=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new me(n,i,s,t,r.Jn)}(0,r.Xd)(new s.wA(ve,Ie,"PUBLIC").setMultipleInstances(!0)),(0,r.KN)(ge,ye,""),(0,r.KN)(ge,ye,"esm2020")},26531:function(e,t,n){"use strict";n.d(t,{Lj:function(){return y},X3:function(){return g}});const r=(e,t)=>t.some((t=>e instanceof t));let i,s;const o=new WeakMap,a=new WeakMap,c=new WeakMap,u=new WeakMap,l=new WeakMap;let h={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return a.get(e);if("objectStoreNames"===t)return e.objectStoreNames||c.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return p(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function d(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(s||(s=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(...t){return e.apply(m(this),t),p(o.get(this))}:function(...t){return p(e.apply(m(this),t))}:function(t,...n){const r=e.call(m(this),t,...n);return c.set(r,t.sort?t.sort():[t]),p(r)}}function f(e){return"function"===typeof e?d(e):(e instanceof IDBTransaction&&function(e){if(a.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));a.set(e,t)}(e),r(e,i||(i=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction]))?new Proxy(e,h):e)}function p(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(p(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&o.set(t,e)})).catch((()=>{})),l.set(t,e),t}(e);if(u.has(e))return u.get(e);const t=f(e);return t!==e&&(u.set(e,t),l.set(t,e)),t}const m=e=>l.get(e);function g(e,t,{blocked:n,upgrade:r,blocking:i,terminated:s}={}){const o=indexedDB.open(e,t),a=p(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(p(o.result),e.oldVersion,e.newVersion,p(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}function y(e,{blocked:t}={}){const n=indexedDB.deleteDatabase(e);return t&&n.addEventListener("blocked",(e=>t(e.oldVersion,e))),p(n).then((()=>{}))}const v=["get","getKey","getAll","getAllKeys","count"],w=["put","add","delete","clear"],b=new Map;function _(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(b.get(t))return b.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=w.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!v.includes(n))return;const s=async function(e,...t){const s=this.transaction(e,i?"readwrite":"readonly");let o=s.store;return r&&(o=o.index(t.shift())),(await Promise.all([o[n](...t),i&&s.done]))[0]};return b.set(t,s),s}h=(e=>({...e,get:(t,n,r)=>_(t,n)||e.get(t,n,r),has:(t,n)=>!!_(t,n)||e.has(t,n)}))(h)},86501:function(e,t,n){"use strict";n.d(t,{x7:function(){return ne},ZP:function(){return re},Am:function(){return O}});var r=n(67294);let i={data:""},s=e=>{if("object"==typeof window){let t=(e?e.querySelector("#_goober"):window._goober)||Object.assign(document.createElement("style"),{innerHTML:" ",id:"_goober"});return t.nonce=window.__nonce__,t.parentNode||(e||document.head).appendChild(t),t.firstChild}return e||i},o=/(?:([\u0080-\uFFFF\w-%@]+) *:? *([^{;]+?);|([^;}{]*?) *{)|(}\s*)/g,a=/\/\*[^]*?\*\/|  +/g,c=/\n+/g,u=(e,t)=>{let n="",r="",i="";for(let s in e){let o=e[s];"@"==s[0]?"i"==s[1]?n=s+" "+o+";":r+="f"==s[1]?u(o,s):s+"{"+u(o,"k"==s[1]?"":t)+"}":"object"==typeof o?r+=u(o,t?t.replace(/([^,])+/g,(e=>s.replace(/([^,]*:\S+\([^)]*\))|([^,])+/g,(t=>/&/.test(t)?t.replace(/&/g,e):e?e+" "+t:t)))):s):null!=o&&(s=/^--/.test(s)?s:s.replace(/[A-Z]/g,"-$&").toLowerCase(),i+=u.p?u.p(s,o):s+":"+o+";")}return n+(t&&i?t+"{"+i+"}":i)+r},l={},h=e=>{if("object"==typeof e){let t="";for(let n in e)t+=n+h(e[n]);return t}return e},d=(e,t,n,r,i)=>{let s=h(e),d=l[s]||(l[s]=(e=>{let t=0,n=11;for(;t<e.length;)n=101*n+e.charCodeAt(t++)>>>0;return"go"+n})(s));if(!l[d]){let t=s!==e?e:(e=>{let t,n,r=[{}];for(;t=o.exec(e.replace(a,""));)t[4]?r.shift():t[3]?(n=t[3].replace(c," ").trim(),r.unshift(r[0][n]=r[0][n]||{})):r[0][t[1]]=t[2].replace(c," ").trim();return r[0]})(e);l[d]=u(i?{["@keyframes "+d]:t}:t,n?"":"."+d)}let f=n&&l.g?l.g:null;return n&&(l.g=l[d]),((e,t,n,r)=>{r?t.data=t.data.replace(r,e):-1===t.data.indexOf(e)&&(t.data=n?e+t.data:t.data+e)})(l[d],t,r,f),d},f=(e,t,n)=>e.reduce(((e,r,i)=>{let s=t[i];if(s&&s.call){let e=s(n),t=e&&e.props&&e.props.className||/^go/.test(e)&&e;s=t?"."+t:e&&"object"==typeof e?e.props?"":u(e,""):!1===e?"":e}return e+r+(null==s?"":s)}),"");function p(e){let t=this||{},n=e.call?e(t.p):e;return d(n.unshift?n.raw?f(n,[].slice.call(arguments,1),t.p):n.reduce(((e,n)=>Object.assign(e,n&&n.call?n(t.p):n)),{}):n,s(t.target),t.g,t.o,t.k)}p.bind({g:1});let m,g,y,v=p.bind({k:1});function w(e,t){let n=this||{};return function(){let r=arguments;function i(s,o){let a=Object.assign({},s),c=a.className||i.className;n.p=Object.assign({theme:g&&g()},a),n.o=/ *go\d+/.test(c),a.className=p.apply(n,r)+(c?" "+c:""),t&&(a.ref=o);let u=e;return e[0]&&(u=a.as||e,delete a.as),y&&u[0]&&y(a),m(u,a)}return t?t(i):i}}var b=(e,t)=>(e=>"function"==typeof e)(e)?e(t):e,_=(()=>{let e=0;return()=>(++e).toString()})(),E=(()=>{let e;return()=>{if(void 0===e&&typeof window<"u"){let t=matchMedia("(prefers-reduced-motion: reduce)");e=!t||t.matches}return e}})(),I=new Map,T=e=>{if(I.has(e))return;let t=setTimeout((()=>{I.delete(e),C({type:4,toastId:e})}),1e3);I.set(e,t)},k=(e,t)=>{switch(t.type){case 0:return{...e,toasts:[t.toast,...e.toasts].slice(0,20)};case 1:return t.toast.id&&(e=>{let t=I.get(e);t&&clearTimeout(t)})(t.toast.id),{...e,toasts:e.toasts.map((e=>e.id===t.toast.id?{...e,...t.toast}:e))};case 2:let{toast:n}=t;return e.toasts.find((e=>e.id===n.id))?k(e,{type:1,toast:n}):k(e,{type:0,toast:n});case 3:let{toastId:r}=t;return r?T(r):e.toasts.forEach((e=>{T(e.id)})),{...e,toasts:e.toasts.map((e=>e.id===r||void 0===r?{...e,visible:!1}:e))};case 4:return void 0===t.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==t.toastId))};case 5:return{...e,pausedAt:t.time};case 6:let i=t.time-(e.pausedAt||0);return{...e,pausedAt:void 0,toasts:e.toasts.map((e=>({...e,pauseDuration:e.pauseDuration+i})))}}},S=[],A={toasts:[],pausedAt:void 0},C=e=>{A=k(A,e),S.forEach((e=>{e(A)}))},N={blank:4e3,error:4e3,success:2e3,loading:1/0,custom:4e3},R=e=>(t,n)=>{let r=((e,t="blank",n)=>({createdAt:Date.now(),visible:!0,type:t,ariaProps:{role:"status","aria-live":"polite"},message:e,pauseDuration:0,...n,id:(null==n?void 0:n.id)||_()}))(t,e,n);return C({type:2,toast:r}),r.id},O=(e,t)=>R("blank")(e,t);O.error=R("error"),O.success=R("success"),O.loading=R("loading"),O.custom=R("custom"),O.dismiss=e=>{C({type:3,toastId:e})},O.remove=e=>C({type:4,toastId:e}),O.promise=(e,t,n)=>{let r=O.loading(t.loading,{...n,...null==n?void 0:n.loading});return e.then((e=>(O.success(b(t.success,e),{id:r,...n,...null==n?void 0:n.success}),e))).catch((e=>{O.error(b(t.error,e),{id:r,...n,...null==n?void 0:n.error})})),e};var x=(e,t)=>{C({type:1,toast:{id:e,height:t}})},L=()=>{C({type:5,time:Date.now()})},P=e=>{let{toasts:t,pausedAt:n}=((e={})=>{let[t,n]=(0,r.useState)(A);(0,r.useEffect)((()=>(S.push(n),()=>{let e=S.indexOf(n);e>-1&&S.splice(e,1)})),[t]);let i=t.toasts.map((t=>{var n,r;return{...e,...e[t.type],...t,duration:t.duration||(null==(n=e[t.type])?void 0:n.duration)||(null==e?void 0:e.duration)||N[t.type],style:{...e.style,...null==(r=e[t.type])?void 0:r.style,...t.style}}}));return{...t,toasts:i}})(e);(0,r.useEffect)((()=>{if(n)return;let e=Date.now(),r=t.map((t=>{if(t.duration===1/0)return;let n=(t.duration||0)+t.pauseDuration-(e-t.createdAt);if(!(n<0))return setTimeout((()=>O.dismiss(t.id)),n);t.visible&&O.dismiss(t.id)}));return()=>{r.forEach((e=>e&&clearTimeout(e)))}}),[t,n]);let i=(0,r.useCallback)((()=>{n&&C({type:6,time:Date.now()})}),[n]),s=(0,r.useCallback)(((e,n)=>{let{reverseOrder:r=!1,gutter:i=8,defaultPosition:s}=n||{},o=t.filter((t=>(t.position||s)===(e.position||s)&&t.height)),a=o.findIndex((t=>t.id===e.id)),c=o.filter(((e,t)=>t<a&&e.visible)).length;return o.filter((e=>e.visible)).slice(...r?[c+1]:[0,c]).reduce(((e,t)=>e+(t.height||0)+i),0)}),[t]);return{toasts:t,handlers:{updateHeight:x,startPause:L,endPause:i,calculateOffset:s}}},D=v`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
 transform: scale(1) rotate(45deg);
  opacity: 1;
}`,M=v`
from {
  transform: scale(0);
  opacity: 0;
}
to {
  transform: scale(1);
  opacity: 1;
}`,U=v`
from {
  transform: scale(0) rotate(90deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(90deg);
	opacity: 1;
}`,V=w("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#ff4b4b"};
  position: relative;
  transform: rotate(45deg);

  animation: ${D} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;

  &:after,
  &:before {
    content: '';
    animation: ${M} 0.15s ease-out forwards;
    animation-delay: 150ms;
    position: absolute;
    border-radius: 3px;
    opacity: 0;
    background: ${e=>e.secondary||"#fff"};
    bottom: 9px;
    left: 4px;
    height: 2px;
    width: 12px;
  }

  &:before {
    animation: ${U} 0.15s ease-out forwards;
    animation-delay: 180ms;
    transform: rotate(90deg);
  }
`,F=v`
  from {
    transform: rotate(0deg);
  }
  to {
    transform: rotate(360deg);
  }
`,j=w("div")`
  width: 12px;
  height: 12px;
  box-sizing: border-box;
  border: 2px solid;
  border-radius: 100%;
  border-color: ${e=>e.secondary||"#e0e0e0"};
  border-right-color: ${e=>e.primary||"#616161"};
  animation: ${F} 1s linear infinite;
`,B=v`
from {
  transform: scale(0) rotate(45deg);
	opacity: 0;
}
to {
  transform: scale(1) rotate(45deg);
	opacity: 1;
}`,z=v`
0% {
	height: 0;
	width: 0;
	opacity: 0;
}
40% {
  height: 0;
	width: 6px;
	opacity: 1;
}
100% {
  opacity: 1;
  height: 10px;
}`,q=w("div")`
  width: 20px;
  opacity: 0;
  height: 20px;
  border-radius: 10px;
  background: ${e=>e.primary||"#61d345"};
  position: relative;
  transform: rotate(45deg);

  animation: ${B} 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
  animation-delay: 100ms;
  &:after {
    content: '';
    box-sizing: border-box;
    animation: ${z} 0.2s ease-out forwards;
    opacity: 0;
    animation-delay: 200ms;
    position: absolute;
    border-right: 2px solid;
    border-bottom: 2px solid;
    border-color: ${e=>e.secondary||"#fff"};
    bottom: 6px;
    left: 6px;
    height: 10px;
    width: 6px;
  }
`,$=w("div")`
  position: absolute;
`,K=w("div")`
  position: relative;
  display: flex;
  justify-content: center;
  align-items: center;
  min-width: 20px;
  min-height: 20px;
`,G=v`
from {
  transform: scale(0.6);
  opacity: 0.4;
}
to {
  transform: scale(1);
  opacity: 1;
}`,H=w("div")`
  position: relative;
  transform: scale(0.6);
  opacity: 0.4;
  min-width: 20px;
  animation: ${G} 0.3s 0.12s cubic-bezier(0.175, 0.885, 0.32, 1.275)
    forwards;
`,W=({toast:e})=>{let{icon:t,type:n,iconTheme:i}=e;return void 0!==t?"string"==typeof t?r.createElement(H,null,t):t:"blank"===n?null:r.createElement(K,null,r.createElement(j,{...i}),"loading"!==n&&r.createElement($,null,"error"===n?r.createElement(V,{...i}):r.createElement(q,{...i})))},X=e=>`\n0% {transform: translate3d(0,${-200*e}%,0) scale(.6); opacity:.5;}\n100% {transform: translate3d(0,0,0) scale(1); opacity:1;}\n`,Q=e=>`\n0% {transform: translate3d(0,0,-1px) scale(1); opacity:1;}\n100% {transform: translate3d(0,${-150*e}%,-1px) scale(.6); opacity:0;}\n`,Y=w("div")`
  display: flex;
  align-items: center;
  background: #fff;
  color: #363636;
  line-height: 1.3;
  will-change: transform;
  box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1), 0 3px 3px rgba(0, 0, 0, 0.05);
  max-width: 350px;
  pointer-events: auto;
  padding: 8px 10px;
  border-radius: 8px;
`,J=w("div")`
  display: flex;
  justify-content: center;
  margin: 4px 10px;
  color: inherit;
  flex: 1 1 auto;
  white-space: pre-line;
`,Z=r.memo((({toast:e,position:t,style:n,children:i})=>{let s=e.height?((e,t)=>{let n=e.includes("top")?1:-1,[r,i]=E()?["0%{opacity:0;} 100%{opacity:1;}","0%{opacity:1;} 100%{opacity:0;}"]:[X(n),Q(n)];return{animation:t?`${v(r)} 0.35s cubic-bezier(.21,1.02,.73,1) forwards`:`${v(i)} 0.4s forwards cubic-bezier(.06,.71,.55,1)`}})(e.position||t||"top-center",e.visible):{opacity:0},o=r.createElement(W,{toast:e}),a=r.createElement(J,{...e.ariaProps},b(e.message,e));return r.createElement(Y,{className:e.className,style:{...s,...n,...e.style}},"function"==typeof i?i({icon:o,message:a}):r.createElement(r.Fragment,null,o,a))}));!function(e,t,n,r){u.p=t,m=e,g=n,y=r}(r.createElement);var ee=({id:e,className:t,style:n,onHeightUpdate:i,children:s})=>{let o=r.useCallback((t=>{if(t){let n=()=>{let n=t.getBoundingClientRect().height;i(e,n)};n(),new MutationObserver(n).observe(t,{subtree:!0,childList:!0,characterData:!0})}}),[e,i]);return r.createElement("div",{ref:o,className:t,style:n},s)},te=p`
  z-index: 9999;
  > * {
    pointer-events: auto;
  }
`,ne=({reverseOrder:e,position:t="top-center",toastOptions:n,gutter:i,children:s,containerStyle:o,containerClassName:a})=>{let{toasts:c,handlers:u}=P(n);return r.createElement("div",{style:{position:"fixed",zIndex:9999,top:16,left:16,right:16,bottom:16,pointerEvents:"none",...o},className:a,onMouseEnter:u.startPause,onMouseLeave:u.endPause},c.map((n=>{let o=n.position||t,a=((e,t)=>{let n=e.includes("top"),r=n?{top:0}:{bottom:0},i=e.includes("center")?{justifyContent:"center"}:e.includes("right")?{justifyContent:"flex-end"}:{};return{left:0,right:0,display:"flex",position:"absolute",transition:E()?void 0:"all 230ms cubic-bezier(.21,1.02,.73,1)",transform:`translateY(${t*(n?1:-1)}px)`,...r,...i}})(o,u.calculateOffset(n,{reverseOrder:e,gutter:i,defaultPosition:t}));return r.createElement(ee,{id:n.id,key:n.id,onHeightUpdate:u.updateHeight,className:n.visible?te:"",style:a},"custom"===n.type?b(n.message,n):s?s(n):r.createElement(Z,{toast:n,position:o}))})))},re=O}},function(e){var t=function(t){return e(e.s=t)};e.O(0,[9774,179],(function(){return t(6840),t(43079)}));var n=e.O();_N_E=n}]);