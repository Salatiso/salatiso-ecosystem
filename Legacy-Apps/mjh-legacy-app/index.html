<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mdeni Family Enterprise - Intranet</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <script type="module" src="./bridge.js"></script>
    <style>
        /* --- Earthy Theme Color Palette --- */
        :root {
            --color-primary-dark: #5D4037;      /* Deep Brown */
            --color-primary-medium: #795548;    /* Brown */
            --color-primary-light: #A1887F;     /* Light Brown */
            --color-secondary-dark: #2E7D32;    /* Darker Green */
            --color-secondary-medium: #4CAF50;  /* Vibrant Green */
            --color-secondary-light: #C8E6C9;   /* Light Green */
            --color-accent-orange: #EF6C00;     /* Deep Terracotta/Orange */
            --color-accent-gold: #FFAB00;       /* Warm Gold */
            --color-background-main: linear-gradient(to bottom right, var(--color-background-cream), var(--color-background-light-tan));
            --color-background-cream: #FAF3E0;  /* Warmer Cream */
            --color-background-light-tan: #EFEBE9; /* Light Tan */
            --color-text-dark: #3E2723;        /* Darkest Brown for text */
            --color-text-medium: #5D4037;      /* Medium Brown for text */
            --color-text-light: #8D6E63;       /* Light Brown for text */
            --color-border: #BCAAA4;           /* Brownish Grey for borders */
            --color-success: var(--color-secondary-medium);
            --color-warning: var(--color-accent-gold);
            --color-danger: #D32F2F;           /* Deeper Red */
        }

        /* Global Styles */
        body {
            font-family: 'Open Sans', sans-serif;
            background: var(--color-background-main);
            color: var(--color-text-dark);
            margin: 0;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            padding-top: 80px;
        }

        h1, h2, h3, h4, h5, h6, .font-display {
            font-family: 'Montserrat', sans-serif;
            color: var(--color-primary-dark);
        }

        /* Header */
        header {
            background-color: var(--color-primary-dark);
            color: var(--color-background-cream);
            position: fixed;
            top: 0; left: 0; right: 0; z-index: 1000;
            width: 100%; box-shadow: 0 3px 8px rgba(0,0,0,0.25);
        }
        .header-container {
            max-width: 100%; margin: 0 auto; display: flex;
            justify-content: space-between; align-items: center;
            padding: 10px 30px; height: 80px;
        }
        .logo-container img { height: 50px; margin-right: 15px; }
        .logo-container .company-name { font-size: 1.8em; font-weight: 700; color: var(--color-background-cream); }
        .main-nav-links { display: flex; flex-wrap: wrap; }
        .main-nav-links a {
            color: var(--color-background-cream); margin: 0 8px; font-size: 0.9em;
            font-weight: 500; text-decoration: none; padding: 8px 10px;
            border-radius: 6px; transition: background-color 0.3s, color 0.3s;
        }
        .main-nav-links a:hover, .main-nav-links a.active-main-nav {
            background-color: var(--color-accent-orange);
            color: white;
        }
        .user-actions { display: flex; align-items: center; }
        .user-actions .notification-bell, .user-actions .user-profile-menu > button {
            color: var(--color-background-cream); margin-left: 20px; font-size: 1.2em;
            cursor: pointer; position: relative;
        }
         .notification-badge {
            background-color: var(--color-danger); color: white; font-size: 0.65rem;
            font-weight: bold; padding: 2px 5px; border-radius: 50%;
            position: absolute; top: -5px; right: -8px;
        }
        .user-profile-menu img { width: 38px; height: 38px; border-radius: 50%; border: 2px solid var(--color-background-cream); }
        .dropdown-menu {
            display: none; position: absolute; right: 0; top: 55px;
            background-color: white; color: var(--color-text-dark); border-radius: 6px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15); z-index: 1001; width: 220px;
            border: 1px solid var(--color-border);
        }
        .dropdown-menu a { display: block; padding: 12px 18px; text-decoration: none; color: var(--color-text-medium); font-size: 0.9em; }
        .dropdown-menu a:hover { background-color: var(--color-background-light-tan); color: var(--color-primary-dark); }
        .user-profile-menu:hover .dropdown-menu { display: block; }


        /* Main Content Area */
        .main-content-wrapper { display: flex; flex-grow: 1; }
        .content-display-area { flex-grow: 1; padding: 25px; /* Standard padding for non-dashboard pages */ overflow-y: auto; }
        .content-section {
            background-color: #FFFFFF; padding: 30px 35px;
            border-radius: 10px; box-shadow: 0 5px 15px rgba(93,64,55,0.1);
            /* margin: 25px; */ /* Removed margin, padding handled by content-display-area */
            display: none; opacity: 0;
            transition: opacity 0.4s ease-in-out;
            border: 1px solid var(--color-border);
        }
        .content-section.active { display: block; opacity: 1; }
        .content-section h2.section-title {
            font-size: 2.2em; color: var(--color-primary-dark); margin-bottom: 30px;
            padding-bottom: 12px; border-bottom: 3px solid var(--color-accent-orange);
        }
        /* Special handling for dashboard section to be full page without its own margin/padding */
        #dashboard.content-section { margin: 0; border-radius: 0; padding:0; background:transparent; box-shadow:none; border: none; max-height: none; overflow: visible;}


        /* Dashboard - Single Page with Internal Carousel for Widgets */
        #dashboard .dashboard-main-view {
            padding: 30px 40px;
            height: calc(100vh - 80px); /* Full viewport minus header */
            overflow-y: auto;
            background: var(--color-background-main); /* Consistent gradient */
        }
        #dashboard .welcome-banner { text-align: center; margin-bottom: 30px; }
        #dashboard .welcome-banner img { height: 80px; /* Smaller logo */ margin-bottom: 15px; }
        #dashboard .welcome-banner h2 { font-size: 2.8em; }
        #dashboard .welcome-banner p { font-size: 1.1em; color: var(--color-text-medium); max-width: 700px; margin: 0 auto 20px; }

        .dashboard-static-grid { /* For key info widgets */
            display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px; width:100%; max-width: 1600px; margin: 0 auto 30px;
        }
        .dashboard-widget-carousel-container {
            margin-top: 30px; padding: 20px; background-color: rgba(255,255,255,0.5); /* Semi-transparent white */
            border-radius: 10px; box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .dashboard-widget-carousel-container h3.carousel-title {
            font-size: 1.8em; color: var(--color-primary-dark); text-align: center; margin-bottom: 20px;
        }
        .widget-carousel-track { display: flex; transition: transform 0.5s ease-in-out; padding-bottom: 10px; }
        .widget-carousel-item { min-width: 360px; /* Width of each widget in carousel */ padding: 0 12px; box-sizing: border-box; }
        .widget-carousel-controls { text-align: center; margin-top: 15px; }
        .widget-carousel-controls button {
            background-color: var(--color-primary-medium); color:white; border:none;
            padding: 8px 15px; margin: 0 5px; border-radius: 5px; cursor:pointer;
        }
        .widget-carousel-controls button:hover { background-color: var(--color-primary-dark); }


        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(340px, 1fr)); gap: 25px; width:100%; max-width: 1600px;}
        .dashboard-widget {
            background-color: #FFFFFF; padding: 25px; border-radius: 8px;
            box-shadow: 0 3px 8px rgba(93,64,55,0.1); border-left: 5px solid var(--color-secondary-medium);
            display: flex; flex-direction: column; /* For consistent height if needed */
            min-height: 200px; /* Ensure widgets have some base height */
        }
        .dashboard-widget h3 { font-size: 1.4em; color: var(--color-primary-dark); margin-bottom: 18px; display: flex; align-items: center; }
        .dashboard-widget h3 i { margin-right: 10px; color: var(--color-secondary-dark); }
        .dashboard-widget ul { list-style: none; padding: 0; }
        .dashboard-widget li { margin-bottom: 10px; font-size: 0.95em; display: flex; align-items: center; color: var(--color-text-medium); }
        .dashboard-widget li i { margin-right: 8px; color: var(--color-secondary-medium); }
        .progress-bar-container { background-color: #E0E0E0; border-radius: 6px; height: 12px; margin-top: 6px; overflow: hidden; }
        .progress-bar { background-color: var(--color-secondary-medium); height: 100%; border-radius: 6px; transition: width 0.6s ease-in-out; }
        .task-list input[type="checkbox"] { margin-right: 10px; accent-color: var(--color-primary-medium); }
        .task-list label { font-size: 0.9em; color: var(--color-text-medium); }

        /* Organogram Styles */
        .organogram { text-align: center; padding: 20px 0; overflow-x: auto; }
        .org-level { display: flex; justify-content: center; align-items: flex-start; margin-top: 30px; position: relative; min-width: fit-content; }
        .org-node-container { display: flex; flex-direction: column; align-items: center; margin: 0 10px; }
        .org-node {
            padding: 12px 18px; border: 1px solid var(--color-primary-light); background-color: var(--color-background-cream);
            border-radius: 8px; cursor: pointer; transition: all 0.3s ease;
            box-shadow: 0 2px 4px rgba(93,64,55,0.1); min-width: 220px; text-align: center;
        }
        .org-node:hover { background-color: #EFEBE9; transform: translateY(-3px); box-shadow: 0 4px 8px rgba(93,64,55,0.15); }
        .org-node .name { font-weight: 600; color: var(--color-primary-dark); font-size: 1em; }
        .org-node .role { font-size: 0.8em; color: var(--color-text-medium); margin-top: 4px; }
        .org-node .reporting-line { font-size: 0.7em; color: var(--color-text-light); margin-top: 3px; font-style: italic; }
        .org-children-container { display: flex; justify-content: center; margin-top: 20px; position: relative; }
        .org-children-container::before {
            content: ''; position: absolute; top: -10px; left: 10%; right: 10%; height: 1px; background-color: var(--color-border);
        }
        .org-node-container > .org-connector-down {
            width: 1px; height: 20px; background-color: var(--color-border); margin: 0 auto;
        }

        /* Team Carousel (mfe-carousel) */
        .mfe-carousel-container { position: relative; width: 100%; overflow: hidden; background: var(--color-background-light-tan); border-radius: 8px; padding:20px; margin-top:20px; box-shadow: inset 0 0 10px rgba(93,64,55,0.05);}
        .mfe-carousel-track { display: flex; transition: transform 0.5s cubic-bezier(0.68, -0.55, 0.27, 1.55); }
        .mfe-carousel-item { min-width: 100%; padding: 10px; box-sizing: border-box; }
        .mfe-carousel-item .card-content {
            background:white; padding:25px; border-radius:8px;
            box-shadow: 0 4px 10px rgba(93,64,55,0.1);
            min-height: 220px; display: flex; flex-direction: column; justify-content: space-between;
        }
        .mfe-carousel-item .card-content img { border: 3px solid var(--color-primary-medium); }
        .mfe-carousel-button {
            position: absolute; top: 50%; transform: translateY(-50%);
            background-color: var(--color-primary-medium); color: white; opacity: 0.8;
            border: none; width: 40px; height: 40px; border-radius: 50%;
            cursor: pointer; z-index:10; transition: opacity 0.3s;
            display: flex; align-items: center; justify-content: center; font-size: 1.2em;
        }
        .mfe-carousel-button:hover { opacity: 1; }
        .mfe-carousel-button.prev-btn { left: 20px; }
        .mfe-carousel-button.next-btn { right: 20px; }
        .carousel-dots { text-align: center; margin-top: 15px; }
        .carousel-dot { display: inline-block; width:12px; height:12px; background: var(--color-primary-light); border-radius:50%; margin: 0 6px; cursor:pointer; transition: background-color 0.3s; }
        .carousel-dot.active { background: var(--color-primary-dark); }

        /* Modal Styles */
        .modal {
            display: none; position: fixed; inset: 0;
            background-color: rgba(62,39,35,0.7);
            display: flex; justify-content: center; align-items: center;
            padding: 20px; z-index: 1001;
            opacity: 0; pointer-events: none; transition: opacity 0.3s ease-in-out;
        }
        .modal.active { opacity: 1; pointer-events: auto; display:flex; }
        .modal-content {
            background-color: white; padding: 30px 35px; border-radius: 10px;
            box-shadow: 0 8px 25px rgba(0,0,0,0.2);
            max-width: 950px; width: 100%;
            max-height: 90vh; overflow-y: auto;
            position: relative; border-top: 5px solid var(--color-accent-orange);
        }
        .modal-content h3.modal-title { color: var(--color-primary-dark); margin-bottom:10px; font-size:1.8em; border-bottom: 2px solid var(--color-accent-orange); padding-bottom: 10px;}
        .modal-content .role-subtitle { font-size: 1.1em; color: var(--color-text-medium); margin-bottom: 20px; }
        .close-modal-btn {
            position: absolute; top: 18px; right: 25px;
            font-size: 2em; color: var(--color-text-light);
            background:none; border:none; cursor:pointer; line-height: 1;
        }
        .close-modal-btn:hover { color: var(--color-primary-dark); }
        .modal-section h4 { font-size: 1.25em; color: var(--color-primary-medium); margin-top: 25px; margin-bottom: 10px; display:flex; align-items:center;}
        .modal-section h4 i { margin-right: 8px; color: var(--color-secondary-medium); }
        .modal-tabs { display: flex; border-bottom: 1px solid var(--color-border); margin-bottom: 15px; }
        .modal-tab-button { padding: 10px 15px; cursor: pointer; background: var(--color-background-light-tan); border: 1px solid var(--color-border); border-bottom: none; margin-right: 5px; border-radius: 5px 5px 0 0; font-size: 0.9em; color: var(--color-text-medium);}
        .modal-tab-button.active { background: white; border-bottom: 1px solid white; font-weight: bold; color: var(--color-primary-dark);}
        .modal-tab-pane { display: none; }
        .modal-tab-pane.active { display: block; }

        /* Action Plan Table & Performance Sections */
        .action-plan-table { width: 100%; border-collapse: collapse; margin-top: 15px; font-size: 0.85em; }
        .action-plan-table th, .action-plan-table td { border: 1px solid var(--color-border); padding: 8px 10px; text-align: left; vertical-align: middle;}
        .action-plan-table th { background-color: var(--color-background-light-tan); color: var(--color-primary-dark); font-weight: 600; }
        .action-plan-table input, .action-plan-table select, .action-plan-table textarea {
            width: 100%; padding: 7px; border: 1px solid var(--color-border); border-radius: 4px; box-sizing: border-box; font-size:0.95em; background-color: #fff; color: var(--color-text-dark);
        }
        .action-plan-table textarea { min-height: 40px; resize: vertical; }
        .action-plan-table .status-select { padding: 7px 5px; }
        .status-completed { background-color: var(--color-secondary-light) !important; color: var(--color-secondary-dark); }
        .status-in-progress { background-color: var(--color-accent-gold) !important; color: var(--color-primary-dark); opacity: 0.8; }
        .status-not-started { background-color: #FFCCBC !important; color: var(--color-danger); } /* Light terracotta/peach */
        .action-btn {
            background-color: var(--color-secondary-medium); color:white; font-size:0.8em;
            padding: 6px 10px; border-radius:4px; border:none; cursor:pointer;
        }
        .action-btn:hover { background-color: var(--color-secondary-dark); }
        .signature-area { border: 1px dashed var(--color-border); padding: 10px; margin-top:15px; text-align: center; }
        .signature-area button { background-color: var(--color-primary-medium); color:white; padding: 8px 15px; border-radius: 5px; border:none; cursor:pointer;}
        .signature-area button:disabled { background-color: #BDBDBD; }
        .signed-confirmation { color: var(--color-success); font-weight: bold; font-size: 0.9em; }

        /* Ventures & Documents Section Cards */
        .resource-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }
        .resource-card {
            background-color: #fff; border-radius: 8px; padding: 20px;
            box-shadow: 0 3px 8px rgba(93,64,55,0.1);
            border-left: 4px solid var(--color-accent-orange);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }
        .resource-card:hover { transform: translateY(-5px); box-shadow: 0 6px 12px rgba(93,64,55,0.15); }
        .resource-card h4 { font-size: 1.2em; color: var(--color-primary-dark); margin-bottom: 10px; }
        .resource-card p { font-size: 0.9em; color: var(--color-text-medium); margin-bottom: 15px; }
        .resource-card a.learn-more-btn {
            display: inline-block; background-color: var(--color-primary-medium); color: white;
            padding: 8px 15px; border-radius: 5px; text-decoration: none; font-size: 0.85em;
        }
        .resource-card a.learn-more-btn:hover { background-color: var(--color-primary-dark); }

        /* Footer */
        footer {
            background-color: var(--color-primary-dark); color: var(--color-background-cream); padding: 25px 0;
            text-align: center; font-size: 0.9em; margin-top: auto;
        }
        footer a { color: var(--color-accent-gold); text-decoration: none; }
        footer a:hover { text-decoration: underline; }

        /* Tabs for Governance & Welcome Section */
        .tabs button { padding: 10px 18px; margin-right: 5px; border: 1px solid var(--color-border); border-bottom: none; background-color: var(--color-background-light-tan); cursor: pointer; border-radius: 6px 6px 0 0; font-size: 0.95em; font-weight: 500; color: var(--color-text-medium);}
        .tabs button.active { background-color: white; border-bottom: 1px solid white; font-weight: bold; color: var(--color-primary-dark);}
        .tab-content { border: 1px solid var(--color-border); padding: 20px; border-top: none; border-radius: 0 0 6px 6px; background-color: white;}

        /* Horizontal Timeline styles */
        .horizontal-timeline-container {
            width: 100%;
            overflow-x: auto;
            padding: 20px 0;
            background-color: var(--color-background-light-tan);
            border-radius: 8px;
            margin-top: 20px;
            border: 1px solid var(--color-border);
        }
        .horizontal-timeline {
            display: flex;
            position: relative;
            min-width: 2500px; /* Adjust based on number of items and their width */
            padding: 40px 20px; /* Increased padding for better spacing */
        }
        .horizontal-timeline::before { /* The main line */
            content: '';
            position: absolute;
            top: 50%; /* Center the line */
            left: 20px; /* Start padding */
            right: 20px; /* End padding */
            height: 4px;
            background-color: var(--color-primary-light);
            transform: translateY(-50%);
            z-index: 0;
            border-radius: 2px;
        }
        .timeline-event {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
            min-width: 300px; /* Width of each event box */
            padding: 0 20px; /* Spacing between events */
            z-index: 1;
        }
        .timeline-event-marker {
            width: 24px; /* Larger marker */
            height: 24px;
            border-radius: 50%;
            background-color: var(--color-accent-orange);
            border: 4px solid var(--color-background-light-tan); /* Match container bg */
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 2;
        }
        .timeline-event-content {
            background-color: white;
            padding: 20px; /* More padding */
            border-radius: 8px; /* Softer radius */
            box-shadow: 0 3px 8px rgba(93,64,55,0.15);
            text-align: center;
            width: 100%;
            border: 1px solid var(--color-border);
            min-height: 180px; /* Ensure consistent height */
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }
        .timeline-event:nth-child(odd) .timeline-event-content { margin-bottom: 40px; /* Space for line */ }
        .timeline-event:nth-child(even) .timeline-event-content { margin-top: 40px; /* Space for line */ }

        .timeline-event-date {
            font-size: 0.9em;
            font-weight: 600;
            color: var(--color-primary-dark);
            margin-bottom: 10px;
        }
        .timeline-event-title {
            font-size: 1.1em; /* Slightly larger title */
            font-weight: bold;
            color: var(--color-primary-medium);
            margin-bottom: 8px;
        }
        .timeline-event-details {
            font-size: 0.85em;
            color: var(--color-text-medium);
            line-height: 1.5;
            flex-grow: 1; /* Allow details to take up space */
        }
        .timeline-event-status {
            font-size: 0.75em; font-weight: bold; margin-top:10px; display:inline-block;
            padding: 4px 10px; border-radius:12px; /* Pill shape */
        }
        .timeline-status-completed { background-color: var(--color-secondary-light); color: var(--color-secondary-dark); }
        .timeline-status-inprogress { background-color: var(--color-accent-gold); color: var(--color-primary-dark); opacity: 0.9;}
        .timeline-status-pending { background-color: #E0E0E0; color: var(--color-text-medium); }


    </style>
</head>
<body>
    <header>
        </header>

    <div class="main-content-wrapper">
        <main class="content-display-area w-full">
            <section id="dashboard" class="content-section active">
                <div class="dashboard-main-view">
                    <div class="welcome-banner">
                        <img src="salatiso/assets/photos/mfe_logo_large_earthy.png" alt="Mdeni Family Enterprise">
                        <h2 class="slide-title text-4xl">Molweni! Welcome, Mdeni Family!</h2>
                        <p>This Intranet is our central hub for collaboration, growth, and building our shared legacy. Let's track our progress, support each other, and achieve our collective goals.</p>
                    </div>

                    <div class="dashboard-static-grid">
                        <div class="dashboard-widget border-l-secondary-dark">
                            <h3 class="text-secondary-dark"><i class="fas fa-rocket text-secondary-dark"></i>Company Launch Roadmap</h3>
                            <ul id="companyLaunchRoadmapWidget"></ul>
                        </div>
                        <div class="dashboard-widget border-l-accent-orange">
                            <h3 class="text-accent-orange"><i class="fas fa-dollar-sign text-accent-orange"></i>Visa's Income Target (Dec 2025)</h3>
                            <p class="text-lg">Target: R15,000 / month</p>
                            <p class="text-lg">Current Projected: <span id="visaIncomeProjected" class="font-bold text-xl text-accent-orange">R4,200</span></p>
                            <div class="progress-bar-container mt-2"><div class="progress-bar bg-accent-orange" style="width: 28%;"></div></div>
                        </div>
                         <div class="dashboard-widget border-l-accent-gold">
                            <h3 class="text-accent-gold"><i class="fas fa-calendar-check text-accent-gold"></i>Key Upcoming Deadlines</h3>
                            <ul class="text-sm">
                                <li class="text-danger font-semibold">Integrate Chatbot (Salatiso): May 24</li>
                                <li class="text-danger font-semibold">SafetyHelp Launch: June 1</li>
                                <li>Q3 Budget Approval (Salatiso): June 15</li>
                            </ul>
                        </div>
                        <div class="dashboard-widget border-l-primary-light">
                            <h3 class="text-primary-light"><i class="fas fa-users text-primary-light"></i>Next Family Council Meeting</h3>
                            <p class="text-lg font-semibold">June 10, 2025 - 6 PM</p>
                            <p class="text-sm">Agenda: Q2 Review, SafetyHelp Post-Launch Analysis</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mt-8">
                        <div class="dashboard-widget">
                            <h3><i class="fas fa-stream text-gray-500"></i>Recent Company Activity</h3>
                            <div id="recentActivityWidget" class="bg-white p-3 rounded-md max-h-48 overflow-y-auto text-xs space-y-1.5 border">
                            </div>
                        </div>
                        <div class="dashboard-widget">
                            <h3><i class="fas fa-comments text-orange-500"></i>Quick Communication</h3>
                            <textarea placeholder="Post a quick update or question for the team..." class="w-full p-2 border rounded-md text-sm h-20 bg-white"></textarea>
                            <button class="mt-2 text-sm bg-orange-500 hover:bg-orange-600 text-white py-1.5 px-4 rounded-md">Post Update</button>
                        </div>
                    </div>
                    
                    <div class="dashboard-widget-carousel-container">
                        <h3 class="carousel-title">Key Performance Indicators & Trackers</h3>
                        <div class="relative">
                            <div class="widget-carousel-track">
                                <div class="widget-carousel-item">
                                    <div class="dashboard-widget">
                                        <h3><i class="fas fa-tasks text-purple-500"></i>Overall Training Progress</h3>
                                        <div id="trainingProgressWidget"></div>
                                    </div>
                                </div>
                                <div class="widget-carousel-item">
                                    <div class="dashboard-widget">
                                        <h3><i class="fas fa-user-clock text-teal-500"></i>My Pending Actions (<span id="currentUserNamePendingActions">User</span>)</h3>
                                        <ul class="task-list" id="myPendingActionsWidget"></ul>
                                    </div>
                                </div>
                                <div class="widget-carousel-item">
                                    <div class="dashboard-widget">
                                        <h3><i class="fas fa-calendar-alt text-cyan-500"></i>Meeting Tracker</h3>
                                        <p><strong>Last Meeting:</strong> May 17, 2025 - Weekly Sync</p>
                                        <p class="text-xs mt-1">Key Action: Finalize Intranet User Roles - <span class="font-semibold">Visa</span> (Due: May 20)</p>
                                    </div>
                                </div>
                                </div>
                            <button class="widget-carousel-controls prev absolute top-1/2 -translate-y-1/2 left-2 bg-primary-medium text-white p-2 rounded-full"><i class="fas fa-chevron-left"></i></button>
                            <button class="widget-carousel-controls next absolute top-1/2 -translate-y-1/2 right-2 bg-primary-medium text-white p-2 rounded-full"><i class="fas fa-chevron-right"></i></button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="ourVision" class="content-section">
                </section>

            <section id="team" class="content-section">
                </section>

            <section id="ourJourney" class="content-section">
                <h2 class="section-title">Our Journey: MFE Launch & Growth Timeline (Year 1)</h2>
                <p class="text-sm text-text-medium mb-6">This timeline tracks our key phases and major deliverables for the first year, starting May 19, 2025. Completed items will be marked. Click on items for more details or to see linked PADP actions.</p>
                <div class="horizontal-timeline-container">
                    <div class="horizontal-timeline" id="horizontalTimeline">
                        </div>
                </div>
            </section>

            <section id="ventures" class="content-section">
                </section>

            <section id="trainingHub" class="content-section">
                </section>

            <section id="documents" class="content-section">
                </section>

            <section id="governance" class="content-section">
                </section>
            
            </main>
    </div>

    <footer>
        </footer>

    <div id="memberDetailsModal" class="modal">
        <div class="modal-content">
            <button class="close-modal-btn">&times;</button>
            <div id="modalBodyContent">
                </div>
        </div>
    </div>
    
    <div id="journeyDetailsModal" class="modal">
        <div class="modal-content max-w-xl">
            <button class="close-modal-btn" onclick="closeJourneyModal()">&times;</button>
            <h3 id="journeyModalTitle" class="modal-title text-primary-dark text-xl">Phase Details</h3>
            <div id="journeyModalBody" class="text-sm mt-4">
                </div>
        </div>
    </div>


    <script>
        // --- GLOBAL APP STATE (Conceptual - would be server-driven) ---
        let currentLoggedInUser = 'salatiso'; 
        const MFE_Data = { /* This would hold all dynamic data if not using a backend */ };

        // --- NAVIGATION & SECTION DISPLAY ---
        const mainNavLinks = document.querySelectorAll('.main-nav-links a');
        const contentSections = document.querySelectorAll('.content-display-area > .content-section');
        const myProfileLink = document.getElementById('myProfileLink');

        function showMainSection(targetId, skipHistoryPush) {
            contentSections.forEach(section => section.classList.remove('active'));
            mainNavLinks.forEach(link => {
                link.classList.remove('active-main-nav');
                if (link.dataset.target === targetId) {
                    link.classList.add('active-main-nav');
                }
            });
            const targetSection = document.getElementById(targetId);
            const contentDisplayArea = document.querySelector('.content-display-area');

            if (targetSection) {
                if (targetId === 'dashboard') {
                    contentDisplayArea.style.padding = '0';
                    contentDisplayArea.style.overflow = 'hidden'; 
                } else {
                    contentDisplayArea.style.padding = '25px'; 
                    contentDisplayArea.style.overflow = 'auto'; 
                }
                contentDisplayArea.scrollTop = 0;
                targetSection.classList.add('active');

                if (!skipHistoryPush) {
                    // window.location.hash = targetId;
                }
                if (targetId === 'team' && !teamCarouselPopulated) {
                    populateAndInitTeamCarousel();
                }
                if (targetId === 'ourJourney') {
                    populateHorizontalTimeline();
                }
            }
        }

        mainNavLinks.forEach(link => {
            link.addEventListener('click', (e) => {
                e.preventDefault();
                const targetId = link.dataset.target;
                showMainSection(targetId, false);
            });
        });

        if (myProfileLink) {
            myProfileLink.addEventListener('click', (e) => {
                e.preventDefault();
                showMainSection('team', false);
                setTimeout(() => populateModal(currentLoggedInUser), 50);
            });
        }

        // --- DASHBOARD WIDGET CAROUSEL ---
        const widgetCarouselContainer = document.querySelector('.dashboard-widget-carousel-container');
        if (widgetCarouselContainer) {
            const track = widgetCarouselContainer.querySelector('.widget-carousel-track');
            const items = Array.from(track.children);
            const nextButton = widgetCarouselContainer.querySelector('.widget-carousel-controls.next');
            const prevButton = widgetCarouselContainer.querySelector('.widget-carousel-controls.prev');
            let widgetCurrentIndex = 0;
            const widgetsToShow = 3; // Number of widgets visible at a time
            let widgetItemWidth = 0;

            function updateWidgetItemWidth() {
                 if (items.length > 0) {
                    const containerWidth = track.parentElement.offsetWidth;
                    widgetItemWidth = Math.floor(containerWidth / widgetsToShow);
                    items.forEach(item => item.style.minWidth = `${widgetItemWidth}px`);
                 }
            }

            function WupdateCarousel() {
                if (items.length > 0) {
                    updateWidgetItemWidth(); // Recalculate width
                    const offset = -widgetCurrentIndex * widgetItemWidth;
                    track.style.transform = `translateX(${offset}px)`;
                }
            }

            if (nextButton) {
                nextButton.addEventListener('click', () => {
                    if (widgetCurrentIndex < items.length - widgetsToShow) {
                        widgetCurrentIndex++;
                    } else {
                        widgetCurrentIndex = 0; // Loop back
                    }
                    WupdateCarousel();
                });
            }
            if (prevButton) {
                prevButton.addEventListener('click', () => {
                    if (widgetCurrentIndex > 0) {
                        widgetCurrentIndex--;
                    } else {
                        widgetCurrentIndex = items.length - widgetsToShow; // Loop to end
                    }
                    WupdateCarousel();
                });
            }
            window.addEventListener('resize', WupdateCarousel);
            if (items.length > 0) WupdateCarousel(); // Initial call
        }


        // --- TEAM CAROUSEL (MFE) ---
        function setupCarousel(carouselElement) {
            const track = carouselElement.querySelector('.mfe-carousel-track');
            if (!track) return;
            const items = Array.from(track.children);
            const nextButton = carouselElement.querySelector('.next-btn');
            const prevButton = carouselElement.querySelector('.prev-btn');
            const dotsContainer = carouselElement.querySelector('.carousel-dots');
            
            if (items.length === 0) return;

            let itemWidth = items[0].getBoundingClientRect().width;
            let currentIndex = 0;
            const itemsPerView = 1;

            if (dotsContainer) {
                dotsContainer.innerHTML = '';
                items.forEach((_, i) => {
                    const dot = document.createElement('button');
                    dot.classList.add('carousel-dot');
                    dot.addEventListener('click', () => { currentIndex = i; updateCarouselDisplay(); });
                    dotsContainer.appendChild(dot);
                });
            }
            
            function updateActiveDot() {
                if (dotsContainer) {
                    Array.from(dotsContainer.children).forEach((dot, i) => {
                        dot.classList.toggle('active', i === currentIndex);
                    });
                }
            }

            function updateCarouselDisplay() {
                if (items.length > 0 && items[0].offsetWidth > 0) { 
                    itemWidth = items[0].getBoundingClientRect().width / itemsPerView;
                    track.style.transform = `translateX(-${currentIndex * itemWidth * itemsPerView}px)`;
                    updateActiveDot();
                }
            }

            if (nextButton) nextButton.addEventListener('click', () => { currentIndex = (currentIndex + 1) % items.length; updateCarouselDisplay(); });
            if (prevButton) prevButton.addEventListener('click', () => { currentIndex = (currentIndex - 1 + items.length) % items.length; updateCarouselDisplay(); });
            
            let autoSlideInterval = setInterval(() => { if (nextButton) nextButton.click(); }, 7000);
            carouselElement.addEventListener('mouseenter', () => clearInterval(autoSlideInterval));
            carouselElement.addEventListener('mouseleave', () => {
                 clearInterval(autoSlideInterval);
                 autoSlideInterval = setInterval(() => { if (nextButton) nextButton.click(); }, 7000);
            });

            const resizeObserver = new ResizeObserver(entries => {
                for (let entry of entries) { if (entry.target.offsetWidth > 0) { updateCarouselDisplay(); } }
            });
            if(items.length > 0) resizeObserver.observe(items[0]);
            updateCarouselDisplay();
        }

        // --- TEAM MEMBER DATA & MODAL (PADP Logic) ---
        const memberDetailModal = document.getElementById('memberDetailsModal');
        const modalBody = document.getElementById('modalBodyContent');
        const closeModalButtons = memberDetailModal.querySelectorAll('.close-modal-btn');

        const teamMemberData = {
            salatiso: {
                name: "Salatiso L. Mdeni", role: "Chief Strategic & Operations Officer (CSOO)",
                profileImage: "salatiso/assets/photos/team/salatiso_profile_thumb.jpg",
                profile: `A highly experienced OHS and Risk Management expert... His guiding principle: "I am a father to my son; all else is a means to this end," extending this to his role as an Umlandeli. Key Deadline: Integrate Salatiso Chatbot on safetyfirst.help staging by May 24, 2025.`,
                responsibilities: ["Overall operational excellence", "Product development", "Risk management & Compliance", "Mentoring next generation", "Appoints Chairperson & CEO (initial)"],
                padp: {
                    commonActions: [
                        { id: "familiarize", task: "Fully navigate Intranet and familiarize with MFE vision, structure, policies.", status: "not-started", signedOff: null, estimatedTime: "2h" },
                        { id: "acceptRole", task: "Review and Electronically Accept Role Profile & Performance Plan.", status: "not-started", signedOff: null, estimatedTime: "1h" },
                        { id: "induction", task: "Complete General Company Induction module.", status: "not-started", signedOff: null, estimatedTime: "3h" }
                    ],
                    coreDeliverables: [
                        { task: "Uphold MFE Family Values & Ethical Conduct", weight: 20, score: 0, notes: "Non-negotiable.", optOut: false },
                        { task: "Strategic oversight and guidance for all ventures", weight: 30, score: 0, notes: "Ensure alignment with long-term vision.", optOut: false },
                    ],
                    roleSpecificDeliverables: [
                        { task: "Integrate Salatiso Chatbot on SafetyHelp Staging", deadline: "May 24, 2025", weight: 15, score: 0, status: "not-started", estimatedTime: "8h", optOut: false },
                        { task: "Finalize Trust Deed research and brief legal counsel", deadline: "May 30, 2025", weight: 10, score: 0, status: "not-started", estimatedTime: "10h", optOut: false },
                        { task: "Approve Q3 Operating Budget and Resource Allocation Plan", deadline: "June 15, 2025", weight: 10, score: 0, status: "not-started", estimatedTime: "5h", optOut: false },
                        { task: "Mentor CEO and Solonwabo weekly", deadline: "Ongoing", weight: 10, score: 0, status: "in-progress", estimatedTime: "2h/week", optOut: false },
                    ],
                    userDefinedDeliverables: [ { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""} ],
                    trainingPlan: [
                        { task: "Mentor Team Leads (Visa, Tina, Kwakho, Solo)", month: "Ongoing", week: "Weekly Check-ins", cost: 0, status: "in-progress", deliverable: "Mentorship Logs/Feedback", estimatedTime: "2h/week" },
                        { task: "Advanced Course: AI in Business Strategy & Automation", month: 4, week: "Self-paced", cost: 5000, status: "not-started", deliverable: "Course Certificate & Implementation Plan", estimatedTime: "40h" },
                    ]
                },
                performanceKPIs: ["Strategic Goal Achievement Rate", "Successful New Product/Service Launches (SafetyHelp Chatbot)", "Team Skill Development & Performance", "Operational Efficiency Gains", "Profitability of Ventures"],
                nextLevelEligibility: "N/A (Founder, CSOO)"
            },
            visa: {
                name: "Visa Mdeni", role: "Chief Executive Officer (CEO)",
                profileImage: "salatiso/assets/photos/team/visa_profile_thumb.jpg",
                profile: `Natural leader... Product Champion for SafetyHelp. Current job at Meril SA (D&B) from 7am-4pm daily. Target: Replace R15,000/month income by Dec 2025. Accountable for overall company performance and appointments of Tina & Kwakho.`,
                responsibilities: ["Leading company registration", "Overall company direction", "Stakeholder management", "Driving growth for SafetyHelp", "Appointing team members (Tina, Kwakho) with Chairperson support", "Quarterly performance reviews for direct reports"],
                 padp: {
                    commonActions: [
                        { id: "familiarize", task: "Fully navigate Intranet and familiarize with MFE vision, structure, policies.", status: "not-started", signedOff: null, estimatedTime: "2h" },
                        { id: "acceptRole", task: "Review and Electronically Accept Role Profile & Performance Plan.", status: "not-started", signedOff: null, estimatedTime: "1h" },
                        { id: "induction", task: "Complete General Company Induction module.", status: "not-started", signedOff: null, estimatedTime: "3h" }
                    ],
                    coreDeliverables: [
                        { task: "Achieve Company Registration & Bank Account Setup by target date", weight: 25, score: 0, notes: "Critical path for operations.", optOut: false },
                        { task: "Develop and Present Q3 Strategic Plan to CSOO & Council", weight: 20, score: 0, notes: "Includes SafetyHelp launch plan.", optOut: false },
                        { task: "Uphold MFE Family Values & Ethical Conduct in all dealings", weight: 15, score: 0, notes: "", optOut: false },
                    ],
                    roleSpecificDeliverables: [
                        { task: "Finalize Company Name & CIPC Name Reservation", deadline: "Month 1, Week 1", weight: 5, score: 0, status: "not-started", estimatedTime: "4h", optOut: false },
                        { task: "Achieve SafetyHelp Launch (Construction Module & Chatbot)", deadline: "June 1, 2025", weight: 20, score: 0, status: "not-started", estimatedTime: "Dedicated Focus", optOut: false },
                        { task: "Onboard Tina & Kwakho, finalize their PADPs", deadline: "Month 1, Week 3", weight: 10, score: 0, status: "not-started", estimatedTime: "6h", optOut: false },
                        { task: "Secure first paying client for SafetyHelp", deadline: "Month 3", weight: 15, score: 0, status: "not-started", estimatedTime: "Ongoing", optOut: true }, 
                    ],
                    userDefinedDeliverables: [ { task: "Explore partnership with 2 local construction firms", weight: 10, score: 0, estimatedTime: "10h"}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""} ],
                    trainingPlan: [
                        { task: "Alison.com: Diploma in Business Management & Entrepreneurship (Complete)", month: "1-3", week: "Self-paced", cost: 0, status: "not-started", deliverable: "Certificate", estimatedTime: "20h" },
                        { task: "SafetyHelp Platform Deep Dive & OHS Act Overview (with Salatiso)", month: 1, week: "3-4", cost: 0, status: "not-started", deliverable: "Presentation of SafetyHelp GTM strategy", estimatedTime: "10h" },
                        { task: "Course: Effective Leadership & Team Management", month: 4, week: "Self-paced", cost: 800, status: "not-started", deliverable: "Certificate", estimatedTime: "15h"}
                    ]
                },
                performanceKPIs: ["Successful Company & NPO Registration", "SafetyHelp User Growth & Revenue by Q4 2025", "Positive Stakeholder Feedback", "Effective Team Leadership & Motivation (Quarterly Review Scores)", "Progress to R15k Income Replacement Target"],
                nextLevelEligibility: "Increased autonomy, potential for board seat on subsidiary entities, higher profit share."
            },
            tina: {
                name: "Tina Mdeni", role: "Head of Marketing & Communications, Tenant/Supplier Mgt.",
                profileImage: "salatiso/assets/photos/team/tina_profile_thumb.jpg",
                profile: `Creative flair... Responsible for marketing, social media, and tenant/supplier management (accountable to CEO). Initial responsibilities slightly broader to leverage existing skills. Starts with no shares, earns based on performance (6-24m for 5%, then next 36m for further 5% from Nozukile's trust).`,
                responsibilities: ["Marketing strategies for all ventures", "Social media management", "Tenant & Supplier liaison/management", "Brand promotion & content creation"],
                padp: {
                    commonActions: [
                        { id: "familiarize", task: "Fully navigate Intranet and familiarize with MFE vision, structure, policies.", status: "not-started", signedOff: null, estimatedTime: "2h" },
                        { id: "acceptRole", task: "Review and Electronically Accept Role Profile & Performance Plan.", status: "not-started", signedOff: null, estimatedTime: "1h" },
                        { id: "induction", task: "Complete General Company Induction module.", status: "not-started", signedOff: null, estimatedTime: "3h" }
                    ],
                    coreDeliverables: [
                        { task: "Develop & implement marketing calendar for Q3", weight: 20, score: 0, notes: "", optOut: false },
                        { task: "Maintain positive tenant relations for 2 rental units", weight: 15, score: 0, notes: "", optOut: false },
                    ],
                    roleSpecificDeliverables: [
                        { task: "Establish Supplier Database (min 10 vetted suppliers for key services)", deadline: "Month 2, Week 4", weight: 15, score: 0, status: "not-started", estimatedTime: "12h", optOut: false },
                        { task: "Launch MFE Social Media Presence (Facebook, LinkedIn) with initial content strategy", deadline: "Month 2, Week 2", weight: 15, score: 0, status: "not-started", estimatedTime: "10h", optOut: false },
                        { task: "Create marketing brochure for SafetyHelp (Construction Module)", deadline: "Month 1, Week 4", weight: 10, score: 0, status: "not-started", estimatedTime: "8h", optOut: false },
                        { task: "Resolve tenant issue at Property A within 48 hours", deadline: "As Arises", weight: 10, score: 0, status: "ongoing", estimatedTime: "2h/issue", optOut: false },
                    ],
                    userDefinedDeliverables: [ { task: "Learn basic video editing for social media shorts", weight: 5, score: 0, estimatedTime: "15h"}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""} ],
                    trainingPlan: [
                        { task: "Google Digital Garage: 'Fundamentals of Digital Marketing' (Complete)", month: 1, week: "1-4", cost: 0, status: "not-started", deliverable: "Certificate", estimatedTime: "40h" },
                        { task: "HubSpot Academy: 'Social Media Marketing Course' (Complete)", month: 2, week: "1-4", cost: 0, status: "not-started", deliverable: "Certificate", estimatedTime: "6h" },
                        { task: "Short Course: Basics of Property/Tenant Management (Online)", month: 3, week: "Self-paced", cost: 300, status: "not-started", deliverable: "Completion Cert/Notes", estimatedTime: "10h"},
                        { task: "Workshop: Effective Supplier Negotiation", month: 4, week: "1-day", cost: 500, status: "not-started", deliverable: "Attendance & Key Learnings", estimatedTime: "8h"}
                    ]
                },
                performanceKPIs: ["Growth in Social Media Followers & Engagement Rate", "Positive Tenant Feedback Score (>4/5)", "Cost Savings/Efficiency in Supplier Management", "Share Vesting Milestones Met (documented quarterly)", "Timely resolution of tenant issues"],
                nextLevelEligibility: "Marketing Manager, Senior Marketing Strategist, potential for leading a property management division. Eligibility for first share tranche (up to 5%) after 6-24 months based on sustained high performance."
            },
             kwakho: {
                name: "Kwakho Mdeni", role: "Head of Operations Support & Curriculum Development",
                profileImage: "salatiso/assets/photos/team/kwakho_profile_thumb.jpg",
                profile: `Meticulous, resourceful... Product Champion for Sazi Life. Starts with no shares, earns based on performance (6-24m for 5%, then next 36m for further 5% from Nozukile's trust). Works from her own home, leveraging online tools for collaboration.`,
                responsibilities: ["Ops support for all ventures", "Multilingual translations (isiXhosa focus)", "Sazi Life Curriculum Dev.", "Admin & Document Mgt.", "Meeting minutes and action tracking"],
                 padp: {
                    commonActions: [
                        { id: "familiarize", task: "Fully navigate Intranet and familiarize with MFE vision, structure, policies.", status: "not-started", signedOff: null, estimatedTime: "2h" },
                        { id: "acceptRole", task: "Review and Electronically Accept Role Profile & Performance Plan.", status: "not-started", signedOff: null, estimatedTime: "1h" },
                        { id: "induction", task: "Complete General Company Induction module.", status: "not-started", signedOff: null, estimatedTime: "3h" }
                    ],
                    coreDeliverables: [
                        { task: "Develop Sazi Life Curriculum Framework (Phase 1: Grades R-3 isiXhosa)", weight: 25, score: 0, notes: "", optOut: false },
                        { task: "Ensure accurate and timely meeting minutes & action item distribution", weight: 15, score: 0, notes: "", optOut: false },
                    ],
                    roleSpecificDeliverables: [
                        { task: "Establish Centralized Document Management System (Google Drive/Intranet)", deadline: "Month 2, Week 2", weight: 15, score: 0, status: "not-started", estimatedTime: "10h", optOut: false },
                        { task: "Translate MFE Vision & Mission into isiXhosa for Intranet", deadline: "Month 1, Week 3", weight: 10, score: 0, status: "not-started", estimatedTime: "6h", optOut: false },
                        { task: "Compile and review 2 modules for Sazi Life Grade R curriculum", deadline: "Month 3, Week 4", weight: 15, score: 0, status: "not-started", estimatedTime: "20h", optOut: false },
                    ],
                    userDefinedDeliverables: [ { task: "Research and propose 3 EdTech tools for Sazi Life", weight: 10, score: 0, estimatedTime: "12h"}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""} ],
                    trainingPlan: [
                        { task: "Alison.com: Diploma in Educational Psychology (Complete relevant modules on curriculum & child dev)", month: "1-2", week: "Self-paced", cost: 0, status: "not-started", deliverable: "Module summaries", estimatedTime: "20h" },
                        { task: "Asana or Trello: Advanced Project Management Course (Online)", month: 3, week: "Self-paced", cost: 0, status: "not-started", deliverable: "Certificate / Project Board Demo for Sazi Life", estimatedTime: "15h" },
                        { task: "Course: Professional Translation Techniques (isiXhosa focus if available)", month: 4, week: "Self-paced", cost: 400, status: "not-started", deliverable: "Completion Cert/Notes", estimatedTime: "25h"},
                        { task: "Workshop: Effective Remote Collaboration Tools & Practices", month: 1, week: "2h online", cost: 0, status: "not-started", deliverable: "Attendance & key takeaways", estimatedTime: "2h"}
                    ]
                },
                performanceKPIs: ["Quality & Timeliness of Sazi Life Curriculum Modules", "Accuracy & Efficiency of Translations and Admin Support", "Effective Document Management", "Share Vesting Milestones Met (documented quarterly)", "Positive team feedback on operational support"],
                nextLevelEligibility: "Operations Manager, Senior Curriculum Developer, potential for leading Sazi Life education venture. Eligibility for first share tranche (up to 5%) after 6-24 months based on sustained high performance."
            },
            nozukile: {
                name: "Nozukile Mdeni", role: "Chairperson of the Family Council (Non-Executive Director - Advisory)",
                profileImage: "salatiso/assets/photos/team/nozukile_profile_thumb.jpg",
                profile: `As the matriarch, Nozukile embodies wisdom, stability, and a deep understanding of family dynamics and Xhosa traditions... Her role is to ensure that as the business grows, its core purpose of family unity, legacy, and community upliftment remains paramount. She holds 20% of company shares in The Mdeni Grandchildren's Legacy Trust, from which Tina and Kwakho's performance-based shares will be allocated.`,
                responsibilities: ["Providing high-level oversight at Family Council meetings", "Ensuring alignment with family values and ethics", "Safeguarding shareholder interests (trusts)", "Moral compass & mediator", "Championing Xhosa culture integration"],
                 padp: {
                    commonActions: [
                        { id: "familiarize", task: "Review Intranet overview and key governance documents.", status: "not-started", signedOff: null, estimatedTime: "2h" },
                        { id: "acceptRole", task: "Review and Electronically Accept Chairperson Role Outline.", status: "not-started", signedOff: null, estimatedTime: "0.5h" },
                    ],
                    coreDeliverables: [
                        { task: "Chair quarterly Family Council meetings effectively", weight: 40, score: 0, notes: "", optOut: false },
                        { task: "Provide guidance on ethical dilemmas or family business conflicts", weight: 30, score: 0, notes: "", optOut: false },
                    ],
                    roleSpecificDeliverables: [
                        { task: "Review and approve transfer of shares to Tina/Kwakho upon CEO/CSOO certification of performance", deadline: "As per vesting schedule", weight: 20, score: 0, status: "ongoing", estimatedTime: "1h/instance", optOut: false },
                        { task: "Advise on one cultural integration initiative per year", deadline: "Annual", weight: 10, score: 0, status: "not-started", estimatedTime: "5h/year", optOut: false },
                    ],
                    userDefinedDeliverables: [], 
                    trainingPlan: [
                        { task: "Attend Quarterly Family Council Meetings", month: "Quarterly", week: "N/A", cost: 0, status: "ongoing", deliverable: "Active Participation & Minutes Review", estimatedTime: "2h/meeting" },
                        { task: "Reading: 'Governance for Family Enterprises' (summary provided by Salatiso)", month: 2, week: "Self-paced", cost: 0, status: "not-started", deliverable: "Discussion points for next council", estimatedTime: "4h" }
                    ]
                },
                performanceKPIs: ["Active and insightful participation in Family Council", "Upholding of Family Values within business decisions", "Positive influence on family harmony related to business", "Guidance on cultural integration initiatives", "Timely execution of trust-related duties for share allocation"],
                nextLevelEligibility: "Continued advisory role, potential for mentorship roles within the family."
            },
            solonwabo: {
                name: "Solonwabo Milile Mdeni", role: "Jr. Product Designer & Technical Apprentice",
                profileImage: "salatiso/assets/photos/team/solonwabo_profile_thumb.jpg",
                profile: `A talented and self-motivated young web developer... Accountable to CSOO (Salatiso) for technical mentorship and quality; responsible to CEO (Visa) for project deliverables and operational alignment.`,
                responsibilities: ["Assisting with product design", "Website development (Intranet, ventures)", "Technical support for digital ventures", "Learning new technologies"],
                padp: {
                    commonActions: [
                        { id: "familiarize", task: "Fully navigate Intranet and familiarize with MFE vision, structure, policies.", status: "not-started", signedOff: null, estimatedTime: "2h" },
                        { id: "acceptRole", task: "Review and Electronically Accept Role Profile & Performance Plan.", status: "not-started", signedOff: null, estimatedTime: "1h" },
                        { id: "induction", task: "Complete General Company Induction module.", status: "not-started", signedOff: null, estimatedTime: "3h" }
                    ],
                    coreDeliverables: [
                        { task: "Deliver assigned technical tasks on time and to quality standards", weight: 30, score: 0, notes: "", optOut: false },
                        { task: "Actively participate in mentorship sessions with CSOO", weight: 20, score: 0, notes: "", optOut: false },
                    ],
                    roleSpecificDeliverables: [
                        { task: "Complete Intranet V1.1 enhancements (styling, dashboard widgets)", deadline: "Month 1, Week 4", weight: 20, score: 0, status: "not-started", estimatedTime: "25h", optOut: false },
                        { task: "Develop UI mockups for SafetyHelp new module (under Salatiso's guidance)", deadline: "Month 2, Week 3", weight: 15, score: 0, status: "not-started", estimatedTime: "15h", optOut: false },
                        { task: "Provide tech support for team on Intranet usage (max 2h/week)", deadline: "Ongoing", weight: 10, score: 0, status: "in-progress", estimatedTime: "2h/week", optOut: false },
                    ],
                    userDefinedDeliverables: [ { task: "Learn basics of a backend language (e.g., Python Flask or Node.js)", weight: 15, score: 0, estimatedTime: "30h"}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""}, { task: "", weight: 0, score: 0, estimatedTime: ""} ],
                    trainingPlan: [
                        { task: "FreeCodeCamp: Responsive Web Design Certification (Complete)", month: "1-2", week: "Self-paced", cost: 0, status: "in-progress", deliverable: "Certificate & Deployed Projects", estimatedTime: "80h" },
                        { task: "GitHub Learning Lab: Full Suite (Intro, Git Flow, etc.)", month: 3, week: "Self-paced", cost: 0, status: "not-started", deliverable: "Completed Labs", estimatedTime: "10h" },
                        { task: "Figma Learn: 'UI Design Principles' & 'Prototyping'", month: "3-4", week: "Self-paced", cost: 0, status: "not-started", deliverable: "Sample Prototype Project", estimatedTime: "20h" },
                        { task: "MDN Web Docs: JavaScript Intermediate Concepts", month: 4, week: "Self-paced", cost: 0, status: "not-started", deliverable: "Completed 5 JS coding challenges", estimatedTime: "30h" }
                    ]
                },
                performanceKPIs: ["Completion of Technical Training Modules & Certifications", "Quality of Code and Design Contributions (minimal bugs, good UX)", "Problem-Solving Ability in Technical Tasks", "Timeliness of Intranet Updates & Tech Support", "Proactive Learning and Application of New Skills"],
                nextLevelEligibility: "Product Designer, Junior Full-Stack Developer, specialized tech roles based on interest and performance."
            }
        };

        function populateModal(memberKey) {
            const member = teamMemberData[memberKey];
            if (!member) { console.error("Member data not found for key:", memberKey); return; }

            let profileImageHtml = member.profileImage ? `<img src="${member.profileImage}" alt="${member.name}" class="w-32 h-32 rounded-full mx-auto mb-6 border-4 border-secondary-medium shadow-lg">` : `<div class="w-32 h-32 rounded-full mx-auto mb-6 bg-gray-300 flex items-center justify-center text-gray-500 text-4xl border-4 border-secondary-medium shadow-lg">${member.name.split(' ').map(n=>n[0]).join('')}</div>`;

            let tabsHtml = `<div class="modal-tabs">
                <button class="modal-tab-button active" onclick="openModalTab(event, '${memberKey}-padp')">PADP & Role</button>
                <button class="modal-tab-button" onclick="openModalTab(event, '${memberKey}-training')">Formal Training</button>
                <button class="modal-tab-button" onclick="openModalTab(event, '${memberKey}-performance')">Performance & Growth</button>
            </div>`;

            let padpPaneHtml = `<div id="${memberKey}-padp" class="modal-tab-pane active">`;
            padpPaneHtml += commonActionsHtml(member, memberKey);
            padpPaneHtml += responsibilitiesHtml(member);
            padpPaneHtml += profileSummaryHtml(member);
            padpPaneHtml += padpDeliverablesHtml(member, memberKey);
            padpPaneHtml += `</div>`;

            let trainingPaneHtml = `<div id="${memberKey}-training" class="modal-tab-pane">`;
            trainingPaneHtml += formalTrainingPlanHtml(member, memberKey);
            trainingPaneHtml += `</div>`;

            let performancePaneHtml = `<div id="${memberKey}-performance" class="modal-tab-pane">`;
            performancePaneHtml += performanceKPIsHtml(member);
            performancePaneHtml += nextLevelEligibilityHtml(member);
            performancePaneHtml += assignedTasksHtml(memberKey);
            performancePaneHtml += `<div class="mt-8 text-right border-t pt-4">
                                        <button class="bg-accent-orange hover:bg-orange-700 text-white py-2 px-5 rounded-md text-sm font-medium"><i class="fas fa-comment-dots mr-2"></i>Request PADP Review</button>
                                    </div>`;
            performancePaneHtml += `</div>`;


            modalBody.innerHTML = `
                <h3 class="modal-title text-center">${member.name}</h3>
                <p class="role-subtitle text-center">${member.role}</p>
                ${profileImageHtml}
                ${tabsHtml}
                ${padpPaneHtml}
                ${trainingPaneHtml}
                ${performancePaneHtml}
            `;
            memberDetailModal.classList.add('active');
            attachModalEventListeners(memberKey);
        }

        function commonActionsHtml(member, memberKey) {
            let html = '<div class="modal-section"><h4 class="text-lg font-semibold mt-4 mb-3 text-primary-dark"><i class="fas fa-check-square mr-2 text-secondary-medium"></i>Initial Actions & Role Acceptance</h4><ul class="list-none p-0 space-y-3">';
            member.padp.commonActions.forEach((action, index) => {
                const signedOffText = action.signedOff ? ` (Accepted: ${action.signedOff})` : "";
                const isChecked = action.status === 'completed' ? 'checked' : '';
                const isDisabled = action.status === 'completed' ? 'disabled' : '';
                let actionButtonHtml = '';
                if (action.id === 'acceptRole' && action.status !== 'completed') {
                     actionButtonHtml = `<button class="ml-auto text-xs bg-green-600 hover:bg-green-700 text-white px-2 py-1 rounded sign-action-btn" data-action-id="${action.id}" ${isDisabled}>Accept Role</button>`;
                } else if (action.status !== 'completed') {
                     actionButtonHtml = `<button class="ml-auto text-xs bg-primary-medium hover:bg-primary-dark text-white px-2 py-1 rounded complete-action-btn" data-action-id="${action.id}" ${isDisabled}>Mark Complete</button>`;
                }

                html += `
                    <li class="flex items-center p-2 border border-border rounded-md ${isChecked ? 'bg-green-50' : 'bg-gray-50'}">
                        <input type="checkbox" id="commonAction_${memberKey}_${index}" data-member="${memberKey}" data-action-type="common" data-action-id="${action.id}" class="mr-3 common-action-checkbox h-5 w-5 text-primary-medium border-gray-300 rounded focus:ring-primary-medium" ${isChecked} ${isDisabled}>
                        <label for="commonAction_${memberKey}_${index}" class="text-sm flex-grow ${isChecked ? 'line-through text-text-light' : 'text-text-medium'}">${action.task} <span class="text-xs text-text-light ml-1">(Est. ${action.estimatedTime})</span><span class="text-xs text-green-700 ml-1 signed-off-text">${signedOffText}</span></label>
                        ${actionButtonHtml}
                    </li>`;
            });
            html += '</ul></div>';
            return html;
        }

        function responsibilitiesHtml(member) {
            return `<div class="modal-section"><h4 class="text-lg font-semibold text-primary-dark"><i class="fas fa-user-tie mr-2 text-secondary-medium"></i>Key Responsibilities:</h4><ul class="list-disc pl-6 text-sm space-y-1 text-text-medium">${member.responsibilities.map(r => `<li>${r}</li>`).join('')}</ul></div>`;
        }
        function profileSummaryHtml(member) {
            return `<div class="modal-section"><h4 class="text-lg font-semibold text-primary-dark"><i class="fas fa-id-card mr-2 text-secondary-medium"></i>Profile Summary:</h4><p class="text-sm text-text-medium leading-relaxed">${member.profile.substring(0,250)}...</p></div>`;
        }

        function padpDeliverablesHtml(member, memberKey) {
            let html = `<div class="modal-section"><h4 class="text-lg font-semibold mt-4 mb-3 text-primary-dark"><i class="fas fa-bullseye mr-2 text-secondary-medium"></i>PADP Deliverables</h4>`;
            html += `<p class="text-xs text-text-light mb-3">Core deliverables are fixed. Role-specific have initial weights; propose changes and add up to 5 user-defined goals. Total weight of Role-Specific + User-Defined should ideally be 100 - sum of Core weights.</p>`;
            html += `<div class="overflow-x-auto"><table class="action-plan-table">
                            <thead><tr><th>Type</th><th>Task / Objective (Est. Time)</th><th>Weight (%)</th><th>Score (1-5)</th><th>Notes / Opt-Out</th><th>Status</th><th>Save</th></tr></thead><tbody>`;
            member.padp.coreDeliverables.forEach((item, index) => {
                html += `<tr>
                    <td class="font-medium bg-gray-100">Core</td>
                    <td><textarea rows="2" data-field="task" data-type="core" data-index="${index}" readonly class="bg-gray-100 cursor-not-allowed">${item.task}</textarea></td>
                    <td><input type="number" value="${item.weight}" data-field="weight" data-type="core" data-index="${index}" readonly class="bg-gray-100 text-center cursor-not-allowed"></td>
                    <td><input type="number" value="${item.score}" min="0" max="5" data-field="score" data-type="core" data-index="${index}" class="text-center"></td>
                    <td><textarea rows="1" data-field="notes" data-type="core" data-index="${index}" readonly class="bg-gray-100 cursor-not-allowed">${item.notes}</textarea></td>
                    <td class="text-center"><span class="text-xs font-semibold">Ongoing</span></td>
                    <td><button class="action-btn save-padp-item" data-member="${memberKey}" data-type="core" data-index="${index}"><i class="fas fa-save"></i></button></td>
                </tr>`;
            });
            member.padp.roleSpecificDeliverables.forEach((item, index) => {
                 html += `<tr>
                    <td class="font-medium bg-secondary-light bg-opacity-20">Role-Specific</td>
                    <td><textarea rows="2" data-field="task" data-type="roleSpecific" data-index="${index}">${item.task} (Est. ${item.estimatedTime || 'N/A'})</textarea></td>
                    <td><input type="number" value="${item.weight}" data-field="weight" data-type="roleSpecific" data-index="${index}" class="text-center"></td>
                    <td><input type="number" value="${item.score}" min="0" max="5" data-field="score" data-type="roleSpecific" data-index="${index}" class="text-center"></td>
                    <td><label class="text-xs block"><input type="checkbox" class="mr-1" data-field="optOut" data-type="roleSpecific" data-index="${index}" ${item.optOut ? 'checked' : ''}> Opt-Out Req.</label><textarea rows="1" data-field="notes" data-type="roleSpecific" data-index="${index}" placeholder="Reason if opting out...">${item.notes || ''}</textarea></td>
                    <td><select class="status-select text-xs" data-field="status" data-type="roleSpecific" data-index="${index}">
                        <option value="not-started" ${item.status === 'not-started' ? 'selected' : ''}>Not Started</option>
                        <option value="in-progress" ${item.status === 'in-progress' ? 'selected' : ''}>In Progress</option>
                        <option value="completed" ${item.status === 'completed' ? 'selected' : ''}>Completed</option>
                    </select></td>
                    <td><button class="action-btn save-padp-item" data-member="${memberKey}" data-type="roleSpecific" data-index="${index}"><i class="fas fa-save"></i></button></td>
                </tr>`;
            });
             member.padp.userDefinedDeliverables.forEach((item, index) => {
                html += `<tr>
                    <td class="font-medium bg-green-100">User-Defined</td>
                    <td><textarea rows="2" placeholder="Define objective..." data-field="task" data-type="userDefined" data-index="${index}">${item.task}</textarea>
                        <input type="text" placeholder="Est. Time (e.g., 10h)" value="${item.estimatedTime || ''}" data-field="estimatedTime" data-type="userDefined" data-index="${index}" class="text-xs mt-1"></td>
                    <td><input type="number" placeholder="Weight" value="${item.weight}" data-field="weight" data-type="userDefined" data-index="${index}" class="text-center"></td>
                    <td><input type="number" value="${item.score}" min="0" max="5" data-field="score" data-type="userDefined" data-index="${index}" class="text-center"></td>
                    <td><textarea rows="1" data-field="notes" data-type="userDefined" data-index="${index}" placeholder="Details...">${item.notes || ''}</textarea></td>
                     <td><select class="status-select text-xs" data-field="status" data-type="userDefined" data-index="${index}">
                        <option value="not-started" ${item.status === 'not-started' ? 'selected' : ''}>Not Started</option>
                        <option value="in-progress" ${item.status === 'in-progress' ? 'selected' : ''}>In Progress</option>
                        <option value="completed" ${item.status === 'completed' ? 'selected' : ''}>Completed</option>
                    </select></td>
                    <td><button class="action-btn save-padp-item" data-member="${memberKey}" data-type="userDefined" data-index="${index}"><i class="fas fa-save"></i></button></td>
                </tr>`;
            });
            html += `</tbody></table></div><p class="text-xs text-text-light mt-2">Total PADP Weight: <span id="totalPadpWeight_${memberKey}" class="font-bold">0</span>% (Aim for 100% across Core, Role-Specific, User-Defined)</p></div>`;
            return html;
        }

        function formalTrainingPlanHtml(member, memberKey) {
            let html = `<div class="modal-section"><h4 class="text-lg font-semibold mt-4 mb-3 text-primary-dark"><i class="fas fa-graduation-cap mr-2 text-secondary-medium"></i>Formal Training Plan</h4>
                        <p class="text-xs text-text-light mb-3">Track progress on formal courses and workshops. You can confirm completion of training done elsewhere.</p>
                        <div class="overflow-x-auto">
                        <table class="action-plan-table">
                            <thead><tr><th>Task/Course</th><th>Month</th><th>Week Ref</th><th>Est. Cost (ZAR)</th><th>Deliverable/Link</th><th>Status</th><th>Confirm/Save</th></tr></thead><tbody>`;
            member.padp.trainingPlan.forEach((item, index) => {
                html += `<tr>
                    <td><textarea rows="2" data-field="task" data-type="training" data-index="${index}">${item.task} (Est. ${item.estimatedTime || 'N/A'})</textarea></td>
                    <td><input type="text" value="${item.month}" data-field="month" data-type="training" data-index="${index}" class="text-sm"></td>
                    <td><input type="text" value="${item.week || 'N/A'}" data-field="week" data-type="training" data-index="${index}" class="text-sm"></td>
                    <td><input type="number" value="${item.cost}" data-field="cost" data-type="training" data-index="${index}" class="text-sm"></td>
                    <td><textarea rows="2" data-field="deliverable" data-type="training" data-index="${index}" placeholder="Certificate URL, notes...">${item.deliverable || ''}</textarea></td>
                    <td>
                        <select class="status-select text-sm" data-field="status" data-type="training" data-index="${index}">
                            <option value="not-started" ${item.status === 'not-started' ? 'selected' : ''}>Not Started</option>
                            <option value="in-progress" ${item.status === 'in-progress' ? 'selected' : ''}>In Progress</option>
                            <option value="completed" ${item.status === 'completed' ? 'selected' : ''}>Completed</option>
                        </select>
                    </td>
                    <td><button class="action-btn save-padp-item" data-member="${memberKey}" data-type="training" data-index="${index}"><i class="fas fa-save"></i> Save</button></td>
                </tr>`;
            });
            html += `</tbody></table></div></div>`;
            return html;
        }

        function performanceKPIsHtml(member) {
            let html = `<div class="modal-section"><h4 class="text-lg font-semibold mt-6 mb-3 text-primary-dark"><i class="fas fa-chart-line mr-2 text-secondary-medium"></i>Performance KPIs</h4><ul class="list-disc pl-6 text-sm space-y-1 text-text-medium">`;
            member.performanceKPIs.forEach(kpi => html += `<li>${kpi}</li>`);
            html += `</ul><p class="text-xs text-text-light mt-2">Performance against PADP deliverables and these KPIs will be reviewed quarterly by the CEO (or CSOO for CEO).</p></div>`;
            return html;
        }

        function nextLevelEligibilityHtml(member) {
            let html = `<div class="modal-section"><h4 class="text-lg font-semibold mt-6 mb-3 text-primary-dark"><i class="fas fa-layer-group mr-2 text-secondary-medium"></i>Next Level Eligibility & Growth Path</h4><p class="text-sm text-text-medium">${member.nextLevelEligibility || "To be defined based on PADP completion and company needs."}</p>`;
            if (member.name === "Tina Mdeni" || member.name === "Kwakho Mdeni") {
                html += `<p class="text-xs text-primary-medium mt-2">Performance-based share vesting: Up to 5% (6-24 months), further 5% (next 36 months) from Nozukile Mdeni's Trust, based on PADP and KPI achievement.</p>`;
            }
            html += `</div>`;
            return html;
        }
        
        function assignedTasksHtml(memberKey) {
             let html = `<div class="modal-section"><h4 class="text-lg font-semibold mt-6 mb-3 text-primary-dark"><i class="fas fa-clipboard-check mr-2 text-secondary-medium"></i>My Assigned Tasks (from others)</h4>`;
            html += `<ul class="list-disc pl-6 text-sm space-y-2 text-text-medium">
                        <li class="p-2 border border-border rounded-md bg-yellow-50">Task: Review Marketing Budget Q3 (Assigned by: Visa, Due: May 28) 
                            <div class="mt-1">
                                <button class="text-xs bg-green-600 text-white px-1.5 py-0.5 rounded ml-1">Accept</button> 
                                <button class="text-xs bg-accent-orange text-white px-1.5 py-0.5 rounded ml-1">Request Assist</button> 
                                <button class="text-xs bg-danger text-white px-1.5 py-0.5 rounded ml-1">Request Transfer</button>
                            </div>
                        </li>
                        <li class="p-2 border border-border rounded-md">Task: Provide Feedback on Sazi Life Module 1 (Assigned by: Kwakho, Due: June 5)</li>
                     </ul></div>`;
            return html;
        }

        function attachModalEventListeners(memberKey) {
            const currentMemberData = teamMemberData[memberKey];
            modalBody.querySelectorAll('.common-action-checkbox').forEach(checkbox => {
                checkbox.addEventListener('change', function() { handleCommonActionChange(this, memberKey); });
            });
            modalBody.querySelectorAll('.sign-action-btn, .complete-action-btn').forEach(button => {
                button.addEventListener('click', function() { handleCommonActionButtonClick(this, memberKey); });
            });
            modalBody.querySelectorAll('.save-padp-item').forEach(button => {
                button.addEventListener('click', function() { handlePadpItemSave(this, memberKey); });
            });
             modalBody.querySelectorAll('.status-select').forEach(selectEl => {
                selectEl.addEventListener('change', function() {
                    this.className = 'status-select text-xs';
                    if (this.value === 'completed') this.classList.add('status-completed');
                    else if (this.value === 'in-progress') this.classList.add('status-in-progress');
                    else this.classList.add('status-not-started');
                });
                selectEl.dispatchEvent(new Event('change')); // Trigger initial style
            });
            calculateTotalPadpWeight(memberKey);
        }
        
        function calculateTotalPadpWeight(memberKey) {
            const member = teamMemberData[memberKey];
            if (!member || !member.padp) return;
            let totalWeight = 0;
            ['coreDeliverables', 'roleSpecificDeliverables', 'userDefinedDeliverables'].forEach(type => {
                if (member.padp[type]) {
                    member.padp[type].forEach(item => {
                        totalWeight += (parseInt(item.weight) || 0);
                    });
                }
            });
            const weightDisplay = modalBody.querySelector(`#totalPadpWeight_${memberKey}`); // Search within modalBody
            if(weightDisplay) weightDisplay.textContent = totalWeight;
        }


        function handleCommonActionChange(checkbox, memberKey) {
            const actionId = checkbox.dataset.actionId;
            const actionItem = teamMemberData[memberKey].padp.commonActions.find(a => a.id === actionId);
            if (actionItem) {
                if (checkbox.checked && actionItem.status !== 'completed') {
                    console.warn("Common action checkbox manually changed. Prefer using action buttons.");
                } else if (!checkbox.checked && actionItem.status === 'completed') {
                    checkbox.checked = true;
                    alert("This action has already been completed and signed off. It cannot be reverted here.");
                }
            }
        }
        function handleCommonActionButtonClick(button, memberKey) {
            const actionId = button.dataset.actionId;
            const actionItem = teamMemberData[memberKey].padp.commonActions.find(a => a.id === actionId);
            const listItem = button.closest('li');
            const checkbox = listItem.querySelector(`.common-action-checkbox[data-action-id="${actionId}"]`);


            if (actionItem && actionItem.status !== 'completed') {
                actionItem.status = 'completed';
                actionItem.signedOff = new Date().toLocaleDateString() + " " + new Date().toLocaleTimeString();
                if (checkbox) {
                    checkbox.checked = true;
                    checkbox.disabled = true;
                    const label = checkbox.closest('li').querySelector('label');
                    if (label) {
                        label.classList.add('line-through', 'text-text-light');
                        const signedOffSpan = label.querySelector('.signed-off-text');
                        if (signedOffSpan) signedOffSpan.textContent = ` (Accepted: ${actionItem.signedOff})`;
                    }
                }
                button.textContent = 'Completed';
                button.disabled = true;
                button.classList.remove('bg-green-600', 'hover:bg-green-700', 'bg-primary-medium', 'hover:bg-primary-dark');
                button.classList.add('bg-gray-400', 'cursor-not-allowed');

                alert(`Action '${actionItem.task}' has been electronically signed off and marked complete by ${memberKey}.`);
                console.log("Action Signed Off:", memberKey, actionItem);
                populateTrainingProgress();
                populateMyPendingActions();
            }
        }

        function handlePadpItemSave(button, memberKey) {
            const itemTypeKey = button.dataset.type; 
            const itemIndex = parseInt(button.dataset.index);
            const row = button.closest('tr');
            
            let targetArray;
            if (itemTypeKey === 'training') {
                targetArray = teamMemberData[memberKey].padp.trainingPlan;
            } else {
                const deliverableKey = itemTypeKey.endsWith('s') ? itemTypeKey : itemTypeKey + 'Deliverables';
                targetArray = teamMemberData[memberKey].padp[deliverableKey];
            }

            if (!targetArray || !targetArray[itemIndex]) {
                console.error("Could not find PADP item to update:", memberKey, itemTypeKey, itemIndex);
                return;
            }
            const itemToUpdate = targetArray[itemIndex];

            row.querySelectorAll('[data-field]').forEach(field => {
                const fieldName = field.dataset.field;
                if (field.type === 'checkbox' && fieldName === 'optOut') { 
                    itemToUpdate[fieldName] = field.checked;
                } else if (field.type === 'number') {
                    itemToUpdate[fieldName] = parseInt(field.value) || 0;
                } else {
                    itemToUpdate[fieldName] = field.value;
                }
            });
            
            console.log(`Updated PADP item for ${memberKey}, type ${itemTypeKey}, index ${itemIndex}:`, itemToUpdate);
            alert('PADP item updated (conceptual save). Dashboard would refresh if connected to backend.');
            populateTrainingProgress();
            if (itemTypeKey !== 'training') calculateTotalPadpWeight(memberKey);
        }


        let teamCarouselPopulated = false;
        function populateAndInitTeamCarousel() {
            if (teamCarouselPopulated) {
                 const teamCarouselEl = document.querySelector('#team .mfe-carousel-container');
                 if(teamCarouselEl) setupCarousel(teamCarouselEl);
                return;
            }
            const teamCarouselTrack = document.querySelector('#team .mfe-carousel-track');
            if (!teamCarouselTrack) return;

            teamCarouselTrack.innerHTML = ''; 
            Object.keys(teamMemberData).forEach(key => {
                const member = teamMemberData[key];
                const itemDiv = document.createElement('div');
                itemDiv.className = 'mfe-carousel-item';
                itemDiv.innerHTML = `
                    <div class="card-content">
                        <img src="${member.profileImage || 'salatiso/assets/photos/team_placeholder_carousel.png'}" alt="${member.name}" class="w-24 h-24 rounded-full mx-auto mb-4 border-4">
                        <h4 class="text-xl font-semibold text-primary-dark text-center">${member.name}</h4>
                        <p class="text-text-medium text-sm text-center mb-3">${member.role}</p>
                        <p class="text-text-light text-xs mb-4 flex-grow text-center">${member.profile.substring(0,70)}...</p>
                        <button class="mt-auto w-full bg-primary-medium text-white py-2.5 px-4 rounded-md hover:bg-primary-dark transition-colors text-sm font-medium view-member-details-btn" data-member="${key}">View PADP & Details</button>
                    </div>`;
                teamCarouselTrack.appendChild(itemDiv);
            });
            teamCarouselTrack.querySelectorAll('.view-member-details-btn').forEach(button => {
                button.addEventListener('click', () => populateModal(button.dataset.member));
            });
            setupCarousel(document.querySelector('#team .mfe-carousel-container'));
            teamCarouselPopulated = true;
        }

        function populateTrainingProgress() {
            const widget = document.getElementById('trainingProgressWidget');
            if (!widget) return;
            widget.innerHTML = ''; 
            Object.keys(teamMemberData).forEach(key => {
                const member = teamMemberData[key];
                if (member.padp && member.padp.trainingPlan && member.padp.trainingPlan.length > 0) {
                    const completedTasks = member.padp.trainingPlan.filter(t => t.status === 'completed').length;
                    const totalTasks = member.padp.trainingPlan.length;
                    const progress = totalTasks > 0 ? Math.round((completedTasks / totalTasks) * 100) : 0;
                    
                    const p = document.createElement('p');
                    p.className = "text-sm mb-0.5 text-text-medium";
                    p.innerHTML = `${member.name.split(' ')[0]} ${member.name.includes('.') ? member.name.split(' ')[1] : ''}: <span class="font-semibold">${progress}%</span>`;
                    widget.appendChild(p);
                    
                    const barContainer = document.createElement('div');
                    barContainer.className = 'progress-bar-container mb-2';
                    const bar = document.createElement('div');
                    bar.className = 'progress-bar bg-secondary-medium';
                    bar.style.width = `${progress}%`;
                    barContainer.appendChild(bar);
                    widget.appendChild(barContainer);
                }
            });
        }
        
        function populateMyPendingActions() {
            const widget = document.getElementById('myPendingActionsWidget');
            const userNameSpan = document.getElementById('currentUserNamePendingActions');
            if (!widget || !teamMemberData[currentLoggedInUser] || !teamMemberData[currentLoggedInUser].padp) return;
            
            if(userNameSpan) userNameSpan.textContent = teamMemberData[currentLoggedInUser].name.split(' ')[0];

            widget.innerHTML = '';
            const userPADP = teamMemberData[currentLoggedInUser].padp;
            let actionCount = 0;

            userPADP.commonActions.filter(a => a.status !== 'completed').slice(0, 2).forEach(action => {
                const li = document.createElement('li');
                li.innerHTML = `<input type="checkbox" id="dash_common_${action.id}" class="mr-2"><label for="dash_common_${action.id}">${action.task} (Initial Action)</label>`;
                widget.appendChild(li);
                actionCount++;
            });

            userPADP.roleSpecificDeliverables.filter(d => d.status !== 'completed').slice(0, 4 - actionCount).forEach(del => {
                 const li = document.createElement('li');
                li.innerHTML = `<input type="checkbox" id="dash_role_${del.task.replace(/\s+/g, '_').substring(0,10)}" class="mr-2"><label for="dash_role_${del.task.replace(/\s+/g, '_').substring(0,10)}">${del.task.substring(0,35)}... (PADP)</label>`;
                widget.appendChild(li);
            });
            if (currentLoggedInUser === 'salatiso' && userPADP.roleSpecificDeliverables.find(d=>d.task.includes("Chatbot") && d.status !== 'completed')) {
                 const li = document.createElement('li');
                li.innerHTML = `<input type="checkbox" id="dash_chatbot_salatiso" class="mr-2"><label for="dash_chatbot_salatiso" class="font-bold text-danger">Integrate Chatbot on SafetyHelp Staging (Due: May 24)</label>`;
                widget.appendChild(li);
            }
        }
        
        function populateCompanyLaunchRoadmap() {
            const widget = document.getElementById('companyLaunchRoadmapWidget');
            if (!widget) return;
            const roadmap = [
                { name: "Phase 1: Legal Foundation", status: "completed", progress: 100, icon: "fas fa-check-circle text-green-600" },
                { name: "Phase 2: Operational Setup", status: "in-progress", progress: 70, icon: "fas fa-cogs text-blue-500" },
                { name: "Phase 3: Intranet & Internal Launch", status: "in-progress", progress: 40, icon: "fas fa-users text-purple-500" },
                { name: "Phase 4: SafetyHelp Public Launch (June 1)", status: "not-started", progress: 10, icon: "far fa-clock text-orange-500" }
            ];
            widget.innerHTML = '';
            roadmap.forEach(phase => {
                const li = document.createElement('li');
                li.className = "mb-2";
                li.innerHTML = `<i class="${phase.icon} mr-2"></i>${phase.name} (${phase.progress}%)
                                <div class="progress-bar-container"><div class="progress-bar ${phase.status === 'not-started' ? 'bg-accent-orange' : phase.status === 'in-progress' ? 'bg-blue-500' : 'bg-secondary-medium'}" style="width: ${phase.progress}%;"></div></div>`;
                widget.appendChild(li);
            });
        }

        function populateRecentActivity() {
            const widget = document.getElementById('recentActivityWidget');
            if (!widget) return;
            const activities = [
                { type: "COMPLETED", user: "Visa M.", text: "submitted CIPC company registration.", time: "1h ago", color: "text-green-700" },
                { type: "UPDATED", user: "Tina M.", text: "added 'Brand Voice Guide' to Marketing Content Calendar.", time: "3h ago", color: "text-blue-600" },
                { type: "ASSIGNED", user: "Salatiso M.", text: "to review Phase 2 budget by EOD May 23rd.", time: "Yesterday", color: "text-orange-600" },
                { type: "COMMENT", user: "Kwakho M.", text: "on Sazi Life Curriculum: 'Need input on Grade 2 isiXhosa module.'", time: "Yesterday", color: "text-purple-600"},
                { type: "SIGNED OFF", user: "Solonwabo M.", text: "Role Acceptance in PADP.", time: "2 days ago", color: "text-green-700"}
            ];
            widget.innerHTML = '';
            activities.forEach(act => {
                const p = document.createElement('p');
                p.innerHTML = `<span class="font-semibold ${act.color}">${act.type}:</span> ${act.user} ${act.text} <span class="text-gray-400 text-xs">- ${act.time}</span>`;
                widget.appendChild(p);
            });
        }

        // --- HORIZONTAL TIMELINE ---
        function populateHorizontalTimeline() {
            const timelineContainer = document.getElementById('horizontalTimeline');
            if (!timelineContainer) return;
            timelineContainer.innerHTML = ''; // Clear existing

            const year1Plan = [
                // May 2025
                { month: "MAY", year: "2025", week: "Wk 1 (19-25)", title: "Foundation Week", details: "Company Name, CIPC Start (Visa). Chatbot Integration (Salatiso). Intranet Familiarization (All).", status: "inprogress"},
                { month: "MAY", year: "2025", week: "Wk 2 (26-01)", title: "Launch Week!", details: "Bank Account (Visa). SafetyHelp Launch! Role Acceptance (All).", status: "inprogress"},
                // June 2025
                { month: "JUN", year: "2025", week: "Wk 1 (02-08)", title: "Ops Kickstart", details: "Internal Agreements Drafted. Supplier DB Setup (Tina).", status: "pending"},
                { month: "JUN", year: "2025", week: "Wk 2 (09-15)", title: "Marketing & Curriculum", details: "Social Media Launch (Tina). Sazi Life Framework V1 (Kwakho). Q3 Budget Approved (Salatiso).", status: "pending"},
                { month: "JUN", year: "2025", week: "Wk 3 (16-22)", title: "Legal & Compliance", details: "SARS Reg Finalized. Trust Deed Review.", status: "pending"},
                { month: "JUN", year: "2025", week: "Wk 4 (23-29)", title: "Content & Systems", details: "SafetyHelp Brochure (Tina). Document Mgt System (Kwakho).", status: "pending"},
                // July 2025
                { month: "JUL", year: "2025", week: "Wk 1 (30-06)", title: "Performance Cycle Start", details: "First PADP Check-ins (Visa). SafetyHelp Marketing Push.", status: "pending"},
                { month: "AUG", year: "2025", week: "", title: "Sazi Life Module 1 Dev", details: "Focus on Grade R content.", status: "pending"},
                { month: "SEP", year: "2025", week: "", title: "Q3 Review Prep", details: "Compile performance data.", status: "pending"},
                { month: "OCT", year: "2025", week: "", title: "Flamea NPO Update", details: "Check registration status.", status: "pending"},
                { month: "NOV", year: "2025", week: "", title: "Year 2 Planning", details: "Initial strategic discussions.", status: "pending"},
                { month: "DEC", year: "2025", week: "", title: "Visa Income Target Review", details: "Assess progress towards R15k.", status: "pending"},
                { month: "JAN", year: "2026", week: "", title: "Year-End Performance Reviews", details: "Full PADP reviews.", status: "pending"},
                { month: "FEB", year: "2026", week: "", title: "Sazi Life Pilot Launch", details: "Internal testing of curriculum.", status: "pending"},
                { month: "MAR", year: "2026", week: "", title: "Expand SafetyHelp Modules", details: "Plan next features.", status: "pending"},
                { month: "APR", year: "2026", week: "", title: "Community Outreach (Flamea)", details: "Plan first initiative.", status: "pending"},
                { month: "MAY", year: "2026", week: "", title: "One Year Anniversary Review", details: "Celebrate successes, plan ahead.", status: "pending"},
            ];

            year1Plan.forEach((eventData, index) => {
                const eventDiv = document.createElement('div');
                eventDiv.className = 'timeline-event';
                
                let statusClass = 'timeline-status-pending';
                if (eventData.status === 'completed') statusClass = 'timeline-status-completed';
                else if (eventData.status === 'inprogress') statusClass = 'timeline-status-inprogress';

                eventDiv.innerHTML = `
                    <div class="timeline-event-marker"></div>
                    <div class="timeline-event-content">
                        <div class="timeline-event-date">${eventData.month} <span>${eventData.week ? eventData.week : eventData.year}</span></div>
                        <h4 class="timeline-event-title">${eventData.title}</h4>
                        <p class="timeline-event-details">${eventData.details}</p>
                        <span class="timeline-status ${statusClass}">${eventData.status.toUpperCase()}</span>
                    </div>
                `;
                if (index % 2 === 0) {
                    eventDiv.querySelector('.timeline-event-content').style.marginBottom = '40px';
                } else {
                    eventDiv.querySelector('.timeline-event-content').style.marginTop = '40px';
                }
                timelineContainer.appendChild(eventDiv);
            });
        }


        // --- JOURNEY DETAILS MODAL ---
        const journeyDetailsModal = document.getElementById('journeyDetailsModal');
        const journeyModalTitle = document.getElementById('journeyModalTitle');
        const journeyModalBody = document.getElementById('journeyModalBody');

        const journeyPhaseDetails = {
            phase1: {
                title: "Phase 1: Foundation & Legal Details",
                content: `<ul class="list-disc pl-5 space-y-1">
                            <li>Finalize Holding Company Name (Lead: Visa, Cost: R50, Due: May 22)</li>
                            <li>Register Holding Company (Pty) Ltd (Lead: Visa, Cost: R125, Due: May 28)</li>
                            <li>Draft Basic Trust Deeds (Research - Salatiso, Due: June 5)</li>
                            <li>Open Business Bank Account (Lead: Visa, Due: June 10)</li>
                            <li>SARS Registrations (Lead: Visa/Salatiso, Due: June 20)</li>
                            <li>Register Flamea as NPO (Lead: Visa/Salatiso, Target Start: June, Duration: 4-8 wks)</li>
                            <li>COID Registration (if applicable - Salatiso, Due: June 25)</li>
                         </ul>
                         <p class="mt-3 text-xs">Refer to Strategic Roadmap v4 for full details and responsible parties.</p>`
            },
            phase2: { title: "Phase 2: Operational & Content Setup Details", content: `<p>Key tasks: Internal Agreements (Salatiso), Venture Info Consolidation (Salatiso), Basic Accounting Setup (Visa/Salatiso), Initial Operating Budget (Visa/Salatiso), Formalize Service Offerings (All Leads), IP Inventory (Salatiso), Company Induction Materials Development (Kwakho/Salatiso). Target Completion: Mid-August 2025. Full details in Strategic Roadmap v4.</p>`},
            phase3: { title: "Phase 3: Internal Launch & Initial Operations Details", content: `<p>Key tasks: Intranet Launch (Salatiso/Solo), Training Plan Commencement (All), Initial Marketing Content (Tina), Regular Council Meetings (All), Critical: SafetyHelp Public Launch (June 1, 2025 - All Support). Ongoing from late August 2025. Full details in Strategic Roadmap v4.</p>`}
        };

        document.querySelectorAll('.view-journey-details-btn').forEach(button => {
            button.addEventListener('click', function() {
                const phaseKey = this.dataset.journeyPhase;
                const details = journeyPhaseDetails[phaseKey];
                if (details) {
                    journeyModalTitle.textContent = details.title;
                    journeyModalBody.innerHTML = details.content;
                    journeyDetailsModal.classList.add('active');
                }
            });
        });
        function closeJourneyModal() {
            journeyDetailsModal.classList.remove('active');
        }
         journeyDetailsModal.addEventListener('click', (event) => {
            if (event.target === journeyDetailsModal) {
                closeJourneyModal();
            }
        });


        // --- MODAL TABS ---
        function openModalTab(event, tabIdToOpen) {
            const modal = event.target.closest('.modal-content');
            if (!modal) return;

            modal.querySelectorAll('.modal-tab-pane').forEach(pane => pane.classList.remove('active'));
            modal.querySelectorAll('.modal-tab-button').forEach(btn => btn.classList.remove('active'));

            const tabToActivate = modal.querySelector('#' + tabIdToOpen);
            if (tabToActivate) tabToActivate.classList.add('active');
            event.currentTarget.classList.add('active');
        }
        
        // --- GOVERNANCE TABS ---
        function openTab(event, tabName) {
            var i, tabcontent, tablinks;
            const governanceSection = document.getElementById('governance');
            if (!governanceSection) return;
            tabcontent = governanceSection.getElementsByClassName("tab-content");
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = governanceSection.getElementsByClassName("tabs")[0].getElementsByTagName("button");
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            const tabToOpen = document.getElementById(tabName);
            if (tabToOpen) tabToOpen.style.display = "block";
            event.currentTarget.className += " active";
        }


        // --- INITIALIZE ---
        document.addEventListener('DOMContentLoaded', () => {
            const initialSection = 'dashboard'; 
            showMainSection(initialSection, true);

            populateTrainingProgress();
            populateMyPendingActions();
            populateCompanyLaunchRoadmap();
            populateRecentActivity();

            const teamSectionObserver = new MutationObserver((mutationsList, observer) => {
                for(const mutation of mutationsList) {
                    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                        const teamSection = document.getElementById('team');
                        if (teamSection.classList.contains('active') && !teamCarouselPopulated) {
                            populateAndInitTeamCarousel();
                        }
                    }
                }
            });
            if (document.getElementById('team')) {
                teamSectionObserver.observe(document.getElementById('team'), { attributes: true });
            }
            
            const governanceSection = document.getElementById('governance');
            if (governanceSection) {
                const governanceSectionObserver = new MutationObserver((mutationsList, observer) => {
                    for(const mutation of mutationsList) {
                        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
                            if (governanceSection.classList.contains('active')) {
                                const tabsContainer = governanceSection.querySelector('.tabs');
                                if (tabsContainer && !tabsContainer.querySelector('button.active')) {
                                     const firstTabButton = tabsContainer.querySelector('button');
                                     if(firstTabButton) firstTabButton.click();
                                }
                            }
                        }
                    }
                });
                governanceSectionObserver.observe(governanceSection, { attributes: true });
            }
             // Fill in any missing sections that were previously removed
            const ourVisionSection = document.getElementById('ourVision');
            if (ourVisionSection && ourVisionSection.innerHTML.trim() === "") {
                ourVisionSection.innerHTML = `<h2 class="section-title">Our Guiding Light: Vision & Mission</h2>
                <div class="grid md:grid-cols-2 gap-8 items-start">
                    <div class="bg-secondary-light bg-opacity-30 p-6 rounded-lg shadow-md border-l-4 border-secondary-medium">
                        <h3 class="font-display text-3xl text-secondary-dark mb-4 flex items-center"><i class="fas fa-eye mr-3 text-secondary-dark"></i>Our Vision</h3>
                        <p class="text-text-medium leading-relaxed">To be a leading family-owned enterprise recognized for its innovation, integrity, and commitment to empowering its members and the community, building a lasting legacy for generations to come, rooted in our Xhosa heritage and South African identity.</p>
                    </div>
                    <div class="bg-accent-orange bg-opacity-10 p-6 rounded-lg shadow-md border-l-4 border-accent-orange">
                        <h3 class="font-display text-3xl text-accent-orange mb-4 flex items-center"><i class="fas fa-bullseye mr-3 text-accent-orange"></i>Our Mission</h3>
                        <p class="text-text-medium leading-relaxed">To strategically manage and grow a diversified portfolio of ventures in OHS consulting, property management, digital solutions, education, and publishing, while fostering the professional development of family members and contributing positively to society through its non-profit activities.</p>
                    </div>
                </div>
                <div class="mt-10 text-center">
                    <p class="mt-3 text-text-medium text-sm">"Indlovu ithwala umboko wayo." (An elephant carries its own trunk - We are self-reliant and carry our own responsibilities.)</p>
                </div>`;
            }
            const teamSection = document.getElementById('team');
            if (teamSection && teamSection.innerHTML.trim() === "") {
                teamSection.innerHTML = `<h2 class="section-title">Our Family Team & Structure</h2>
                <p class="text-text-medium mb-4 text-sm">
                    Our strength lies in our family, working together with clearly defined roles and accountabilities. Solonwabo, while technically proficient and contributing significantly to product design, is in an apprentice role. He is accountable to the CSOO (Salatiso) for technical mentorship, skill development, and quality of technical output. He is responsible to the CEO (Visa) for project deliverables, timelines, and day-to-day operational alignment with company priorities. Tina and Kwakho report directly to the CEO.
                </p>
                <div class="organogram mb-10">
                    <div class="org-level">
                        <div class="org-node-container">
                            <div class="org-node" data-member="nozukile_org">
                                <div class="name">Nozukile Mdeni</div> <div class="role">Chairperson, Family Council</div>
                            </div>
                        </div>
                    </div>
                    <div class="org-connector-down"></div>
                    <div class="org-level">
                        <div class="org-node-container">
                            <div class="org-node" data-member="salatiso_org">
                               <div class="name">Salatiso L. Mdeni</div> <div class="role">CSOO</div>
                            </div>
                            <div class="org-connector-down"></div>
                            <div class="org-level"> <div class="org-node-container">
                                    <div class="org-node" data-member="solonwabo_org">
                                        <div class="name">Solonwabo M. Mdeni</div> <div class="role">Jr. Product Designer & Tech Apprentice</div>
                                        <div class="reporting-line">(Acct: CSOO, Resp: CEO)</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="org-node-container">
                            <div class="org-node" data-member="visa_org">
                                <div class="name">Visa Mdeni</div> <div class="role">CEO</div>
                            </div>
                            <div class="org-connector-down"></div>
                            <div class="org-level"> <div class="org-node-container">
                                    <div class="org-node" data-member="tina_org">
                                        <div class="name">Tina Mdeni</div> <div class="role">Head of Marketing & Comms, Tenant/Supplier Mgt.</div>
                                    </div>
                                </div>
                                <div class="org-node-container">
                                    <div class="org-node" data-member="kwakho_org">
                                        <div class="name">Kwakho Mdeni</div> <div class="role">Head of Ops Support & Curriculum Dev.</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                <p class="text-center text-sm text-text-light mb-8">Click on a team member in the organogram or the carousel below for detailed profiles, Personalized Action & Development Plans (PADP), and performance metrics.</p>
                <div class="mfe-carousel-container">
                    <div class="mfe-carousel-track"></div>
                    <button class="mfe-carousel-button prev-btn"><i class="fas fa-chevron-left"></i></button>
                    <button class="mfe-carousel-button next-btn"><i class="fas fa-chevron-right"></i></button>
                    <div class="carousel-dots mt-4"></div>
                </div>`;
                 if (!teamCarouselPopulated) populateAndInitTeamCarousel();
            }

            const venturesSection = document.getElementById('ventures');
            if (venturesSection && venturesSection.innerHTML.trim() === "") {
                venturesSection.innerHTML = `<h2 class="section-title">Our Family Ventures</h2>
                <div class="resource-grid">
                    <div class="resource-card">
                        <h4>SafetyHelp OHS Platform</h4>
                        <p>AI-enhanced tools for OHS compliance, risk assessments, and safety management. Led by Visa Mdeni.</p>
                        <a href="#" class="learn-more-btn">Explore SafetyHelp Details</a>
                    </div>
                    <div class="resource-card">
                        <h4>Sazi Life Education</h4>
                        <p>Personalized learning resources and homeschooling support, fostering lifelong learning. Led by Kwakho Mdeni.</p>
                        <a href="#" class="learn-more-btn">Discover Sazi Life</a>
                    </div>
                    <div class="resource-card">
                        <h4>Salatiso Mdeni Ventures</h4>
                        <p>Expert OHS, Risk Management, Compliance, and Business Continuity consulting services.</p>
                        <a href="#" class="learn-more-btn">Consulting Services</a>
                    </div>
                    <div class="resource-card">
                        <h4>Digital Creations & Publishing</h4>
                        <p>Website design, e-learning content, and book publishing services. Showcasing our family's creative and tech skills.</p>
                        <a href="#" class="learn-more-btn">Our Digital Portfolio</a>
                    </div>
                    <div class="resource-card">
                        <h4>Property Management</h4>
                        <p>Management of family rental properties and Airbnb units, ensuring optimal returns and guest satisfaction.</p>
                        <a href="#" class="learn-more-btn">View Properties</a>
                    </div>
                    <div class="resource-card">
                        <h4><i class="fas fa-hands-helping mr-2 text-secondary-medium"></i>Flamea (Non-Profit Arm)</h4>
                        <p>Promoting equality through education, fathers' & family rights advocacy, and community upliftment. <a href="https://flamea.org/" target="_blank" class="text-primary-medium hover:underline">Visit Flamea.org</a></p>
                    </div>
                </div>`;
            }

            const trainingHubSection = document.getElementById('trainingHub');
             if (trainingHubSection && trainingHubSection.innerHTML.trim() === "") {
                trainingHubSection.innerHTML = `<h2 class="section-title">Training & Development Hub</h2>
                <p class="mb-6 text-text-medium">Welcome to the central hub for all Mdeni Family Enterprise training and development. Here you can find links to individual training plans, shared resources, and upcoming workshop schedules. Our goal is to empower every family member with the skills and knowledge to excel in their roles and contribute to our collective success.</p>
                <div class="grid md:grid-cols-2 gap-6">
                    <div class="dashboard-widget">
                        <h3><i class="fas fa-user-graduate text-secondary-medium"></i>My Training Plan</h3>
                        <p class="text-sm mb-3 text-text-light">Access your personalized training action plan, update your progress, and find relevant resources.</p>
                        <button class="bg-primary-medium hover:bg-primary-dark text-white py-2 px-4 rounded text-sm" onclick="openMyTrainingPlan()">Go to My Plan</button>
                    </div>
                    <div class="dashboard-widget">
                        <h3><i class="fas fa-chalkboard-teacher text-secondary-medium"></i>Master Training Overview</h3>
                        <p class="text-sm mb-3 text-text-light">View the aggregated training progress for the entire team and identify upcoming group sessions.</p>
                        <a href="#" class="learn-more-btn">View Master Plan</a>
                    </div>
                    <div class="dashboard-widget">
                        <h3><i class="fas fa-book text-secondary-medium"></i>Shared Learning Resources</h3>
                        <ul class="text-sm space-y-1">
                            <li><a href="#" class="text-primary-medium hover:underline">MFE Onboarding Guide V1.pdf</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Link to Free Digital Marketing Courses</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">OHS Act Summary Document</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Guide to Using Asana/Trello for PM</a></li>
                        </ul>
                    </div>
                    <div class="dashboard-widget">
                        <h3><i class="fas fa-calendar-alt text-secondary-medium"></i>Upcoming Workshops</h3>
                        <p class="text-sm text-text-medium"><strong>June 15:</strong> Introduction to Financial Literacy for Small Business (All invited)</p>
                        <p class="text-sm mt-1 text-text-medium"><strong>July 5:</strong> Advanced Canva Techniques for Marketing (Tina, Solo)</p>
                    </div>
                </div>`;
            }
            const documentsSection = document.getElementById('documents');
            if(documentsSection && documentsSection.innerHTML.trim() === "") {
                 documentsSection.innerHTML = `<h2 class="section-title">Company Documents & Resources</h2>
                <p class="mb-6 text-text-medium">This is the central repository for all official Mdeni Family Enterprise documents. Please ensure you are familiar with relevant policies and procedures.</p>
                 <div class="resource-grid">
                    <div class="resource-card">
                        <h4><i class="fas fa-file-alt mr-2 text-secondary-medium"></i>Foundational Documents</h4>
                        <ul class="list-disc pl-5 text-sm mt-2 space-y-1">
                            <li><a href="#" class="text-primary-medium hover:underline">Strategic Roadmap & Foundational Plan v4.0.pdf</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Company Registration Certificate (CoR 14.3).pdf</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Draft Trust Deed - Sazi Mdeni Family Trust.docx</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Flamea NPO Registration Application.pdf</a></li>
                        </ul>
                    </div>
                     <div class="resource-card">
                        <h4><i class="fas fa-briefcase mr-2 text-secondary-medium"></i>Operational Documents</h4>
                        <ul class="list-disc pl-5 text-sm mt-2 space-y-1">
                            <li><a href="#" class="text-primary-medium hover:underline">Q3 Operating Budget.xlsx</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Service Agreement Template.docx</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Marketing & Brand Guidelines V1.pdf</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Supplier Vetting Checklist.pdf</a></li>
                        </ul>
                    </div>
                     <div class="resource-card">
                        <h4><i class="fas fa-users mr-2 text-secondary-medium"></i>HR & Team Documents</h4>
                        <ul class="list-disc pl-5 text-sm mt-2 space-y-1">
                            <li><a href="#" class="text-primary-medium hover:underline">Family Council Meeting Minutes (May 2025).pdf</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Performance Review Template.docx</a></li>
                            <li><a href="#" class="text-primary-medium hover:underline">Work From Home Policy Guide.pdf</a></li>
                        </ul>
                    </div>
                 </div>`;
            }
             const governanceSectionContent = document.getElementById('governance');
             if(governanceSectionContent && governanceSectionContent.innerHTML.trim() === "") {
                governanceSectionContent.innerHTML = ` <h2 class="section-title">Governance & Compliance</h2>
                <div class="tabs mb-6">
                    <button class="active" onclick="openTab(event, 'doaTab')">Delegation of Authority</button>
                    <button onclick="openTab(event, 'legalResourcesTab')">Key Legal Resources</button>
                    <button onclick="openTab(event, 'policyTab')">Company Policies</button>
                </div>
                <div id="doaTab" class="tab-content">
                    <h3 class="text-xl font-semibold mb-3 text-primary-dark">Delegation of Authority (DoA) Overview</h3>
                    <p class="text-sm text-text-medium mb-4">The DoA outlines decision-making powers and responsibilities within the Mdeni Family Enterprise. This ensures clarity, efficiency, and accountability. The full DoA document will be linked here once finalized.</p>
                    <ul class="list-disc pl-5 text-sm space-y-2 text-text-medium">
                        <li><strong>CSOO (Salatiso L. Mdeni):</strong> Strategic oversight, major unbudgeted CapEx, core compliance frameworks, appointment of Chairperson & CEO (initial).</li>
                        <li><strong>Chairperson (Nozukile Mdeni):</strong> Convening Family Council, ethical guidance, support CEO appointments.</li>
                        <li><strong>CEO (Visa Mdeni):</strong> Operational decisions, budgeted expenditure, team management, performance reviews, client contracts (defined limits), team appointments. Accountable for supplier/tenant management (delegated to Tina).</li>
                        <li><strong>Heads of Dept. (Tina, Kwakho):</strong> Functional area management, assigned budgets, task delegation.</li>
                    </ul>
                    <p class="mt-4 text-xs text-text-light"><em>Awaiting formal DoA document upload.</em></p>
                </div>
                <div id="legalResourcesTab" class="tab-content" style="display:none;">
                    <h3 class="text-xl font-semibold mb-3 text-primary-dark">Key Legal & Compliance Resources</h3>
                    <ul class="list-disc pl-5 text-sm space-y-2">
                        <li><a href="https://www.cipc.co.za/" target="_blank" class="text-primary-medium hover:underline">CIPC (Companies and Intellectual Property Commission)</a></li>
                        <li><a href="https://www.gov.za/documents/constitution-republic-south-africa-1996" target="_blank" class="text-primary-medium hover:underline">The Constitution of South Africa</a></li>
                        <li><a href="https://www.gov.za/documents/occupational-health-and-safety-act" target="_blank" class="text-primary-medium hover:underline">Occupational Health and Safety Act (OHSA)</a></li>
                        <li><a href="https://www.gov.za/documents/companies-act" target="_blank" class="text-primary-medium hover:underline">Companies Act</a></li>
                    </ul>
                </div>
                 <div id="policyTab" class="tab-content" style="display:none;">
                    <h3 class="text-xl font-semibold mb-3 text-primary-dark">Company Policies (Drafts / To Be Developed)</h3>
                     <ul class="list-disc pl-5 text-sm space-y-2 text-text-medium">
                        <li>Work From Home Policy</li>
                        <li>Data Protection & Privacy Policy (POPIA Compliance)</li>
                        <li>Code of Conduct & Ethics</li>
                    </ul>
                     <p class="mt-4 text-xs text-text-light"><em>Policy documents will be uploaded here as they are finalized.</em></p>
                </div>`;
                const tabsContainer = governanceSectionContent.querySelector('.tabs');
                if (tabsContainer && !tabsContainer.querySelector('button.active')) {
                        const firstTabButton = tabsContainer.querySelector('button');
                        if(firstTabButton) firstTabButton.click();
                }
            }
            const footerElement = document.querySelector('footer');
            if (footerElement && footerElement.innerHTML.trim() === "") {
                footerElement.innerHTML = `<div class="container mx-auto px-6">
                    <p>&copy; ${new Date().getFullYear()} Mdeni Family Enterprise (Pty) Ltd. All Rights Reserved.</p>
                    <p>Internal Portal - Confidential. Built with <i class="fas fa-heart text-red-400"></i> by the Mdeni Family, for the Mdeni Family.</p>
                </div>`;
            }
            const headerElement = document.querySelector('header');
            if (headerElement && headerElement.innerHTML.trim() === "") {
                 headerElement.innerHTML = `<div class="header-container">
                    <div class="logo-container flex items-center">
                        <img src="salatiso/assets/photos/mfe_logo_earthy_placeholder.png" alt="Mdeni Family Enterprise Logo">
                        <span class="company-name">Mdeni Family Intranet</span>
                    </div>
                    <nav class="main-nav-links">
                         <a href="#" data-target="dashboard" class="active-main-nav">Dashboard</a>
                        <a href="#" data-target="ourVision">Our Vision</a>
                        <a href="#" data-target="team">Our Team</a>
                        <a href="#" data-target="ourJourney">Our Journey</a>
                        <a href="#" data-target="ventures">Ventures</a>
                        <a href="#" data-target="trainingHub">Training Hub</a>
                        <a href="#" data-target="documents">Docs</a>
                        <a href="#" data-target="governance">Governance</a>
                    </nav>
                    <div class="user-actions">
                        <div class="notification-bell">
                            <i class="fas fa-bell"></i>
                            <span class="notification-badge">4</span>
                        </div>
                        <div class="user-profile-menu ml-5 relative">
                            <button>
                                <img src="salatiso/assets/photos/team/profile_salatiso_thumb.jpg" alt="Salatiso Mdeni Profile">
                            </button>
                            <div class="dropdown-menu">
                                <a href="#" id="myProfileLinkRecheck">My Profile & Plan</a>
                                <a href="#">Settings</a>
                                <a href="#">Logout (Conceptual)</a>
                            </div>
                        </div>
                    </div>
                </div>`;
                document.querySelectorAll('.main-nav-links a').forEach(link => {
                    link.addEventListener('click', (e) => {
                        e.preventDefault();
                        const targetId = link.dataset.target;
                        showMainSection(targetId, false);
                    });
                });
                const myProfileLinkRecheck = document.getElementById('myProfileLinkRecheck');
                if (myProfileLinkRecheck) {
                     myProfileLinkRecheck.addEventListener('click', (e) => {
                        e.preventDefault();
                        showMainSection('team', false);
                        setTimeout(() => populateModal(currentLoggedInUser), 50);
                    });
                }
            }


        });

    </script>
</body>
</html>
